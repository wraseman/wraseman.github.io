(function(e,t){'object'==typeof exports&&'object'==typeof module?module.exports=t():'function'==typeof define&&define.amd?define([],t):'object'==typeof exports?exports.ML=t():e.ML=t()})(this,function(){var e=Number.MAX_VALUE,t=Number.MIN_VALUE,n=Math.tanh,o=Math.exp,s=Math.ceil,r=Math.log,c=Math.pow,u=Math.abs,a=Number.EPSILON,M=Math.max,v=Math.min,g=Math.floor,m=Number.isInteger,R=Math.sqrt;return function(e){function t(n){if(i[n])return i[n].exports;var o=i[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var i={};return t.m=e,t.c=i,t.d=function(e,i,n){t.o(e,i)||Object.defineProperty(e,i,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var i=e&&e.__esModule?function(){return e['default']}:function(){return e};return t.d(i,'a',i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p='',t(t.s=103)}([function(e){'use strict';function t(e,t){for(var n=0,o=0;o<e.length;o++)n+=(e[o]-t[o])*(e[o]-t[o]);return n}function i(e,i){return R(t(e,i))}e.exports=i,i.squared=t},function(e,t,i){'use strict';e.exports=t=i(105),t.getEquallySpacedData=i(107).getEquallySpacedData,t.SNV=i(108).SNV},function(e,t,i){'use strict';t.array=i(52),t.matrix=i(106)},function(e,t,i){'use strict';function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var o=i(125);Object.defineProperty(t,'maybeToPrecision',{enumerable:!0,get:function(){return n(o).default}});var s=i(126);Object.defineProperty(t,'checkArrayLength',{enumerable:!0,get:function(){return n(s).default}});class r{constructor(){if(new.target===r)throw new Error('BaseRegression must be subclassed')}predict(e){if('number'==typeof e)return this._predict(e);if(Array.isArray(e)){for(var t=Array(e.length),n=0;n<e.length;n++)t[n]=this._predict(e[n]);return t}throw new TypeError('x must be a number or array')}_predict(){throw new Error('_predict must be implemented')}train(){}toString(){return''}toLaTeX(){return''}score(e,t){if(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length)throw new Error('x and y must be arrays of the same length');for(var o=e.length,n=Array(o),s=0;s<o;s++)n[s]=this._predict(e[s]);for(var i=0,a=0,l=0,c=0,u=0,m=0,d=0,g=0;g<o;g++)i+=n[g],a+=t[g],u+=n[g]*n[g],m+=t[g]*t[g],d+=n[g]*t[g],0!==t[g]&&(l+=(t[g]-n[g])*(t[g]-n[g])/t[g]),c=(t[g]-n[g])*(t[g]-n[g]);var h=(o*d-i*a)/R((o*u-i*i)*(o*m-a*a));return{r:h,r2:h*h,chi2:l,rmsd:c*c/o}}}t.default=r},function(e,t,i){'use strict';Object.defineProperty(t,'__esModule',{value:!0}),i(104);var n=i(32),o=function(e){return e&&e.__esModule?e:{default:e}}(n),s=i(23);class r extends(0,o.default)(Array){constructor(e,t){var n;if(1===arguments.length&&'number'==typeof e)return Array(e);if(r.isMatrix(e))return e.clone();if(m(e)&&0<e){if(super(e),m(t)&&0<t)for(n=0;n<e;n++)this[n]=Array(t);else throw new TypeError('nColumns must be a positive integer');}else if(Array.isArray(e)){var i=e;if(e=i.length,t=i[0].length,'number'!=typeof t||0===t)throw new TypeError('Data must be a 2D array with at least one element');for(super(e),n=0;n<e;n++){if(i[n].length!==t)throw new RangeError('Inconsistent array dimensions');this[n]=[].concat(i[n])}}else throw new TypeError('First argument must be a positive number or an array');return this.rows=e,this.columns=t,this}set(e,t,i){return this[e][t]=i,this}get(e,t){return this[e][t]}clone(){for(var e=new this.constructor[Symbol.species](this.rows,this.columns),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e.set(t,i,this.get(t,i));return e}removeRow(e){if((0,s.checkRowIndex)(this,e),1===this.rows)throw new RangeError('A matrix cannot have less than one row');return this.splice(e,1),this.rows-=1,this}addRow(e,t){return void 0===t&&(t=e,e=this.rows),(0,s.checkRowIndex)(this,e,!0),t=(0,s.checkRowVector)(this,t,!0),this.splice(e,0,t),this.rows+=1,this}removeColumn(e){if((0,s.checkColumnIndex)(this,e),1===this.columns)throw new RangeError('A matrix cannot have less than one column');for(var t=0;t<this.rows;t++)this[t].splice(e,1);return this.columns-=1,this}addColumn(e,t){'undefined'==typeof t&&(t=e,e=this.columns),(0,s.checkColumnIndex)(this,e,!0),t=(0,s.checkColumnVector)(this,t);for(var n=0;n<this.rows;n++)this[n].splice(e,0,t[n]);return this.columns+=1,this}}t.default=r},function(e,t,i){'use strict';i(193);var n=i(69),o=i(24);class s extends n(Array){constructor(e,t){var n;if(1===arguments.length&&'number'==typeof e)return Array(e);if(s.isMatrix(e))return e.clone();if(m(e)&&0<e){if(super(e),m(t)&&0<t)for(n=0;n<e;n++)this[n]=Array(t);else throw new TypeError('nColumns must be a positive integer');}else if(Array.isArray(e)){var i=e;if(e=i.length,t=i[0].length,'number'!=typeof t||0===t)throw new TypeError('Data must be a 2D array with at least one element');for(super(e),n=0;n<e;n++){if(i[n].length!==t)throw new RangeError('Inconsistent array dimensions');this[n]=[].concat(i[n])}}else throw new TypeError('First argument must be a positive number or an array');return this.rows=e,this.columns=t,this}set(e,t,i){return this[e][t]=i,this}get(e,t){return this[e][t]}clone(){for(var e=new this.constructor[Symbol.species](this.rows,this.columns),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e.set(t,i,this.get(t,i));return e}removeRow(e){if(o.checkRowIndex(this,e),1===this.rows)throw new RangeError('A matrix cannot have less than one row');return this.splice(e,1),this.rows-=1,this}addRow(e,t){return void 0===t&&(t=e,e=this.rows),o.checkRowIndex(this,e,!0),t=o.checkRowVector(this,t,!0),this.splice(e,0,t),this.rows+=1,this}removeColumn(e){if(o.checkColumnIndex(this,e),1===this.columns)throw new RangeError('A matrix cannot have less than one column');for(var t=0;t<this.rows;t++)this[t].splice(e,1);return this.columns-=1,this}addColumn(e,t){'undefined'==typeof t&&(t=e,e=this.columns),o.checkColumnIndex(this,e,!0),t=o.checkColumnVector(this,t);for(var n=0;n<this.rows;n++)this[n].splice(e,0,t[n]);return this.columns+=1,this}}t.Matrix=s,s.abstractMatrix=n},function(e,t,i){'use strict';i(211);var n=i(73),o=i(25);class s extends n(Array){constructor(e,t){var n;if(1===arguments.length&&'number'==typeof e)return Array(e);if(s.isMatrix(e))return e.clone();if(m(e)&&0<e){if(super(e),m(t)&&0<t)for(n=0;n<e;n++)this[n]=Array(t);else throw new TypeError('nColumns must be a positive integer');}else if(Array.isArray(e)){var i=e;if(e=i.length,t=i[0].length,'number'!=typeof t||0===t)throw new TypeError('Data must be a 2D array with at least one element');for(super(e),n=0;n<e;n++){if(i[n].length!==t)throw new RangeError('Inconsistent array dimensions');this[n]=[].concat(i[n])}}else throw new TypeError('First argument must be a positive number or an array');return this.rows=e,this.columns=t,this}set(e,t,i){return this[e][t]=i,this}get(e,t){return this[e][t]}clone(){for(var e=new this.constructor[Symbol.species](this.rows,this.columns),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e.set(t,i,this.get(t,i));return e}removeRow(e){if(o.checkRowIndex(this,e),1===this.rows)throw new RangeError('A matrix cannot have less than one row');return this.splice(e,1),this.rows-=1,this}addRow(e,t){return void 0===t&&(t=e,e=this.rows),o.checkRowIndex(this,e,!0),t=o.checkRowVector(this,t,!0),this.splice(e,0,t),this.rows+=1,this}removeColumn(e){if(o.checkColumnIndex(this,e),1===this.columns)throw new RangeError('A matrix cannot have less than one column');for(var t=0;t<this.rows;t++)this[t].splice(e,1);return this.columns-=1,this}addColumn(e,t){'undefined'==typeof t&&(t=e,e=this.columns),o.checkColumnIndex(this,e,!0),t=o.checkColumnVector(this,t);for(var n=0;n<this.rows;n++)this[n].splice(e,0,t[n]);return this.columns+=1,this}}t.Matrix=s,s.abstractMatrix=n},function(e,t,i){'use strict';i(228);var n=i(76),o=i(26);class s extends n(Array){constructor(e,t){var n;if(1===arguments.length&&'number'==typeof e)return Array(e);if(s.isMatrix(e))return e.clone();if(m(e)&&0<e){if(super(e),m(t)&&0<t)for(n=0;n<e;n++)this[n]=Array(t);else throw new TypeError('nColumns must be a positive integer');}else if(Array.isArray(e)){var i=e;if(e=i.length,t=i[0].length,'number'!=typeof t||0===t)throw new TypeError('Data must be a 2D array with at least one element');for(super(e),n=0;n<e;n++){if(i[n].length!==t)throw new RangeError('Inconsistent array dimensions');this[n]=[].concat(i[n])}}else throw new TypeError('First argument must be a positive number or an array');return this.rows=e,this.columns=t,this}set(e,t,i){return this[e][t]=i,this}get(e,t){return this[e][t]}clone(){for(var e=new this.constructor[Symbol.species](this.rows,this.columns),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e.set(t,i,this.get(t,i));return e}removeRow(e){if(o.checkRowIndex(this,e),1===this.rows)throw new RangeError('A matrix cannot have less than one row');return this.splice(e,1),this.rows-=1,this}addRow(e,t){return void 0===t&&(t=e,e=this.rows),o.checkRowIndex(this,e,!0),t=o.checkRowVector(this,t,!0),this.splice(e,0,t),this.rows+=1,this}removeColumn(e){if(o.checkColumnIndex(this,e),1===this.columns)throw new RangeError('A matrix cannot have less than one column');for(var t=0;t<this.rows;t++)this[t].splice(e,1);return this.columns-=1,this}addColumn(e,t){'undefined'==typeof t&&(t=e,e=this.columns),o.checkColumnIndex(this,e,!0),t=o.checkColumnVector(this,t);for(var n=0;n<this.rows;n++)this[n].splice(e,0,t[n]);return this.columns+=1,this}}t.Matrix=s,s.abstractMatrix=n},function(e,t,i){'use strict';i(241);var n=i(80),o=i(27);class s extends n(Array){constructor(e,t){var n;if(1===arguments.length&&'number'==typeof e)return Array(e);if(s.isMatrix(e))return e.clone();if(m(e)&&0<e){if(super(e),m(t)&&0<t)for(n=0;n<e;n++)this[n]=Array(t);else throw new TypeError('nColumns must be a positive integer');}else if(Array.isArray(e)){var i=e;if(e=i.length,t=i[0].length,'number'!=typeof t||0===t)throw new TypeError('Data must be a 2D array with at least one element');for(super(e),n=0;n<e;n++){if(i[n].length!==t)throw new RangeError('Inconsistent array dimensions');this[n]=[].concat(i[n])}}else throw new TypeError('First argument must be a positive number or an array');return this.rows=e,this.columns=t,this}set(e,t,i){return this[e][t]=i,this}get(e,t){return this[e][t]}clone(){for(var e=new this.constructor[Symbol.species](this.rows,this.columns),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e.set(t,i,this.get(t,i));return e}removeRow(e){if(o.checkRowIndex(this,e),1===this.rows)throw new RangeError('A matrix cannot have less than one row');return this.splice(e,1),this.rows-=1,this}addRow(e,t){return void 0===t&&(t=e,e=this.rows),o.checkRowIndex(this,e,!0),t=o.checkRowVector(this,t,!0),this.splice(e,0,t),this.rows+=1,this}removeColumn(e){if(o.checkColumnIndex(this,e),1===this.columns)throw new RangeError('A matrix cannot have less than one column');for(var t=0;t<this.rows;t++)this[t].splice(e,1);return this.columns-=1,this}addColumn(e,t){'undefined'==typeof t&&(t=e,e=this.columns),o.checkColumnIndex(this,e,!0),t=o.checkColumnVector(this,t);for(var n=0;n<this.rows;n++)this[n].splice(e,0,t[n]);return this.columns+=1,this}}t.Matrix=s,s.abstractMatrix=n},function(e,t,i){'use strict';i(257);var n=i(83),o=i(28);class s extends n(Array){constructor(e,t){var n;if(1===arguments.length&&'number'==typeof e)return Array(e);if(s.isMatrix(e))return e.clone();if(m(e)&&0<e){if(super(e),m(t)&&0<t)for(n=0;n<e;n++)this[n]=Array(t);else throw new TypeError('nColumns must be a positive integer');}else if(Array.isArray(e)){var i=e;if(e=i.length,t=i[0].length,'number'!=typeof t||0===t)throw new TypeError('Data must be a 2D array with at least one element');for(super(e),n=0;n<e;n++){if(i[n].length!==t)throw new RangeError('Inconsistent array dimensions');this[n]=[].concat(i[n])}}else throw new TypeError('First argument must be a positive number or an array');return this.rows=e,this.columns=t,this}set(e,t,i){return this[e][t]=i,this}get(e,t){return this[e][t]}clone(){for(var e=new this.constructor[Symbol.species](this.rows,this.columns),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e.set(t,i,this.get(t,i));return e}removeRow(e){if(o.checkRowIndex(this,e),1===this.rows)throw new RangeError('A matrix cannot have less than one row');return this.splice(e,1),this.rows-=1,this}addRow(e,t){return void 0===t&&(t=e,e=this.rows),o.checkRowIndex(this,e,!0),t=o.checkRowVector(this,t,!0),this.splice(e,0,t),this.rows+=1,this}removeColumn(e){if(o.checkColumnIndex(this,e),1===this.columns)throw new RangeError('A matrix cannot have less than one column');for(var t=0;t<this.rows;t++)this[t].splice(e,1);return this.columns-=1,this}addColumn(e,t){'undefined'==typeof t&&(t=e,e=this.columns),o.checkColumnIndex(this,e,!0),t=o.checkColumnVector(this,t);for(var n=0;n<this.rows;n++)this[n].splice(e,0,t[n]);return this.columns+=1,this}}t.Matrix=s,s.abstractMatrix=n},function(e,t,i){'use strict';i(277);var n=i(88),o=i(29);class s extends n(Array){constructor(e,t){var n;if(1===arguments.length&&'number'==typeof e)return Array(e);if(s.isMatrix(e))return e.clone();if(m(e)&&0<e){if(super(e),m(t)&&0<t)for(n=0;n<e;n++)this[n]=Array(t);else throw new TypeError('nColumns must be a positive integer');}else if(Array.isArray(e)){var i=e;if(e=i.length,t=i[0].length,'number'!=typeof t||0===t)throw new TypeError('Data must be a 2D array with at least one element');for(super(e),n=0;n<e;n++){if(i[n].length!==t)throw new RangeError('Inconsistent array dimensions');this[n]=[].concat(i[n])}}else throw new TypeError('First argument must be a positive number or an array');return this.rows=e,this.columns=t,this}set(e,t,i){return this[e][t]=i,this}get(e,t){return this[e][t]}clone(){for(var e=new this.constructor[Symbol.species](this.rows,this.columns),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e.set(t,i,this.get(t,i));return e}removeRow(e){if(o.checkRowIndex(this,e),1===this.rows)throw new RangeError('A matrix cannot have less than one row');return this.splice(e,1),this.rows-=1,this}addRow(e,t){return void 0===t&&(t=e,e=this.rows),o.checkRowIndex(this,e,!0),t=o.checkRowVector(this,t,!0),this.splice(e,0,t),this.rows+=1,this}removeColumn(e){if(o.checkColumnIndex(this,e),1===this.columns)throw new RangeError('A matrix cannot have less than one column');for(var t=0;t<this.rows;t++)this[t].splice(e,1);return this.columns-=1,this}addColumn(e,t){'undefined'==typeof t&&(t=e,e=this.columns),o.checkColumnIndex(this,e,!0),t=o.checkColumnVector(this,t);for(var n=0;n<this.rows;n++)this[n].splice(e,0,t[n]);return this.columns+=1,this}}t.Matrix=s,s.abstractMatrix=n},function(e,t,i){'use strict';i(291);var n=i(91),o=i(30);class s extends n(Array){constructor(e,t){var n;if(1===arguments.length&&'number'==typeof e)return Array(e);if(s.isMatrix(e))return e.clone();if(m(e)&&0<e){if(super(e),m(t)&&0<t)for(n=0;n<e;n++)this[n]=Array(t);else throw new TypeError('nColumns must be a positive integer');}else if(Array.isArray(e)){var i=e;if(e=i.length,t=i[0].length,'number'!=typeof t||0===t)throw new TypeError('Data must be a 2D array with at least one element');for(super(e),n=0;n<e;n++){if(i[n].length!==t)throw new RangeError('Inconsistent array dimensions');this[n]=[].concat(i[n])}}else throw new TypeError('First argument must be a positive number or an array');return this.rows=e,this.columns=t,this}set(e,t,i){return this[e][t]=i,this}get(e,t){return this[e][t]}clone(){for(var e=new this.constructor[Symbol.species](this.rows,this.columns),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e.set(t,i,this.get(t,i));return e}removeRow(e){if(o.checkRowIndex(this,e),1===this.rows)throw new RangeError('A matrix cannot have less than one row');return this.splice(e,1),this.rows-=1,this}addRow(e,t){return void 0===t&&(t=e,e=this.rows),o.checkRowIndex(this,e,!0),t=o.checkRowVector(this,t,!0),this.splice(e,0,t),this.rows+=1,this}removeColumn(e){if(o.checkColumnIndex(this,e),1===this.columns)throw new RangeError('A matrix cannot have less than one column');for(var t=0;t<this.rows;t++)this[t].splice(e,1);return this.columns-=1,this}addColumn(e,t){'undefined'==typeof t&&(t=e,e=this.columns),o.checkColumnIndex(this,e,!0),t=o.checkColumnVector(this,t);for(var n=0;n<this.rows;n++)this[n].splice(e,0,t[n]);return this.columns+=1,this}}t.Matrix=s,s.abstractMatrix=n},function(e,t,i){'use strict';i(322);var n=i(97),o=i(31);class s extends n(Array){constructor(e,t){var n;if(1===arguments.length&&'number'==typeof e)return Array(e);if(s.isMatrix(e))return e.clone();if(m(e)&&0<e){if(super(e),m(t)&&0<t)for(n=0;n<e;n++)this[n]=Array(t);else throw new TypeError('nColumns must be a positive integer');}else if(Array.isArray(e)){var i=e;if(e=i.length,t=i[0].length,'number'!=typeof t||0===t)throw new TypeError('Data must be a 2D array with at least one element');for(super(e),n=0;n<e;n++){if(i[n].length!==t)throw new RangeError('Inconsistent array dimensions');this[n]=[].concat(i[n])}}else throw new TypeError('First argument must be a positive number or an array');return this.rows=e,this.columns=t,this}set(e,t,i){return this[e][t]=i,this}get(e,t){return this[e][t]}clone(){for(var e=new this.constructor[Symbol.species](this.rows,this.columns),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e.set(t,i,this.get(t,i));return e}removeRow(e){if(o.checkRowIndex(this,e),1===this.rows)throw new RangeError('A matrix cannot have less than one row');return this.splice(e,1),this.rows-=1,this}addRow(e,t){return void 0===t&&(t=e,e=this.rows),o.checkRowIndex(this,e,!0),t=o.checkRowVector(this,t,!0),this.splice(e,0,t),this.rows+=1,this}removeColumn(e){if(o.checkColumnIndex(this,e),1===this.columns)throw new RangeError('A matrix cannot have less than one column');for(var t=0;t<this.rows;t++)this[t].splice(e,1);return this.columns-=1,this}addColumn(e,t){'undefined'==typeof t&&(t=e,e=this.columns),o.checkColumnIndex(this,e,!0),t=o.checkColumnVector(this,t);for(var n=0;n<this.rows;n++)this[n].splice(e,0,t[n]);return this.columns+=1,this}}t.Matrix=s,s.abstractMatrix=n},function(e,t,i){'use strict';function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var o=i(4);Object.defineProperty(t,'default',{enumerable:!0,get:function(){return n(o).default}}),Object.defineProperty(t,'Matrix',{enumerable:!0,get:function(){return n(o).default}});var s=i(32);Object.defineProperty(t,'abstractMatrix',{enumerable:!0,get:function(){return n(s).default}});var r=i(116);Object.defineProperty(t,'solve',{enumerable:!0,get:function(){return r.solve}}),Object.defineProperty(t,'inverse',{enumerable:!0,get:function(){return r.inverse}});var a=i(51);Object.defineProperty(t,'SingularValueDecomposition',{enumerable:!0,get:function(){return n(a).default}}),Object.defineProperty(t,'SVD',{enumerable:!0,get:function(){return n(a).default}});var l=i(117);Object.defineProperty(t,'EigenvalueDecomposition',{enumerable:!0,get:function(){return n(l).default}}),Object.defineProperty(t,'EVD',{enumerable:!0,get:function(){return n(l).default}});var c=i(118);Object.defineProperty(t,'CholeskyDecomposition',{enumerable:!0,get:function(){return n(c).default}}),Object.defineProperty(t,'CHO',{enumerable:!0,get:function(){return n(c).default}});var u=i(33);Object.defineProperty(t,'LuDecomposition',{enumerable:!0,get:function(){return n(u).default}}),Object.defineProperty(t,'LU',{enumerable:!0,get:function(){return n(u).default}});var m=i(53);Object.defineProperty(t,'QrDecomposition',{enumerable:!0,get:function(){return n(m).default}}),Object.defineProperty(t,'QR',{enumerable:!0,get:function(){return n(m).default}})},function(e,t,i){'use strict';function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var o=i(32),s=n(o),r=i(4),a=n(r);class l extends(0,s.default)(){constructor(e,t,i){super(),this.matrix=e,this.rows=t,this.columns=i}static get[Symbol.species](){return a.default}}t.default=l},function(e,t,i){'use strict';var n=i(69),o=i(5);class s extends n(){constructor(e,t,i){super(),this.matrix=e,this.rows=t,this.columns=i}static get[Symbol.species](){return o.Matrix}}e.exports=s},function(e,t,i){'use strict';var n=i(73),o=i(6);class s extends n(){constructor(e,t,i){super(),this.matrix=e,this.rows=t,this.columns=i}static get[Symbol.species](){return o.Matrix}}e.exports=s},function(e,t,i){'use strict';var n=i(76),o=i(7);class s extends n(){constructor(e,t,i){super(),this.matrix=e,this.rows=t,this.columns=i}static get[Symbol.species](){return o.Matrix}}e.exports=s},function(e,t,i){'use strict';var n=i(80),o=i(8);class s extends n(){constructor(e,t,i){super(),this.matrix=e,this.rows=t,this.columns=i}static get[Symbol.species](){return o.Matrix}}e.exports=s},function(e,t,i){'use strict';var n=i(83),o=i(9);class s extends n(){constructor(e,t,i){super(),this.matrix=e,this.rows=t,this.columns=i}static get[Symbol.species](){return o.Matrix}}e.exports=s},function(e,t,i){'use strict';var n=i(88),o=i(10);class s extends n(){constructor(e,t,i){super(),this.matrix=e,this.rows=t,this.columns=i}static get[Symbol.species](){return o.Matrix}}e.exports=s},function(e,t,i){'use strict';var n=i(91),o=i(11);class s extends n(){constructor(e,t,i){super(),this.matrix=e,this.rows=t,this.columns=i}static get[Symbol.species](){return o.Matrix}}e.exports=s},function(e,t,i){'use strict';var n=i(97),o=i(12);class s extends n(){constructor(e,t,i){super(),this.matrix=e,this.rows=t,this.columns=i}static get[Symbol.species](){return o.Matrix}}e.exports=s},function(e,t,i){'use strict';Object.defineProperty(t,'__esModule',{value:!0}),t.checkRowIndex=function(e,t,i){var n=i?e.rows:e.rows-1;if(0>t||t>n)throw new RangeError('Row index out of range')},t.checkColumnIndex=function(e,t,i){var n=i?e.columns:e.columns-1;if(0>t||t>n)throw new RangeError('Column index out of range')},t.checkRowVector=function(e,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==e.columns)throw new RangeError('vector size must be the same as the number of columns');return t},t.checkColumnVector=function(e,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==e.rows)throw new RangeError('vector size must be the same as the number of rows');return t},t.checkIndices=function(e,t,i){var n=t.some((t)=>{return 0>t||t>=e.rows}),o=i.some((t)=>{return 0>t||t>=e.columns});if(n||o)throw new RangeError('Indices are out of range');if('object'!=typeof t||'object'!=typeof i)throw new TypeError('Unexpected type for row/column indices');return Array.isArray(t)||(t=Array.from(t)),Array.isArray(i)||(t=Array.from(i)),{row:t,column:i}},t.checkRange=function(e,t,i,n,o){if(5!==arguments.length)throw new TypeError('Invalid argument type');var s=Array.from(arguments).slice(1).some(function(e){return'number'!=typeof e});if(s)throw new TypeError('Invalid argument type');if(t>i||n>o||0>t||t>=e.rows||0>i||i>=e.rows||0>n||n>=e.columns||0>o||o>=e.columns)throw new RangeError('Submatrix indices are out of range')},t.getRange=function(e,t){for(var n=Array(t-e+1),o=0;o<n.length;o++)n[o]=e+o;return n},t.sumByRow=function(e){for(var t=o.default.zeros(e.rows,1),n=0;n<e.rows;++n)for(var i=0;i<e.columns;++i)t.set(n,0,t.get(n,0)+e.get(n,i));return t},t.sumByColumn=function(e){for(var t=o.default.zeros(1,e.columns),n=0;n<e.rows;++n)for(var i=0;i<e.columns;++i)t.set(0,i,t.get(0,i)+e.get(n,i));return t},t.sumAll=function(e){for(var t=0,n=0;n<e.rows;n++)for(var i=0;i<e.columns;i++)t+=e.get(n,i);return t};var n=i(4),o=function(e){return e&&e.__esModule?e:{default:e}}(n)},function(e,t,i){'use strict';var n=i(5);t.checkRowIndex=function(e,t,i){var n=i?e.rows:e.rows-1;if(0>t||t>n)throw new RangeError('Row index out of range')},t.checkColumnIndex=function(e,t,i){var n=i?e.columns:e.columns-1;if(0>t||t>n)throw new RangeError('Column index out of range')},t.checkRowVector=function(e,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==e.columns)throw new RangeError('vector size must be the same as the number of columns');return t},t.checkColumnVector=function(e,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==e.rows)throw new RangeError('vector size must be the same as the number of rows');return t},t.checkIndices=function(e,t,i){var n=t.some((t)=>{return 0>t||t>=e.rows}),o=i.some((t)=>{return 0>t||t>=e.columns});if(n||o)throw new RangeError('Indices are out of range');if('object'!=typeof t||'object'!=typeof i)throw new TypeError('Unexpected type for row/column indices');return Array.isArray(t)||(t=Array.from(t)),Array.isArray(i)||(t=Array.from(i)),{row:t,column:i}},t.checkRange=function(e,t,i,n,o){if(5!==arguments.length)throw new TypeError('Invalid argument type');var s=Array.from(arguments).slice(1).some(function(e){return'number'!=typeof e});if(s)throw new TypeError('Invalid argument type');if(t>i||n>o||0>t||t>=e.rows||0>i||i>=e.rows||0>n||n>=e.columns||0>o||o>=e.columns)throw new RangeError('Submatrix indices are out of range')},t.getRange=function(e,t){for(var n=Array(t-e+1),o=0;o<n.length;o++)n[o]=e+o;return n},t.sumByRow=function(e){for(var t=n.Matrix.zeros(e.rows,1),o=0;o<e.rows;++o)for(var i=0;i<e.columns;++i)t.set(o,0,t.get(o,0)+e.get(o,i));return t},t.sumByColumn=function(e){for(var t=n.Matrix.zeros(1,e.columns),o=0;o<e.rows;++o)for(var i=0;i<e.columns;++i)t.set(0,i,t.get(0,i)+e.get(o,i));return t},t.sumAll=function(e){for(var t=0,n=0;n<e.rows;n++)for(var i=0;i<e.columns;i++)t+=e.get(n,i);return t}},function(e,t,i){'use strict';var n=i(6);t.checkRowIndex=function(e,t,i){var n=i?e.rows:e.rows-1;if(0>t||t>n)throw new RangeError('Row index out of range')},t.checkColumnIndex=function(e,t,i){var n=i?e.columns:e.columns-1;if(0>t||t>n)throw new RangeError('Column index out of range')},t.checkRowVector=function(e,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==e.columns)throw new RangeError('vector size must be the same as the number of columns');return t},t.checkColumnVector=function(e,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==e.rows)throw new RangeError('vector size must be the same as the number of rows');return t},t.checkIndices=function(e,t,i){var n=t.some((t)=>{return 0>t||t>=e.rows}),o=i.some((t)=>{return 0>t||t>=e.columns});if(n||o)throw new RangeError('Indices are out of range');if('object'!=typeof t||'object'!=typeof i)throw new TypeError('Unexpected type for row/column indices');return Array.isArray(t)||(t=Array.from(t)),Array.isArray(i)||(t=Array.from(i)),{row:t,column:i}},t.checkRange=function(e,t,i,n,o){if(5!==arguments.length)throw new TypeError('Invalid argument type');var s=Array.from(arguments).slice(1).some(function(e){return'number'!=typeof e});if(s)throw new TypeError('Invalid argument type');if(t>i||n>o||0>t||t>=e.rows||0>i||i>=e.rows||0>n||n>=e.columns||0>o||o>=e.columns)throw new RangeError('Submatrix indices are out of range')},t.getRange=function(e,t){for(var n=Array(t-e+1),o=0;o<n.length;o++)n[o]=e+o;return n},t.sumByRow=function(e){for(var t=n.Matrix.zeros(e.rows,1),o=0;o<e.rows;++o)for(var i=0;i<e.columns;++i)t.set(o,0,t.get(o,0)+e.get(o,i));return t},t.sumByColumn=function(e){for(var t=n.Matrix.zeros(1,e.columns),o=0;o<e.rows;++o)for(var i=0;i<e.columns;++i)t.set(0,i,t.get(0,i)+e.get(o,i));return t},t.sumAll=function(e){for(var t=0,n=0;n<e.rows;n++)for(var i=0;i<e.columns;i++)t+=e.get(n,i);return t}},function(e,t,i){'use strict';var n=i(7);t.checkRowIndex=function(e,t,i){var n=i?e.rows:e.rows-1;if(0>t||t>n)throw new RangeError('Row index out of range')},t.checkColumnIndex=function(e,t,i){var n=i?e.columns:e.columns-1;if(0>t||t>n)throw new RangeError('Column index out of range')},t.checkRowVector=function(e,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==e.columns)throw new RangeError('vector size must be the same as the number of columns');return t},t.checkColumnVector=function(e,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==e.rows)throw new RangeError('vector size must be the same as the number of rows');return t},t.checkIndices=function(e,t,i){var n=t.some((t)=>{return 0>t||t>=e.rows}),o=i.some((t)=>{return 0>t||t>=e.columns});if(n||o)throw new RangeError('Indices are out of range');if('object'!=typeof t||'object'!=typeof i)throw new TypeError('Unexpected type for row/column indices');return Array.isArray(t)||(t=Array.from(t)),Array.isArray(i)||(t=Array.from(i)),{row:t,column:i}},t.checkRange=function(e,t,i,n,o){if(5!==arguments.length)throw new TypeError('Invalid argument type');var s=Array.from(arguments).slice(1).some(function(e){return'number'!=typeof e});if(s)throw new TypeError('Invalid argument type');if(t>i||n>o||0>t||t>=e.rows||0>i||i>=e.rows||0>n||n>=e.columns||0>o||o>=e.columns)throw new RangeError('Submatrix indices are out of range')},t.getRange=function(e,t){for(var n=Array(t-e+1),o=0;o<n.length;o++)n[o]=e+o;return n},t.sumByRow=function(e){for(var t=n.Matrix.zeros(e.rows,1),o=0;o<e.rows;++o)for(var i=0;i<e.columns;++i)t.set(o,0,t.get(o,0)+e.get(o,i));return t},t.sumByColumn=function(e){for(var t=n.Matrix.zeros(1,e.columns),o=0;o<e.rows;++o)for(var i=0;i<e.columns;++i)t.set(0,i,t.get(0,i)+e.get(o,i));return t},t.sumAll=function(e){for(var t=0,n=0;n<e.rows;n++)for(var i=0;i<e.columns;i++)t+=e.get(n,i);return t}},function(e,t,i){'use strict';var n=i(8);t.checkRowIndex=function(e,t,i){var n=i?e.rows:e.rows-1;if(0>t||t>n)throw new RangeError('Row index out of range')},t.checkColumnIndex=function(e,t,i){var n=i?e.columns:e.columns-1;if(0>t||t>n)throw new RangeError('Column index out of range')},t.checkRowVector=function(e,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==e.columns)throw new RangeError('vector size must be the same as the number of columns');return t},t.checkColumnVector=function(e,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==e.rows)throw new RangeError('vector size must be the same as the number of rows');return t},t.checkIndices=function(e,t,i){var n=t.some((t)=>{return 0>t||t>=e.rows}),o=i.some((t)=>{return 0>t||t>=e.columns});if(n||o)throw new RangeError('Indices are out of range');if('object'!=typeof t||'object'!=typeof i)throw new TypeError('Unexpected type for row/column indices');return Array.isArray(t)||(t=Array.from(t)),Array.isArray(i)||(t=Array.from(i)),{row:t,column:i}},t.checkRange=function(e,t,i,n,o){if(5!==arguments.length)throw new TypeError('Invalid argument type');var s=Array.from(arguments).slice(1).some(function(e){return'number'!=typeof e});if(s)throw new TypeError('Invalid argument type');if(t>i||n>o||0>t||t>=e.rows||0>i||i>=e.rows||0>n||n>=e.columns||0>o||o>=e.columns)throw new RangeError('Submatrix indices are out of range')},t.getRange=function(e,t){for(var n=Array(t-e+1),o=0;o<n.length;o++)n[o]=e+o;return n},t.sumByRow=function(e){for(var t=n.Matrix.zeros(e.rows,1),o=0;o<e.rows;++o)for(var i=0;i<e.columns;++i)t.set(o,0,t.get(o,0)+e.get(o,i));return t},t.sumByColumn=function(e){for(var t=n.Matrix.zeros(1,e.columns),o=0;o<e.rows;++o)for(var i=0;i<e.columns;++i)t.set(0,i,t.get(0,i)+e.get(o,i));return t},t.sumAll=function(e){for(var t=0,n=0;n<e.rows;n++)for(var i=0;i<e.columns;i++)t+=e.get(n,i);return t}},function(e,t,i){'use strict';var n=i(9);t.checkRowIndex=function(e,t,i){var n=i?e.rows:e.rows-1;if(0>t||t>n)throw new RangeError('Row index out of range')},t.checkColumnIndex=function(e,t,i){var n=i?e.columns:e.columns-1;if(0>t||t>n)throw new RangeError('Column index out of range')},t.checkRowVector=function(e,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==e.columns)throw new RangeError('vector size must be the same as the number of columns');return t},t.checkColumnVector=function(e,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==e.rows)throw new RangeError('vector size must be the same as the number of rows');return t},t.checkIndices=function(e,t,i){var n=t.some((t)=>{return 0>t||t>=e.rows}),o=i.some((t)=>{return 0>t||t>=e.columns});if(n||o)throw new RangeError('Indices are out of range');if('object'!=typeof t||'object'!=typeof i)throw new TypeError('Unexpected type for row/column indices');return Array.isArray(t)||(t=Array.from(t)),Array.isArray(i)||(t=Array.from(i)),{row:t,column:i}},t.checkRange=function(e,t,i,n,o){if(5!==arguments.length)throw new TypeError('Invalid argument type');var s=Array.from(arguments).slice(1).some(function(e){return'number'!=typeof e});if(s)throw new TypeError('Invalid argument type');if(t>i||n>o||0>t||t>=e.rows||0>i||i>=e.rows||0>n||n>=e.columns||0>o||o>=e.columns)throw new RangeError('Submatrix indices are out of range')},t.getRange=function(e,t){for(var n=Array(t-e+1),o=0;o<n.length;o++)n[o]=e+o;return n},t.sumByRow=function(e){for(var t=n.Matrix.zeros(e.rows,1),o=0;o<e.rows;++o)for(var i=0;i<e.columns;++i)t.set(o,0,t.get(o,0)+e.get(o,i));return t},t.sumByColumn=function(e){for(var t=n.Matrix.zeros(1,e.columns),o=0;o<e.rows;++o)for(var i=0;i<e.columns;++i)t.set(0,i,t.get(0,i)+e.get(o,i));return t},t.sumAll=function(e){for(var t=0,n=0;n<e.rows;n++)for(var i=0;i<e.columns;i++)t+=e.get(n,i);return t}},function(e,t,i){'use strict';var n=i(10);t.checkRowIndex=function(e,t,i){var n=i?e.rows:e.rows-1;if(0>t||t>n)throw new RangeError('Row index out of range')},t.checkColumnIndex=function(e,t,i){var n=i?e.columns:e.columns-1;if(0>t||t>n)throw new RangeError('Column index out of range')},t.checkRowVector=function(e,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==e.columns)throw new RangeError('vector size must be the same as the number of columns');return t},t.checkColumnVector=function(e,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==e.rows)throw new RangeError('vector size must be the same as the number of rows');return t},t.checkIndices=function(e,t,i){var n=t.some((t)=>{return 0>t||t>=e.rows}),o=i.some((t)=>{return 0>t||t>=e.columns});if(n||o)throw new RangeError('Indices are out of range');if('object'!=typeof t||'object'!=typeof i)throw new TypeError('Unexpected type for row/column indices');return Array.isArray(t)||(t=Array.from(t)),Array.isArray(i)||(t=Array.from(i)),{row:t,column:i}},t.checkRange=function(e,t,i,n,o){if(5!==arguments.length)throw new TypeError('Invalid argument type');var s=Array.from(arguments).slice(1).some(function(e){return'number'!=typeof e});if(s)throw new TypeError('Invalid argument type');if(t>i||n>o||0>t||t>=e.rows||0>i||i>=e.rows||0>n||n>=e.columns||0>o||o>=e.columns)throw new RangeError('Submatrix indices are out of range')},t.getRange=function(e,t){for(var n=Array(t-e+1),o=0;o<n.length;o++)n[o]=e+o;return n},t.sumByRow=function(e){for(var t=n.Matrix.zeros(e.rows,1),o=0;o<e.rows;++o)for(var i=0;i<e.columns;++i)t.set(o,0,t.get(o,0)+e.get(o,i));return t},t.sumByColumn=function(e){for(var t=n.Matrix.zeros(1,e.columns),o=0;o<e.rows;++o)for(var i=0;i<e.columns;++i)t.set(0,i,t.get(0,i)+e.get(o,i));return t},t.sumAll=function(e){for(var t=0,n=0;n<e.rows;n++)for(var i=0;i<e.columns;i++)t+=e.get(n,i);return t}},function(e,t,i){'use strict';var n=i(11);t.checkRowIndex=function(e,t,i){var n=i?e.rows:e.rows-1;if(0>t||t>n)throw new RangeError('Row index out of range')},t.checkColumnIndex=function(e,t,i){var n=i?e.columns:e.columns-1;if(0>t||t>n)throw new RangeError('Column index out of range')},t.checkRowVector=function(e,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==e.columns)throw new RangeError('vector size must be the same as the number of columns');return t},t.checkColumnVector=function(e,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==e.rows)throw new RangeError('vector size must be the same as the number of rows');return t},t.checkIndices=function(e,t,i){var n=t.some((t)=>{return 0>t||t>=e.rows}),o=i.some((t)=>{return 0>t||t>=e.columns});if(n||o)throw new RangeError('Indices are out of range');if('object'!=typeof t||'object'!=typeof i)throw new TypeError('Unexpected type for row/column indices');return Array.isArray(t)||(t=Array.from(t)),Array.isArray(i)||(t=Array.from(i)),{row:t,column:i}},t.checkRange=function(e,t,i,n,o){if(5!==arguments.length)throw new TypeError('Invalid argument type');var s=Array.from(arguments).slice(1).some(function(e){return'number'!=typeof e});if(s)throw new TypeError('Invalid argument type');if(t>i||n>o||0>t||t>=e.rows||0>i||i>=e.rows||0>n||n>=e.columns||0>o||o>=e.columns)throw new RangeError('Submatrix indices are out of range')},t.getRange=function(e,t){for(var n=Array(t-e+1),o=0;o<n.length;o++)n[o]=e+o;return n},t.sumByRow=function(e){for(var t=n.Matrix.zeros(e.rows,1),o=0;o<e.rows;++o)for(var i=0;i<e.columns;++i)t.set(o,0,t.get(o,0)+e.get(o,i));return t},t.sumByColumn=function(e){for(var t=n.Matrix.zeros(1,e.columns),o=0;o<e.rows;++o)for(var i=0;i<e.columns;++i)t.set(0,i,t.get(0,i)+e.get(o,i));return t},t.sumAll=function(e){for(var t=0,n=0;n<e.rows;n++)for(var i=0;i<e.columns;i++)t+=e.get(n,i);return t}},function(e,t,i){'use strict';var n=i(12);t.checkRowIndex=function(e,t,i){var n=i?e.rows:e.rows-1;if(0>t||t>n)throw new RangeError('Row index out of range')},t.checkColumnIndex=function(e,t,i){var n=i?e.columns:e.columns-1;if(0>t||t>n)throw new RangeError('Column index out of range')},t.checkRowVector=function(e,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==e.columns)throw new RangeError('vector size must be the same as the number of columns');return t},t.checkColumnVector=function(e,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==e.rows)throw new RangeError('vector size must be the same as the number of rows');return t},t.checkIndices=function(e,t,i){var n=t.some((t)=>{return 0>t||t>=e.rows}),o=i.some((t)=>{return 0>t||t>=e.columns});if(n||o)throw new RangeError('Indices are out of range');if('object'!=typeof t||'object'!=typeof i)throw new TypeError('Unexpected type for row/column indices');return Array.isArray(t)||(t=Array.from(t)),Array.isArray(i)||(t=Array.from(i)),{row:t,column:i}},t.checkRange=function(e,t,i,n,o){if(5!==arguments.length)throw new TypeError('Invalid argument type');var s=Array.from(arguments).slice(1).some(function(e){return'number'!=typeof e});if(s)throw new TypeError('Invalid argument type');if(t>i||n>o||0>t||t>=e.rows||0>i||i>=e.rows||0>n||n>=e.columns||0>o||o>=e.columns)throw new RangeError('Submatrix indices are out of range')},t.getRange=function(e,t){for(var n=Array(t-e+1),o=0;o<n.length;o++)n[o]=e+o;return n},t.sumByRow=function(e){for(var t=n.Matrix.zeros(e.rows,1),o=0;o<e.rows;++o)for(var i=0;i<e.columns;++i)t.set(o,0,t.get(o,0)+e.get(o,i));return t},t.sumByColumn=function(e){for(var t=n.Matrix.zeros(1,e.columns),o=0;o<e.rows;++o)for(var i=0;i<e.columns;++i)t.set(0,i,t.get(0,i)+e.get(o,i));return t},t.sumAll=function(e){for(var t=0,n=0;n<e.rows;n++)for(var i=0;i<e.columns;i++)t+=e.get(n,i);return t}},function(e,t,i){'use strict';function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0}),t.default=function(e){function t(e,t){return e-t}function n(e,t){for(var i in t)e=e.replace(new RegExp('%'+i+'%','g'),t[i]);return e}e===void 0&&(e=Object);class o extends e{static get[Symbol.species](){return this}static from1DArray(e,t,i){if(e*t!==i.length)throw new RangeError('Data length does not match given dimensions');for(var n=new this(e,t),o=0;o<e;o++)for(var s=0;s<t;s++)n.set(o,s,i[o*t+s]);return n}static rowVector(e){for(var t=new this(1,e.length),n=0;n<e.length;n++)t.set(0,n,e[n]);return t}static columnVector(e){for(var t=new this(e.length,1),n=0;n<e.length;n++)t.set(n,0,e[n]);return t}static empty(e,t){return new this(e,t)}static zeros(e,t){return this.empty(e,t).fill(0)}static ones(e,t){return this.empty(e,t).fill(1)}static rand(e,t,n){n===void 0&&(n=Math.random);for(var o=this.empty(e,t),s=0;s<e;s++)for(var i=0;i<t;i++)o.set(s,i,n());return o}static randInt(e,t,n,o){n===void 0&&(n=1e3),o===void 0&&(o=Math.random);for(var s=this.empty(e,t),r=0;r<e;r++)for(var i=0,a;i<t;i++)a=g(o()*n),s.set(r,i,a);return s}static eye(e,t,n){t===void 0&&(t=e),n===void 0&&(n=1);for(var o=v(e,t),s=this.zeros(e,t),r=0;r<o;r++)s.set(r,r,n);return s}static diag(e,t,n){var o=e.length;t===void 0&&(t=o),n===void 0&&(n=t);for(var s=v(o,t,n),r=this.zeros(t,n),a=0;a<s;a++)r.set(a,a,e[a]);return r}static min(e,t){e=this.checkMatrix(e),t=this.checkMatrix(t);for(var n=e.rows,o=e.columns,s=new this(n,o),r=0;r<n;r++)for(var i=0;i<o;i++)s.set(r,i,v(e.get(r,i),t.get(r,i)));return s}static max(e,t){e=this.checkMatrix(e),t=this.checkMatrix(t);for(var n=e.rows,o=e.columns,s=new this(n,o),r=0;r<n;r++)for(var i=0;i<o;i++)s.set(r,i,M(e.get(r,i),t.get(r,i)));return s}static checkMatrix(e){return o.isMatrix(e)?e:new this(e)}static isMatrix(e){return null!=e&&'Matrix'===e.klass}get size(){return this.rows*this.columns}apply(e){if('function'!=typeof e)throw new TypeError('callback must be a function');for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var i=0;i<n;i++)e.call(this,o,i);return this}to1DArray(){for(var e=Array(this.size),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e[t*this.columns+i]=this.get(t,i);return e}to2DArray(){for(var e=Array(this.rows),t=0;t<this.rows;t++){e[t]=Array(this.columns);for(var i=0;i<this.columns;i++)e[t][i]=this.get(t,i)}return e}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isSymmetric(){if(this.isSquare()){for(var e=0;e<this.rows;e++)for(var t=0;t<=e;t++)if(this.get(e,t)!==this.get(t,e))return!1;return!0}return!1}set(){throw new Error('set method is unimplemented')}get(){throw new Error('get method is unimplemented')}repeat(e,t){e=e||1,t=t||1;for(var n=new this.constructor[Symbol.species](this.rows*e,this.columns*t),o=0;o<e;o++)for(var i=0;i<t;i++)n.setSubMatrix(this,this.rows*o,this.columns*i);return n}fill(e){for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,e);return this}neg(){return this.mulS(-1)}getRow(e){d.checkRowIndex(this,e);for(var t=Array(this.columns),n=0;n<this.columns;n++)t[n]=this.get(e,n);return t}getRowVector(e){return this.constructor.rowVector(this.getRow(e))}setRow(e,t){d.checkRowIndex(this,e),t=d.checkRowVector(this,t);for(var n=0;n<this.columns;n++)this.set(e,n,t[n]);return this}swapRows(e,t){d.checkRowIndex(this,e),d.checkRowIndex(this,t);for(var n=0,i;n<this.columns;n++)i=this.get(e,n),this.set(e,n,this.get(t,n)),this.set(t,n,i);return this}getColumn(e){d.checkColumnIndex(this,e);for(var t=Array(this.rows),n=0;n<this.rows;n++)t[n]=this.get(n,e);return t}getColumnVector(e){return this.constructor.columnVector(this.getColumn(e))}setColumn(e,t){d.checkColumnIndex(this,e),t=d.checkColumnVector(this,t);for(var n=0;n<this.rows;n++)this.set(n,e,t[n]);return this}swapColumns(e,t){d.checkColumnIndex(this,e),d.checkColumnIndex(this,t);for(var n=0,i;n<this.rows;n++)i=this.get(n,e),this.set(n,e,this.get(n,t)),this.set(n,t,i);return this}addRowVector(e){e=d.checkRowVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)+e[i]);return this}subRowVector(e){e=d.checkRowVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)-e[i]);return this}mulRowVector(e){e=d.checkRowVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)*e[i]);return this}divRowVector(e){e=d.checkRowVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)/e[i]);return this}addColumnVector(e){e=d.checkColumnVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)+e[t]);return this}subColumnVector(e){e=d.checkColumnVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)-e[t]);return this}mulColumnVector(e){e=d.checkColumnVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)*e[t]);return this}divColumnVector(e){e=d.checkColumnVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)/e[t]);return this}mulRow(e,t){d.checkRowIndex(this,e);for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t);return this}mulColumn(e,t){d.checkColumnIndex(this,e);for(var n=0;n<this.rows;n++)this.set(n,e,this.get(n,e)*t);return this}max(){for(var e=this.get(0,0),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.get(t,i)>e&&(e=this.get(t,i));return e}maxIndex(){for(var e=this.get(0,0),t=[0,0],n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.get(n,i)>e&&(e=this.get(n,i),t[0]=n,t[1]=i);return t}min(){for(var e=this.get(0,0),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.get(t,i)<e&&(e=this.get(t,i));return e}minIndex(){for(var e=this.get(0,0),t=[0,0],n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.get(n,i)<e&&(e=this.get(n,i),t[0]=n,t[1]=i);return t}maxRow(e){d.checkRowIndex(this,e);for(var t=this.get(e,0),n=1;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n));return t}maxRowIndex(e){d.checkRowIndex(this,e);for(var t=this.get(e,0),n=[e,0],o=1;o<this.columns;o++)this.get(e,o)>t&&(t=this.get(e,o),n[1]=o);return n}minRow(e){d.checkRowIndex(this,e);for(var t=this.get(e,0),n=1;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n));return t}minRowIndex(e){d.checkRowIndex(this,e);for(var t=this.get(e,0),n=[e,0],o=1;o<this.columns;o++)this.get(e,o)<t&&(t=this.get(e,o),n[1]=o);return n}maxColumn(e){d.checkColumnIndex(this,e);for(var t=this.get(0,e),n=1;n<this.rows;n++)this.get(n,e)>t&&(t=this.get(n,e));return t}maxColumnIndex(e){d.checkColumnIndex(this,e);for(var t=this.get(0,e),n=[0,e],o=1;o<this.rows;o++)this.get(o,e)>t&&(t=this.get(o,e),n[0]=o);return n}minColumn(e){d.checkColumnIndex(this,e);for(var t=this.get(0,e),n=1;n<this.rows;n++)this.get(n,e)<t&&(t=this.get(n,e));return t}minColumnIndex(e){d.checkColumnIndex(this,e);for(var t=this.get(0,e),n=[0,e],o=1;o<this.rows;o++)this.get(o,e)<t&&(t=this.get(o,e),n[0]=o);return n}diag(){for(var e=v(this.rows,this.columns),t=Array(e),n=0;n<e;n++)t[n]=this.get(n,n);return t}sum(e){return'row'===e?d.sumByRow(this):'column'===e?d.sumByColumn(this):d.sumAll(this)}mean(){return this.sum()/this.size}prod(){for(var e=1,t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e*=this.get(t,i);return e}cumulativeSum(){for(var e=0,t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e+=this.get(t,i),this.set(t,i,e);return this}dot(e){o.isMatrix(e)&&(e=e.to1DArray());var t=this.to1DArray();if(t.length!==e.length)throw new RangeError('vectors do not have the same size');for(var n=0,s=0;s<t.length;s++)n+=t[s]*e[s];return n}mmul(e){e=this.constructor.checkMatrix(e),this.columns!==e.rows&&console.warn('Number of columns of left matrix are not equal to number of rows of right matrix.');for(var t=this.rows,o=this.columns,n=e.columns,r=new this.constructor[Symbol.species](t,n),a=Array(o),l=0;l<n;l++){for(var c=0;c<o;c++)a[c]=e.get(c,l);for(var u=0,i;u<t;u++){for(i=0,c=0;c<o;c++)i+=this.get(u,c)*a[c];r.set(u,l,i)}}return r}strassen2x2(e){var t=new this.constructor[Symbol.species](2,2),i=this.get(0,0),n=e.get(0,0),o=this.get(0,1),s=e.get(0,1),r=this.get(1,0),a=e.get(1,0),l=this.get(1,1),c=e.get(1,1),u=(i+l)*(n+c),m=(r+l)*n,d=i*(s-c),g=l*(a-n),h=(i+o)*c;return t.set(0,0,u+g-h+(o-l)*(a+c)),t.set(0,1,d+h),t.set(1,0,m+g),t.set(1,1,u-m+d+(r-i)*(n+s)),t}strassen3x3(e){var t=new this.constructor[Symbol.species](3,3),i=this.get(0,0),n=this.get(0,1),o=this.get(0,2),s=this.get(1,0),r=this.get(1,1),a=this.get(1,2),l=this.get(2,0),c=this.get(2,1),u=this.get(2,2),m=e.get(0,0),d=e.get(0,1),g=e.get(0,2),h=e.get(1,0),p=e.get(1,1),k=e.get(1,2),j=e.get(2,0),x=e.get(2,1),w=e.get(2,2),f=(i-s)*(-d+p),y=(-i+s+r)*(m-d+p),M=(s+r)*(-m+d),b=i*m,v=(-i+l+c)*(m-g+k),R=(-i+l)*(g-k),I=(l+c)*(-m+g),S=(-o+c+u)*(p+j-x),C=(o-u)*(p-x),V=o*j,D=(c+u)*(-j+x),z=(-o+r+a)*(k+j-w),_=(o-a)*(k-w),P=(r+a)*(-j+w);return t.set(0,0,b+V+n*h),t.set(0,1,(i+n+o-s-r-c-u)*p+y+M+b+S+V+D),t.set(0,2,b+v+I+(i+n+o-r-a-l-c)*k+V+z+P),t.set(1,0,f+r*(-m+d+h-p-k-j+w)+y+b+V+z+_),t.set(1,1,f+y+M+b+a*x),t.set(1,2,V+z+_+P+s*g),t.set(2,0,b+v+R+c*(-m+g+h-p-k-j+x)+S+C+V),t.set(2,1,S+C+V+D+l*d),t.set(2,2,b+v+R+I+u*w),t}mmulStrassen(e){function t(e,t,i){var n=e.rows,s=e.columns;if(n===t&&s===i)return e;var r=o.zeros(t,i);return r=r.setSubMatrix(e,0,0),r}function i(e,n,s,r){if(512>=s||512>=r)return e.mmul(n);1==s%2&&1==r%2?(e=t(e,s+1,r+1),n=t(n,s+1,r+1)):1==s%2?(e=t(e,s+1,r),n=t(n,s+1,r)):1==r%2&&(e=t(e,s,r+1),n=t(n,s,r+1));var a=parseInt(e.rows/2),l=parseInt(e.columns/2),c=e.subMatrix(0,a-1,0,l-1),u=n.subMatrix(0,a-1,0,l-1),m=e.subMatrix(0,a-1,l,e.columns-1),d=n.subMatrix(0,a-1,l,n.columns-1),g=e.subMatrix(a,e.rows-1,0,l-1),h=n.subMatrix(a,n.rows-1,0,l-1),p=e.subMatrix(a,e.rows-1,l,e.columns-1),k=n.subMatrix(a,n.rows-1,l,n.columns-1),j=i(o.add(c,p),o.add(u,k),a,l),x=i(o.add(g,p),u,a,l),w=i(c,o.sub(d,k),a,l),f=i(p,o.sub(h,u),a,l),y=i(o.add(c,m),k,a,l),M=i(o.sub(g,c),o.add(u,d),a,l),b=i(o.sub(m,p),o.add(h,k),a,l),v=o.add(j,f);v.sub(y),v.add(b);var R=o.add(w,y),I=o.add(x,f),S=o.sub(j,x);S.add(w),S.add(M);var C=o.zeros(2*v.rows,2*v.columns);return C=C.setSubMatrix(v,0,0),C=C.setSubMatrix(R,v.rows,0),C=C.setSubMatrix(I,0,v.columns),C=C.setSubMatrix(S,v.rows,v.columns),C.subMatrix(0,s-1,0,r-1)}var n=this.clone(),s=n.rows,a=n.columns,l=e.rows,u=e.columns;a!==l&&console.warn(`Multiplying ${s} x ${a} and ${l} x ${u} matrix: dimensions do not match.`);var m=M(s,l),r=M(a,u);return n=t(n,m,r),e=t(e,m,r),i(n,e,m,r)}scaleRows(e,t){if(e=void 0===e?0:e,t=void 0===t?1:t,e>=t)throw new RangeError('min should be strictly smaller than max');for(var n=this.constructor.empty(this.rows,this.columns),o=0,i;o<this.rows;o++)i=(0,c.scale)(this.getRow(o),{min:e,max:t}),n.setRow(o,i);return n}scaleColumns(e,t){if(e=void 0===e?0:e,t=void 0===t?1:t,e>=t)throw new RangeError('min should be strictly smaller than max');for(var n=this.constructor.empty(this.rows,this.columns),o=0,i;o<this.columns;o++)i=(0,c.scale)(this.getColumn(o),{min:e,max:t}),n.setColumn(o,i);return n}kroneckerProduct(e){e=this.constructor.checkMatrix(e);for(var t=this.rows,o=this.columns,n=e.rows,s=e.columns,r=new this.constructor[Symbol.species](t*n,o*s),a=0;a<t;a++)for(var i=0;i<o;i++)for(var c=0;c<n;c++)for(var u=0;u<s;u++)r[n*a+c][s*i+u]=this.get(a,i)*e.get(c,u);return r}transpose(){for(var e=new this.constructor[Symbol.species](this.columns,this.rows),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e.set(i,t,this.get(t,i));return e}sortRows(e){e===void 0&&(e=t);for(var n=0;n<this.rows;n++)this.setRow(n,this.getRow(n).sort(e));return this}sortColumns(e){e===void 0&&(e=t);for(var n=0;n<this.columns;n++)this.setColumn(n,this.getColumn(n).sort(e));return this}subMatrix(e,t,n,o){d.checkRange(this,e,t,n,o);for(var s=new this.constructor[Symbol.species](t-e+1,o-n+1),r=e;r<=t;r++)for(var i=n;i<=o;i++)s[r-e][i-n]=this.get(r,i);return s}subMatrixRow(e,t,n){if(void 0===t&&(t=0),void 0===n&&(n=this.columns-1),t>n||0>t||t>=this.columns||0>n||n>=this.columns)throw new RangeError('Argument out of range');for(var o=new this.constructor[Symbol.species](e.length,n-t+1),s=0;s<e.length;s++)for(var i=t;i<=n;i++){if(0>e[s]||e[s]>=this.rows)throw new RangeError('Row index out of range: '+e[s]);o.set(s,i-t,this.get(e[s],i))}return o}subMatrixColumn(e,t,n){if(void 0===t&&(t=0),void 0===n&&(n=this.rows-1),t>n||0>t||t>=this.rows||0>n||n>=this.rows)throw new RangeError('Argument out of range');for(var o=new this.constructor[Symbol.species](n-t+1,e.length),s=0;s<e.length;s++)for(var i=t;i<=n;i++){if(0>e[s]||e[s]>=this.columns)throw new RangeError('Column index out of range: '+e[s]);o.set(i-t,s,this.get(i,e[s]))}return o}setSubMatrix(e,t,n){e=this.constructor.checkMatrix(e);var o=t+e.rows-1,s=n+e.columns-1;d.checkRange(this,t,o,n,s);for(var r=0;r<e.rows;r++)for(var i=0;i<e.columns;i++)this[t+r][n+i]=e.get(r,i);return this}selection(e,t){for(var n=d.checkIndices(this,e,t),o=new this.constructor[Symbol.species](e.length,t.length),s=0,i;s<n.row.length;s++){i=n.row[s];for(var r=0,a;r<n.column.length;r++)a=n.column[r],o[s][r]=this.get(i,a)}return o}trace(){for(var e=v(this.rows,this.columns),t=0,n=0;n<e;n++)t+=this.get(n,n);return t}transposeView(){return new p.default(this)}rowView(e){return d.checkRowIndex(this,e),new j.default(this,e)}columnView(e){return d.checkColumnIndex(this,e),new R.default(this,e)}flipRowView(){return new S.default(this)}flipColumnView(){return new V.default(this)}subMatrixView(e,t,i,n){return new w.default(this,e,t,i,n)}selectionView(e,t){return new y.default(this,e,t)}det(){if(this.isSquare()){var e,t,i,n;if(2===this.columns)return e=this.get(0,0),t=this.get(0,1),i=this.get(1,0),n=this.get(1,1),e*n-t*i;if(3===this.columns){var o,r,a;return o=this.selectionView([1,2],[1,2]),r=this.selectionView([1,2],[0,2]),a=this.selectionView([1,2],[0,1]),e=this.get(0,0),t=this.get(0,1),i=this.get(0,2),e*o.det()-t*r.det()+i*a.det()}return new s.default(this).determinant}throw Error('Determinant can only be calculated for a square matrix.')}pseudoInverse(e){void 0===e&&(e=a);for(var t=new l.default(this,{autoTranspose:!0}),n=t.leftSingularVectors,o=t.rightSingularVectors,r=t.diagonal,s=0;s<r.length;s++)r[s]=u(r[s])>e?1/r[s]:0;return r=this.constructor[Symbol.species].diag(r),o.mmul(r.mmul(n.transposeView()))}}o.prototype.klass='Matrix',o.random=o.rand,o.diagonal=o.diag,o.prototype.diagonal=o.prototype.diag,o.identity=o.eye,o.prototype.negate=o.prototype.neg,o.prototype.tensorProduct=o.prototype.kroneckerProduct,o.prototype.determinant=o.prototype.det;var r=`
(function %name%(value) {
    if (typeof value === 'number') return this.%name%S(value);
    return this.%name%M(value);
})
`,m=`
(function %name%S(value) {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, this.get(i, j) %op% value);
        }
    }
    return this;
})
`,h=`
(function %name%M(matrix) {
    matrix = this.constructor.checkMatrix(matrix);
    if (this.rows !== matrix.rows ||
        this.columns !== matrix.columns) {
        throw new RangeError('Matrices dimensions must be equal');
    }
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, this.get(i, j) %op% matrix.get(i, j));
        }
    }
    return this;
})
`,k=`
(function %name%(matrix, value) {
    var newMatrix = new this[Symbol.species](matrix);
    return newMatrix.%name%(value);
})
`,x=`
(function %name%() {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j)));
        }
    }
    return this;
})
`,f=`
(function %name%(matrix) {
    var newMatrix = new this[Symbol.species](matrix);
    return newMatrix.%name%();
})
`,b=`
(function %name%(%args%) {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j), %args%));
        }
    }
    return this;
})
`,I=`
(function %name%(matrix, %args%) {
    var newMatrix = new this[Symbol.species](matrix);
    return newMatrix.%name%(%args%);
})
`,C=`
(function %name%S(value) {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j), value));
        }
    }
    return this;
})
`,D=`
(function %name%M(matrix) {
    matrix = this.constructor.checkMatrix(matrix);
    if (this.rows !== matrix.rows ||
        this.columns !== matrix.columns) {
        throw new RangeError('Matrices dimensions must be equal');
    }
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j), matrix.get(i, j)));
        }
    }
    return this;
})
`,z=`
(function %name%(value) {
    if (typeof value === 'number') return this.%name%S(value);
    return this.%name%M(value);
})
`,_=[['+','add'],['-','sub','subtract'],['*','mul','multiply'],['/','div','divide'],['%','mod','modulus'],['&','and'],['|','or'],['^','xor'],['<<','leftShift'],['>>','signPropagatingRightShift'],['>>>','rightShift','zeroFillRightShift']],P=eval,A=!0,L=!1,U,i;try{for(var F=_[Symbol.iterator](),T;!(A=(T=F.next()).done);A=!0){var q=T.value,N=P(n(r,{name:q[1],op:q[0]})),O=P(n(m,{name:q[1]+'S',op:q[0]})),E=P(n(h,{name:q[1]+'M',op:q[0]})),B=P(n(k,{name:q[1]}));for(U=1;U<q.length;U++)o.prototype[q[U]]=N,o.prototype[q[U]+'S']=O,o.prototype[q[U]+'M']=E,o[q[U]]=B}}catch(e){L=!0,i=e}finally{try{!A&&F.return&&F.return()}finally{if(L)throw i}}var Q=[['~','not']];['abs','acos','acosh','asin','asinh','atan','atanh','cbrt','ceil','clz32','cos','cosh','exp','expm1','floor','fround','log','log1p','log10','log2','round','sign','sin','sinh','sqrt','tan','tanh','trunc'].forEach(function(e){Q.push(['Math.'+e,e])});var W=!0,X=!1,J;try{for(var Y=Q[Symbol.iterator](),H;!(W=(H=Y.next()).done);W=!0){var K=H.value,G=P(n(x,{name:K[1],method:K[0]})),Z=P(n(f,{name:K[1]}));for(U=1;U<K.length;U++)o.prototype[K[U]]=G,o[K[U]]=Z}}catch(e){X=!0,J=e}finally{try{!W&&Y.return&&Y.return()}finally{if(X)throw J}}var $=[['Math.pow',1,'pow']],ee=!0,te=!1,ie;try{for(var ne=$[Symbol.iterator](),oe;!(ee=(oe=ne.next()).done);ee=!0){var se=oe.value,re='arg0';for(U=1;U<se[1];U++)re+=`, arg${U}`;if(1!==se[1]){var ae=P(n(b,{name:se[2],method:se[0],args:re})),le=P(n(I,{name:se[2],args:re}));for(U=2;U<se.length;U++)o.prototype[se[U]]=ae,o[se[U]]=le}else{var ce={name:se[2],args:re,method:se[0]},ue=P(n(z,ce)),me=P(n(C,ce)),de=P(n(D,ce)),ge=P(n(I,ce));for(U=2;U<se.length;U++)o.prototype[se[U]]=ue,o.prototype[se[U]+'M']=de,o.prototype[se[U]+'S']=me,o[se[U]]=ge}}}catch(e){te=!0,ie=e}finally{try{!ee&&ne.return&&ne.return()}finally{if(te)throw ie}}return o};var o=i(33),s=n(o),r=i(51),l=n(r),c=i(1),m=i(23),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(m),h=i(109),p=n(h),k=i(110),j=n(k),x=i(111),w=n(x),f=i(112),y=n(f),b=i(113),R=n(b),I=i(114),S=n(I),C=i(115),V=n(C)},function(e,t,i){'use strict';function n(e){if(!(this instanceof n))return new n(e);e=r.default.checkMatrix(e);var o=e.clone(),a=o.rows,l=o.columns,c=Array(a),m=1,d,i,g,h,p,s,t,k,j,x;for(d=0;d<a;d++)c[d]=d;for(j=Array(a),i=0;i<l;i++){for(d=0;d<a;d++)j[d]=o[d][i];for(d=0;d<a;d++){for(k=o[d],x=v(d,i),p=0,g=0;g<x;g++)p+=k[g]*j[g];k[i]=j[d]-=p}for(h=i,d=i+1;d<a;d++)u(j[d])>u(j[h])&&(h=d);if(h!==i){for(g=0;g<l;g++)s=o[h][g],o[h][g]=o[i][g],o[i][g]=s;t=c[h],c[h]=c[i],c[i]=t,m=-m}if(i<a&&0!==o[i][i])for(d=i+1;d<a;d++)o[d][i]/=o[i][i]}this.LU=o,this.pivotVector=c,this.pivotSign=m}Object.defineProperty(t,'__esModule',{value:!0});var o=i(4),r=function(e){return e&&e.__esModule?e:{default:e}}(o);n.prototype={isSingular:function(){for(var e=this.LU,t=e.columns,i=0;i<t;i++)if(0===e[i][i])return!0;return!1},get determinant(){var e=this.LU;if(!e.isSquare())throw new Error('Matrix must be square');for(var t=this.pivotSign,i=e.columns,n=0;n<i;n++)t*=e[n][n];return t},get lowerTriangularMatrix(){for(var e=this.LU,t=e.rows,n=e.columns,o=new r.default(t,n),s=0;s<t;s++)for(var i=0;i<n;i++)o[s][i]=s>i?e[s][i]:s===i?1:0;return o},get upperTriangularMatrix(){for(var e=this.LU,t=e.rows,n=e.columns,o=new r.default(t,n),s=0;s<t;s++)for(var i=0;i<n;i++)o[s][i]=s<=i?e[s][i]:0;return o},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(e){e=r.default.checkMatrix(e);var t=this.LU,n=t.rows;if(n!==e.rows)throw new Error('Invalid matrix dimensions');if(this.isSingular())throw new Error('LU matrix is singular');var o=e.columns,s=e.subMatrixRow(this.pivotVector,0,o-1),a=t.columns,l,i,c;for(c=0;c<a;c++)for(l=c+1;l<a;l++)for(i=0;i<o;i++)s[l][i]-=s[c][i]*t[l][c];for(c=a-1;0<=c;c--){for(i=0;i<o;i++)s[c][i]/=t[c][c];for(l=0;l<c;l++)for(i=0;i<o;i++)s[l][i]-=s[c][i]*t[l][c]}return s}},t.default=n},function(e,t){'use strict';Object.defineProperty(t,'__esModule',{value:!0}),t.hypotenuse=function(e,t){var i;return u(e)>u(t)?(i=t/e,u(e)*R(1+i*i)):0===t?0:(i=e/t,u(t)*R(1+i*i))},t.getEmpty2DArray=function(e,t){for(var n=Array(e),o=0;o<e;o++)n[o]=Array(t);return n},t.getFilled2DArray=function(e,t,n){for(var o=Array(e),s=0;s<e;s++){o[s]=Array(t);for(var i=0;i<t;i++)o[s][i]=n}return o}},function(e){'use strict';var t=Object.prototype.hasOwnProperty,i=Object.prototype.toString,n=function(e){return'function'==typeof Array.isArray?Array.isArray(e):'[object Array]'===i.call(e)},o=function(e){if(!e||'[object Object]'!==i.call(e))return!1;var n=t.call(e,'constructor'),o=e.constructor&&e.constructor.prototype&&t.call(e.constructor.prototype,'isPrototypeOf');if(e.constructor&&!n&&!o)return!1;for(var s in e);return'undefined'==typeof s||t.call(e,s)};e.exports=function e(){var t=arguments[0],s=1,i=arguments.length,r=!1,a,l,c,u,m,d;for('boolean'==typeof t&&(r=t,t=arguments[1]||{},s=2),(null==t||'object'!=typeof t&&'function'!=typeof t)&&(t={});s<i;++s)if(a=arguments[s],null!=a)for(l in a)c=t[l],u=a[l],t!==u&&(r&&u&&(o(u)||(m=n(u)))?(m?(m=!1,d=c&&n(c)?c:[]):d=c&&o(c)?c:{},t[l]=e(r,d,u)):'undefined'!=typeof u&&(t[l]=u));return t}},function(e,t,i){'use strict';function n(e,t,o){for(var s=t.length,n=0,r=0,a=0,l=0,c=0;c<s;c++)n+=t[c],r+=o[c],a+=t[c]*t[c],l+=t[c]*o[c];var i=s*l-n*r;e.slope=i/(s*a-n*n),e.intercept=1/s*r-e.slope*(1/s)*n,e.coefficients=[e.intercept,e.slope]}Object.defineProperty(t,'__esModule',{value:!0});var o=i(3),s=function(e){return e&&e.__esModule?e:{default:e}}(o);class r extends s.default{constructor(e,t){super(),!0===e?(this.slope=t.slope,this.intercept=t.intercept,this.coefficients=[t.intercept,t.slope]):((0,o.checkArrayLength)(e,t),n(this,e,t))}toJSON(){return{name:'simpleLinearRegression',slope:this.slope,intercept:this.intercept}}_predict(e){return this.slope*e+this.intercept}computeX(e){return(e-this.intercept)/this.slope}toString(e){var t='f(x) = ';if(0!==this.slope){var i=(0,o.maybeToPrecision)(this.slope,e);if(t+=('1'===i?'':i+' * ')+'x',this.intercept){var n=u(this.intercept),s=n===this.intercept?'+':'-';t+=` ${s} ${(0,o.maybeToPrecision)(n,e)}`}}else t+=(0,o.maybeToPrecision)(this.intercept,e);return t}toLaTeX(e){return this.toString(e)}static load(e){if('simpleLinearRegression'!==e.name)throw new TypeError('not a SLR model');return new r(!0,e)}}t.default=r},function(e,t,i){'use strict';var n=i(13).Matrix,o=i(131),s=i(132),r=i(133),a=i(134),l=i(135),c=i(136),u=i(137),m=i(138),d=i(139),g=i(140),h={gaussian:o,rbf:o,polynomial:s,poly:s,anova:r,cauchy:a,exponential:l,histogram:c,min:c,laplacian:u,multiquadratic:m,rational:d,sigmoid:g,mlp:g};e.exports=class{constructor(e,t){if(this.kernelType=e,'linear'!==e)if('string'==typeof e){e=e.toLowerCase();var i=h[e];if(i)this.kernelFunction=new i(t);else throw new Error('unsupported kernel type: '+e)}else if('object'==typeof e&&'function'==typeof e.compute)this.kernelFunction=e;else throw new TypeError('first argument must be a valid kernel type or instance')}compute(e,t){if(void 0===t&&(t=e),'linear'===this.kernelType){var o=new n(e);return o.mmul(new n(t).transposeView())}var s=new n(e.length,t.length),r,i;if(e===t)for(r=0;r<e.length;r++)for(i=r;i<e.length;i++)s[r][i]=s[i][r]=this.kernelFunction.compute(e[r],e[i]);else for(r=0;r<e.length;r++)for(i=0;i<t.length;i++)s[r][i]=this.kernelFunction.compute(e[r],t[i]);return s}}},function(e,t){'use strict';t.hypotenuse=function(e,t){var i;return u(e)>u(t)?(i=t/e,u(e)*R(1+i*i)):0===t?0:(i=e/t,u(t)*R(1+i*i))},t.getEmpty2DArray=function(e,t){for(var n=Array(e),o=0;o<e;o++)n[o]=Array(t);return n},t.getFilled2DArray=function(e,t,n){for(var o=Array(e),s=0;s<e;s++){o[s]=Array(t);for(var i=0;i<t;i++)o[s][i]=n}return o}},function(e,t){'use strict';t.hypotenuse=function(e,t){var i;return u(e)>u(t)?(i=t/e,u(e)*R(1+i*i)):0===t?0:(i=e/t,u(t)*R(1+i*i))},t.getEmpty2DArray=function(e,t){for(var n=Array(e),o=0;o<e;o++)n[o]=Array(t);return n},t.getFilled2DArray=function(e,t,n){for(var o=Array(e),s=0;s<e;s++){o[s]=Array(t);for(var i=0;i<t;i++)o[s][i]=n}return o}},function(e,t,i){'use strict';e.exports=i(7).Matrix,e.exports.Decompositions=e.exports.DC=i(236)},function(e,t){'use strict';t.hypotenuse=function(e,t){var i;return u(e)>u(t)?(i=t/e,u(e)*R(1+i*i)):0===t?0:(i=e/t,u(t)*R(1+i*i))},t.getEmpty2DArray=function(e,t){for(var n=Array(e),o=0;o<e;o++)n[o]=Array(t);return n},t.getFilled2DArray=function(e,t,n){for(var o=Array(e),s=0;s<e;s++){o[s]=Array(t);for(var i=0;i<t;i++)o[s][i]=n}return o}},function(e,t){'use strict';t.hypotenuse=function(e,t){var i;return u(e)>u(t)?(i=t/e,u(e)*R(1+i*i)):0===t?0:(i=e/t,u(t)*R(1+i*i))},t.getEmpty2DArray=function(e,t){for(var n=Array(e),o=0;o<e;o++)n[o]=Array(t);return n},t.getFilled2DArray=function(e,t,n){for(var o=Array(e),s=0;s<e;s++){o[s]=Array(t);for(var i=0;i<t;i++)o[s][i]=n}return o}},function(e,t){'use strict';t.hypotenuse=function(e,t){var i;return u(e)>u(t)?(i=t/e,u(e)*R(1+i*i)):0===t?0:(i=e/t,u(t)*R(1+i*i))},t.getEmpty2DArray=function(e,t){for(var n=Array(e),o=0;o<e;o++)n[o]=Array(t);return n},t.getFilled2DArray=function(e,t,n){for(var o=Array(e),s=0;s<e;s++){o[s]=Array(t);for(var i=0;i<t;i++)o[s][i]=n}return o}},function(e,t){'use strict';t.hypotenuse=function(e,t){var i;return u(e)>u(t)?(i=t/e,u(e)*R(1+i*i)):0===t?0:(i=e/t,u(t)*R(1+i*i))},t.getEmpty2DArray=function(e,t){for(var n=Array(e),o=0;o<e;o++)n[o]=Array(t);return n},t.getFilled2DArray=function(e,t,n){for(var o=Array(e),s=0;s<e;s++){o[s]=Array(t);for(var i=0;i<t;i++)o[s][i]=n}return o}},function(e,t,i){'use strict';e.exports=i(11).Matrix,e.exports.Decompositions=e.exports.DC=i(299)},function(e,t){'use strict';t.hypotenuse=function(e,t){var i;return u(e)>u(t)?(i=t/e,u(e)*R(1+i*i)):0===t?0:(i=e/t,u(t)*R(1+i*i))},t.getEmpty2DArray=function(e,t){for(var n=Array(e),o=0;o<e;o++)n[o]=Array(t);return n},t.getFilled2DArray=function(e,t,n){for(var o=Array(e),s=0;s<e;s++){o[s]=Array(t);for(var i=0;i<t;i++)o[s][i]=n}return o}},function(e,t,i){'use strict';function n(e,t){return this[e][t]*=this[e][t],this}var o=i(45),s=i(2);e.exports={norm:function(e){return R(e.clone().apply(n).sum())},pow2array:n,featureNormalize:function(e){var t=s.matrix.mean(e),i=s.matrix.standardDeviation(e,t,!0),n=o.checkMatrix(e).subRowVector(t);return{result:n.divRowVector(i),means:t,std:i}}}},function(e,t,i){'use strict';function n(){this.children=[],this.distance=-1,this.index=[]}var o=i(311);n.prototype.cut=function(e){if(0>e)throw new RangeError('Threshold too small');var t=new n;t.children=this.children,t.distance=this.distance,t.index=this.index;for(var i=[t],o=[];0<i.length;){var s=i.shift();e>=s.distance?o.push(s):i=i.concat(s.children)}return o},n.prototype.group=function(e){if(!m(e)||1>e)throw new RangeError('Number of groups must be a positive integer');var t=new o(function(e,t){return t.distance-e.distance});for(t.push(this);t.size()<e;){var i=t.pop();if(0===i.children.length)break;i.children.forEach((e)=>t.push(e))}var s=new n;return s.children=t.toArray(),s.distance=this.distance,s},n.prototype.traverse=function(e){function t(e,n){if(n(e),e.children)for(var o=e.children.length-1;0<=o;o--)t(e.children[o],n)}t(this,e)},e.exports=n},function(e,t,i){'use strict';e.exports=i(12).Matrix,e.exports.Decompositions=e.exports.DC=i(330)},function(e,t){'use strict';t.hypotenuse=function(e,t){var i;return u(e)>u(t)?(i=t/e,u(e)*R(1+i*i)):0===t?0:(i=e/t,u(t)*R(1+i*i))},t.getEmpty2DArray=function(e,t){for(var n=Array(e),o=0;o<e;o++)n[o]=Array(t);return n},t.getFilled2DArray=function(e,t,n){for(var o=Array(e),s=0;s<e;s++){o[s]=Array(t);for(var i=0;i<t;i++)o[s][i]=n}return o}},function(e,t,i){'use strict';function o(d,h){if(!(this instanceof o))return new o(d,h);d=r.default.checkMatrix(d),h=h||{};var x=d.rows,m=d.columns,n=v(x,m),w=!0,y=!0;!1===h.computeLeftSingularVectors&&(w=!1),!1===h.computeRightSingularVectors&&(y=!1);var I=!0===h.autoTranspose,S=!1,C;if(!(x<m))C=d.clone();else if(!I)C=d.clone(),console.warn('Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose');else{C=d.transpose(),x=C.rows,m=C.columns,S=!0;var a=w;w=y,y=a}var D=Array(v(x+1,m)),s=(0,l.getFilled2DArray)(x,n,0),z=(0,l.getFilled2DArray)(m,m,0),V=Array(m),e=Array(x),_=v(x-1,m),P=M(0,v(m-2,x)),A,i,j,k,p,L,U,f,F,T,q,N,O,E,B,Q,W,X,b,c,J;for(j=0,T=M(_,P);j<T;j++){if(j<_){for(D[j]=0,A=j;A<x;A++)D[j]=(0,l.hypotenuse)(D[j],C[A][j]);if(0!==D[j]){for(0>C[j][j]&&(D[j]=-D[j]),A=j;A<x;A++)C[A][j]/=D[j];C[j][j]+=1}D[j]=-D[j]}for(i=j+1;i<m;i++){if(j<_&&0!==D[j]){for(p=0,A=j;A<x;A++)p+=C[A][j]*C[A][i];for(p=-p/C[j][j],A=j;A<x;A++)C[A][i]+=p*C[A][j]}V[i]=C[j][i]}if(w&&j<_)for(A=j;A<x;A++)s[A][j]=C[A][j];if(j<P){for(V[j]=0,A=j+1;A<m;A++)V[j]=(0,l.hypotenuse)(V[j],V[A]);if(0!==V[j]){for(0>V[j+1]&&(V[j]=0-V[j]),A=j+1;A<m;A++)V[A]/=V[j];V[j+1]+=1}if(V[j]=-V[j],j+1<x&&0!==V[j]){for(A=j+1;A<x;A++)e[A]=0;for(i=j+1;i<m;i++)for(A=j+1;A<x;A++)e[A]+=V[i]*C[A][i];for(i=j+1;i<m;i++)for(p=-V[i]/V[j+1],A=j+1;A<x;A++)C[A][i]+=p*e[A]}if(y)for(A=j+1;A<m;A++)z[A][j]=V[A]}}if(k=v(m,x+1),_<m&&(D[_]=C[_][_]),x<k&&(D[k-1]=0),P+1<k&&(V[P]=C[P][k-1]),V[k-1]=0,w){for(i=_;i<n;i++){for(A=0;A<x;A++)s[A][i]=0;s[i][i]=1}for(j=_-1;0<=j;j--)if(0!==D[j]){for(i=j+1;i<n;i++){for(p=0,A=j;A<x;A++)p+=s[A][j]*s[A][i];for(p=-p/s[j][j],A=j;A<x;A++)s[A][i]+=p*s[A][j]}for(A=j;A<x;A++)s[A][j]=-s[A][j];for(s[j][j]=1+s[j][j],A=0;A<j-1;A++)s[A][j]=0}else{for(A=0;A<x;A++)s[A][j]=0;s[j][j]=1}}if(y)for(j=m-1;0<=j;j--){if(j<P&&0!==V[j])for(i=j+1;i<m;i++){for(p=0,A=j+1;A<m;A++)p+=z[A][j]*z[A][i];for(p=-p/z[j+1][j],A=j+1;A<m;A++)z[A][i]+=p*z[A][j]}for(A=0;A<m;A++)z[A][j]=0;z[j][j]=1}for(var g=k-1,Y=0,H=2.220446049250313e-16;0<k;){for(j=k-2;-1<=j&&-1!==j;j--)if(u(V[j])<=H*(u(D[j])+u(D[j+1]))){V[j]=0;break}if(j===k-2)q=4;else{for(L=k-1;L>=j&&L!==j;L--)if(p=(L===k?0:u(V[L]))+(L===j+1?0:u(V[L-1])),u(D[L])<=H*p){D[L]=0;break}L===j?q=3:L===k-1?q=1:(q=2,j=L)}switch(j++,q){case 1:{for(U=V[k-2],V[k-2]=0,i=k-2;i>=j;i--)if(p=(0,l.hypotenuse)(D[i],U),f=D[i]/p,F=U/p,D[i]=p,i!==j&&(U=-F*V[i-1],V[i-1]=f*V[i-1]),y)for(A=0;A<m;A++)p=f*z[A][i]+F*z[A][k-1],z[A][k-1]=-F*z[A][i]+f*z[A][k-1],z[A][i]=p;break}case 2:{for(U=V[j-1],V[j-1]=0,i=j;i<k;i++)if(p=(0,l.hypotenuse)(D[i],U),f=D[i]/p,F=U/p,D[i]=p,U=-F*V[i],V[i]=f*V[i],w)for(A=0;A<x;A++)p=f*s[A][i]+F*s[A][j-1],s[A][j-1]=-F*s[A][i]+f*s[A][j-1],s[A][i]=p;break}case 3:{for(N=M(M(M(M(u(D[k-1]),u(D[k-2])),u(V[k-2])),u(D[j])),u(V[j])),O=D[k-1]/N,E=D[k-2]/N,B=V[k-2]/N,Q=D[j]/N,W=V[j]/N,X=((E+O)*(E-O)+B*B)/2,b=O*B*(O*B),c=0,(0!==X||0!==b)&&(c=R(X*X+b),0>X&&(c=-c),c=b/(X+c)),U=(Q+O)*(Q-O)+c,J=Q*W,i=j;i<k-1;i++){if(p=(0,l.hypotenuse)(U,J),f=U/p,F=J/p,i!==j&&(V[i-1]=p),U=f*D[i]+F*V[i],V[i]=f*V[i]-F*D[i],J=F*D[i+1],D[i+1]=f*D[i+1],y)for(A=0;A<m;A++)p=f*z[A][i]+F*z[A][i+1],z[A][i+1]=-F*z[A][i]+f*z[A][i+1],z[A][i]=p;if(p=(0,l.hypotenuse)(U,J),f=U/p,F=J/p,D[i]=p,U=f*V[i]+F*D[i+1],D[i+1]=-F*V[i]+f*D[i+1],J=F*V[i+1],V[i+1]=f*V[i+1],w&&i<x-1)for(A=0;A<x;A++)p=f*s[A][i]+F*s[A][i+1],s[A][i+1]=-F*s[A][i]+f*s[A][i+1],s[A][i]=p}V[k-2]=U,++Y;break}case 4:{if(0>=D[j]&&(D[j]=0>D[j]?-D[j]:0,y))for(A=0;A<=g;A++)z[A][j]=-z[A][j];for(;j<g&&!(D[j]>=D[j+1]);){if(p=D[j],D[j]=D[j+1],D[j+1]=p,y&&j<m-1)for(A=0;A<m;A++)p=z[A][j+1],z[A][j+1]=z[A][j],z[A][j]=p;if(w&&j<x-1)for(A=0;A<x;A++)p=s[A][j+1],s[A][j+1]=s[A][j],s[A][j]=p;j++}Y=0,k--;break}}}if(S){var K=z;z=s,s=K}this.m=x,this.n=m,this.s=D,this.U=s,this.V=z}Object.defineProperty(t,'__esModule',{value:!0});var n=i(4),r=function(e){return e&&e.__esModule?e:{default:e}}(n),l=i(34);o.prototype={get condition(){return this.s[0]/this.s[v(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var e=M(this.m,this.n)*this.s[0]*2.220446049250313e-16,t=0,n=this.s,o=0,i=n.length;o<i;o++)n[o]>e&&t++;return t},get diagonal(){return this.s},get threshold(){return 2.220446049250313e-16/2*M(this.m,this.n)*this.s[0]},get leftSingularVectors(){return r.default.isMatrix(this.U)||(this.U=new r.default(this.U)),this.U},get rightSingularVectors(){return r.default.isMatrix(this.V)||(this.V=new r.default(this.V)),this.V},get diagonalMatrix(){return r.default.diag(this.s)},solve:function(t){var n=this.threshold,e=this.s.length,o=r.default.zeros(e,e),s;for(s=0;s<e;s++)o[s][s]=u(this.s[s])<=n?0:1/this.s[s];var i=this.U,a=this.rightSingularVectors,l=a.mmul(o),c=a.rows,m=i.length,d=r.default.zeros(c,m),g,h,p;for(s=0;s<c;s++)for(g=0;g<m;g++){for(p=0,h=0;h<e;h++)p+=l[s][h]*i[g][h];d[s][g]=p}return d.mmul(t)},solveForDiagonal:function(e){return this.solve(r.default.diag(e))},inverse:function(){var t=this.V,n=this.threshold,e=t.length,o=t[0].length,s=new r.default(e,this.s.length),a,i;for(a=0;a<e;a++)for(i=0;i<o;i++)s[a][i]=u(this.s[i])>n?t[a][i]/this.s[i]:0;var l=this.U,c=l.length,m=l[0].length,d=new r.default(e,c),g,h;for(a=0;a<e;a++)for(i=0;i<c;i++){for(h=0,g=0;g<m;g++)h+=s[a][g]*l[i][g];d[a][i]=h}return d}},t.default=o},function(e,t){'use strict';function n(e,t){return e-t}t.sum=function(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t},t.max=function(e){for(var t=e[0],n=e.length,o=1;o<n;o++)e[o]>t&&(t=e[o]);return t},t.min=function(e){for(var t=e[0],n=e.length,o=1;o<n;o++)e[o]<t&&(t=e[o]);return t},t.minMax=function(e){for(var t=e[0],n=e[0],o=e.length,s=1;s<o;s++)e[s]<t&&(t=e[s]),e[s]>n&&(n=e[s]);return{min:t,max:n}},t.arithmeticMean=function(e){for(var t=0,n=e.length,o=0;o<n;o++)t+=e[o];return t/n},t.mean=t.arithmeticMean,t.geometricMean=function(e){for(var t=1,n=e.length,o=0;o<n;o++)t*=e[o];return c(t,1/n)},t.logMean=function(e){for(var t=0,n=e.length,o=0;o<n;o++)t+=r(e[o]);return t/n},t.grandMean=function(e,t){for(var o=0,s=0,n=e.length,r=0;r<n;r++)o+=t[r]*e[r],s+=t[r];return o/s},t.truncatedMean=function(e,t,o){o===void 0&&(o=!1),o||(e=[].concat(e).sort(n));for(var s=e.length,r=g(s*t),a=0,l=r;l<s-r;l++)a+=e[l];return a/(s-2*r)},t.harmonicMean=function(e){for(var t=0,n=e.length,o=0;o<n;o++){if(0===e[o])throw new RangeError('value at index '+o+'is zero');t+=1/e[o]}return n/t},t.contraHarmonicMean=function(e){for(var t=0,n=0,o=e.length,s=0;s<o;s++)t+=e[s]*e[s],n+=e[s];if(0>n)throw new RangeError('sum of values is negative');return t/n},t.median=function(e,t){t===void 0&&(t=!1),t||(e=[].concat(e).sort(n));var i=e.length,o=g(i/2);return 0==i%2?0.5*(e[o-1]+e[o]):e[o]},t.variance=function(e,n){n===void 0&&(n=!0);for(var o=t.mean(e),s=0,r=e.length,a=0,i;a<r;a++)i=e[a]-o,s+=i*i;return n?s/(r-1):s/r},t.standardDeviation=function(e,i){return R(t.variance(e,i))},t.standardError=function(e){return t.standardDeviation(e)/R(e.length)},t.robustMeanAndStdev=function(e){var t=0,o=0,s=e.length,r=0;for(r=0;r<s;r++)t+=e[r];t/=s;var i=Array(s);for(r=0;r<s;r++)i[r]=u(e[r]-t);return i.sort(n),o=1==s%2?i[(s-1)/2]/0.6745:0.5*(i[s/2]+i[s/2-1])/0.6745,{mean:t,stdev:o}},t.quartiles=function(e,i){'undefined'==typeof i&&(i=!1),i||(e=[].concat(e).sort(n));var o=e.length/4,r=e[s(o)-1],a=t.median(e,!0),l=e[s(3*o)-1];return{q1:r,q2:a,q3:l}},t.pooledStandardDeviation=function(e,i){return R(t.pooledVariance(e,i))},t.pooledVariance=function(e,n){'undefined'==typeof n&&(n=!0);for(var o=0,s=0,r=e.length,a=0;a<r;a++){var i=e[a],l=t.variance(i);o+=(i.length-1)*l,s+=n?i.length-1:i.length}return o/s},t.mode=function(e){var t=e.length,n=Array(t),o;for(o=0;o<t;o++)n[o]=0;var i=Array(t),s=0;for(o=0;o<t;o++){var r=i.indexOf(e[o]);0<=r?n[r]++:(i[s]=e[o],n[s]=1,s++)}var a=0,l=0;for(o=0;o<s;o++)n[o]>a&&(a=n[o],l=o);return i[l]},t.covariance=function(e,n,o){'undefined'==typeof o&&(o=!0);var s=t.mean(e),r=t.mean(n);if(e.length!==n.length)throw'Vectors do not have the same dimensions';for(var a=0,c=e.length,l=0;l<c;l++){var i=e[l]-s,u=n[l]-r;a+=i*u}return o?a/(c-1):a/c},t.skewness=function(e,n){'undefined'==typeof n&&(n=!0);for(var o=t.mean(e),s=0,r=0,u=e.length,l=0,i;l<u;l++)i=e[l]-o,s+=i*i,r+=i*i*i;var m=s/u,d=r/u,h=d/c(m,3/2);if(n){var g=R(u*(u-1));return g/(u-2)*h}return h},t.kurtosis=function(e,o){'undefined'==typeof o&&(o=!0);for(var s=t.mean(e),r=e.length,n=0,a=0,l=0,i;l<r;l++)i=e[l]-s,n+=i*i,a+=i*i*i*i;var c=n/r,u=a/r;if(o){var m=n/(r-1),d=a/(m*m);return r*(r+1)/((r-1)*(r-2)*(r-3))*d-3*((r-1)*(r-1)/((r-2)*(r-3)))}return u/(c*c)-3},t.entropy=function(e,t){'undefined'==typeof t&&(t=0);for(var n=0,o=e.length,s=0;s<o;s++)n+=e[s]*r(e[s]+t);return-n},t.weightedMean=function(e,t){for(var n=0,o=e.length,s=0;s<o;s++)n+=e[s]*t[s];return n},t.weightedStandardDeviation=function(e,i){return R(t.weightedVariance(e,i))},t.weightedVariance=function(e,n){for(var o=t.weightedMean(e,n),s=0,r=e.length,l=0,a=0,c=0;c<r;c++){var i=e[c]-o,u=n[c];s+=u*(i*i),a+=u,l+=u*u}return s*(a/(a*a-l))},t.center=function(e,n){'undefined'==typeof n&&(n=!1);var o=e;n||(o=[].concat(e));for(var s=t.mean(o),r=o.length,a=0;a<r;a++)o[a]-=s},t.standardize=function(e,n,o){'undefined'==typeof n&&(n=t.standardDeviation(e)),'undefined'==typeof o&&(o=!1);for(var s=e.length,r=o?e:Array(s),a=0;a<s;a++)r[a]=e[a]/n;return r},t.cumulativeSum=function(e){var t=e.length,n=Array(t);n[0]=e[0];for(var o=1;o<t;o++)n[o]=n[o-1]+e[o];return n}},function(e,t,i){'use strict';function o(e){if(!(this instanceof o))return new o(e);e=r.default.checkMatrix(e);var t=e.clone(),a=e.rows,l=e.columns,n=Array(l),c,i,u,m;for(u=0;u<l;u++){var d=0;for(c=u;c<a;c++)d=(0,s.hypotenuse)(d,t[c][u]);if(0!==d){for(0>t[u][u]&&(d=-d),c=u;c<a;c++)t[c][u]/=d;for(t[u][u]+=1,i=u+1;i<l;i++){for(m=0,c=u;c<a;c++)m+=t[c][u]*t[c][i];for(m=-m/t[u][u],c=u;c<a;c++)t[c][i]+=m*t[c][u]}}n[u]=-d}this.QR=t,this.Rdiag=n}Object.defineProperty(t,'__esModule',{value:!0});var n=i(4),r=function(e){return e&&e.__esModule?e:{default:e}}(n),s=i(34);o.prototype={solve:function(e){e=r.default.checkMatrix(e);var t=this.QR,o=t.rows;if(e.rows!==o)throw new Error('Matrix row dimensions must agree');if(!this.isFullRank())throw new Error('Matrix is rank deficient');var a=e.columns,l=e.clone(),c=t.columns,n,i,u,m;for(u=0;u<c;u++)for(i=0;i<a;i++){for(m=0,n=u;n<o;n++)m+=t[n][u]*l[n][i];for(m=-m/t[u][u],n=u;n<o;n++)l[n][i]+=m*t[n][u]}for(u=c-1;0<=u;u--){for(i=0;i<a;i++)l[u][i]/=this.Rdiag[u];for(n=0;n<u;n++)for(i=0;i<a;i++)l[n][i]-=l[u][i]*t[n][u]}return l.subMatrix(0,c-1,0,a-1)},isFullRank:function(){for(var e=this.QR.columns,t=0;t<e;t++)if(0===this.Rdiag[t])return!1;return!0},get upperTriangularMatrix(){var e=this.QR,t=e.columns,n=new r.default(t,t),o,i;for(o=0;o<t;o++)for(i=0;i<t;i++)n[o][i]=o<i?e[o][i]:o===i?this.Rdiag[o]:0;return n},get orthogonalMatrix(){var e=this.QR,t=e.rows,n=e.columns,o=new r.default(t,n),a,i,l,c;for(l=n-1;0<=l;l--){for(a=0;a<t;a++)o[a][l]=0;for(o[l][l]=1,i=l;i<n;i++)if(0!==e[l][l]){for(c=0,a=l;a<t;a++)c+=e[a][l]*o[a][i];for(c=-c/e[l][l],a=l;a<t;a++)o[a][i]+=c*e[a][l]}}return o}},t.default=o},function(e,t,i){'use strict';function n(e,t){return 0|e*t}function o(e,t){return v(e-2,0|e*t)}function s(e,t,i){return c(M(e+1,0|4*e/(3*t+i)))}function r(e,t,i){return c(M(e+1,0|4*e/(t+3*i)))}var a=i(121),l=i(122),c=l.nextPrime,u=l.largestPrime,m=0,d=1,g=2;class h{constructor(e={}){if(e instanceof h)return this.table=e.table.slice(),this.values=e.values.slice(),this.state=e.state.slice(),this.minLoadFactor=e.minLoadFactor,this.maxLoadFactor=e.maxLoadFactor,this.distinct=e.distinct,this.freeEntries=e.freeEntries,this.lowWaterMark=e.lowWaterMark,void(this.highWaterMark=e.maxLoadFactor);var t=e.initialCapacity===void 0?150:e.initialCapacity;if(0>t)throw new RangeError(`initial capacity must not be less than zero: ${t}`);var i=e.minLoadFactor===void 0?1/6:e.minLoadFactor,n=e.maxLoadFactor===void 0?2/3:e.maxLoadFactor;if(0>i||1<=i)throw new RangeError(`invalid minLoadFactor: ${i}`);if(0>=n||1<=n)throw new RangeError(`invalid maxLoadFactor: ${n}`);if(i>=n)throw new RangeError(`minLoadFactor (${i}) must be smaller than maxLoadFactor (${n})`);var s=t;s=0|s/n,s=c(s),0===s&&(s=1),this.table=a(s,0),this.values=a(s,0),this.state=a(s,0),this.minLoadFactor=i,this.maxLoadFactor=s===u?1:n,this.distinct=0,this.freeEntries=s,this.lowWaterMark=0,this.highWaterMark=o(s,this.maxLoadFactor)}clone(){return new h(this)}get size(){return this.distinct}get(e){var t=this.indexOfKey(e);return 0>t?0:this.values[t]}set(e,t){var n=this.indexOfInsertion(e);if(0>n)return n=-n-1,this.values[n]=t,!1;if(this.distinct>this.highWaterMark){var o=s(this.distinct+1,this.minLoadFactor,this.maxLoadFactor);return this.rehash(o),this.set(e,t)}if(this.table[n]=e,this.values[n]=t,this.state[n]===m&&this.freeEntries--,this.state[n]=d,this.distinct++,1>this.freeEntries){var r=s(this.distinct+1,this.minLoadFactor,this.maxLoadFactor);this.rehash(r)}return!0}remove(e,t){var n=this.indexOfKey(e);return!(0>n)&&(this.state[n]=g,this.distinct--,t||this.maybeShrinkCapacity(),!0)}delete(e,t){var n=this.indexOfKey(e);return!(0>n)&&(this.state[n]=m,this.distinct--,t||this.maybeShrinkCapacity(),!0)}maybeShrinkCapacity(){if(this.distinct<this.lowWaterMark){var e=r(this.distinct,this.minLoadFactor,this.maxLoadFactor);this.rehash(e)}}containsKey(e){return 0<=this.indexOfKey(e)}indexOfKey(e){var t=this.table,n=this.state,o=this.table.length,s=2147483647&e,r=s%o,i=s%(o-2);for(0==i&&(i=1);n[r]!==m&&(n[r]===g||t[r]!==e);)r-=i,0>r&&(r+=o);return n[r]===m?-1:r}containsValue(e){return 0<=this.indexOfValue(e)}indexOfValue(e){for(var t=this.values,n=this.state,o=0;o<n.length;o++)if(n[o]===d&&t[o]===e)return o;return-1}indexOfInsertion(e){var t=this.table,n=this.state,o=t.length,s=2147483647&e,r=s%o,a=s%(o-2);for(0==a&&(a=1);n[r]===d&&t[r]!==e;)r-=a,0>r&&(r+=o);if(n[r]===g){for(var l=r;n[r]!==m&&(n[r]===g||t[r]!==e);)r-=a,0>r&&(r+=o);n[r]===m&&(r=l)}return n[r]===d?-r-1:r}ensureCapacity(e){if(this.table.length<e){var t=c(e);this.rehash(t)}}rehash(e){var t=this.table.length;if(e<=this.distinct)throw new Error('Unexpected');var s=this.table,r=this.values,l=this.state,c=a(e,0),u=a(e,0),m=a(e,0);this.lowWaterMark=n(e,this.minLoadFactor),this.highWaterMark=o(e,this.maxLoadFactor),this.table=c,this.values=u,this.state=m,this.freeEntries=e-this.distinct;for(var g=0;g<t;g++)if(l[g]===d){var i=s[g],h=this.indexOfInsertion(i);c[h]=i,u[h]=r[g],m[h]=d}}forEachKey(e){for(var t=0;t<this.state.length;t++)if(this.state[t]===d&&!e(this.table[t]))return!1;return!0}forEachValue(e){for(var t=0;t<this.state.length;t++)if(this.state[t]===d&&!e(this.values[t]))return!1;return!0}forEachPair(e){for(var t=0;t<this.state.length;t++)if(this.state[t]===d&&!e(this.table[t],this.values[t]))return!1;return!0}}e.exports=h},function(e){'use strict';e.exports=function(e,t,i,n,o){var s,r;if(void 0===n)n=0;else if(n|=0,0>n||n>=e.length)throw new RangeError('invalid lower bound');if(void 0===o)o=e.length-1;else if(o|=0,o<n||o>=e.length)throw new RangeError('invalid upper bound');for(;n<=o;)if(s=n+(o-n>>1),r=+i(e[s],t,s,e),0>r)n=s+1;else if(0<r)o=s-1;else return s;return~n}},function(e,t,i){'use strict';function n(e){if('number'!=typeof e||o(e))throw new TypeError('Expected a number')}var o=i(123);t.asc=function(e,t){return n(e),n(t),e-t},t.desc=function(e,t){return n(e),n(t),t-e}},function(e,t,i){'use strict';function n(e,t){var n=e.length;'number'==typeof t.size&&(t.size=[t.size,t.size]);var o=n+t.size[0]+t.size[1],s;if(t.output){if(t.output.length!==o)throw new RangeError('Wrong output size');s=t.output}else s=Array(o);var r;if('circular'===t.value)for(r=0;r<o;r++)s[r]=r<t.size[0]?e[(n-t.size[0]%n+r)%n]:r<t.size[0]+n?e[r-t.size[0]]:e[(r-t.size[0])%n];else if('replicate'===t.value)for(r=0;r<o;r++)s[r]=r<t.size[0]?e[0]:r<t.size[0]+n?e[r-t.size[0]]:e[n-1];else if('symmetric'===t.value){if(t.size[0]>n||t.size[1]>n)throw new RangeError('expanded value should not be bigger than the data length');for(r=0;r<o;r++)s[r]=r<t.size[0]?e[t.size[0]-1-r]:r<t.size[0]+n?e[r-t.size[0]]:e[2*n+t.size[0]-r-1]}else for(r=0;r<o;r++)s[r]=r<t.size[0]?t.value:r<t.size[0]+n?e[r-t.size[0]]:t.value;return s}function o(e,t){var i=e.length,n=e[0].length;throw void 0===t.size[0]&&(t.size=[t.size,t.size,t.size,t.size]),new Error('matrix not supported yet, sorry')}var s=i(35),r={size:1,value:0};e.exports=function(e,t){if(t=s({},r,t),Array.isArray(e))return Array.isArray(e[0])?o(e,t):n(e,t);throw new TypeError('data should be an array')}},function(e,t,i){'use strict';function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t,o,s){var r=t.length,n;if(Array.isArray(s))n=s,s=n.length;else{s++,n=Array(s);for(var u=0;u<s;u++)n[u]=u}for(var m=new l.default(r,s),d=new l.default([o]),g=0;g<s;g++)for(var h=0;h<r;h++)m[h][g]=0===n[g]?1:c(t[h],n[g]);var i=m.transposeView(),p=i.mmul(m),k=i.mmul(d.transposeView());e.degree=s-1,e.powers=n,e.coefficients=(0,a.solve)(p,k).to1DArray()}Object.defineProperty(t,'__esModule',{value:!0});var s=i(3),r=n(s),a=i(13),l=n(a);class u extends r.default{constructor(e,t,i){super(),!0===e?(this.degree=t.degree,this.powers=t.powers,this.coefficients=t.coefficients):((0,s.checkArrayLength)(e,t),o(this,e,t,i))}_predict(e){for(var t=0,i=0;i<this.powers.length;i++)t+=this.coefficients[i]*c(e,this.powers[i]);return t}toJSON(){return{name:'polynomialRegression',degree:this.degree,powers:this.powers,coefficients:this.coefficients}}toString(e){return this._toFormula(e,!1)}toLaTeX(e){return this._toFormula(e,!0)}_toFormula(e,t){var i='^',n='',o=' * ';t&&(i='^{',n='}',o='');for(var r='',a='',l=0;l<this.coefficients.length;l++)a='',0!==this.coefficients[l]&&(a=0===this.powers[l]?(0,s.maybeToPrecision)(this.coefficients[l],e):1===this.powers[l]?(0,s.maybeToPrecision)(this.coefficients[l],e)+o+'x':(0,s.maybeToPrecision)(this.coefficients[l],e)+o+'x'+i+this.powers[l]+n,0<this.coefficients[l]&&l!==this.coefficients.length-1?a=' + '+a:l!==this.coefficients.length-1&&(a=' '+a)),r=a+r;return'+'===r.charAt(0)&&(r=r.slice(1)),'f(x) = '+r}static load(e){if('polynomialRegression'!==e.name)throw new TypeError('not a polynomial regression model');return new u(!0,e)}}t.default=u},function(e){'use strict';e.exports=function(e,t){for(var n=0,o=0,s=0;s<e.length;s++)n+=v(e[s],t[s]),o+=e[s]+t[s];return 2*n/o}},function(e){'use strict';e.exports=function(e,t){for(var n=e.length,o=0,s=0,r=0,a=0;a<n;a++)o+=e[a]*e[a],s+=t[a]*t[a],r+=(e[a]-t[a])*(e[a]-t[a]);return r/(o+s)}},function(e){'use strict';e.exports=function(e,t){for(var n=e.length,o=0,s=0;s<n;s++)o+=v(e[s],t[s]);return 1-o}},function(e){'use strict';e.exports=function(e,t){for(var n=e.length,o=0,s=0,r=0,a=0,l=0;l<n;l++)o+=e[l]*t[l],s+=e[l]*e[l],r+=t[l]*t[l],a+=(e[l]-t[l])*(e[l]-t[l]);return a/(s+r-o)}},function(e){'use strict';e.exports=function(e,t){for(var n=e.length,o=0,s=0,r=0;r<n;r++)o+=u(e[r]-t[r]),s+=v(e[r],t[r]);return o/s}},function(e){'use strict';e.exports=function(e,t){for(var n=e.length,o=0,s=0,r=0;r<n;r++)o+=v(e[r],t[r]),s+=e[r]+t[r];return 1-o/s}},function(e){'use strict';e.exports=function(e,t){for(var n=e.length,o=0,s=0;s<n;s++)o+=(R(e[s])-R(t[s]))*(R(e[s])-R(t[s]));return o}},function(e){'use strict';e.exports=function(e,t,n){if(n){for(var o=0,s=0,r=0;r<e.length;r++)o+=e[r]&&t[r],s+=e[r]||t[r];return 0===s?1:o/s}for(var a=e.length,l=0,c=0,u=0,m=0;m<a;m++)l+=e[m],c+=t[m],u+=v(e[m],t[m]);return 1-(l+c-2*u)/(l+c-u)}},function(e){'use strict';e.exports=function(e,t){for(var n=e.length,o=0,s=0,r=0,a=0;a<n;a++)o+=e[a]*t[a],s+=e[a]*e[a],r+=t[a]*t[a];return o/(R(s)*R(r))}},function(e){'use strict';e.exports=function(e,t){for(var n=e.length,o=Array.from({length:n}).map(()=>Array.from({length:n})),s=0;s<n;s++)for(var i=0;i<=s;i++)o[s][i]=t(e[s],e[i]);for(var r=0;r<n;r++)for(var a=r+1;a<n;a++)o[r][a]=o[a][r];return o}},function(e,t,i){'use strict';function n(e){function t(e,t){if(e.rows!==t.rows||e.columns!==t.columns)throw new RangeError('Matrices dimensions must be equal')}function n(e,t){return e-t}function x(e,t){for(var i in t)e=e.replace(new RegExp('%'+i+'%','g'),t[i]);return e}e===void 0&&(e=Object);class w extends e{static get[Symbol.species](){return this}static from1DArray(e,t,i){if(e*t!==i.length)throw new RangeError('Data length does not match given dimensions');for(var n=new this(e,t),o=0;o<e;o++)for(var s=0;s<t;s++)n.set(o,s,i[o*t+s]);return n}static rowVector(e){for(var t=new this(1,e.length),n=0;n<e.length;n++)t.set(0,n,e[n]);return t}static columnVector(e){for(var t=new this(e.length,1),n=0;n<e.length;n++)t.set(n,0,e[n]);return t}static empty(e,t){return new this(e,t)}static zeros(e,t){return this.empty(e,t).fill(0)}static ones(e,t){return this.empty(e,t).fill(1)}static rand(e,t,n){n===void 0&&(n=Math.random);for(var o=this.empty(e,t),s=0;s<e;s++)for(var i=0;i<t;i++)o.set(s,i,n());return o}static randInt(e,t,n,o){n===void 0&&(n=1e3),o===void 0&&(o=Math.random);for(var s=this.empty(e,t),r=0;r<e;r++)for(var i=0,a;i<t;i++)a=g(o()*n),s.set(r,i,a);return s}static eye(e,t,n){t===void 0&&(t=e),n===void 0&&(n=1);for(var o=v(e,t),s=this.zeros(e,t),r=0;r<o;r++)s.set(r,r,n);return s}static diag(e,t,n){var o=e.length;t===void 0&&(t=o),n===void 0&&(n=t);for(var s=v(o,t,n),r=this.zeros(t,n),a=0;a<s;a++)r.set(a,a,e[a]);return r}static min(e,t){e=this.checkMatrix(e),t=this.checkMatrix(t);for(var n=e.rows,o=e.columns,s=new this(n,o),r=0;r<n;r++)for(var i=0;i<o;i++)s.set(r,i,v(e.get(r,i),t.get(r,i)));return s}static max(e,t){e=this.checkMatrix(e),t=this.checkMatrix(t);for(var n=e.rows,o=e.columns,s=new this(n,o),r=0;r<n;r++)for(var i=0;i<o;i++)s.set(r,i,M(e.get(r,i),t.get(r,i)));return s}static checkMatrix(e){return w.isMatrix(e)?e:new this(e)}static isMatrix(e){return null!=e&&'Matrix'===e.klass}get size(){return this.rows*this.columns}apply(e){if('function'!=typeof e)throw new TypeError('callback must be a function');for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var i=0;i<n;i++)e.call(this,o,i);return this}to1DArray(){for(var e=Array(this.size),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e[t*this.columns+i]=this.get(t,i);return e}to2DArray(){for(var e=Array(this.rows),t=0;t<this.rows;t++){e[t]=Array(this.columns);for(var i=0;i<this.columns;i++)e[t][i]=this.get(t,i)}return e}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isSymmetric(){if(this.isSquare()){for(var e=0;e<this.rows;e++)for(var t=0;t<=e;t++)if(this.get(e,t)!==this.get(t,e))return!1;return!0}return!1}set(){throw new Error('set method is unimplemented')}get(){throw new Error('get method is unimplemented')}repeat(e,t){e=e||1,t=t||1;for(var n=new this.constructor[Symbol.species](this.rows*e,this.columns*t),o=0;o<e;o++)for(var i=0;i<t;i++)n.setSubMatrix(this,this.rows*o,this.columns*i);return n}fill(e){for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,e);return this}neg(){return this.mulS(-1)}getRow(e){l.checkRowIndex(this,e);for(var t=Array(this.columns),n=0;n<this.columns;n++)t[n]=this.get(e,n);return t}getRowVector(e){return this.constructor.rowVector(this.getRow(e))}setRow(e,t){l.checkRowIndex(this,e),t=l.checkRowVector(this,t);for(var n=0;n<this.columns;n++)this.set(e,n,t[n]);return this}swapRows(e,t){l.checkRowIndex(this,e),l.checkRowIndex(this,t);for(var n=0,i;n<this.columns;n++)i=this.get(e,n),this.set(e,n,this.get(t,n)),this.set(t,n,i);return this}getColumn(e){l.checkColumnIndex(this,e);for(var t=Array(this.rows),n=0;n<this.rows;n++)t[n]=this.get(n,e);return t}getColumnVector(e){return this.constructor.columnVector(this.getColumn(e))}setColumn(e,t){l.checkColumnIndex(this,e),t=l.checkColumnVector(this,t);for(var n=0;n<this.rows;n++)this.set(n,e,t[n]);return this}swapColumns(e,t){l.checkColumnIndex(this,e),l.checkColumnIndex(this,t);for(var n=0,i;n<this.rows;n++)i=this.get(n,e),this.set(n,e,this.get(n,t)),this.set(n,t,i);return this}addRowVector(e){e=l.checkRowVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)+e[i]);return this}subRowVector(e){e=l.checkRowVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)-e[i]);return this}mulRowVector(e){e=l.checkRowVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)*e[i]);return this}divRowVector(e){e=l.checkRowVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)/e[i]);return this}addColumnVector(e){e=l.checkColumnVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)+e[t]);return this}subColumnVector(e){e=l.checkColumnVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)-e[t]);return this}mulColumnVector(e){e=l.checkColumnVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)*e[t]);return this}divColumnVector(e){e=l.checkColumnVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)/e[t]);return this}mulRow(e,t){l.checkRowIndex(this,e);for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t);return this}mulColumn(e,t){l.checkColumnIndex(this,e);for(var n=0;n<this.rows;n++)this.set(n,e,this.get(n,e)*t);return this}max(){for(var e=this.get(0,0),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.get(t,i)>e&&(e=this.get(t,i));return e}maxIndex(){for(var e=this.get(0,0),t=[0,0],n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.get(n,i)>e&&(e=this.get(n,i),t[0]=n,t[1]=i);return t}min(){for(var e=this.get(0,0),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.get(t,i)<e&&(e=this.get(t,i));return e}minIndex(){for(var e=this.get(0,0),t=[0,0],n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.get(n,i)<e&&(e=this.get(n,i),t[0]=n,t[1]=i);return t}maxRow(e){l.checkRowIndex(this,e);for(var t=this.get(e,0),n=1;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n));return t}maxRowIndex(e){l.checkRowIndex(this,e);for(var t=this.get(e,0),n=[e,0],o=1;o<this.columns;o++)this.get(e,o)>t&&(t=this.get(e,o),n[1]=o);return n}minRow(e){l.checkRowIndex(this,e);for(var t=this.get(e,0),n=1;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n));return t}minRowIndex(e){l.checkRowIndex(this,e);for(var t=this.get(e,0),n=[e,0],o=1;o<this.columns;o++)this.get(e,o)<t&&(t=this.get(e,o),n[1]=o);return n}maxColumn(e){l.checkColumnIndex(this,e);for(var t=this.get(0,e),n=1;n<this.rows;n++)this.get(n,e)>t&&(t=this.get(n,e));return t}maxColumnIndex(e){l.checkColumnIndex(this,e);for(var t=this.get(0,e),n=[0,e],o=1;o<this.rows;o++)this.get(o,e)>t&&(t=this.get(o,e),n[0]=o);return n}minColumn(e){l.checkColumnIndex(this,e);for(var t=this.get(0,e),n=1;n<this.rows;n++)this.get(n,e)<t&&(t=this.get(n,e));return t}minColumnIndex(e){l.checkColumnIndex(this,e);for(var t=this.get(0,e),n=[0,e],o=1;o<this.rows;o++)this.get(o,e)<t&&(t=this.get(o,e),n[0]=o);return n}diag(){for(var e=v(this.rows,this.columns),t=Array(e),n=0;n<e;n++)t[n]=this.get(n,n);return t}sum(e){return'row'===e?l.sumByRow(this):'column'===e?l.sumByColumn(this):l.sumAll(this)}mean(){return this.sum()/this.size}prod(){for(var e=1,t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e*=this.get(t,i);return e}cumulativeSum(){for(var e=0,t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e+=this.get(t,i),this.set(t,i,e);return this}dot(e){w.isMatrix(e)&&(e=e.to1DArray());var t=this.to1DArray();if(t.length!==e.length)throw new RangeError('vectors do not have the same size');for(var n=0,o=0;o<t.length;o++)n+=t[o]*e[o];return n}mmul(e){e=this.constructor.checkMatrix(e),this.columns!==e.rows&&console.warn('Number of columns of left matrix are not equal to number of rows of right matrix.');for(var t=this.rows,o=this.columns,n=e.columns,r=new this.constructor[Symbol.species](t,n),a=Array(o),l=0;l<n;l++){for(var c=0;c<o;c++)a[c]=e.get(c,l);for(var u=0,i;u<t;u++){for(i=0,c=0;c<o;c++)i+=this.get(u,c)*a[c];r.set(u,l,i)}}return r}strassen2x2(e){var t=new this.constructor[Symbol.species](2,2),i=this.get(0,0),n=e.get(0,0),o=this.get(0,1),s=e.get(0,1),r=this.get(1,0),a=e.get(1,0),l=this.get(1,1),c=e.get(1,1),u=(i+l)*(n+c),m=(r+l)*n,d=i*(s-c),g=l*(a-n),h=(i+o)*c;return t.set(0,0,u+g-h+(o-l)*(a+c)),t.set(0,1,d+h),t.set(1,0,m+g),t.set(1,1,u-m+d+(r-i)*(n+s)),t}strassen3x3(e){var t=new this.constructor[Symbol.species](3,3),i=this.get(0,0),n=this.get(0,1),o=this.get(0,2),s=this.get(1,0),r=this.get(1,1),a=this.get(1,2),l=this.get(2,0),c=this.get(2,1),u=this.get(2,2),m=e.get(0,0),d=e.get(0,1),g=e.get(0,2),h=e.get(1,0),p=e.get(1,1),k=e.get(1,2),j=e.get(2,0),x=e.get(2,1),w=e.get(2,2),f=(i-s)*(-d+p),y=(-i+s+r)*(m-d+p),M=(s+r)*(-m+d),b=i*m,v=(-i+l+c)*(m-g+k),R=(-i+l)*(g-k),I=(l+c)*(-m+g),S=(-o+c+u)*(p+j-x),C=(o-u)*(p-x),V=o*j,D=(c+u)*(-j+x),z=(-o+r+a)*(k+j-w),_=(o-a)*(k-w),P=(r+a)*(-j+w);return t.set(0,0,b+V+n*h),t.set(0,1,(i+n+o-s-r-c-u)*p+y+M+b+S+V+D),t.set(0,2,b+v+I+(i+n+o-r-a-l-c)*k+V+z+P),t.set(1,0,f+r*(-m+d+h-p-k-j+w)+y+b+V+z+_),t.set(1,1,f+y+M+b+a*x),t.set(1,2,V+z+_+P+s*g),t.set(2,0,b+v+R+c*(-m+g+h-p-k-j+x)+S+C+V),t.set(2,1,S+C+V+D+l*d),t.set(2,2,b+v+R+I+u*w),t}mmulStrassen(e){function t(e,t,i){var n=e.rows,o=e.columns;if(n===t&&o===i)return e;var s=w.zeros(t,i);return s=s.setSubMatrix(e,0,0),s}function i(e,n,o,s){if(512>=o||512>=s)return e.mmul(n);1==o%2&&1==s%2?(e=t(e,o+1,s+1),n=t(n,o+1,s+1)):1==o%2?(e=t(e,o+1,s),n=t(n,o+1,s)):1==s%2&&(e=t(e,o,s+1),n=t(n,o,s+1));var r=parseInt(e.rows/2),a=parseInt(e.columns/2),l=e.subMatrix(0,r-1,0,a-1),c=n.subMatrix(0,r-1,0,a-1),u=e.subMatrix(0,r-1,a,e.columns-1),m=n.subMatrix(0,r-1,a,n.columns-1),d=e.subMatrix(r,e.rows-1,0,a-1),g=n.subMatrix(r,n.rows-1,0,a-1),h=e.subMatrix(r,e.rows-1,a,e.columns-1),p=n.subMatrix(r,n.rows-1,a,n.columns-1),k=i(w.add(l,h),w.add(c,p),r,a),j=i(w.add(d,h),c,r,a),x=i(l,w.sub(m,p),r,a),f=i(h,w.sub(g,c),r,a),y=i(w.add(l,u),p,r,a),M=i(w.sub(d,l),w.add(c,m),r,a),b=i(w.sub(u,h),w.add(g,p),r,a),v=w.add(k,f);v.sub(y),v.add(b);var R=w.add(x,y),I=w.add(j,f),S=w.sub(k,j);S.add(x),S.add(M);var C=w.zeros(2*v.rows,2*v.columns);return C=C.setSubMatrix(v,0,0),C=C.setSubMatrix(R,v.rows,0),C=C.setSubMatrix(I,0,v.columns),C=C.setSubMatrix(S,v.rows,v.columns),C.subMatrix(0,o-1,0,s-1)}var n=this.clone(),o=n.rows,s=n.columns,a=e.rows,l=e.columns;s!==a&&console.warn(`Multiplying ${o} x ${s} and ${a} x ${l} matrix: dimensions do not match.`);var u=M(o,a),r=M(s,l);return n=t(n,u,r),e=t(e,u,r),i(n,e,u,r)}scaleRows(e,t){if(e=void 0===e?0:e,t=void 0===t?1:t,e>=t)throw new RangeError('min should be strictly smaller than max');for(var n=this.constructor.empty(this.rows,this.columns),o=0,i;o<this.rows;o++)i=s.scale(this.getRow(o),{min:e,max:t}),n.setRow(o,i);return n}scaleColumns(e,t){if(e=void 0===e?0:e,t=void 0===t?1:t,e>=t)throw new RangeError('min should be strictly smaller than max');for(var n=this.constructor.empty(this.rows,this.columns),o=0,i;o<this.columns;o++)i=s.scale(this.getColumn(o),{min:e,max:t}),n.setColumn(o,i);return n}kroneckerProduct(e){e=this.constructor.checkMatrix(e);for(var t=this.rows,o=this.columns,n=e.rows,s=e.columns,r=new this.constructor[Symbol.species](t*n,o*s),a=0;a<t;a++)for(var i=0;i<o;i++)for(var c=0;c<n;c++)for(var u=0;u<s;u++)r[n*a+c][s*i+u]=this.get(a,i)*e.get(c,u);return r}transpose(){for(var e=new this.constructor[Symbol.species](this.columns,this.rows),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e.set(i,t,this.get(t,i));return e}sortRows(e){e===void 0&&(e=n);for(var t=0;t<this.rows;t++)this.setRow(t,this.getRow(t).sort(e));return this}sortColumns(e){e===void 0&&(e=n);for(var t=0;t<this.columns;t++)this.setColumn(t,this.getColumn(t).sort(e));return this}subMatrix(e,t,n,o){l.checkRange(this,e,t,n,o);for(var s=new this.constructor[Symbol.species](t-e+1,o-n+1),r=e;r<=t;r++)for(var i=n;i<=o;i++)s[r-e][i-n]=this.get(r,i);return s}subMatrixRow(e,t,n){if(void 0===t&&(t=0),void 0===n&&(n=this.columns-1),t>n||0>t||t>=this.columns||0>n||n>=this.columns)throw new RangeError('Argument out of range');for(var o=new this.constructor[Symbol.species](e.length,n-t+1),s=0;s<e.length;s++)for(var i=t;i<=n;i++){if(0>e[s]||e[s]>=this.rows)throw new RangeError('Row index out of range: '+e[s]);o.set(s,i-t,this.get(e[s],i))}return o}subMatrixColumn(e,t,n){if(void 0===t&&(t=0),void 0===n&&(n=this.rows-1),t>n||0>t||t>=this.rows||0>n||n>=this.rows)throw new RangeError('Argument out of range');for(var o=new this.constructor[Symbol.species](n-t+1,e.length),s=0;s<e.length;s++)for(var i=t;i<=n;i++){if(0>e[s]||e[s]>=this.columns)throw new RangeError('Column index out of range: '+e[s]);o.set(i-t,s,this.get(i,e[s]))}return o}setSubMatrix(e,t,n){e=this.constructor.checkMatrix(e);var o=t+e.rows-1,s=n+e.columns-1;l.checkRange(this,t,o,n,s);for(var r=0;r<e.rows;r++)for(var i=0;i<e.columns;i++)this[t+r][n+i]=e.get(r,i);return this}selection(e,t){for(var n=l.checkIndices(this,e,t),o=new this.constructor[Symbol.species](e.length,t.length),s=0,i;s<n.row.length;s++){i=n.row[s];for(var r=0,a;r<n.column.length;r++)a=n.column[r],o[s][r]=this.get(i,a)}return o}trace(){for(var e=v(this.rows,this.columns),t=0,n=0;n<e;n++)t+=this.get(n,n);return t}transposeView(){return new c(this)}rowView(e){return l.checkRowIndex(this,e),new m(this,e)}columnView(e){return l.checkColumnIndex(this,e),new p(this,e)}flipRowView(){return new k(this)}flipColumnView(){return new j(this)}subMatrixView(e,t,i,n){return new d(this,e,t,i,n)}selectionView(e,t){return new h(this,e,t)}det(){if(this.isSquare()){var e,t,i,n;if(2===this.columns)return e=this.get(0,0),t=this.get(0,1),i=this.get(1,0),n=this.get(1,1),e*n-t*i;if(3===this.columns){var s,r,a;return s=this.selectionView([1,2],[1,2]),r=this.selectionView([1,2],[0,2]),a=this.selectionView([1,2],[0,1]),e=this.get(0,0),t=this.get(0,1),i=this.get(0,2),e*s.det()-t*r.det()+i*a.det()}return new o(this).determinant}throw Error('Determinant can only be calculated for a square matrix.')}pseudoInverse(e){void 0===e&&(e=a);for(var t=new r(this,{autoTranspose:!0}),n=t.leftSingularVectors,o=t.rightSingularVectors,l=t.diagonal,s=0;s<l.length;s++)l[s]=u(l[s])>e?1/l[s]:0;return l=this.constructor[Symbol.species].diag(l),o.mmul(l.mmul(n.transposeView()))}}w.prototype.klass='Matrix',w.random=w.rand,w.diagonal=w.diag,w.prototype.diagonal=w.prototype.diag,w.identity=w.eye,w.prototype.negate=w.prototype.neg,w.prototype.tensorProduct=w.prototype.kroneckerProduct,w.prototype.determinant=w.prototype.det;var f=`
(function %name%(value) {
    if (typeof value === 'number') return this.%name%S(value);
    return this.%name%M(value);
})
`,y=`
(function %name%S(value) {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, this.get(i, j) %op% value);
        }
    }
    return this;
})
`,b=`
(function %name%M(matrix) {
    matrix = this.constructor.checkMatrix(matrix);
    checkDimensions(this, matrix);
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, this.get(i, j) %op% matrix.get(i, j));
        }
    }
    return this;
})
`,R=`
(function %name%(matrix, value) {
    var newMatrix = new this[Symbol.species](matrix);
    return newMatrix.%name%(value);
})
`,I=`
(function %name%() {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j)));
        }
    }
    return this;
})
`,S=`
(function %name%(matrix) {
    var newMatrix = new this[Symbol.species](matrix);
    return newMatrix.%name%();
})
`,C=`
(function %name%(%args%) {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j), %args%));
        }
    }
    return this;
})
`,V=`
(function %name%(matrix, %args%) {
    var newMatrix = new this[Symbol.species](matrix);
    return newMatrix.%name%(%args%);
})
`,D=`
(function %name%S(value) {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j), value));
        }
    }
    return this;
})
`,z=`
(function %name%M(matrix) {
    matrix = this.constructor.checkMatrix(matrix);
    checkDimensions(this, matrix);
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j), matrix.get(i, j)));
        }
    }
    return this;
})
`,_=`
(function %name%(value) {
    if (typeof value === 'number') return this.%name%S(value);
    return this.%name%M(value);
})
`,P=V,A=[['+','add'],['-','sub','subtract'],['*','mul','multiply'],['/','div','divide'],['%','mod','modulus'],['&','and'],['|','or'],['^','xor'],['<<','leftShift'],['>>','signPropagatingRightShift'],['>>>','rightShift','zeroFillRightShift']],L=!0,U=!1,F,i;try{for(var T=A[Symbol.iterator](),q;!(L=(q=T.next()).done);L=!0){var N=q.value,O=eval(x(f,{name:N[1],op:N[0]})),E=eval(x(y,{name:N[1]+'S',op:N[0]})),B=eval(x(b,{name:N[1]+'M',op:N[0]})),Q=eval(x(R,{name:N[1]}));for(F=1;F<N.length;F++)w.prototype[N[F]]=O,w.prototype[N[F]+'S']=E,w.prototype[N[F]+'M']=B,w[N[F]]=Q}}catch(e){U=!0,i=e}finally{try{!L&&T.return&&T.return()}finally{if(U)throw i}}var W=[['~','not']];['abs','acos','acosh','asin','asinh','atan','atanh','cbrt','ceil','clz32','cos','cosh','exp','expm1','floor','fround','log','log1p','log10','log2','round','sign','sin','sinh','sqrt','tan','tanh','trunc'].forEach(function(e){W.push(['Math.'+e,e])});var X=!0,J=!1,Y;try{for(var H=W[Symbol.iterator](),K;!(X=(K=H.next()).done);X=!0){var G=K.value,Z=eval(x(I,{name:G[1],method:G[0]})),$=eval(x(S,{name:G[1]}));for(F=1;F<G.length;F++)w.prototype[G[F]]=Z,w[G[F]]=$}}catch(e){J=!0,Y=e}finally{try{!X&&H.return&&H.return()}finally{if(J)throw Y}}var ee=[['Math.pow',1,'pow']],te=!0,ie=!1,ne;try{for(var oe=ee[Symbol.iterator](),se;!(te=(se=oe.next()).done);te=!0){var re=se.value,ae='arg0';for(F=1;F<re[1];F++)ae+=`, arg${F}`;if(1!==re[1]){var le=eval(x(C,{name:re[2],method:re[0],args:ae})),ce=eval(x(V,{name:re[2],args:ae}));for(F=2;F<re.length;F++)w.prototype[re[F]]=le,w[re[F]]=ce}else{var ue={name:re[2],args:ae,method:re[0]},me=eval(x(_,ue)),de=eval(x(D,ue)),ge=eval(x(z,ue)),he=eval(x(P,ue));for(F=2;F<re.length;F++)w.prototype[re[F]]=me,w.prototype[re[F]+'M']=ge,w.prototype[re[F]+'S']=de,w[re[F]]=he}}}catch(e){ie=!0,ne=e}finally{try{!te&&oe.return&&oe.return()}finally{if(ie)throw ne}}return w}e.exports=n;var o=i(70),r=i(71),s=i(1),l=i(24),c=i(194),m=i(195),d=i(196),h=i(197),p=i(198),k=i(199),j=i(200)},function(e,t,i){'use strict';function n(e){if(!(this instanceof n))return new n(e);e=o.Matrix.checkMatrix(e);var r=e.clone(),a=r.rows,l=r.columns,c=Array(a),m=1,d,i,g,h,p,s,t,k,j,x;for(d=0;d<a;d++)c[d]=d;for(j=Array(a),i=0;i<l;i++){for(d=0;d<a;d++)j[d]=r[d][i];for(d=0;d<a;d++){for(k=r[d],x=v(d,i),p=0,g=0;g<x;g++)p+=k[g]*j[g];k[i]=j[d]-=p}for(h=i,d=i+1;d<a;d++)u(j[d])>u(j[h])&&(h=d);if(h!==i){for(g=0;g<l;g++)s=r[h][g],r[h][g]=r[i][g],r[i][g]=s;t=c[h],c[h]=c[i],c[i]=t,m=-m}if(i<a&&0!==r[i][i])for(d=i+1;d<a;d++)r[d][i]/=r[i][i]}this.LU=r,this.pivotVector=c,this.pivotSign=m}var o=i(5);n.prototype={isSingular:function(){for(var e=this.LU,t=e.columns,i=0;i<t;i++)if(0===e[i][i])return!0;return!1},get determinant(){var e=this.LU;if(!e.isSquare())throw new Error('Matrix must be square');for(var t=this.pivotSign,i=e.columns,n=0;n<i;n++)t*=e[n][n];return t},get lowerTriangularMatrix(){for(var e=this.LU,t=e.rows,n=e.columns,s=new o.Matrix(t,n),r=0;r<t;r++)for(var i=0;i<n;i++)s[r][i]=r>i?e[r][i]:r===i?1:0;return s},get upperTriangularMatrix(){for(var e=this.LU,t=e.rows,n=e.columns,s=new o.Matrix(t,n),r=0;r<t;r++)for(var i=0;i<n;i++)s[r][i]=r<=i?e[r][i]:0;return s},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(e){e=o.Matrix.checkMatrix(e);var t=this.LU,n=t.rows;if(n!==e.rows)throw new Error('Invalid matrix dimensions');if(this.isSingular())throw new Error('LU matrix is singular');var s=e.columns,r=e.subMatrixRow(this.pivotVector,0,s-1),a=t.columns,l,i,c;for(c=0;c<a;c++)for(l=c+1;l<a;l++)for(i=0;i<s;i++)r[l][i]-=r[c][i]*t[l][c];for(c=a-1;0<=c;c--){for(i=0;i<s;i++)r[c][i]/=t[c][c];for(l=0;l<c;l++)for(i=0;i<s;i++)r[l][i]-=r[c][i]*t[l][c]}return r}},e.exports=n},function(e,t,i){'use strict';function o(h,x){if(!(this instanceof o))return new o(h,x);h=r.Matrix.checkMatrix(h),x=x||{};var w=h.rows,m=h.columns,n=v(w,m),y=!0,I=!0;!1===x.computeLeftSingularVectors&&(y=!1),!1===x.computeRightSingularVectors&&(I=!1);var S=!0===x.autoTranspose,C=!1,D;if(!(w<m))D=h.clone();else if(!S)D=h.clone(),console.warn('Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose');else{D=h.transpose(),w=D.rows,m=D.columns,C=!0;var a=y;y=I,I=a}var z=Array(v(w+1,m)),s=d(w,n,0),_=d(m,m,0),V=Array(m),e=Array(w),P=v(w-1,m),A=M(0,v(m-2,w)),L,i,j,k,p,U,F,f,T,q,N,O,E,B,Q,W,X,J,b,c,Y;for(j=0,q=M(P,A);j<q;j++){if(j<P){for(z[j]=0,L=j;L<w;L++)z[j]=l(z[j],D[L][j]);if(0!==z[j]){for(0>D[j][j]&&(z[j]=-z[j]),L=j;L<w;L++)D[L][j]/=z[j];D[j][j]+=1}z[j]=-z[j]}for(i=j+1;i<m;i++){if(j<P&&0!==z[j]){for(p=0,L=j;L<w;L++)p+=D[L][j]*D[L][i];for(p=-p/D[j][j],L=j;L<w;L++)D[L][i]+=p*D[L][j]}V[i]=D[j][i]}if(y&&j<P)for(L=j;L<w;L++)s[L][j]=D[L][j];if(j<A){for(V[j]=0,L=j+1;L<m;L++)V[j]=l(V[j],V[L]);if(0!==V[j]){for(0>V[j+1]&&(V[j]=0-V[j]),L=j+1;L<m;L++)V[L]/=V[j];V[j+1]+=1}if(V[j]=-V[j],j+1<w&&0!==V[j]){for(L=j+1;L<w;L++)e[L]=0;for(i=j+1;i<m;i++)for(L=j+1;L<w;L++)e[L]+=V[i]*D[L][i];for(i=j+1;i<m;i++)for(p=-V[i]/V[j+1],L=j+1;L<w;L++)D[L][i]+=p*e[L]}if(I)for(L=j+1;L<m;L++)_[L][j]=V[L]}}if(k=v(m,w+1),P<m&&(z[P]=D[P][P]),w<k&&(z[k-1]=0),A+1<k&&(V[A]=D[A][k-1]),V[k-1]=0,y){for(i=P;i<n;i++){for(L=0;L<w;L++)s[L][i]=0;s[i][i]=1}for(j=P-1;0<=j;j--)if(0!==z[j]){for(i=j+1;i<n;i++){for(p=0,L=j;L<w;L++)p+=s[L][j]*s[L][i];for(p=-p/s[j][j],L=j;L<w;L++)s[L][i]+=p*s[L][j]}for(L=j;L<w;L++)s[L][j]=-s[L][j];for(s[j][j]=1+s[j][j],L=0;L<j-1;L++)s[L][j]=0}else{for(L=0;L<w;L++)s[L][j]=0;s[j][j]=1}}if(I)for(j=m-1;0<=j;j--){if(j<A&&0!==V[j])for(i=j+1;i<m;i++){for(p=0,L=j+1;L<m;L++)p+=_[L][j]*_[L][i];for(p=-p/_[j+1][j],L=j+1;L<m;L++)_[L][i]+=p*_[L][j]}for(L=0;L<m;L++)_[L][j]=0;_[j][j]=1}for(var g=k-1,H=0,K=2.220446049250313e-16;0<k;){for(j=k-2;-1<=j&&-1!==j;j--)if(u(V[j])<=K*(u(z[j])+u(z[j+1]))){V[j]=0;break}if(j===k-2)N=4;else{for(U=k-1;U>=j&&U!==j;U--)if(p=(U===k?0:u(V[U]))+(U===j+1?0:u(V[U-1])),u(z[U])<=K*p){z[U]=0;break}U===j?N=3:U===k-1?N=1:(N=2,j=U)}switch(j++,N){case 1:{for(F=V[k-2],V[k-2]=0,i=k-2;i>=j;i--)if(p=l(z[i],F),f=z[i]/p,T=F/p,z[i]=p,i!==j&&(F=-T*V[i-1],V[i-1]=f*V[i-1]),I)for(L=0;L<m;L++)p=f*_[L][i]+T*_[L][k-1],_[L][k-1]=-T*_[L][i]+f*_[L][k-1],_[L][i]=p;break}case 2:{for(F=V[j-1],V[j-1]=0,i=j;i<k;i++)if(p=l(z[i],F),f=z[i]/p,T=F/p,z[i]=p,F=-T*V[i],V[i]=f*V[i],y)for(L=0;L<w;L++)p=f*s[L][i]+T*s[L][j-1],s[L][j-1]=-T*s[L][i]+f*s[L][j-1],s[L][i]=p;break}case 3:{for(O=M(M(M(M(u(z[k-1]),u(z[k-2])),u(V[k-2])),u(z[j])),u(V[j])),E=z[k-1]/O,B=z[k-2]/O,Q=V[k-2]/O,W=z[j]/O,X=V[j]/O,J=((B+E)*(B-E)+Q*Q)/2,b=E*Q*(E*Q),c=0,(0!==J||0!==b)&&(c=R(J*J+b),0>J&&(c=-c),c=b/(J+c)),F=(W+E)*(W-E)+c,Y=W*X,i=j;i<k-1;i++){if(p=l(F,Y),f=F/p,T=Y/p,i!==j&&(V[i-1]=p),F=f*z[i]+T*V[i],V[i]=f*V[i]-T*z[i],Y=T*z[i+1],z[i+1]=f*z[i+1],I)for(L=0;L<m;L++)p=f*_[L][i]+T*_[L][i+1],_[L][i+1]=-T*_[L][i]+f*_[L][i+1],_[L][i]=p;if(p=l(F,Y),f=F/p,T=Y/p,z[i]=p,F=f*V[i]+T*z[i+1],z[i+1]=-T*V[i]+f*z[i+1],Y=T*V[i+1],V[i+1]=f*V[i+1],y&&i<w-1)for(L=0;L<w;L++)p=f*s[L][i]+T*s[L][i+1],s[L][i+1]=-T*s[L][i]+f*s[L][i+1],s[L][i]=p}V[k-2]=F,++H;break}case 4:{if(0>=z[j]&&(z[j]=0>z[j]?-z[j]:0,I))for(L=0;L<=g;L++)_[L][j]=-_[L][j];for(;j<g&&!(z[j]>=z[j+1]);){if(p=z[j],z[j]=z[j+1],z[j+1]=p,I&&j<m-1)for(L=0;L<m;L++)p=_[L][j+1],_[L][j+1]=_[L][j],_[L][j]=p;if(y&&j<w-1)for(L=0;L<w;L++)p=s[L][j+1],s[L][j+1]=s[L][j],s[L][j]=p;j++}H=0,k--;break}}}if(C){var G=_;_=s,s=G}this.m=w,this.n=m,this.s=z,this.U=s,this.V=_}var r=i(5),n=i(38),l=n.hypotenuse,d=n.getFilled2DArray;o.prototype={get condition(){return this.s[0]/this.s[v(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var e=M(this.m,this.n)*this.s[0]*2.220446049250313e-16,t=0,n=this.s,o=0,i=n.length;o<i;o++)n[o]>e&&t++;return t},get diagonal(){return this.s},get threshold(){return 2.220446049250313e-16/2*M(this.m,this.n)*this.s[0]},get leftSingularVectors(){return r.Matrix.isMatrix(this.U)||(this.U=new r.Matrix(this.U)),this.U},get rightSingularVectors(){return r.Matrix.isMatrix(this.V)||(this.V=new r.Matrix(this.V)),this.V},get diagonalMatrix(){return r.Matrix.diag(this.s)},solve:function(t){var n=this.threshold,e=this.s.length,o=r.Matrix.zeros(e,e),s;for(s=0;s<e;s++)o[s][s]=u(this.s[s])<=n?0:1/this.s[s];var i=this.U,a=this.rightSingularVectors,l=a.mmul(o),c=a.rows,m=i.length,d=r.Matrix.zeros(c,m),g,h,p;for(s=0;s<c;s++)for(g=0;g<m;g++){for(p=0,h=0;h<e;h++)p+=l[s][h]*i[g][h];d[s][g]=p}return d.mmul(t)},solveForDiagonal:function(e){return this.solve(r.Matrix.diag(e))},inverse:function(){var t=this.V,n=this.threshold,e=t.length,o=t[0].length,s=new r.Matrix(e,this.s.length),a,i;for(a=0;a<e;a++)for(i=0;i<o;i++)s[a][i]=u(this.s[i])>n?t[a][i]/this.s[i]:0;var l=this.U,c=l.length,m=l[0].length,d=new r.Matrix(e,c),g,h;for(a=0;a<e;a++)for(i=0;i<c;i++){for(h=0,g=0;g<m;g++)h+=s[a][g]*l[i][g];d[a][i]=h}return d}},e.exports=o},function(e,t){'use strict';function n(e,t){return e-t}t.sum=function(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t},t.max=function(e){for(var t=-Infinity,n=e.length,o=0;o<n;o++)e[o]>t&&(t=e[o]);return t},t.min=function(e){for(var t=Infinity,n=e.length,o=0;o<n;o++)e[o]<t&&(t=e[o]);return t},t.minMax=function(e){for(var t=Infinity,n=-Infinity,o=e.length,s=0;s<o;s++)e[s]<t&&(t=e[s]),e[s]>n&&(n=e[s]);return{min:t,max:n}},t.arithmeticMean=function(e){for(var t=0,n=e.length,o=0;o<n;o++)t+=e[o];return t/n},t.mean=t.arithmeticMean,t.geometricMean=function(e){for(var t=1,n=e.length,o=0;o<n;o++)t*=e[o];return c(t,1/n)},t.logMean=function(e){for(var t=0,n=e.length,o=0;o<n;o++)t+=r(e[o]);return t/n},t.grandMean=function(e,t){for(var o=0,s=0,n=e.length,r=0;r<n;r++)o+=t[r]*e[r],s+=t[r];return o/s},t.truncatedMean=function(e,t,o){o===void 0&&(o=!1),o||(e=e.slice().sort(n));for(var s=e.length,r=g(s*t),a=0,l=r;l<s-r;l++)a+=e[l];return a/(s-2*r)},t.harmonicMean=function(e){for(var t=0,n=e.length,o=0;o<n;o++){if(0===e[o])throw new RangeError('value at index '+o+'is zero');t+=1/e[o]}return n/t},t.contraHarmonicMean=function(e){for(var t=0,n=0,o=e.length,s=0;s<o;s++)t+=e[s]*e[s],n+=e[s];if(0>n)throw new RangeError('sum of values is negative');return t/n},t.median=function(e,t){t===void 0&&(t=!1),t||(e=e.slice().sort(n));var i=e.length,o=g(i/2);return 0==i%2?0.5*(e[o-1]+e[o]):e[o]},t.variance=function(e,n){n===void 0&&(n=!0);for(var o=t.mean(e),s=0,r=e.length,a=0,i;a<r;a++)i=e[a]-o,s+=i*i;return n?s/(r-1):s/r},t.standardDeviation=function(e,i){return R(t.variance(e,i))},t.standardError=function(e){return t.standardDeviation(e)/R(e.length)},t.quartiles=function(e,i){'undefined'==typeof i&&(i=!1),i||(e=e.slice(),e.sort(n));var o=e.length/4,r=e[s(o)-1],a=t.median(e,!0),l=e[s(3*o)-1];return{q1:r,q2:a,q3:l}},t.pooledStandardDeviation=function(e,i){return R(t.pooledVariance(e,i))},t.pooledVariance=function(e,n){'undefined'==typeof n&&(n=!0);for(var o=0,s=0,r=e.length,a=0;a<r;a++){var i=e[a],l=t.variance(i);o+=(i.length-1)*l,s+=n?i.length-1:i.length}return o/s},t.mode=function(e){var t=e.length,n=Array(t),o;for(o=0;o<t;o++)n[o]=0;var i=Array(t),s=0;for(o=0;o<t;o++){var r=i.indexOf(e[o]);0<=r?n[r]++:(i[s]=e[o],n[s]=1,s++)}var a=0,l=0;for(o=0;o<s;o++)n[o]>a&&(a=n[o],l=o);return i[l]},t.covariance=function(e,n,o){'undefined'==typeof o&&(o=!0);var s=t.mean(e),r=t.mean(n);if(e.length!==n.length)throw'Vectors do not have the same dimensions';for(var a=0,c=e.length,l=0;l<c;l++){var i=e[l]-s,u=n[l]-r;a+=i*u}return o?a/(c-1):a/c},t.skewness=function(e,n){'undefined'==typeof n&&(n=!0);for(var o=t.mean(e),s=0,r=0,u=e.length,l=0,i;l<u;l++)i=e[l]-o,s+=i*i,r+=i*i*i;var m=s/u,d=r/u,h=d/c(m,3/2);if(n){var g=R(u*(u-1));return g/(u-2)*h}return h},t.kurtosis=function(e,o){'undefined'==typeof o&&(o=!0);for(var s=t.mean(e),r=e.length,n=0,a=0,l=0,i;l<r;l++)i=e[l]-s,n+=i*i,a+=i*i*i*i;var c=n/r,u=a/r;if(o){var m=n/(r-1),d=a/(m*m);return r*(r+1)/((r-1)*(r-2)*(r-3))*d-3*((r-1)*(r-1)/((r-2)*(r-3)))}return u/(c*c)-3},t.entropy=function(e,t){'undefined'==typeof t&&(t=0);for(var n=0,o=e.length,s=0;s<o;s++)n+=e[s]*r(e[s]+t);return-n},t.weightedMean=function(e,t){for(var n=0,o=e.length,s=0;s<o;s++)n+=e[s]*t[s];return n},t.weightedStandardDeviation=function(e,i){return R(t.weightedVariance(e,i))},t.weightedVariance=function(e,n){for(var o=t.weightedMean(e,n),s=0,r=e.length,l=0,a=0,c=0;c<r;c++){var i=e[c]-o,u=n[c];s+=u*(i*i),a+=u,l+=u*u}return s*(a/(a*a-l))},t.center=function(e,n){'undefined'==typeof n&&(n=!1);var o=e;n||(o=e.slice());for(var s=t.mean(o),r=o.length,a=0;a<r;a++)o[a]-=s},t.standardize=function(e,n,o){'undefined'==typeof n&&(n=t.standardDeviation(e)),'undefined'==typeof o&&(o=!1);for(var s=e.length,r=o?e:Array(s),a=0;a<s;a++)r[a]=e[a]/n;return r},t.cumulativeSum=function(e){var t=e.length,n=Array(t);n[0]=e[0];for(var o=1;o<t;o++)n[o]=n[o-1]+e[o];return n}},function(e,t,i){'use strict';function n(e){function t(e,t){if(e.rows!==t.rows||e.columns!==t.columns)throw new RangeError('Matrices dimensions must be equal')}function n(e,t){return e-t}function x(e,t){for(var i in t)e=e.replace(new RegExp('%'+i+'%','g'),t[i]);return e}e===void 0&&(e=Object);class w extends e{static get[Symbol.species](){return this}static from1DArray(e,t,i){if(e*t!==i.length)throw new RangeError('Data length does not match given dimensions');for(var n=new this(e,t),o=0;o<e;o++)for(var s=0;s<t;s++)n.set(o,s,i[o*t+s]);return n}static rowVector(e){for(var t=new this(1,e.length),n=0;n<e.length;n++)t.set(0,n,e[n]);return t}static columnVector(e){for(var t=new this(e.length,1),n=0;n<e.length;n++)t.set(n,0,e[n]);return t}static empty(e,t){return new this(e,t)}static zeros(e,t){return this.empty(e,t).fill(0)}static ones(e,t){return this.empty(e,t).fill(1)}static rand(e,t,n){n===void 0&&(n=Math.random);for(var o=this.empty(e,t),s=0;s<e;s++)for(var i=0;i<t;i++)o.set(s,i,n());return o}static randInt(e,t,n,o){n===void 0&&(n=1e3),o===void 0&&(o=Math.random);for(var s=this.empty(e,t),r=0;r<e;r++)for(var i=0,a;i<t;i++)a=g(o()*n),s.set(r,i,a);return s}static eye(e,t,n){t===void 0&&(t=e),n===void 0&&(n=1);for(var o=v(e,t),s=this.zeros(e,t),r=0;r<o;r++)s.set(r,r,n);return s}static diag(e,t,n){var o=e.length;t===void 0&&(t=o),n===void 0&&(n=t);for(var s=v(o,t,n),r=this.zeros(t,n),a=0;a<s;a++)r.set(a,a,e[a]);return r}static min(e,t){e=this.checkMatrix(e),t=this.checkMatrix(t);for(var n=e.rows,o=e.columns,s=new this(n,o),r=0;r<n;r++)for(var i=0;i<o;i++)s.set(r,i,v(e.get(r,i),t.get(r,i)));return s}static max(e,t){e=this.checkMatrix(e),t=this.checkMatrix(t);for(var n=e.rows,o=e.columns,s=new this(n,o),r=0;r<n;r++)for(var i=0;i<o;i++)s.set(r,i,M(e.get(r,i),t.get(r,i)));return s}static checkMatrix(e){return w.isMatrix(e)?e:new this(e)}static isMatrix(e){return null!=e&&'Matrix'===e.klass}get size(){return this.rows*this.columns}apply(e){if('function'!=typeof e)throw new TypeError('callback must be a function');for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var i=0;i<n;i++)e.call(this,o,i);return this}to1DArray(){for(var e=Array(this.size),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e[t*this.columns+i]=this.get(t,i);return e}to2DArray(){for(var e=Array(this.rows),t=0;t<this.rows;t++){e[t]=Array(this.columns);for(var i=0;i<this.columns;i++)e[t][i]=this.get(t,i)}return e}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isSymmetric(){if(this.isSquare()){for(var e=0;e<this.rows;e++)for(var t=0;t<=e;t++)if(this.get(e,t)!==this.get(t,e))return!1;return!0}return!1}set(){throw new Error('set method is unimplemented')}get(){throw new Error('get method is unimplemented')}repeat(e,t){e=e||1,t=t||1;for(var n=new this.constructor[Symbol.species](this.rows*e,this.columns*t),o=0;o<e;o++)for(var i=0;i<t;i++)n.setSubMatrix(this,this.rows*o,this.columns*i);return n}fill(e){for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,e);return this}neg(){return this.mulS(-1)}getRow(e){l.checkRowIndex(this,e);for(var t=Array(this.columns),n=0;n<this.columns;n++)t[n]=this.get(e,n);return t}getRowVector(e){return this.constructor.rowVector(this.getRow(e))}setRow(e,t){l.checkRowIndex(this,e),t=l.checkRowVector(this,t);for(var n=0;n<this.columns;n++)this.set(e,n,t[n]);return this}swapRows(e,t){l.checkRowIndex(this,e),l.checkRowIndex(this,t);for(var n=0,i;n<this.columns;n++)i=this.get(e,n),this.set(e,n,this.get(t,n)),this.set(t,n,i);return this}getColumn(e){l.checkColumnIndex(this,e);for(var t=Array(this.rows),n=0;n<this.rows;n++)t[n]=this.get(n,e);return t}getColumnVector(e){return this.constructor.columnVector(this.getColumn(e))}setColumn(e,t){l.checkColumnIndex(this,e),t=l.checkColumnVector(this,t);for(var n=0;n<this.rows;n++)this.set(n,e,t[n]);return this}swapColumns(e,t){l.checkColumnIndex(this,e),l.checkColumnIndex(this,t);for(var n=0,i;n<this.rows;n++)i=this.get(n,e),this.set(n,e,this.get(n,t)),this.set(n,t,i);return this}addRowVector(e){e=l.checkRowVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)+e[i]);return this}subRowVector(e){e=l.checkRowVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)-e[i]);return this}mulRowVector(e){e=l.checkRowVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)*e[i]);return this}divRowVector(e){e=l.checkRowVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)/e[i]);return this}addColumnVector(e){e=l.checkColumnVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)+e[t]);return this}subColumnVector(e){e=l.checkColumnVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)-e[t]);return this}mulColumnVector(e){e=l.checkColumnVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)*e[t]);return this}divColumnVector(e){e=l.checkColumnVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)/e[t]);return this}mulRow(e,t){l.checkRowIndex(this,e);for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t);return this}mulColumn(e,t){l.checkColumnIndex(this,e);for(var n=0;n<this.rows;n++)this.set(n,e,this.get(n,e)*t);return this}max(){for(var e=this.get(0,0),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.get(t,i)>e&&(e=this.get(t,i));return e}maxIndex(){for(var e=this.get(0,0),t=[0,0],n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.get(n,i)>e&&(e=this.get(n,i),t[0]=n,t[1]=i);return t}min(){for(var e=this.get(0,0),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.get(t,i)<e&&(e=this.get(t,i));return e}minIndex(){for(var e=this.get(0,0),t=[0,0],n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.get(n,i)<e&&(e=this.get(n,i),t[0]=n,t[1]=i);return t}maxRow(e){l.checkRowIndex(this,e);for(var t=this.get(e,0),n=1;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n));return t}maxRowIndex(e){l.checkRowIndex(this,e);for(var t=this.get(e,0),n=[e,0],o=1;o<this.columns;o++)this.get(e,o)>t&&(t=this.get(e,o),n[1]=o);return n}minRow(e){l.checkRowIndex(this,e);for(var t=this.get(e,0),n=1;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n));return t}minRowIndex(e){l.checkRowIndex(this,e);for(var t=this.get(e,0),n=[e,0],o=1;o<this.columns;o++)this.get(e,o)<t&&(t=this.get(e,o),n[1]=o);return n}maxColumn(e){l.checkColumnIndex(this,e);for(var t=this.get(0,e),n=1;n<this.rows;n++)this.get(n,e)>t&&(t=this.get(n,e));return t}maxColumnIndex(e){l.checkColumnIndex(this,e);for(var t=this.get(0,e),n=[0,e],o=1;o<this.rows;o++)this.get(o,e)>t&&(t=this.get(o,e),n[0]=o);return n}minColumn(e){l.checkColumnIndex(this,e);for(var t=this.get(0,e),n=1;n<this.rows;n++)this.get(n,e)<t&&(t=this.get(n,e));return t}minColumnIndex(e){l.checkColumnIndex(this,e);for(var t=this.get(0,e),n=[0,e],o=1;o<this.rows;o++)this.get(o,e)<t&&(t=this.get(o,e),n[0]=o);return n}diag(){for(var e=v(this.rows,this.columns),t=Array(e),n=0;n<e;n++)t[n]=this.get(n,n);return t}sum(e){return'row'===e?l.sumByRow(this):'column'===e?l.sumByColumn(this):l.sumAll(this)}mean(){return this.sum()/this.size}prod(){for(var e=1,t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e*=this.get(t,i);return e}cumulativeSum(){for(var e=0,t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e+=this.get(t,i),this.set(t,i,e);return this}dot(e){w.isMatrix(e)&&(e=e.to1DArray());var t=this.to1DArray();if(t.length!==e.length)throw new RangeError('vectors do not have the same size');for(var n=0,o=0;o<t.length;o++)n+=t[o]*e[o];return n}mmul(e){e=this.constructor.checkMatrix(e),this.columns!==e.rows&&console.warn('Number of columns of left matrix are not equal to number of rows of right matrix.');for(var t=this.rows,o=this.columns,n=e.columns,r=new this.constructor[Symbol.species](t,n),a=Array(o),l=0;l<n;l++){for(var c=0;c<o;c++)a[c]=e.get(c,l);for(var u=0,i;u<t;u++){for(i=0,c=0;c<o;c++)i+=this.get(u,c)*a[c];r.set(u,l,i)}}return r}strassen2x2(e){var t=new this.constructor[Symbol.species](2,2),i=this.get(0,0),n=e.get(0,0),o=this.get(0,1),s=e.get(0,1),r=this.get(1,0),a=e.get(1,0),l=this.get(1,1),c=e.get(1,1),u=(i+l)*(n+c),m=(r+l)*n,d=i*(s-c),g=l*(a-n),h=(i+o)*c;return t.set(0,0,u+g-h+(o-l)*(a+c)),t.set(0,1,d+h),t.set(1,0,m+g),t.set(1,1,u-m+d+(r-i)*(n+s)),t}strassen3x3(e){var t=new this.constructor[Symbol.species](3,3),i=this.get(0,0),n=this.get(0,1),o=this.get(0,2),s=this.get(1,0),r=this.get(1,1),a=this.get(1,2),l=this.get(2,0),c=this.get(2,1),u=this.get(2,2),m=e.get(0,0),d=e.get(0,1),g=e.get(0,2),h=e.get(1,0),p=e.get(1,1),k=e.get(1,2),j=e.get(2,0),x=e.get(2,1),w=e.get(2,2),f=(i-s)*(-d+p),y=(-i+s+r)*(m-d+p),M=(s+r)*(-m+d),b=i*m,v=(-i+l+c)*(m-g+k),R=(-i+l)*(g-k),I=(l+c)*(-m+g),S=(-o+c+u)*(p+j-x),C=(o-u)*(p-x),V=o*j,D=(c+u)*(-j+x),z=(-o+r+a)*(k+j-w),_=(o-a)*(k-w),P=(r+a)*(-j+w);return t.set(0,0,b+V+n*h),t.set(0,1,(i+n+o-s-r-c-u)*p+y+M+b+S+V+D),t.set(0,2,b+v+I+(i+n+o-r-a-l-c)*k+V+z+P),t.set(1,0,f+r*(-m+d+h-p-k-j+w)+y+b+V+z+_),t.set(1,1,f+y+M+b+a*x),t.set(1,2,V+z+_+P+s*g),t.set(2,0,b+v+R+c*(-m+g+h-p-k-j+x)+S+C+V),t.set(2,1,S+C+V+D+l*d),t.set(2,2,b+v+R+I+u*w),t}mmulStrassen(e){function t(e,t,i){var n=e.rows,o=e.columns;if(n===t&&o===i)return e;var s=w.zeros(t,i);return s=s.setSubMatrix(e,0,0),s}function i(e,n,o,s){if(512>=o||512>=s)return e.mmul(n);1==o%2&&1==s%2?(e=t(e,o+1,s+1),n=t(n,o+1,s+1)):1==o%2?(e=t(e,o+1,s),n=t(n,o+1,s)):1==s%2&&(e=t(e,o,s+1),n=t(n,o,s+1));var r=parseInt(e.rows/2),a=parseInt(e.columns/2),l=e.subMatrix(0,r-1,0,a-1),c=n.subMatrix(0,r-1,0,a-1),u=e.subMatrix(0,r-1,a,e.columns-1),m=n.subMatrix(0,r-1,a,n.columns-1),d=e.subMatrix(r,e.rows-1,0,a-1),g=n.subMatrix(r,n.rows-1,0,a-1),h=e.subMatrix(r,e.rows-1,a,e.columns-1),p=n.subMatrix(r,n.rows-1,a,n.columns-1),k=i(w.add(l,h),w.add(c,p),r,a),j=i(w.add(d,h),c,r,a),x=i(l,w.sub(m,p),r,a),f=i(h,w.sub(g,c),r,a),y=i(w.add(l,u),p,r,a),M=i(w.sub(d,l),w.add(c,m),r,a),b=i(w.sub(u,h),w.add(g,p),r,a),v=w.add(k,f);v.sub(y),v.add(b);var R=w.add(x,y),I=w.add(j,f),S=w.sub(k,j);S.add(x),S.add(M);var C=w.zeros(2*v.rows,2*v.columns);return C=C.setSubMatrix(v,0,0),C=C.setSubMatrix(R,v.rows,0),C=C.setSubMatrix(I,0,v.columns),C=C.setSubMatrix(S,v.rows,v.columns),C.subMatrix(0,o-1,0,s-1)}var n=this.clone(),o=n.rows,s=n.columns,a=e.rows,l=e.columns;s!==a&&console.warn(`Multiplying ${o} x ${s} and ${a} x ${l} matrix: dimensions do not match.`);var u=M(o,a),r=M(s,l);return n=t(n,u,r),e=t(e,u,r),i(n,e,u,r)}scaleRows(e,t){if(e=void 0===e?0:e,t=void 0===t?1:t,e>=t)throw new RangeError('min should be strictly smaller than max');for(var n=this.constructor.empty(this.rows,this.columns),o=0,i;o<this.rows;o++)i=s.scale(this.getRow(o),{min:e,max:t}),n.setRow(o,i);return n}scaleColumns(e,t){if(e=void 0===e?0:e,t=void 0===t?1:t,e>=t)throw new RangeError('min should be strictly smaller than max');for(var n=this.constructor.empty(this.rows,this.columns),o=0,i;o<this.columns;o++)i=s.scale(this.getColumn(o),{min:e,max:t}),n.setColumn(o,i);return n}kroneckerProduct(e){e=this.constructor.checkMatrix(e);for(var t=this.rows,o=this.columns,n=e.rows,s=e.columns,r=new this.constructor[Symbol.species](t*n,o*s),a=0;a<t;a++)for(var i=0;i<o;i++)for(var c=0;c<n;c++)for(var u=0;u<s;u++)r[n*a+c][s*i+u]=this.get(a,i)*e.get(c,u);return r}transpose(){for(var e=new this.constructor[Symbol.species](this.columns,this.rows),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e.set(i,t,this.get(t,i));return e}sortRows(e){e===void 0&&(e=n);for(var t=0;t<this.rows;t++)this.setRow(t,this.getRow(t).sort(e));return this}sortColumns(e){e===void 0&&(e=n);for(var t=0;t<this.columns;t++)this.setColumn(t,this.getColumn(t).sort(e));return this}subMatrix(e,t,n,o){l.checkRange(this,e,t,n,o);for(var s=new this.constructor[Symbol.species](t-e+1,o-n+1),r=e;r<=t;r++)for(var i=n;i<=o;i++)s[r-e][i-n]=this.get(r,i);return s}subMatrixRow(e,t,n){if(void 0===t&&(t=0),void 0===n&&(n=this.columns-1),t>n||0>t||t>=this.columns||0>n||n>=this.columns)throw new RangeError('Argument out of range');for(var o=new this.constructor[Symbol.species](e.length,n-t+1),s=0;s<e.length;s++)for(var i=t;i<=n;i++){if(0>e[s]||e[s]>=this.rows)throw new RangeError('Row index out of range: '+e[s]);o.set(s,i-t,this.get(e[s],i))}return o}subMatrixColumn(e,t,n){if(void 0===t&&(t=0),void 0===n&&(n=this.rows-1),t>n||0>t||t>=this.rows||0>n||n>=this.rows)throw new RangeError('Argument out of range');for(var o=new this.constructor[Symbol.species](n-t+1,e.length),s=0;s<e.length;s++)for(var i=t;i<=n;i++){if(0>e[s]||e[s]>=this.columns)throw new RangeError('Column index out of range: '+e[s]);o.set(i-t,s,this.get(i,e[s]))}return o}setSubMatrix(e,t,n){e=this.constructor.checkMatrix(e);var o=t+e.rows-1,s=n+e.columns-1;l.checkRange(this,t,o,n,s);for(var r=0;r<e.rows;r++)for(var i=0;i<e.columns;i++)this[t+r][n+i]=e.get(r,i);return this}selection(e,t){for(var n=l.checkIndices(this,e,t),o=new this.constructor[Symbol.species](e.length,t.length),s=0,i;s<n.row.length;s++){i=n.row[s];for(var r=0,a;r<n.column.length;r++)a=n.column[r],o[s][r]=this.get(i,a)}return o}trace(){for(var e=v(this.rows,this.columns),t=0,n=0;n<e;n++)t+=this.get(n,n);return t}transposeView(){return new c(this)}rowView(e){return l.checkRowIndex(this,e),new m(this,e)}columnView(e){return l.checkColumnIndex(this,e),new p(this,e)}flipRowView(){return new k(this)}flipColumnView(){return new j(this)}subMatrixView(e,t,i,n){return new d(this,e,t,i,n)}selectionView(e,t){return new h(this,e,t)}det(){if(this.isSquare()){var e,t,i,n;if(2===this.columns)return e=this.get(0,0),t=this.get(0,1),i=this.get(1,0),n=this.get(1,1),e*n-t*i;if(3===this.columns){var s,r,a;return s=this.selectionView([1,2],[1,2]),r=this.selectionView([1,2],[0,2]),a=this.selectionView([1,2],[0,1]),e=this.get(0,0),t=this.get(0,1),i=this.get(0,2),e*s.det()-t*r.det()+i*a.det()}return new o(this).determinant}throw Error('Determinant can only be calculated for a square matrix.')}pseudoInverse(e){void 0===e&&(e=a);for(var t=new r(this,{autoTranspose:!0}),n=t.leftSingularVectors,o=t.rightSingularVectors,l=t.diagonal,s=0;s<l.length;s++)l[s]=u(l[s])>e?1/l[s]:0;return l=this.constructor[Symbol.species].diag(l),o.mmul(l.mmul(n.transposeView()))}}w.prototype.klass='Matrix',w.random=w.rand,w.diagonal=w.diag,w.prototype.diagonal=w.prototype.diag,w.identity=w.eye,w.prototype.negate=w.prototype.neg,w.prototype.tensorProduct=w.prototype.kroneckerProduct,w.prototype.determinant=w.prototype.det;var f=`
(function %name%(value) {
    if (typeof value === 'number') return this.%name%S(value);
    return this.%name%M(value);
})
`,y=`
(function %name%S(value) {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, this.get(i, j) %op% value);
        }
    }
    return this;
})
`,b=`
(function %name%M(matrix) {
    matrix = this.constructor.checkMatrix(matrix);
    checkDimensions(this, matrix);
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, this.get(i, j) %op% matrix.get(i, j));
        }
    }
    return this;
})
`,R=`
(function %name%(matrix, value) {
    var newMatrix = new this[Symbol.species](matrix);
    return newMatrix.%name%(value);
})
`,I=`
(function %name%() {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j)));
        }
    }
    return this;
})
`,S=`
(function %name%(matrix) {
    var newMatrix = new this[Symbol.species](matrix);
    return newMatrix.%name%();
})
`,C=`
(function %name%(%args%) {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j), %args%));
        }
    }
    return this;
})
`,V=`
(function %name%(matrix, %args%) {
    var newMatrix = new this[Symbol.species](matrix);
    return newMatrix.%name%(%args%);
})
`,D=`
(function %name%S(value) {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j), value));
        }
    }
    return this;
})
`,z=`
(function %name%M(matrix) {
    matrix = this.constructor.checkMatrix(matrix);
    checkDimensions(this, matrix);
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j), matrix.get(i, j)));
        }
    }
    return this;
})
`,_=`
(function %name%(value) {
    if (typeof value === 'number') return this.%name%S(value);
    return this.%name%M(value);
})
`,P=V,A=[['+','add'],['-','sub','subtract'],['*','mul','multiply'],['/','div','divide'],['%','mod','modulus'],['&','and'],['|','or'],['^','xor'],['<<','leftShift'],['>>','signPropagatingRightShift'],['>>>','rightShift','zeroFillRightShift']],L=!0,U=!1,F,i;try{for(var T=A[Symbol.iterator](),q;!(L=(q=T.next()).done);L=!0){var N=q.value,O=eval(x(f,{name:N[1],op:N[0]})),E=eval(x(y,{name:N[1]+'S',op:N[0]})),B=eval(x(b,{name:N[1]+'M',op:N[0]})),Q=eval(x(R,{name:N[1]}));for(F=1;F<N.length;F++)w.prototype[N[F]]=O,w.prototype[N[F]+'S']=E,w.prototype[N[F]+'M']=B,w[N[F]]=Q}}catch(e){U=!0,i=e}finally{try{!L&&T.return&&T.return()}finally{if(U)throw i}}var W=[['~','not']];['abs','acos','acosh','asin','asinh','atan','atanh','cbrt','ceil','clz32','cos','cosh','exp','expm1','floor','fround','log','log1p','log10','log2','round','sign','sin','sinh','sqrt','tan','tanh','trunc'].forEach(function(e){W.push(['Math.'+e,e])});var X=!0,J=!1,Y;try{for(var H=W[Symbol.iterator](),K;!(X=(K=H.next()).done);X=!0){var G=K.value,Z=eval(x(I,{name:G[1],method:G[0]})),$=eval(x(S,{name:G[1]}));for(F=1;F<G.length;F++)w.prototype[G[F]]=Z,w[G[F]]=$}}catch(e){J=!0,Y=e}finally{try{!X&&H.return&&H.return()}finally{if(J)throw Y}}var ee=[['Math.pow',1,'pow']],te=!0,ie=!1,ne;try{for(var oe=ee[Symbol.iterator](),se;!(te=(se=oe.next()).done);te=!0){var re=se.value,ae='arg0';for(F=1;F<re[1];F++)ae+=`, arg${F}`;if(1!==re[1]){var le=eval(x(C,{name:re[2],method:re[0],args:ae})),ce=eval(x(V,{name:re[2],args:ae}));for(F=2;F<re.length;F++)w.prototype[re[F]]=le,w[re[F]]=ce}else{var ue={name:re[2],args:ae,method:re[0]},me=eval(x(_,ue)),de=eval(x(D,ue)),ge=eval(x(z,ue)),he=eval(x(P,ue));for(F=2;F<re.length;F++)w.prototype[re[F]]=me,w.prototype[re[F]+'M']=ge,w.prototype[re[F]+'S']=de,w[re[F]]=he}}}catch(e){ie=!0,ne=e}finally{try{!te&&oe.return&&oe.return()}finally{if(ie)throw ne}}return w}e.exports=n;var o=i(74),r=i(75),s=i(1),l=i(25),c=i(212),m=i(213),d=i(214),h=i(215),p=i(216),k=i(217),j=i(218)},function(e,t,i){'use strict';function n(e){if(!(this instanceof n))return new n(e);e=o.Matrix.checkMatrix(e);var r=e.clone(),a=r.rows,l=r.columns,c=Array(a),m=1,d,i,g,h,p,s,t,k,j,x;for(d=0;d<a;d++)c[d]=d;for(j=Array(a),i=0;i<l;i++){for(d=0;d<a;d++)j[d]=r[d][i];for(d=0;d<a;d++){for(k=r[d],x=v(d,i),p=0,g=0;g<x;g++)p+=k[g]*j[g];k[i]=j[d]-=p}for(h=i,d=i+1;d<a;d++)u(j[d])>u(j[h])&&(h=d);if(h!==i){for(g=0;g<l;g++)s=r[h][g],r[h][g]=r[i][g],r[i][g]=s;t=c[h],c[h]=c[i],c[i]=t,m=-m}if(i<a&&0!==r[i][i])for(d=i+1;d<a;d++)r[d][i]/=r[i][i]}this.LU=r,this.pivotVector=c,this.pivotSign=m}var o=i(6);n.prototype={isSingular:function(){for(var e=this.LU,t=e.columns,i=0;i<t;i++)if(0===e[i][i])return!0;return!1},get determinant(){var e=this.LU;if(!e.isSquare())throw new Error('Matrix must be square');for(var t=this.pivotSign,i=e.columns,n=0;n<i;n++)t*=e[n][n];return t},get lowerTriangularMatrix(){for(var e=this.LU,t=e.rows,n=e.columns,s=new o.Matrix(t,n),r=0;r<t;r++)for(var i=0;i<n;i++)s[r][i]=r>i?e[r][i]:r===i?1:0;return s},get upperTriangularMatrix(){for(var e=this.LU,t=e.rows,n=e.columns,s=new o.Matrix(t,n),r=0;r<t;r++)for(var i=0;i<n;i++)s[r][i]=r<=i?e[r][i]:0;return s},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(e){e=o.Matrix.checkMatrix(e);var t=this.LU,n=t.rows;if(n!==e.rows)throw new Error('Invalid matrix dimensions');if(this.isSingular())throw new Error('LU matrix is singular');var s=e.columns,r=e.subMatrixRow(this.pivotVector,0,s-1),a=t.columns,l,i,c;for(c=0;c<a;c++)for(l=c+1;l<a;l++)for(i=0;i<s;i++)r[l][i]-=r[c][i]*t[l][c];for(c=a-1;0<=c;c--){for(i=0;i<s;i++)r[c][i]/=t[c][c];for(l=0;l<c;l++)for(i=0;i<s;i++)r[l][i]-=r[c][i]*t[l][c]}return r}},e.exports=n},function(e,t,i){'use strict';function o(h,x){if(!(this instanceof o))return new o(h,x);h=r.Matrix.checkMatrix(h),x=x||{};var w=h.rows,m=h.columns,n=v(w,m),y=!0,I=!0;!1===x.computeLeftSingularVectors&&(y=!1),!1===x.computeRightSingularVectors&&(I=!1);var S=!0===x.autoTranspose,C=!1,D;if(!(w<m))D=h.clone();else if(!S)D=h.clone(),console.warn('Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose');else{D=h.transpose(),w=D.rows,m=D.columns,C=!0;var a=y;y=I,I=a}var z=Array(v(w+1,m)),s=d(w,n,0),_=d(m,m,0),V=Array(m),e=Array(w),P=v(w-1,m),A=M(0,v(m-2,w)),L,i,j,k,p,U,F,f,T,q,N,O,E,B,Q,W,X,J,b,c,Y;for(j=0,q=M(P,A);j<q;j++){if(j<P){for(z[j]=0,L=j;L<w;L++)z[j]=l(z[j],D[L][j]);if(0!==z[j]){for(0>D[j][j]&&(z[j]=-z[j]),L=j;L<w;L++)D[L][j]/=z[j];D[j][j]+=1}z[j]=-z[j]}for(i=j+1;i<m;i++){if(j<P&&0!==z[j]){for(p=0,L=j;L<w;L++)p+=D[L][j]*D[L][i];for(p=-p/D[j][j],L=j;L<w;L++)D[L][i]+=p*D[L][j]}V[i]=D[j][i]}if(y&&j<P)for(L=j;L<w;L++)s[L][j]=D[L][j];if(j<A){for(V[j]=0,L=j+1;L<m;L++)V[j]=l(V[j],V[L]);if(0!==V[j]){for(0>V[j+1]&&(V[j]=0-V[j]),L=j+1;L<m;L++)V[L]/=V[j];V[j+1]+=1}if(V[j]=-V[j],j+1<w&&0!==V[j]){for(L=j+1;L<w;L++)e[L]=0;for(i=j+1;i<m;i++)for(L=j+1;L<w;L++)e[L]+=V[i]*D[L][i];for(i=j+1;i<m;i++)for(p=-V[i]/V[j+1],L=j+1;L<w;L++)D[L][i]+=p*e[L]}if(I)for(L=j+1;L<m;L++)_[L][j]=V[L]}}if(k=v(m,w+1),P<m&&(z[P]=D[P][P]),w<k&&(z[k-1]=0),A+1<k&&(V[A]=D[A][k-1]),V[k-1]=0,y){for(i=P;i<n;i++){for(L=0;L<w;L++)s[L][i]=0;s[i][i]=1}for(j=P-1;0<=j;j--)if(0!==z[j]){for(i=j+1;i<n;i++){for(p=0,L=j;L<w;L++)p+=s[L][j]*s[L][i];for(p=-p/s[j][j],L=j;L<w;L++)s[L][i]+=p*s[L][j]}for(L=j;L<w;L++)s[L][j]=-s[L][j];for(s[j][j]=1+s[j][j],L=0;L<j-1;L++)s[L][j]=0}else{for(L=0;L<w;L++)s[L][j]=0;s[j][j]=1}}if(I)for(j=m-1;0<=j;j--){if(j<A&&0!==V[j])for(i=j+1;i<m;i++){for(p=0,L=j+1;L<m;L++)p+=_[L][j]*_[L][i];for(p=-p/_[j+1][j],L=j+1;L<m;L++)_[L][i]+=p*_[L][j]}for(L=0;L<m;L++)_[L][j]=0;_[j][j]=1}for(var g=k-1,H=0,K=2.220446049250313e-16;0<k;){for(j=k-2;-1<=j&&-1!==j;j--)if(u(V[j])<=K*(u(z[j])+u(z[j+1]))){V[j]=0;break}if(j===k-2)N=4;else{for(U=k-1;U>=j&&U!==j;U--)if(p=(U===k?0:u(V[U]))+(U===j+1?0:u(V[U-1])),u(z[U])<=K*p){z[U]=0;break}U===j?N=3:U===k-1?N=1:(N=2,j=U)}switch(j++,N){case 1:{for(F=V[k-2],V[k-2]=0,i=k-2;i>=j;i--)if(p=l(z[i],F),f=z[i]/p,T=F/p,z[i]=p,i!==j&&(F=-T*V[i-1],V[i-1]=f*V[i-1]),I)for(L=0;L<m;L++)p=f*_[L][i]+T*_[L][k-1],_[L][k-1]=-T*_[L][i]+f*_[L][k-1],_[L][i]=p;break}case 2:{for(F=V[j-1],V[j-1]=0,i=j;i<k;i++)if(p=l(z[i],F),f=z[i]/p,T=F/p,z[i]=p,F=-T*V[i],V[i]=f*V[i],y)for(L=0;L<w;L++)p=f*s[L][i]+T*s[L][j-1],s[L][j-1]=-T*s[L][i]+f*s[L][j-1],s[L][i]=p;break}case 3:{for(O=M(M(M(M(u(z[k-1]),u(z[k-2])),u(V[k-2])),u(z[j])),u(V[j])),E=z[k-1]/O,B=z[k-2]/O,Q=V[k-2]/O,W=z[j]/O,X=V[j]/O,J=((B+E)*(B-E)+Q*Q)/2,b=E*Q*(E*Q),c=0,(0!==J||0!==b)&&(c=R(J*J+b),0>J&&(c=-c),c=b/(J+c)),F=(W+E)*(W-E)+c,Y=W*X,i=j;i<k-1;i++){if(p=l(F,Y),f=F/p,T=Y/p,i!==j&&(V[i-1]=p),F=f*z[i]+T*V[i],V[i]=f*V[i]-T*z[i],Y=T*z[i+1],z[i+1]=f*z[i+1],I)for(L=0;L<m;L++)p=f*_[L][i]+T*_[L][i+1],_[L][i+1]=-T*_[L][i]+f*_[L][i+1],_[L][i]=p;if(p=l(F,Y),f=F/p,T=Y/p,z[i]=p,F=f*V[i]+T*z[i+1],z[i+1]=-T*V[i]+f*z[i+1],Y=T*V[i+1],V[i+1]=f*V[i+1],y&&i<w-1)for(L=0;L<w;L++)p=f*s[L][i]+T*s[L][i+1],s[L][i+1]=-T*s[L][i]+f*s[L][i+1],s[L][i]=p}V[k-2]=F,++H;break}case 4:{if(0>=z[j]&&(z[j]=0>z[j]?-z[j]:0,I))for(L=0;L<=g;L++)_[L][j]=-_[L][j];for(;j<g&&!(z[j]>=z[j+1]);){if(p=z[j],z[j]=z[j+1],z[j+1]=p,I&&j<m-1)for(L=0;L<m;L++)p=_[L][j+1],_[L][j+1]=_[L][j],_[L][j]=p;if(y&&j<w-1)for(L=0;L<w;L++)p=s[L][j+1],s[L][j+1]=s[L][j],s[L][j]=p;j++}H=0,k--;break}}}if(C){var G=_;_=s,s=G}this.m=w,this.n=m,this.s=z,this.U=s,this.V=_}var r=i(6),n=i(39),l=n.hypotenuse,d=n.getFilled2DArray;o.prototype={get condition(){return this.s[0]/this.s[v(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var e=M(this.m,this.n)*this.s[0]*2.220446049250313e-16,t=0,n=this.s,o=0,i=n.length;o<i;o++)n[o]>e&&t++;return t},get diagonal(){return this.s},get threshold(){return 2.220446049250313e-16/2*M(this.m,this.n)*this.s[0]},get leftSingularVectors(){return r.Matrix.isMatrix(this.U)||(this.U=new r.Matrix(this.U)),this.U},get rightSingularVectors(){return r.Matrix.isMatrix(this.V)||(this.V=new r.Matrix(this.V)),this.V},get diagonalMatrix(){return r.Matrix.diag(this.s)},solve:function(t){var n=this.threshold,e=this.s.length,o=r.Matrix.zeros(e,e),s;for(s=0;s<e;s++)o[s][s]=u(this.s[s])<=n?0:1/this.s[s];var i=this.U,a=this.rightSingularVectors,l=a.mmul(o),c=a.rows,m=i.length,d=r.Matrix.zeros(c,m),g,h,p;for(s=0;s<c;s++)for(g=0;g<m;g++){for(p=0,h=0;h<e;h++)p+=l[s][h]*i[g][h];d[s][g]=p}return d.mmul(t)},solveForDiagonal:function(e){return this.solve(r.Matrix.diag(e))},inverse:function(){var t=this.V,n=this.threshold,e=t.length,o=t[0].length,s=new r.Matrix(e,this.s.length),a,i;for(a=0;a<e;a++)for(i=0;i<o;i++)s[a][i]=u(this.s[i])>n?t[a][i]/this.s[i]:0;var l=this.U,c=l.length,m=l[0].length,d=new r.Matrix(e,c),g,h;for(a=0;a<e;a++)for(i=0;i<c;i++){for(h=0,g=0;g<m;g++)h+=s[a][g]*l[i][g];d[a][i]=h}return d}},e.exports=o},function(e,t,i){'use strict';function n(e){function t(e,t){if(e.rows!==t.rows||e.columns!==t.columns)throw new RangeError('Matrices dimensions must be equal')}function n(e,t){return e-t}function x(e,t){for(var i in t)e=e.replace(new RegExp('%'+i+'%','g'),t[i]);return e}e===void 0&&(e=Object);class w extends e{static get[Symbol.species](){return this}static from1DArray(e,t,i){if(e*t!==i.length)throw new RangeError('Data length does not match given dimensions');for(var n=new this(e,t),o=0;o<e;o++)for(var s=0;s<t;s++)n.set(o,s,i[o*t+s]);return n}static rowVector(e){for(var t=new this(1,e.length),n=0;n<e.length;n++)t.set(0,n,e[n]);return t}static columnVector(e){for(var t=new this(e.length,1),n=0;n<e.length;n++)t.set(n,0,e[n]);return t}static empty(e,t){return new this(e,t)}static zeros(e,t){return this.empty(e,t).fill(0)}static ones(e,t){return this.empty(e,t).fill(1)}static rand(e,t,n){n===void 0&&(n=Math.random);for(var o=this.empty(e,t),s=0;s<e;s++)for(var i=0;i<t;i++)o.set(s,i,n());return o}static randInt(e,t,n,o){n===void 0&&(n=1e3),o===void 0&&(o=Math.random);for(var s=this.empty(e,t),r=0;r<e;r++)for(var i=0,a;i<t;i++)a=g(o()*n),s.set(r,i,a);return s}static eye(e,t,n){t===void 0&&(t=e),n===void 0&&(n=1);for(var o=v(e,t),s=this.zeros(e,t),r=0;r<o;r++)s.set(r,r,n);return s}static diag(e,t,n){var o=e.length;t===void 0&&(t=o),n===void 0&&(n=t);for(var s=v(o,t,n),r=this.zeros(t,n),a=0;a<s;a++)r.set(a,a,e[a]);return r}static min(e,t){e=this.checkMatrix(e),t=this.checkMatrix(t);for(var n=e.rows,o=e.columns,s=new this(n,o),r=0;r<n;r++)for(var i=0;i<o;i++)s.set(r,i,v(e.get(r,i),t.get(r,i)));return s}static max(e,t){e=this.checkMatrix(e),t=this.checkMatrix(t);for(var n=e.rows,o=e.columns,s=new this(n,o),r=0;r<n;r++)for(var i=0;i<o;i++)s.set(r,i,M(e.get(r,i),t.get(r,i)));return s}static checkMatrix(e){return w.isMatrix(e)?e:new this(e)}static isMatrix(e){return null!=e&&'Matrix'===e.klass}get size(){return this.rows*this.columns}apply(e){if('function'!=typeof e)throw new TypeError('callback must be a function');for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var i=0;i<n;i++)e.call(this,o,i);return this}to1DArray(){for(var e=Array(this.size),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e[t*this.columns+i]=this.get(t,i);return e}to2DArray(){for(var e=Array(this.rows),t=0;t<this.rows;t++){e[t]=Array(this.columns);for(var i=0;i<this.columns;i++)e[t][i]=this.get(t,i)}return e}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isSymmetric(){if(this.isSquare()){for(var e=0;e<this.rows;e++)for(var t=0;t<=e;t++)if(this.get(e,t)!==this.get(t,e))return!1;return!0}return!1}set(){throw new Error('set method is unimplemented')}get(){throw new Error('get method is unimplemented')}repeat(e,t){e=e||1,t=t||1;for(var n=new this.constructor[Symbol.species](this.rows*e,this.columns*t),o=0;o<e;o++)for(var i=0;i<t;i++)n.setSubMatrix(this,this.rows*o,this.columns*i);return n}fill(e){for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,e);return this}neg(){return this.mulS(-1)}getRow(e){l.checkRowIndex(this,e);for(var t=Array(this.columns),n=0;n<this.columns;n++)t[n]=this.get(e,n);return t}getRowVector(e){return this.constructor.rowVector(this.getRow(e))}setRow(e,t){l.checkRowIndex(this,e),t=l.checkRowVector(this,t);for(var n=0;n<this.columns;n++)this.set(e,n,t[n]);return this}swapRows(e,t){l.checkRowIndex(this,e),l.checkRowIndex(this,t);for(var n=0,i;n<this.columns;n++)i=this.get(e,n),this.set(e,n,this.get(t,n)),this.set(t,n,i);return this}getColumn(e){l.checkColumnIndex(this,e);for(var t=Array(this.rows),n=0;n<this.rows;n++)t[n]=this.get(n,e);return t}getColumnVector(e){return this.constructor.columnVector(this.getColumn(e))}setColumn(e,t){l.checkColumnIndex(this,e),t=l.checkColumnVector(this,t);for(var n=0;n<this.rows;n++)this.set(n,e,t[n]);return this}swapColumns(e,t){l.checkColumnIndex(this,e),l.checkColumnIndex(this,t);for(var n=0,i;n<this.rows;n++)i=this.get(n,e),this.set(n,e,this.get(n,t)),this.set(n,t,i);return this}addRowVector(e){e=l.checkRowVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)+e[i]);return this}subRowVector(e){e=l.checkRowVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)-e[i]);return this}mulRowVector(e){e=l.checkRowVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)*e[i]);return this}divRowVector(e){e=l.checkRowVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)/e[i]);return this}addColumnVector(e){e=l.checkColumnVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)+e[t]);return this}subColumnVector(e){e=l.checkColumnVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)-e[t]);return this}mulColumnVector(e){e=l.checkColumnVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)*e[t]);return this}divColumnVector(e){e=l.checkColumnVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)/e[t]);return this}mulRow(e,t){l.checkRowIndex(this,e);for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t);return this}mulColumn(e,t){l.checkColumnIndex(this,e);for(var n=0;n<this.rows;n++)this.set(n,e,this.get(n,e)*t);return this}max(){for(var e=this.get(0,0),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.get(t,i)>e&&(e=this.get(t,i));return e}maxIndex(){for(var e=this.get(0,0),t=[0,0],n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.get(n,i)>e&&(e=this.get(n,i),t[0]=n,t[1]=i);return t}min(){for(var e=this.get(0,0),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.get(t,i)<e&&(e=this.get(t,i));return e}minIndex(){for(var e=this.get(0,0),t=[0,0],n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.get(n,i)<e&&(e=this.get(n,i),t[0]=n,t[1]=i);return t}maxRow(e){l.checkRowIndex(this,e);for(var t=this.get(e,0),n=1;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n));return t}maxRowIndex(e){l.checkRowIndex(this,e);for(var t=this.get(e,0),n=[e,0],o=1;o<this.columns;o++)this.get(e,o)>t&&(t=this.get(e,o),n[1]=o);return n}minRow(e){l.checkRowIndex(this,e);for(var t=this.get(e,0),n=1;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n));return t}minRowIndex(e){l.checkRowIndex(this,e);for(var t=this.get(e,0),n=[e,0],o=1;o<this.columns;o++)this.get(e,o)<t&&(t=this.get(e,o),n[1]=o);return n}maxColumn(e){l.checkColumnIndex(this,e);for(var t=this.get(0,e),n=1;n<this.rows;n++)this.get(n,e)>t&&(t=this.get(n,e));return t}maxColumnIndex(e){l.checkColumnIndex(this,e);for(var t=this.get(0,e),n=[0,e],o=1;o<this.rows;o++)this.get(o,e)>t&&(t=this.get(o,e),n[0]=o);return n}minColumn(e){l.checkColumnIndex(this,e);for(var t=this.get(0,e),n=1;n<this.rows;n++)this.get(n,e)<t&&(t=this.get(n,e));return t}minColumnIndex(e){l.checkColumnIndex(this,e);for(var t=this.get(0,e),n=[0,e],o=1;o<this.rows;o++)this.get(o,e)<t&&(t=this.get(o,e),n[0]=o);return n}diag(){for(var e=v(this.rows,this.columns),t=Array(e),n=0;n<e;n++)t[n]=this.get(n,n);return t}sum(e){return'row'===e?l.sumByRow(this):'column'===e?l.sumByColumn(this):l.sumAll(this)}mean(){return this.sum()/this.size}prod(){for(var e=1,t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e*=this.get(t,i);return e}cumulativeSum(){for(var e=0,t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e+=this.get(t,i),this.set(t,i,e);return this}dot(e){w.isMatrix(e)&&(e=e.to1DArray());var t=this.to1DArray();if(t.length!==e.length)throw new RangeError('vectors do not have the same size');for(var n=0,o=0;o<t.length;o++)n+=t[o]*e[o];return n}mmul(e){e=this.constructor.checkMatrix(e),this.columns!==e.rows&&console.warn('Number of columns of left matrix are not equal to number of rows of right matrix.');for(var t=this.rows,o=this.columns,n=e.columns,r=new this.constructor[Symbol.species](t,n),a=Array(o),l=0;l<n;l++){for(var c=0;c<o;c++)a[c]=e.get(c,l);for(var u=0,i;u<t;u++){for(i=0,c=0;c<o;c++)i+=this.get(u,c)*a[c];r.set(u,l,i)}}return r}strassen2x2(e){var t=new this.constructor[Symbol.species](2,2),i=this.get(0,0),n=e.get(0,0),o=this.get(0,1),s=e.get(0,1),r=this.get(1,0),a=e.get(1,0),l=this.get(1,1),c=e.get(1,1),u=(i+l)*(n+c),m=(r+l)*n,d=i*(s-c),g=l*(a-n),h=(i+o)*c;return t.set(0,0,u+g-h+(o-l)*(a+c)),t.set(0,1,d+h),t.set(1,0,m+g),t.set(1,1,u-m+d+(r-i)*(n+s)),t}strassen3x3(e){var t=new this.constructor[Symbol.species](3,3),i=this.get(0,0),n=this.get(0,1),o=this.get(0,2),s=this.get(1,0),r=this.get(1,1),a=this.get(1,2),l=this.get(2,0),c=this.get(2,1),u=this.get(2,2),m=e.get(0,0),d=e.get(0,1),g=e.get(0,2),h=e.get(1,0),p=e.get(1,1),k=e.get(1,2),j=e.get(2,0),x=e.get(2,1),w=e.get(2,2),f=(i-s)*(-d+p),y=(-i+s+r)*(m-d+p),M=(s+r)*(-m+d),b=i*m,v=(-i+l+c)*(m-g+k),R=(-i+l)*(g-k),I=(l+c)*(-m+g),S=(-o+c+u)*(p+j-x),C=(o-u)*(p-x),V=o*j,D=(c+u)*(-j+x),z=(-o+r+a)*(k+j-w),_=(o-a)*(k-w),P=(r+a)*(-j+w);return t.set(0,0,b+V+n*h),t.set(0,1,(i+n+o-s-r-c-u)*p+y+M+b+S+V+D),t.set(0,2,b+v+I+(i+n+o-r-a-l-c)*k+V+z+P),t.set(1,0,f+r*(-m+d+h-p-k-j+w)+y+b+V+z+_),t.set(1,1,f+y+M+b+a*x),t.set(1,2,V+z+_+P+s*g),t.set(2,0,b+v+R+c*(-m+g+h-p-k-j+x)+S+C+V),t.set(2,1,S+C+V+D+l*d),t.set(2,2,b+v+R+I+u*w),t}mmulStrassen(e){function t(e,t,i){var n=e.rows,o=e.columns;if(n===t&&o===i)return e;var s=w.zeros(t,i);return s=s.setSubMatrix(e,0,0),s}function i(e,n,o,s){if(512>=o||512>=s)return e.mmul(n);1==o%2&&1==s%2?(e=t(e,o+1,s+1),n=t(n,o+1,s+1)):1==o%2?(e=t(e,o+1,s),n=t(n,o+1,s)):1==s%2&&(e=t(e,o,s+1),n=t(n,o,s+1));var r=parseInt(e.rows/2),a=parseInt(e.columns/2),l=e.subMatrix(0,r-1,0,a-1),c=n.subMatrix(0,r-1,0,a-1),u=e.subMatrix(0,r-1,a,e.columns-1),m=n.subMatrix(0,r-1,a,n.columns-1),d=e.subMatrix(r,e.rows-1,0,a-1),g=n.subMatrix(r,n.rows-1,0,a-1),h=e.subMatrix(r,e.rows-1,a,e.columns-1),p=n.subMatrix(r,n.rows-1,a,n.columns-1),k=i(w.add(l,h),w.add(c,p),r,a),j=i(w.add(d,h),c,r,a),x=i(l,w.sub(m,p),r,a),f=i(h,w.sub(g,c),r,a),y=i(w.add(l,u),p,r,a),M=i(w.sub(d,l),w.add(c,m),r,a),b=i(w.sub(u,h),w.add(g,p),r,a),v=w.add(k,f);v.sub(y),v.add(b);var R=w.add(x,y),I=w.add(j,f),S=w.sub(k,j);S.add(x),S.add(M);var C=w.zeros(2*v.rows,2*v.columns);return C=C.setSubMatrix(v,0,0),C=C.setSubMatrix(R,v.rows,0),C=C.setSubMatrix(I,0,v.columns),C=C.setSubMatrix(S,v.rows,v.columns),C.subMatrix(0,o-1,0,s-1)}var n=this.clone(),o=n.rows,s=n.columns,a=e.rows,l=e.columns;s!==a&&console.warn(`Multiplying ${o} x ${s} and ${a} x ${l} matrix: dimensions do not match.`);var u=M(o,a),r=M(s,l);return n=t(n,u,r),e=t(e,u,r),i(n,e,u,r)}scaleRows(e,t){if(e=void 0===e?0:e,t=void 0===t?1:t,e>=t)throw new RangeError('min should be strictly smaller than max');for(var n=this.constructor.empty(this.rows,this.columns),o=0,i;o<this.rows;o++)i=s.scale(this.getRow(o),{min:e,max:t}),n.setRow(o,i);return n}scaleColumns(e,t){if(e=void 0===e?0:e,t=void 0===t?1:t,e>=t)throw new RangeError('min should be strictly smaller than max');for(var n=this.constructor.empty(this.rows,this.columns),o=0,i;o<this.columns;o++)i=s.scale(this.getColumn(o),{min:e,max:t}),n.setColumn(o,i);return n}kroneckerProduct(e){e=this.constructor.checkMatrix(e);for(var t=this.rows,o=this.columns,n=e.rows,s=e.columns,r=new this.constructor[Symbol.species](t*n,o*s),a=0;a<t;a++)for(var i=0;i<o;i++)for(var c=0;c<n;c++)for(var u=0;u<s;u++)r[n*a+c][s*i+u]=this.get(a,i)*e.get(c,u);return r}transpose(){for(var e=new this.constructor[Symbol.species](this.columns,this.rows),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e.set(i,t,this.get(t,i));return e}sortRows(e){e===void 0&&(e=n);for(var t=0;t<this.rows;t++)this.setRow(t,this.getRow(t).sort(e));return this}sortColumns(e){e===void 0&&(e=n);for(var t=0;t<this.columns;t++)this.setColumn(t,this.getColumn(t).sort(e));return this}subMatrix(e,t,n,o){l.checkRange(this,e,t,n,o);for(var s=new this.constructor[Symbol.species](t-e+1,o-n+1),r=e;r<=t;r++)for(var i=n;i<=o;i++)s[r-e][i-n]=this.get(r,i);return s}subMatrixRow(e,t,n){if(void 0===t&&(t=0),void 0===n&&(n=this.columns-1),t>n||0>t||t>=this.columns||0>n||n>=this.columns)throw new RangeError('Argument out of range');for(var o=new this.constructor[Symbol.species](e.length,n-t+1),s=0;s<e.length;s++)for(var i=t;i<=n;i++){if(0>e[s]||e[s]>=this.rows)throw new RangeError('Row index out of range: '+e[s]);o.set(s,i-t,this.get(e[s],i))}return o}subMatrixColumn(e,t,n){if(void 0===t&&(t=0),void 0===n&&(n=this.rows-1),t>n||0>t||t>=this.rows||0>n||n>=this.rows)throw new RangeError('Argument out of range');for(var o=new this.constructor[Symbol.species](n-t+1,e.length),s=0;s<e.length;s++)for(var i=t;i<=n;i++){if(0>e[s]||e[s]>=this.columns)throw new RangeError('Column index out of range: '+e[s]);o.set(i-t,s,this.get(i,e[s]))}return o}setSubMatrix(e,t,n){e=this.constructor.checkMatrix(e);var o=t+e.rows-1,s=n+e.columns-1;l.checkRange(this,t,o,n,s);for(var r=0;r<e.rows;r++)for(var i=0;i<e.columns;i++)this[t+r][n+i]=e.get(r,i);return this}selection(e,t){for(var n=l.checkIndices(this,e,t),o=new this.constructor[Symbol.species](e.length,t.length),s=0,i;s<n.row.length;s++){i=n.row[s];for(var r=0,a;r<n.column.length;r++)a=n.column[r],o[s][r]=this.get(i,a)}return o}trace(){for(var e=v(this.rows,this.columns),t=0,n=0;n<e;n++)t+=this.get(n,n);return t}transposeView(){return new c(this)}rowView(e){return l.checkRowIndex(this,e),new m(this,e)}columnView(e){return l.checkColumnIndex(this,e),new p(this,e)}flipRowView(){return new k(this)}flipColumnView(){return new j(this)}subMatrixView(e,t,i,n){return new d(this,e,t,i,n)}selectionView(e,t){return new h(this,e,t)}det(){if(this.isSquare()){var e,t,i,n;if(2===this.columns)return e=this.get(0,0),t=this.get(0,1),i=this.get(1,0),n=this.get(1,1),e*n-t*i;if(3===this.columns){var s,r,a;return s=this.selectionView([1,2],[1,2]),r=this.selectionView([1,2],[0,2]),a=this.selectionView([1,2],[0,1]),e=this.get(0,0),t=this.get(0,1),i=this.get(0,2),e*s.det()-t*r.det()+i*a.det()}return new o(this).determinant}throw Error('Determinant can only be calculated for a square matrix.')}pseudoInverse(e){void 0===e&&(e=a);for(var t=new r(this,{autoTranspose:!0}),n=t.leftSingularVectors,o=t.rightSingularVectors,l=t.diagonal,s=0;s<l.length;s++)l[s]=u(l[s])>e?1/l[s]:0;return l=this.constructor[Symbol.species].diag(l),o.mmul(l.mmul(n.transposeView()))}}w.prototype.klass='Matrix',w.random=w.rand,w.diagonal=w.diag,w.prototype.diagonal=w.prototype.diag,w.identity=w.eye,w.prototype.negate=w.prototype.neg,w.prototype.tensorProduct=w.prototype.kroneckerProduct,w.prototype.determinant=w.prototype.det;var f=`
(function %name%(value) {
    if (typeof value === 'number') return this.%name%S(value);
    return this.%name%M(value);
})
`,y=`
(function %name%S(value) {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, this.get(i, j) %op% value);
        }
    }
    return this;
})
`,b=`
(function %name%M(matrix) {
    matrix = this.constructor.checkMatrix(matrix);
    checkDimensions(this, matrix);
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, this.get(i, j) %op% matrix.get(i, j));
        }
    }
    return this;
})
`,R=`
(function %name%(matrix, value) {
    var newMatrix = new this[Symbol.species](matrix);
    return newMatrix.%name%(value);
})
`,I=`
(function %name%() {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j)));
        }
    }
    return this;
})
`,S=`
(function %name%(matrix) {
    var newMatrix = new this[Symbol.species](matrix);
    return newMatrix.%name%();
})
`,C=`
(function %name%(%args%) {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j), %args%));
        }
    }
    return this;
})
`,V=`
(function %name%(matrix, %args%) {
    var newMatrix = new this[Symbol.species](matrix);
    return newMatrix.%name%(%args%);
})
`,D=`
(function %name%S(value) {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j), value));
        }
    }
    return this;
})
`,z=`
(function %name%M(matrix) {
    matrix = this.constructor.checkMatrix(matrix);
    checkDimensions(this, matrix);
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j), matrix.get(i, j)));
        }
    }
    return this;
})
`,_=`
(function %name%(value) {
    if (typeof value === 'number') return this.%name%S(value);
    return this.%name%M(value);
})
`,P=V,A=[['+','add'],['-','sub','subtract'],['*','mul','multiply'],['/','div','divide'],['%','mod','modulus'],['&','and'],['|','or'],['^','xor'],['<<','leftShift'],['>>','signPropagatingRightShift'],['>>>','rightShift','zeroFillRightShift']],L=!0,U=!1,F,i;try{for(var T=A[Symbol.iterator](),q;!(L=(q=T.next()).done);L=!0){var N=q.value,O=eval(x(f,{name:N[1],op:N[0]})),E=eval(x(y,{name:N[1]+'S',op:N[0]})),B=eval(x(b,{name:N[1]+'M',op:N[0]})),Q=eval(x(R,{name:N[1]}));for(F=1;F<N.length;F++)w.prototype[N[F]]=O,w.prototype[N[F]+'S']=E,w.prototype[N[F]+'M']=B,w[N[F]]=Q}}catch(e){U=!0,i=e}finally{try{!L&&T.return&&T.return()}finally{if(U)throw i}}var W=[['~','not']];['abs','acos','acosh','asin','asinh','atan','atanh','cbrt','ceil','clz32','cos','cosh','exp','expm1','floor','fround','log','log1p','log10','log2','round','sign','sin','sinh','sqrt','tan','tanh','trunc'].forEach(function(e){W.push(['Math.'+e,e])});var X=!0,J=!1,Y;try{for(var H=W[Symbol.iterator](),K;!(X=(K=H.next()).done);X=!0){var G=K.value,Z=eval(x(I,{name:G[1],method:G[0]})),$=eval(x(S,{name:G[1]}));for(F=1;F<G.length;F++)w.prototype[G[F]]=Z,w[G[F]]=$}}catch(e){J=!0,Y=e}finally{try{!X&&H.return&&H.return()}finally{if(J)throw Y}}var ee=[['Math.pow',1,'pow']],te=!0,ie=!1,ne;try{for(var oe=ee[Symbol.iterator](),se;!(te=(se=oe.next()).done);te=!0){var re=se.value,ae='arg0';for(F=1;F<re[1];F++)ae+=`, arg${F}`;if(1!==re[1]){var le=eval(x(C,{name:re[2],method:re[0],args:ae})),ce=eval(x(V,{name:re[2],args:ae}));for(F=2;F<re.length;F++)w.prototype[re[F]]=le,w[re[F]]=ce}else{var ue={name:re[2],args:ae,method:re[0]},me=eval(x(_,ue)),de=eval(x(D,ue)),ge=eval(x(z,ue)),he=eval(x(P,ue));for(F=2;F<re.length;F++)w.prototype[re[F]]=me,w.prototype[re[F]+'M']=ge,w.prototype[re[F]+'S']=de,w[re[F]]=he}}}catch(e){ie=!0,ne=e}finally{try{!te&&oe.return&&oe.return()}finally{if(ie)throw ne}}return w}e.exports=n;var o=i(77),r=i(78),s=i(1),l=i(26),c=i(229),m=i(230),d=i(231),h=i(232),p=i(233),k=i(234),j=i(235)},function(e,t,i){'use strict';function n(e){if(!(this instanceof n))return new n(e);e=o.Matrix.checkMatrix(e);var r=e.clone(),a=r.rows,l=r.columns,c=Array(a),m=1,d,i,g,h,p,s,t,k,j,x;for(d=0;d<a;d++)c[d]=d;for(j=Array(a),i=0;i<l;i++){for(d=0;d<a;d++)j[d]=r[d][i];for(d=0;d<a;d++){for(k=r[d],x=v(d,i),p=0,g=0;g<x;g++)p+=k[g]*j[g];k[i]=j[d]-=p}for(h=i,d=i+1;d<a;d++)u(j[d])>u(j[h])&&(h=d);if(h!==i){for(g=0;g<l;g++)s=r[h][g],r[h][g]=r[i][g],r[i][g]=s;t=c[h],c[h]=c[i],c[i]=t,m=-m}if(i<a&&0!==r[i][i])for(d=i+1;d<a;d++)r[d][i]/=r[i][i]}this.LU=r,this.pivotVector=c,this.pivotSign=m}var o=i(7);n.prototype={isSingular:function(){for(var e=this.LU,t=e.columns,i=0;i<t;i++)if(0===e[i][i])return!0;return!1},get determinant(){var e=this.LU;if(!e.isSquare())throw new Error('Matrix must be square');for(var t=this.pivotSign,i=e.columns,n=0;n<i;n++)t*=e[n][n];return t},get lowerTriangularMatrix(){for(var e=this.LU,t=e.rows,n=e.columns,s=new o.Matrix(t,n),r=0;r<t;r++)for(var i=0;i<n;i++)s[r][i]=r>i?e[r][i]:r===i?1:0;return s},get upperTriangularMatrix(){for(var e=this.LU,t=e.rows,n=e.columns,s=new o.Matrix(t,n),r=0;r<t;r++)for(var i=0;i<n;i++)s[r][i]=r<=i?e[r][i]:0;return s},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(e){e=o.Matrix.checkMatrix(e);var t=this.LU,n=t.rows;if(n!==e.rows)throw new Error('Invalid matrix dimensions');if(this.isSingular())throw new Error('LU matrix is singular');var s=e.columns,r=e.subMatrixRow(this.pivotVector,0,s-1),a=t.columns,l,i,c;for(c=0;c<a;c++)for(l=c+1;l<a;l++)for(i=0;i<s;i++)r[l][i]-=r[c][i]*t[l][c];for(c=a-1;0<=c;c--){for(i=0;i<s;i++)r[c][i]/=t[c][c];for(l=0;l<c;l++)for(i=0;i<s;i++)r[l][i]-=r[c][i]*t[l][c]}return r}},e.exports=n},function(e,t,i){'use strict';function o(h,x){if(!(this instanceof o))return new o(h,x);h=r.Matrix.checkMatrix(h),x=x||{};var w=h.rows,m=h.columns,n=v(w,m),y=!0,I=!0;!1===x.computeLeftSingularVectors&&(y=!1),!1===x.computeRightSingularVectors&&(I=!1);var S=!0===x.autoTranspose,C=!1,D;if(!(w<m))D=h.clone();else if(!S)D=h.clone(),console.warn('Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose');else{D=h.transpose(),w=D.rows,m=D.columns,C=!0;var a=y;y=I,I=a}var z=Array(v(w+1,m)),s=d(w,n,0),_=d(m,m,0),V=Array(m),e=Array(w),P=v(w-1,m),A=M(0,v(m-2,w)),L,i,j,k,p,U,F,f,T,q,N,O,E,B,Q,W,X,J,b,c,Y;for(j=0,q=M(P,A);j<q;j++){if(j<P){for(z[j]=0,L=j;L<w;L++)z[j]=l(z[j],D[L][j]);if(0!==z[j]){for(0>D[j][j]&&(z[j]=-z[j]),L=j;L<w;L++)D[L][j]/=z[j];D[j][j]+=1}z[j]=-z[j]}for(i=j+1;i<m;i++){if(j<P&&0!==z[j]){for(p=0,L=j;L<w;L++)p+=D[L][j]*D[L][i];for(p=-p/D[j][j],L=j;L<w;L++)D[L][i]+=p*D[L][j]}V[i]=D[j][i]}if(y&&j<P)for(L=j;L<w;L++)s[L][j]=D[L][j];if(j<A){for(V[j]=0,L=j+1;L<m;L++)V[j]=l(V[j],V[L]);if(0!==V[j]){for(0>V[j+1]&&(V[j]=0-V[j]),L=j+1;L<m;L++)V[L]/=V[j];V[j+1]+=1}if(V[j]=-V[j],j+1<w&&0!==V[j]){for(L=j+1;L<w;L++)e[L]=0;for(i=j+1;i<m;i++)for(L=j+1;L<w;L++)e[L]+=V[i]*D[L][i];for(i=j+1;i<m;i++)for(p=-V[i]/V[j+1],L=j+1;L<w;L++)D[L][i]+=p*e[L]}if(I)for(L=j+1;L<m;L++)_[L][j]=V[L]}}if(k=v(m,w+1),P<m&&(z[P]=D[P][P]),w<k&&(z[k-1]=0),A+1<k&&(V[A]=D[A][k-1]),V[k-1]=0,y){for(i=P;i<n;i++){for(L=0;L<w;L++)s[L][i]=0;s[i][i]=1}for(j=P-1;0<=j;j--)if(0!==z[j]){for(i=j+1;i<n;i++){for(p=0,L=j;L<w;L++)p+=s[L][j]*s[L][i];for(p=-p/s[j][j],L=j;L<w;L++)s[L][i]+=p*s[L][j]}for(L=j;L<w;L++)s[L][j]=-s[L][j];for(s[j][j]=1+s[j][j],L=0;L<j-1;L++)s[L][j]=0}else{for(L=0;L<w;L++)s[L][j]=0;s[j][j]=1}}if(I)for(j=m-1;0<=j;j--){if(j<A&&0!==V[j])for(i=j+1;i<m;i++){for(p=0,L=j+1;L<m;L++)p+=_[L][j]*_[L][i];for(p=-p/_[j+1][j],L=j+1;L<m;L++)_[L][i]+=p*_[L][j]}for(L=0;L<m;L++)_[L][j]=0;_[j][j]=1}for(var g=k-1,H=0,K=2.220446049250313e-16;0<k;){for(j=k-2;-1<=j&&-1!==j;j--)if(u(V[j])<=K*(u(z[j])+u(z[j+1]))){V[j]=0;break}if(j===k-2)N=4;else{for(U=k-1;U>=j&&U!==j;U--)if(p=(U===k?0:u(V[U]))+(U===j+1?0:u(V[U-1])),u(z[U])<=K*p){z[U]=0;break}U===j?N=3:U===k-1?N=1:(N=2,j=U)}switch(j++,N){case 1:{for(F=V[k-2],V[k-2]=0,i=k-2;i>=j;i--)if(p=l(z[i],F),f=z[i]/p,T=F/p,z[i]=p,i!==j&&(F=-T*V[i-1],V[i-1]=f*V[i-1]),I)for(L=0;L<m;L++)p=f*_[L][i]+T*_[L][k-1],_[L][k-1]=-T*_[L][i]+f*_[L][k-1],_[L][i]=p;break}case 2:{for(F=V[j-1],V[j-1]=0,i=j;i<k;i++)if(p=l(z[i],F),f=z[i]/p,T=F/p,z[i]=p,F=-T*V[i],V[i]=f*V[i],y)for(L=0;L<w;L++)p=f*s[L][i]+T*s[L][j-1],s[L][j-1]=-T*s[L][i]+f*s[L][j-1],s[L][i]=p;break}case 3:{for(O=M(M(M(M(u(z[k-1]),u(z[k-2])),u(V[k-2])),u(z[j])),u(V[j])),E=z[k-1]/O,B=z[k-2]/O,Q=V[k-2]/O,W=z[j]/O,X=V[j]/O,J=((B+E)*(B-E)+Q*Q)/2,b=E*Q*(E*Q),c=0,(0!==J||0!==b)&&(c=R(J*J+b),0>J&&(c=-c),c=b/(J+c)),F=(W+E)*(W-E)+c,Y=W*X,i=j;i<k-1;i++){if(p=l(F,Y),f=F/p,T=Y/p,i!==j&&(V[i-1]=p),F=f*z[i]+T*V[i],V[i]=f*V[i]-T*z[i],Y=T*z[i+1],z[i+1]=f*z[i+1],I)for(L=0;L<m;L++)p=f*_[L][i]+T*_[L][i+1],_[L][i+1]=-T*_[L][i]+f*_[L][i+1],_[L][i]=p;if(p=l(F,Y),f=F/p,T=Y/p,z[i]=p,F=f*V[i]+T*z[i+1],z[i+1]=-T*V[i]+f*z[i+1],Y=T*V[i+1],V[i+1]=f*V[i+1],y&&i<w-1)for(L=0;L<w;L++)p=f*s[L][i]+T*s[L][i+1],s[L][i+1]=-T*s[L][i]+f*s[L][i+1],s[L][i]=p}V[k-2]=F,++H;break}case 4:{if(0>=z[j]&&(z[j]=0>z[j]?-z[j]:0,I))for(L=0;L<=g;L++)_[L][j]=-_[L][j];for(;j<g&&!(z[j]>=z[j+1]);){if(p=z[j],z[j]=z[j+1],z[j+1]=p,I&&j<m-1)for(L=0;L<m;L++)p=_[L][j+1],_[L][j+1]=_[L][j],_[L][j]=p;if(y&&j<w-1)for(L=0;L<w;L++)p=s[L][j+1],s[L][j+1]=s[L][j],s[L][j]=p;j++}H=0,k--;break}}}if(C){var G=_;_=s,s=G}this.m=w,this.n=m,this.s=z,this.U=s,this.V=_}var r=i(7),n=i(41),l=n.hypotenuse,d=n.getFilled2DArray;o.prototype={get condition(){return this.s[0]/this.s[v(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var e=M(this.m,this.n)*this.s[0]*2.220446049250313e-16,t=0,n=this.s,o=0,i=n.length;o<i;o++)n[o]>e&&t++;return t},get diagonal(){return this.s},get threshold(){return 2.220446049250313e-16/2*M(this.m,this.n)*this.s[0]},get leftSingularVectors(){return r.Matrix.isMatrix(this.U)||(this.U=new r.Matrix(this.U)),this.U},get rightSingularVectors(){return r.Matrix.isMatrix(this.V)||(this.V=new r.Matrix(this.V)),this.V},get diagonalMatrix(){return r.Matrix.diag(this.s)},solve:function(t){var n=this.threshold,e=this.s.length,o=r.Matrix.zeros(e,e),s;for(s=0;s<e;s++)o[s][s]=u(this.s[s])<=n?0:1/this.s[s];var i=this.U,a=this.rightSingularVectors,l=a.mmul(o),c=a.rows,m=i.length,d=r.Matrix.zeros(c,m),g,h,p;for(s=0;s<c;s++)for(g=0;g<m;g++){for(p=0,h=0;h<e;h++)p+=l[s][h]*i[g][h];d[s][g]=p}return d.mmul(t)},solveForDiagonal:function(e){return this.solve(r.Matrix.diag(e))},inverse:function(){var t=this.V,n=this.threshold,e=t.length,o=t[0].length,s=new r.Matrix(e,this.s.length),a,i;for(a=0;a<e;a++)for(i=0;i<o;i++)s[a][i]=u(this.s[i])>n?t[a][i]/this.s[i]:0;var l=this.U,c=l.length,m=l[0].length,d=new r.Matrix(e,c),g,h;for(a=0;a<e;a++)for(i=0;i<c;i++){for(h=0,g=0;g<m;g++)h+=s[a][g]*l[i][g];d[a][i]=h}return d}},e.exports=o},function(e,t,i){'use strict';var n=i(40);e.exports={transpose:function(e){if('number'==typeof e)return e;var t=e.clone();return t.transpose()},add:function(e,t){if('number'==typeof e&&'number'==typeof t)return e+t;if('number'==typeof e)return this.add(t,e);var i=e.clone();return i.add(t)},subtract:function(e,t){if('number'==typeof e&&'number'==typeof t)return e-t;if('number'==typeof e)return this.subtract(t,e);var i=e.clone();return i.sub(t)},multiply:function(e,t){if('number'==typeof e&&'number'==typeof t)return e*t;if('number'==typeof e)return this.multiply(t,e);var i=e.clone();return'number'==typeof t?i.mul(t):i=i.mmul(t),1==i.rows&&1==i.columns?i[0][0]:i},dotMultiply:function(e,t){var i=e.clone();return i.mul(t)},dotDivide:function(e,t){var i=e.clone();return i.div(t)},diag:function(e){var t=null,i=e.rows,o=e.columns,s,a;if('undefined'==typeof o&&'object'==typeof e)if(e[0]&&e[0].length)for(i=e.length,o=e[0].length,a=v(i,o),t=n.zeros(o,o),s=0;s<o;s++)t[s][s]=e[s][s];else for(o=e.length,t=n.zeros(o,o),s=0;s<o;s++)t[s][s]=e[s];if(1==i)for(t=n.zeros(o,o),s=0;s<o;s++)t[s][s]=e[0][s];else if(0<i&&0<o)for(a=v(i,o),t=Array(a),s=0;s<a;s++)t[s]=e[s][s];return t},min:function(e,t){if('number'==typeof e&&'number'==typeof t)return v(e,t);for(var o=e.rows,s=e.columns,r=new n(o,s),a=0;a<o;a++)for(var i=0;i<s;i++)r[a][i]=e[a][i]<t[a][i]?e[a][i]:t[a][i];return r},max:function(e,t){if('number'==typeof e&&'number'==typeof t)return M(e,t);for(var o=e.rows,s=e.columns,r=new n(o,s),a=0;a<o;a++)for(var i=0;i<s;i++)r[a][i]=e[a][i]>t[a][i]?e[a][i]:t[a][i];return r},solve:function(e,t){return e.solve(t)},inv:function(e){return'number'==typeof e?1/e:e.inverse()},sqrt:function(e){if('number'==typeof e)return R(e);for(var t=e.rows,o=e.columns,s=new n(t,o),r=0;r<t;r++)for(var i=0;i<o;i++)s[r][i]=R(e[r][i]);return s},exp:function(e){if('number'==typeof e)return R(e);for(var t=e.rows,s=e.columns,r=new n(t,s),a=0;a<t;a++)for(var i=0;i<s;i++)r[a][i]=o(e[a][i]);return r},dotPow:function(e,t){if('number'==typeof e)return c(e,t);for(var o=e.rows,s=e.columns,r=new n(o,s),a=0;a<o;a++)for(var i=0;i<s;i++)r[a][i]=c(e[a][i],t);return r},abs:function(e){if('number'==typeof e)return u(e);for(var t=e.rows,o=e.columns,s=new n(t,o),r=0;r<t;r++)for(var i=0;i<o;i++)s[r][i]=u(e[r][i]);return s},matrix:function(e,t){return new n(e,t)},ones:function(e,t){return n.ones(e,t)},zeros:function(e,t){return n.zeros(e,t)},random:function(e,t){return n.rand(e,t)},eye:function(e,t){return n.eye(e,t)}}},function(e,t,i){'use strict';function n(e){function t(e,t){if(e.rows!==t.rows||e.columns!==t.columns)throw new RangeError('Matrices dimensions must be equal')}function n(e,t){return e-t}function x(e,t){for(var i in t)e=e.replace(new RegExp('%'+i+'%','g'),t[i]);return e}e===void 0&&(e=Object);class w extends e{static get[Symbol.species](){return this}static from1DArray(e,t,i){if(e*t!==i.length)throw new RangeError('Data length does not match given dimensions');for(var n=new this(e,t),o=0;o<e;o++)for(var s=0;s<t;s++)n.set(o,s,i[o*t+s]);return n}static rowVector(e){for(var t=new this(1,e.length),n=0;n<e.length;n++)t.set(0,n,e[n]);return t}static columnVector(e){for(var t=new this(e.length,1),n=0;n<e.length;n++)t.set(n,0,e[n]);return t}static empty(e,t){return new this(e,t)}static zeros(e,t){return this.empty(e,t).fill(0)}static ones(e,t){return this.empty(e,t).fill(1)}static rand(e,t,n){n===void 0&&(n=Math.random);for(var o=this.empty(e,t),s=0;s<e;s++)for(var i=0;i<t;i++)o.set(s,i,n());return o}static randInt(e,t,n,o){n===void 0&&(n=1e3),o===void 0&&(o=Math.random);for(var s=this.empty(e,t),r=0;r<e;r++)for(var i=0,a;i<t;i++)a=g(o()*n),s.set(r,i,a);return s}static eye(e,t,n){t===void 0&&(t=e),n===void 0&&(n=1);for(var o=v(e,t),s=this.zeros(e,t),r=0;r<o;r++)s.set(r,r,n);return s}static diag(e,t,n){var o=e.length;t===void 0&&(t=o),n===void 0&&(n=t);for(var s=v(o,t,n),r=this.zeros(t,n),a=0;a<s;a++)r.set(a,a,e[a]);return r}static min(e,t){e=this.checkMatrix(e),t=this.checkMatrix(t);for(var n=e.rows,o=e.columns,s=new this(n,o),r=0;r<n;r++)for(var i=0;i<o;i++)s.set(r,i,v(e.get(r,i),t.get(r,i)));return s}static max(e,t){e=this.checkMatrix(e),t=this.checkMatrix(t);for(var n=e.rows,o=e.columns,s=new this(n,o),r=0;r<n;r++)for(var i=0;i<o;i++)s.set(r,i,M(e.get(r,i),t.get(r,i)));return s}static checkMatrix(e){return w.isMatrix(e)?e:new this(e)}static isMatrix(e){return null!=e&&'Matrix'===e.klass}get size(){return this.rows*this.columns}apply(e){if('function'!=typeof e)throw new TypeError('callback must be a function');for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var i=0;i<n;i++)e.call(this,o,i);return this}to1DArray(){for(var e=Array(this.size),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e[t*this.columns+i]=this.get(t,i);return e}to2DArray(){for(var e=Array(this.rows),t=0;t<this.rows;t++){e[t]=Array(this.columns);for(var i=0;i<this.columns;i++)e[t][i]=this.get(t,i)}return e}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isSymmetric(){if(this.isSquare()){for(var e=0;e<this.rows;e++)for(var t=0;t<=e;t++)if(this.get(e,t)!==this.get(t,e))return!1;return!0}return!1}set(){throw new Error('set method is unimplemented')}get(){throw new Error('get method is unimplemented')}repeat(e,t){e=e||1,t=t||1;for(var n=new this.constructor[Symbol.species](this.rows*e,this.columns*t),o=0;o<e;o++)for(var i=0;i<t;i++)n.setSubMatrix(this,this.rows*o,this.columns*i);return n}fill(e){for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,e);return this}neg(){return this.mulS(-1)}getRow(e){l.checkRowIndex(this,e);for(var t=Array(this.columns),n=0;n<this.columns;n++)t[n]=this.get(e,n);return t}getRowVector(e){return this.constructor.rowVector(this.getRow(e))}setRow(e,t){l.checkRowIndex(this,e),t=l.checkRowVector(this,t);for(var n=0;n<this.columns;n++)this.set(e,n,t[n]);return this}swapRows(e,t){l.checkRowIndex(this,e),l.checkRowIndex(this,t);for(var n=0,i;n<this.columns;n++)i=this.get(e,n),this.set(e,n,this.get(t,n)),this.set(t,n,i);return this}getColumn(e){l.checkColumnIndex(this,e);for(var t=Array(this.rows),n=0;n<this.rows;n++)t[n]=this.get(n,e);return t}getColumnVector(e){return this.constructor.columnVector(this.getColumn(e))}setColumn(e,t){l.checkColumnIndex(this,e),t=l.checkColumnVector(this,t);for(var n=0;n<this.rows;n++)this.set(n,e,t[n]);return this}swapColumns(e,t){l.checkColumnIndex(this,e),l.checkColumnIndex(this,t);for(var n=0,i;n<this.rows;n++)i=this.get(n,e),this.set(n,e,this.get(n,t)),this.set(n,t,i);return this}addRowVector(e){e=l.checkRowVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)+e[i]);return this}subRowVector(e){e=l.checkRowVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)-e[i]);return this}mulRowVector(e){e=l.checkRowVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)*e[i]);return this}divRowVector(e){e=l.checkRowVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)/e[i]);return this}addColumnVector(e){e=l.checkColumnVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)+e[t]);return this}subColumnVector(e){e=l.checkColumnVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)-e[t]);return this}mulColumnVector(e){e=l.checkColumnVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)*e[t]);return this}divColumnVector(e){e=l.checkColumnVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)/e[t]);return this}mulRow(e,t){l.checkRowIndex(this,e);for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t);return this}mulColumn(e,t){l.checkColumnIndex(this,e);for(var n=0;n<this.rows;n++)this.set(n,e,this.get(n,e)*t);return this}max(){for(var e=this.get(0,0),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.get(t,i)>e&&(e=this.get(t,i));return e}maxIndex(){for(var e=this.get(0,0),t=[0,0],n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.get(n,i)>e&&(e=this.get(n,i),t[0]=n,t[1]=i);return t}min(){for(var e=this.get(0,0),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.get(t,i)<e&&(e=this.get(t,i));return e}minIndex(){for(var e=this.get(0,0),t=[0,0],n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.get(n,i)<e&&(e=this.get(n,i),t[0]=n,t[1]=i);return t}maxRow(e){l.checkRowIndex(this,e);for(var t=this.get(e,0),n=1;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n));return t}maxRowIndex(e){l.checkRowIndex(this,e);for(var t=this.get(e,0),n=[e,0],o=1;o<this.columns;o++)this.get(e,o)>t&&(t=this.get(e,o),n[1]=o);return n}minRow(e){l.checkRowIndex(this,e);for(var t=this.get(e,0),n=1;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n));return t}minRowIndex(e){l.checkRowIndex(this,e);for(var t=this.get(e,0),n=[e,0],o=1;o<this.columns;o++)this.get(e,o)<t&&(t=this.get(e,o),n[1]=o);return n}maxColumn(e){l.checkColumnIndex(this,e);for(var t=this.get(0,e),n=1;n<this.rows;n++)this.get(n,e)>t&&(t=this.get(n,e));return t}maxColumnIndex(e){l.checkColumnIndex(this,e);for(var t=this.get(0,e),n=[0,e],o=1;o<this.rows;o++)this.get(o,e)>t&&(t=this.get(o,e),n[0]=o);return n}minColumn(e){l.checkColumnIndex(this,e);for(var t=this.get(0,e),n=1;n<this.rows;n++)this.get(n,e)<t&&(t=this.get(n,e));return t}minColumnIndex(e){l.checkColumnIndex(this,e);for(var t=this.get(0,e),n=[0,e],o=1;o<this.rows;o++)this.get(o,e)<t&&(t=this.get(o,e),n[0]=o);return n}diag(){for(var e=v(this.rows,this.columns),t=Array(e),n=0;n<e;n++)t[n]=this.get(n,n);return t}sum(e){return'row'===e?l.sumByRow(this):'column'===e?l.sumByColumn(this):l.sumAll(this)}mean(){return this.sum()/this.size}prod(){for(var e=1,t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e*=this.get(t,i);return e}cumulativeSum(){for(var e=0,t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e+=this.get(t,i),this.set(t,i,e);return this}dot(e){w.isMatrix(e)&&(e=e.to1DArray());var t=this.to1DArray();if(t.length!==e.length)throw new RangeError('vectors do not have the same size');for(var n=0,o=0;o<t.length;o++)n+=t[o]*e[o];return n}mmul(e){e=this.constructor.checkMatrix(e),this.columns!==e.rows&&console.warn('Number of columns of left matrix are not equal to number of rows of right matrix.');for(var t=this.rows,o=this.columns,n=e.columns,r=new this.constructor[Symbol.species](t,n),a=Array(o),l=0;l<n;l++){for(var c=0;c<o;c++)a[c]=e.get(c,l);for(var u=0,i;u<t;u++){for(i=0,c=0;c<o;c++)i+=this.get(u,c)*a[c];r.set(u,l,i)}}return r}strassen2x2(e){var t=new this.constructor[Symbol.species](2,2),i=this.get(0,0),n=e.get(0,0),o=this.get(0,1),s=e.get(0,1),r=this.get(1,0),a=e.get(1,0),l=this.get(1,1),c=e.get(1,1),u=(i+l)*(n+c),m=(r+l)*n,d=i*(s-c),g=l*(a-n),h=(i+o)*c;return t.set(0,0,u+g-h+(o-l)*(a+c)),t.set(0,1,d+h),t.set(1,0,m+g),t.set(1,1,u-m+d+(r-i)*(n+s)),t}strassen3x3(e){var t=new this.constructor[Symbol.species](3,3),i=this.get(0,0),n=this.get(0,1),o=this.get(0,2),s=this.get(1,0),r=this.get(1,1),a=this.get(1,2),l=this.get(2,0),c=this.get(2,1),u=this.get(2,2),m=e.get(0,0),d=e.get(0,1),g=e.get(0,2),h=e.get(1,0),p=e.get(1,1),k=e.get(1,2),j=e.get(2,0),x=e.get(2,1),w=e.get(2,2),f=(i-s)*(-d+p),y=(-i+s+r)*(m-d+p),M=(s+r)*(-m+d),b=i*m,v=(-i+l+c)*(m-g+k),R=(-i+l)*(g-k),I=(l+c)*(-m+g),S=(-o+c+u)*(p+j-x),C=(o-u)*(p-x),V=o*j,D=(c+u)*(-j+x),z=(-o+r+a)*(k+j-w),_=(o-a)*(k-w),P=(r+a)*(-j+w);return t.set(0,0,b+V+n*h),t.set(0,1,(i+n+o-s-r-c-u)*p+y+M+b+S+V+D),t.set(0,2,b+v+I+(i+n+o-r-a-l-c)*k+V+z+P),t.set(1,0,f+r*(-m+d+h-p-k-j+w)+y+b+V+z+_),t.set(1,1,f+y+M+b+a*x),t.set(1,2,V+z+_+P+s*g),t.set(2,0,b+v+R+c*(-m+g+h-p-k-j+x)+S+C+V),t.set(2,1,S+C+V+D+l*d),t.set(2,2,b+v+R+I+u*w),t}mmulStrassen(e){function t(e,t,i){var n=e.rows,o=e.columns;if(n===t&&o===i)return e;var s=w.zeros(t,i);return s=s.setSubMatrix(e,0,0),s}function i(e,n,o,s){if(512>=o||512>=s)return e.mmul(n);1==o%2&&1==s%2?(e=t(e,o+1,s+1),n=t(n,o+1,s+1)):1==o%2?(e=t(e,o+1,s),n=t(n,o+1,s)):1==s%2&&(e=t(e,o,s+1),n=t(n,o,s+1));var r=parseInt(e.rows/2),a=parseInt(e.columns/2),l=e.subMatrix(0,r-1,0,a-1),c=n.subMatrix(0,r-1,0,a-1),u=e.subMatrix(0,r-1,a,e.columns-1),m=n.subMatrix(0,r-1,a,n.columns-1),d=e.subMatrix(r,e.rows-1,0,a-1),g=n.subMatrix(r,n.rows-1,0,a-1),h=e.subMatrix(r,e.rows-1,a,e.columns-1),p=n.subMatrix(r,n.rows-1,a,n.columns-1),k=i(w.add(l,h),w.add(c,p),r,a),j=i(w.add(d,h),c,r,a),x=i(l,w.sub(m,p),r,a),f=i(h,w.sub(g,c),r,a),y=i(w.add(l,u),p,r,a),M=i(w.sub(d,l),w.add(c,m),r,a),b=i(w.sub(u,h),w.add(g,p),r,a),v=w.add(k,f);v.sub(y),v.add(b);var R=w.add(x,y),I=w.add(j,f),S=w.sub(k,j);S.add(x),S.add(M);var C=w.zeros(2*v.rows,2*v.columns);return C=C.setSubMatrix(v,0,0),C=C.setSubMatrix(R,v.rows,0),C=C.setSubMatrix(I,0,v.columns),C=C.setSubMatrix(S,v.rows,v.columns),C.subMatrix(0,o-1,0,s-1)}var n=this.clone(),o=n.rows,s=n.columns,a=e.rows,l=e.columns;s!==a&&console.warn(`Multiplying ${o} x ${s} and ${a} x ${l} matrix: dimensions do not match.`);var u=M(o,a),r=M(s,l);return n=t(n,u,r),e=t(e,u,r),i(n,e,u,r)}scaleRows(e,t){if(e=void 0===e?0:e,t=void 0===t?1:t,e>=t)throw new RangeError('min should be strictly smaller than max');for(var n=this.constructor.empty(this.rows,this.columns),o=0,i;o<this.rows;o++)i=s.scale(this.getRow(o),{min:e,max:t}),n.setRow(o,i);return n}scaleColumns(e,t){if(e=void 0===e?0:e,t=void 0===t?1:t,e>=t)throw new RangeError('min should be strictly smaller than max');for(var n=this.constructor.empty(this.rows,this.columns),o=0,i;o<this.columns;o++)i=s.scale(this.getColumn(o),{min:e,max:t}),n.setColumn(o,i);return n}kroneckerProduct(e){e=this.constructor.checkMatrix(e);for(var t=this.rows,o=this.columns,n=e.rows,s=e.columns,r=new this.constructor[Symbol.species](t*n,o*s),a=0;a<t;a++)for(var i=0;i<o;i++)for(var c=0;c<n;c++)for(var u=0;u<s;u++)r[n*a+c][s*i+u]=this.get(a,i)*e.get(c,u);return r}transpose(){for(var e=new this.constructor[Symbol.species](this.columns,this.rows),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e.set(i,t,this.get(t,i));return e}sortRows(e){e===void 0&&(e=n);for(var t=0;t<this.rows;t++)this.setRow(t,this.getRow(t).sort(e));return this}sortColumns(e){e===void 0&&(e=n);for(var t=0;t<this.columns;t++)this.setColumn(t,this.getColumn(t).sort(e));return this}subMatrix(e,t,n,o){l.checkRange(this,e,t,n,o);for(var s=new this.constructor[Symbol.species](t-e+1,o-n+1),r=e;r<=t;r++)for(var i=n;i<=o;i++)s[r-e][i-n]=this.get(r,i);return s}subMatrixRow(e,t,n){if(void 0===t&&(t=0),void 0===n&&(n=this.columns-1),t>n||0>t||t>=this.columns||0>n||n>=this.columns)throw new RangeError('Argument out of range');for(var o=new this.constructor[Symbol.species](e.length,n-t+1),s=0;s<e.length;s++)for(var i=t;i<=n;i++){if(0>e[s]||e[s]>=this.rows)throw new RangeError('Row index out of range: '+e[s]);o.set(s,i-t,this.get(e[s],i))}return o}subMatrixColumn(e,t,n){if(void 0===t&&(t=0),void 0===n&&(n=this.rows-1),t>n||0>t||t>=this.rows||0>n||n>=this.rows)throw new RangeError('Argument out of range');for(var o=new this.constructor[Symbol.species](n-t+1,e.length),s=0;s<e.length;s++)for(var i=t;i<=n;i++){if(0>e[s]||e[s]>=this.columns)throw new RangeError('Column index out of range: '+e[s]);o.set(i-t,s,this.get(i,e[s]))}return o}setSubMatrix(e,t,n){e=this.constructor.checkMatrix(e);var o=t+e.rows-1,s=n+e.columns-1;l.checkRange(this,t,o,n,s);for(var r=0;r<e.rows;r++)for(var i=0;i<e.columns;i++)this[t+r][n+i]=e.get(r,i);return this}selection(e,t){for(var n=l.checkIndices(this,e,t),o=new this.constructor[Symbol.species](e.length,t.length),s=0,i;s<n.row.length;s++){i=n.row[s];for(var r=0,a;r<n.column.length;r++)a=n.column[r],o[s][r]=this.get(i,a)}return o}trace(){for(var e=v(this.rows,this.columns),t=0,n=0;n<e;n++)t+=this.get(n,n);return t}transposeView(){return new c(this)}rowView(e){return l.checkRowIndex(this,e),new m(this,e)}columnView(e){return l.checkColumnIndex(this,e),new p(this,e)}flipRowView(){return new k(this)}flipColumnView(){return new j(this)}subMatrixView(e,t,i,n){return new d(this,e,t,i,n)}selectionView(e,t){return new h(this,e,t)}det(){if(this.isSquare()){var e,t,i,n;if(2===this.columns)return e=this.get(0,0),t=this.get(0,1),i=this.get(1,0),n=this.get(1,1),e*n-t*i;if(3===this.columns){var s,r,a;return s=this.selectionView([1,2],[1,2]),r=this.selectionView([1,2],[0,2]),a=this.selectionView([1,2],[0,1]),e=this.get(0,0),t=this.get(0,1),i=this.get(0,2),e*s.det()-t*r.det()+i*a.det()}return new o(this).determinant}throw Error('Determinant can only be calculated for a square matrix.')}pseudoInverse(e){void 0===e&&(e=a);for(var t=new r(this,{autoTranspose:!0}),n=t.leftSingularVectors,o=t.rightSingularVectors,l=t.diagonal,s=0;s<l.length;s++)l[s]=u(l[s])>e?1/l[s]:0;return l=this.constructor[Symbol.species].diag(l),o.mmul(l.mmul(n.transposeView()))}}w.prototype.klass='Matrix',w.random=w.rand,w.diagonal=w.diag,w.prototype.diagonal=w.prototype.diag,w.identity=w.eye,w.prototype.negate=w.prototype.neg,w.prototype.tensorProduct=w.prototype.kroneckerProduct,w.prototype.determinant=w.prototype.det;var f=`
(function %name%(value) {
    if (typeof value === 'number') return this.%name%S(value);
    return this.%name%M(value);
})
`,y=`
(function %name%S(value) {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, this.get(i, j) %op% value);
        }
    }
    return this;
})
`,b=`
(function %name%M(matrix) {
    matrix = this.constructor.checkMatrix(matrix);
    checkDimensions(this, matrix);
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, this.get(i, j) %op% matrix.get(i, j));
        }
    }
    return this;
})
`,R=`
(function %name%(matrix, value) {
    var newMatrix = new this[Symbol.species](matrix);
    return newMatrix.%name%(value);
})
`,I=`
(function %name%() {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j)));
        }
    }
    return this;
})
`,S=`
(function %name%(matrix) {
    var newMatrix = new this[Symbol.species](matrix);
    return newMatrix.%name%();
})
`,C=`
(function %name%(%args%) {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j), %args%));
        }
    }
    return this;
})
`,V=`
(function %name%(matrix, %args%) {
    var newMatrix = new this[Symbol.species](matrix);
    return newMatrix.%name%(%args%);
})
`,D=`
(function %name%S(value) {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j), value));
        }
    }
    return this;
})
`,z=`
(function %name%M(matrix) {
    matrix = this.constructor.checkMatrix(matrix);
    checkDimensions(this, matrix);
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j), matrix.get(i, j)));
        }
    }
    return this;
})
`,_=`
(function %name%(value) {
    if (typeof value === 'number') return this.%name%S(value);
    return this.%name%M(value);
})
`,P=V,A=[['+','add'],['-','sub','subtract'],['*','mul','multiply'],['/','div','divide'],['%','mod','modulus'],['&','and'],['|','or'],['^','xor'],['<<','leftShift'],['>>','signPropagatingRightShift'],['>>>','rightShift','zeroFillRightShift']],L=!0,U=!1,F,i;try{for(var T=A[Symbol.iterator](),q;!(L=(q=T.next()).done);L=!0){var N=q.value,O=eval(x(f,{name:N[1],op:N[0]})),E=eval(x(y,{name:N[1]+'S',op:N[0]})),B=eval(x(b,{name:N[1]+'M',op:N[0]})),Q=eval(x(R,{name:N[1]}));for(F=1;F<N.length;F++)w.prototype[N[F]]=O,w.prototype[N[F]+'S']=E,w.prototype[N[F]+'M']=B,w[N[F]]=Q}}catch(e){U=!0,i=e}finally{try{!L&&T.return&&T.return()}finally{if(U)throw i}}var W=[['~','not']];['abs','acos','acosh','asin','asinh','atan','atanh','cbrt','ceil','clz32','cos','cosh','exp','expm1','floor','fround','log','log1p','log10','log2','round','sign','sin','sinh','sqrt','tan','tanh','trunc'].forEach(function(e){W.push(['Math.'+e,e])});var X=!0,J=!1,Y;try{for(var H=W[Symbol.iterator](),K;!(X=(K=H.next()).done);X=!0){var G=K.value,Z=eval(x(I,{name:G[1],method:G[0]})),$=eval(x(S,{name:G[1]}));for(F=1;F<G.length;F++)w.prototype[G[F]]=Z,w[G[F]]=$}}catch(e){J=!0,Y=e}finally{try{!X&&H.return&&H.return()}finally{if(J)throw Y}}var ee=[['Math.pow',1,'pow']],te=!0,ie=!1,ne;try{for(var oe=ee[Symbol.iterator](),se;!(te=(se=oe.next()).done);te=!0){var re=se.value,ae='arg0';for(F=1;F<re[1];F++)ae+=`, arg${F}`;if(1!==re[1]){var le=eval(x(C,{name:re[2],method:re[0],args:ae})),ce=eval(x(V,{name:re[2],args:ae}));for(F=2;F<re.length;F++)w.prototype[re[F]]=le,w[re[F]]=ce}else{var ue={name:re[2],args:ae,method:re[0]},me=eval(x(_,ue)),de=eval(x(D,ue)),ge=eval(x(z,ue)),he=eval(x(P,ue));for(F=2;F<re.length;F++)w.prototype[re[F]]=me,w.prototype[re[F]+'M']=ge,w.prototype[re[F]+'S']=de,w[re[F]]=he}}}catch(e){ie=!0,ne=e}finally{try{!te&&oe.return&&oe.return()}finally{if(ie)throw ne}}return w}e.exports=n;var o=i(81),r=i(82),s=i(1),l=i(27),c=i(242),m=i(243),d=i(244),h=i(245),p=i(246),k=i(247),j=i(248)},function(e,t,i){'use strict';function n(e){if(!(this instanceof n))return new n(e);e=o.Matrix.checkMatrix(e);var r=e.clone(),a=r.rows,l=r.columns,c=Array(a),m=1,d,i,g,h,p,s,t,k,j,x;for(d=0;d<a;d++)c[d]=d;for(j=Array(a),i=0;i<l;i++){for(d=0;d<a;d++)j[d]=r[d][i];for(d=0;d<a;d++){for(k=r[d],x=v(d,i),p=0,g=0;g<x;g++)p+=k[g]*j[g];k[i]=j[d]-=p}for(h=i,d=i+1;d<a;d++)u(j[d])>u(j[h])&&(h=d);if(h!==i){for(g=0;g<l;g++)s=r[h][g],r[h][g]=r[i][g],r[i][g]=s;t=c[h],c[h]=c[i],c[i]=t,m=-m}if(i<a&&0!==r[i][i])for(d=i+1;d<a;d++)r[d][i]/=r[i][i]}this.LU=r,this.pivotVector=c,this.pivotSign=m}var o=i(8);n.prototype={isSingular:function(){for(var e=this.LU,t=e.columns,i=0;i<t;i++)if(0===e[i][i])return!0;return!1},get determinant(){var e=this.LU;if(!e.isSquare())throw new Error('Matrix must be square');for(var t=this.pivotSign,i=e.columns,n=0;n<i;n++)t*=e[n][n];return t},get lowerTriangularMatrix(){for(var e=this.LU,t=e.rows,n=e.columns,s=new o.Matrix(t,n),r=0;r<t;r++)for(var i=0;i<n;i++)s[r][i]=r>i?e[r][i]:r===i?1:0;return s},get upperTriangularMatrix(){for(var e=this.LU,t=e.rows,n=e.columns,s=new o.Matrix(t,n),r=0;r<t;r++)for(var i=0;i<n;i++)s[r][i]=r<=i?e[r][i]:0;return s},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(e){e=o.Matrix.checkMatrix(e);var t=this.LU,n=t.rows;if(n!==e.rows)throw new Error('Invalid matrix dimensions');if(this.isSingular())throw new Error('LU matrix is singular');var s=e.columns,r=e.subMatrixRow(this.pivotVector,0,s-1),a=t.columns,l,i,c;for(c=0;c<a;c++)for(l=c+1;l<a;l++)for(i=0;i<s;i++)r[l][i]-=r[c][i]*t[l][c];for(c=a-1;0<=c;c--){for(i=0;i<s;i++)r[c][i]/=t[c][c];for(l=0;l<c;l++)for(i=0;i<s;i++)r[l][i]-=r[c][i]*t[l][c]}return r}},e.exports=n},function(e,t,i){'use strict';function o(h,x){if(!(this instanceof o))return new o(h,x);h=r.Matrix.checkMatrix(h),x=x||{};var w=h.rows,m=h.columns,n=v(w,m),y=!0,I=!0;!1===x.computeLeftSingularVectors&&(y=!1),!1===x.computeRightSingularVectors&&(I=!1);var S=!0===x.autoTranspose,C=!1,D;if(!(w<m))D=h.clone();else if(!S)D=h.clone(),console.warn('Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose');else{D=h.transpose(),w=D.rows,m=D.columns,C=!0;var a=y;y=I,I=a}var z=Array(v(w+1,m)),s=d(w,n,0),_=d(m,m,0),V=Array(m),e=Array(w),P=v(w-1,m),A=M(0,v(m-2,w)),L,i,j,k,p,U,F,f,T,q,N,O,E,B,Q,W,X,J,b,c,Y;for(j=0,q=M(P,A);j<q;j++){if(j<P){for(z[j]=0,L=j;L<w;L++)z[j]=l(z[j],D[L][j]);if(0!==z[j]){for(0>D[j][j]&&(z[j]=-z[j]),L=j;L<w;L++)D[L][j]/=z[j];D[j][j]+=1}z[j]=-z[j]}for(i=j+1;i<m;i++){if(j<P&&0!==z[j]){for(p=0,L=j;L<w;L++)p+=D[L][j]*D[L][i];for(p=-p/D[j][j],L=j;L<w;L++)D[L][i]+=p*D[L][j]}V[i]=D[j][i]}if(y&&j<P)for(L=j;L<w;L++)s[L][j]=D[L][j];if(j<A){for(V[j]=0,L=j+1;L<m;L++)V[j]=l(V[j],V[L]);if(0!==V[j]){for(0>V[j+1]&&(V[j]=0-V[j]),L=j+1;L<m;L++)V[L]/=V[j];V[j+1]+=1}if(V[j]=-V[j],j+1<w&&0!==V[j]){for(L=j+1;L<w;L++)e[L]=0;for(i=j+1;i<m;i++)for(L=j+1;L<w;L++)e[L]+=V[i]*D[L][i];for(i=j+1;i<m;i++)for(p=-V[i]/V[j+1],L=j+1;L<w;L++)D[L][i]+=p*e[L]}if(I)for(L=j+1;L<m;L++)_[L][j]=V[L]}}if(k=v(m,w+1),P<m&&(z[P]=D[P][P]),w<k&&(z[k-1]=0),A+1<k&&(V[A]=D[A][k-1]),V[k-1]=0,y){for(i=P;i<n;i++){for(L=0;L<w;L++)s[L][i]=0;s[i][i]=1}for(j=P-1;0<=j;j--)if(0!==z[j]){for(i=j+1;i<n;i++){for(p=0,L=j;L<w;L++)p+=s[L][j]*s[L][i];for(p=-p/s[j][j],L=j;L<w;L++)s[L][i]+=p*s[L][j]}for(L=j;L<w;L++)s[L][j]=-s[L][j];for(s[j][j]=1+s[j][j],L=0;L<j-1;L++)s[L][j]=0}else{for(L=0;L<w;L++)s[L][j]=0;s[j][j]=1}}if(I)for(j=m-1;0<=j;j--){if(j<A&&0!==V[j])for(i=j+1;i<m;i++){for(p=0,L=j+1;L<m;L++)p+=_[L][j]*_[L][i];for(p=-p/_[j+1][j],L=j+1;L<m;L++)_[L][i]+=p*_[L][j]}for(L=0;L<m;L++)_[L][j]=0;_[j][j]=1}for(var g=k-1,H=0,K=2.220446049250313e-16;0<k;){for(j=k-2;-1<=j&&-1!==j;j--)if(u(V[j])<=K*(u(z[j])+u(z[j+1]))){V[j]=0;break}if(j===k-2)N=4;else{for(U=k-1;U>=j&&U!==j;U--)if(p=(U===k?0:u(V[U]))+(U===j+1?0:u(V[U-1])),u(z[U])<=K*p){z[U]=0;break}U===j?N=3:U===k-1?N=1:(N=2,j=U)}switch(j++,N){case 1:{for(F=V[k-2],V[k-2]=0,i=k-2;i>=j;i--)if(p=l(z[i],F),f=z[i]/p,T=F/p,z[i]=p,i!==j&&(F=-T*V[i-1],V[i-1]=f*V[i-1]),I)for(L=0;L<m;L++)p=f*_[L][i]+T*_[L][k-1],_[L][k-1]=-T*_[L][i]+f*_[L][k-1],_[L][i]=p;break}case 2:{for(F=V[j-1],V[j-1]=0,i=j;i<k;i++)if(p=l(z[i],F),f=z[i]/p,T=F/p,z[i]=p,F=-T*V[i],V[i]=f*V[i],y)for(L=0;L<w;L++)p=f*s[L][i]+T*s[L][j-1],s[L][j-1]=-T*s[L][i]+f*s[L][j-1],s[L][i]=p;break}case 3:{for(O=M(M(M(M(u(z[k-1]),u(z[k-2])),u(V[k-2])),u(z[j])),u(V[j])),E=z[k-1]/O,B=z[k-2]/O,Q=V[k-2]/O,W=z[j]/O,X=V[j]/O,J=((B+E)*(B-E)+Q*Q)/2,b=E*Q*(E*Q),c=0,(0!==J||0!==b)&&(c=R(J*J+b),0>J&&(c=-c),c=b/(J+c)),F=(W+E)*(W-E)+c,Y=W*X,i=j;i<k-1;i++){if(p=l(F,Y),f=F/p,T=Y/p,i!==j&&(V[i-1]=p),F=f*z[i]+T*V[i],V[i]=f*V[i]-T*z[i],Y=T*z[i+1],z[i+1]=f*z[i+1],I)for(L=0;L<m;L++)p=f*_[L][i]+T*_[L][i+1],_[L][i+1]=-T*_[L][i]+f*_[L][i+1],_[L][i]=p;if(p=l(F,Y),f=F/p,T=Y/p,z[i]=p,F=f*V[i]+T*z[i+1],z[i+1]=-T*V[i]+f*z[i+1],Y=T*V[i+1],V[i+1]=f*V[i+1],y&&i<w-1)for(L=0;L<w;L++)p=f*s[L][i]+T*s[L][i+1],s[L][i+1]=-T*s[L][i]+f*s[L][i+1],s[L][i]=p}V[k-2]=F,++H;break}case 4:{if(0>=z[j]&&(z[j]=0>z[j]?-z[j]:0,I))for(L=0;L<=g;L++)_[L][j]=-_[L][j];for(;j<g&&!(z[j]>=z[j+1]);){if(p=z[j],z[j]=z[j+1],z[j+1]=p,I&&j<m-1)for(L=0;L<m;L++)p=_[L][j+1],_[L][j+1]=_[L][j],_[L][j]=p;if(y&&j<w-1)for(L=0;L<w;L++)p=s[L][j+1],s[L][j+1]=s[L][j],s[L][j]=p;j++}H=0,k--;break}}}if(C){var G=_;_=s,s=G}this.m=w,this.n=m,this.s=z,this.U=s,this.V=_}var r=i(8),n=i(42),l=n.hypotenuse,d=n.getFilled2DArray;o.prototype={get condition(){return this.s[0]/this.s[v(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var e=M(this.m,this.n)*this.s[0]*2.220446049250313e-16,t=0,n=this.s,o=0,i=n.length;o<i;o++)n[o]>e&&t++;return t},get diagonal(){return this.s},get threshold(){return 2.220446049250313e-16/2*M(this.m,this.n)*this.s[0]},get leftSingularVectors(){return r.Matrix.isMatrix(this.U)||(this.U=new r.Matrix(this.U)),this.U},get rightSingularVectors(){return r.Matrix.isMatrix(this.V)||(this.V=new r.Matrix(this.V)),this.V},get diagonalMatrix(){return r.Matrix.diag(this.s)},solve:function(t){var n=this.threshold,e=this.s.length,o=r.Matrix.zeros(e,e),s;for(s=0;s<e;s++)o[s][s]=u(this.s[s])<=n?0:1/this.s[s];var i=this.U,a=this.rightSingularVectors,l=a.mmul(o),c=a.rows,m=i.length,d=r.Matrix.zeros(c,m),g,h,p;for(s=0;s<c;s++)for(g=0;g<m;g++){for(p=0,h=0;h<e;h++)p+=l[s][h]*i[g][h];d[s][g]=p}return d.mmul(t)},solveForDiagonal:function(e){return this.solve(r.Matrix.diag(e))},inverse:function(){var t=this.V,n=this.threshold,e=t.length,o=t[0].length,s=new r.Matrix(e,this.s.length),a,i;for(a=0;a<e;a++)for(i=0;i<o;i++)s[a][i]=u(this.s[i])>n?t[a][i]/this.s[i]:0;var l=this.U,c=l.length,m=l[0].length,d=new r.Matrix(e,c),g,h;for(a=0;a<e;a++)for(i=0;i<c;i++){for(h=0,g=0;g<m;g++)h+=s[a][g]*l[i][g];d[a][i]=h}return d}},e.exports=o},function(e,t,i){'use strict';function n(e){function t(e,t){if(e.rows!==t.rows||e.columns!==t.columns)throw new RangeError('Matrices dimensions must be equal')}function n(e,t){return e-t}function x(e,t){for(var i in t)e=e.replace(new RegExp('%'+i+'%','g'),t[i]);return e}e===void 0&&(e=Object);class w extends e{static get[Symbol.species](){return this}static from1DArray(e,t,i){if(e*t!==i.length)throw new RangeError('Data length does not match given dimensions');for(var n=new this(e,t),o=0;o<e;o++)for(var s=0;s<t;s++)n.set(o,s,i[o*t+s]);return n}static rowVector(e){for(var t=new this(1,e.length),n=0;n<e.length;n++)t.set(0,n,e[n]);return t}static columnVector(e){for(var t=new this(e.length,1),n=0;n<e.length;n++)t.set(n,0,e[n]);return t}static empty(e,t){return new this(e,t)}static zeros(e,t){return this.empty(e,t).fill(0)}static ones(e,t){return this.empty(e,t).fill(1)}static rand(e,t,n){n===void 0&&(n=Math.random);for(var o=this.empty(e,t),s=0;s<e;s++)for(var i=0;i<t;i++)o.set(s,i,n());return o}static randInt(e,t,n,o){n===void 0&&(n=1e3),o===void 0&&(o=Math.random);for(var s=this.empty(e,t),r=0;r<e;r++)for(var i=0,a;i<t;i++)a=g(o()*n),s.set(r,i,a);return s}static eye(e,t,n){t===void 0&&(t=e),n===void 0&&(n=1);for(var o=v(e,t),s=this.zeros(e,t),r=0;r<o;r++)s.set(r,r,n);return s}static diag(e,t,n){var o=e.length;t===void 0&&(t=o),n===void 0&&(n=t);for(var s=v(o,t,n),r=this.zeros(t,n),a=0;a<s;a++)r.set(a,a,e[a]);return r}static min(e,t){e=this.checkMatrix(e),t=this.checkMatrix(t);for(var n=e.rows,o=e.columns,s=new this(n,o),r=0;r<n;r++)for(var i=0;i<o;i++)s.set(r,i,v(e.get(r,i),t.get(r,i)));return s}static max(e,t){e=this.checkMatrix(e),t=this.checkMatrix(t);for(var n=e.rows,o=e.columns,s=new this(n,o),r=0;r<n;r++)for(var i=0;i<o;i++)s.set(r,i,M(e.get(r,i),t.get(r,i)));return s}static checkMatrix(e){return w.isMatrix(e)?e:new this(e)}static isMatrix(e){return null!=e&&'Matrix'===e.klass}get size(){return this.rows*this.columns}apply(e){if('function'!=typeof e)throw new TypeError('callback must be a function');for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var i=0;i<n;i++)e.call(this,o,i);return this}to1DArray(){for(var e=Array(this.size),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e[t*this.columns+i]=this.get(t,i);return e}to2DArray(){for(var e=Array(this.rows),t=0;t<this.rows;t++){e[t]=Array(this.columns);for(var i=0;i<this.columns;i++)e[t][i]=this.get(t,i)}return e}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isSymmetric(){if(this.isSquare()){for(var e=0;e<this.rows;e++)for(var t=0;t<=e;t++)if(this.get(e,t)!==this.get(t,e))return!1;return!0}return!1}set(){throw new Error('set method is unimplemented')}get(){throw new Error('get method is unimplemented')}repeat(e,t){e=e||1,t=t||1;for(var n=new this.constructor[Symbol.species](this.rows*e,this.columns*t),o=0;o<e;o++)for(var i=0;i<t;i++)n.setSubMatrix(this,this.rows*o,this.columns*i);return n}fill(e){for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,e);return this}neg(){return this.mulS(-1)}getRow(e){l.checkRowIndex(this,e);for(var t=Array(this.columns),n=0;n<this.columns;n++)t[n]=this.get(e,n);return t}getRowVector(e){return this.constructor.rowVector(this.getRow(e))}setRow(e,t){l.checkRowIndex(this,e),t=l.checkRowVector(this,t);for(var n=0;n<this.columns;n++)this.set(e,n,t[n]);return this}swapRows(e,t){l.checkRowIndex(this,e),l.checkRowIndex(this,t);for(var n=0,i;n<this.columns;n++)i=this.get(e,n),this.set(e,n,this.get(t,n)),this.set(t,n,i);return this}getColumn(e){l.checkColumnIndex(this,e);for(var t=Array(this.rows),n=0;n<this.rows;n++)t[n]=this.get(n,e);return t}getColumnVector(e){return this.constructor.columnVector(this.getColumn(e))}setColumn(e,t){l.checkColumnIndex(this,e),t=l.checkColumnVector(this,t);for(var n=0;n<this.rows;n++)this.set(n,e,t[n]);return this}swapColumns(e,t){l.checkColumnIndex(this,e),l.checkColumnIndex(this,t);for(var n=0,i;n<this.rows;n++)i=this.get(n,e),this.set(n,e,this.get(n,t)),this.set(n,t,i);return this}addRowVector(e){e=l.checkRowVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)+e[i]);return this}subRowVector(e){e=l.checkRowVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)-e[i]);return this}mulRowVector(e){e=l.checkRowVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)*e[i]);return this}divRowVector(e){e=l.checkRowVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)/e[i]);return this}addColumnVector(e){e=l.checkColumnVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)+e[t]);return this}subColumnVector(e){e=l.checkColumnVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)-e[t]);return this}mulColumnVector(e){e=l.checkColumnVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)*e[t]);return this}divColumnVector(e){e=l.checkColumnVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)/e[t]);return this}mulRow(e,t){l.checkRowIndex(this,e);for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t);return this}mulColumn(e,t){l.checkColumnIndex(this,e);for(var n=0;n<this.rows;n++)this.set(n,e,this.get(n,e)*t);return this}max(){for(var e=this.get(0,0),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.get(t,i)>e&&(e=this.get(t,i));return e}maxIndex(){for(var e=this.get(0,0),t=[0,0],n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.get(n,i)>e&&(e=this.get(n,i),t[0]=n,t[1]=i);return t}min(){for(var e=this.get(0,0),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.get(t,i)<e&&(e=this.get(t,i));return e}minIndex(){for(var e=this.get(0,0),t=[0,0],n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.get(n,i)<e&&(e=this.get(n,i),t[0]=n,t[1]=i);return t}maxRow(e){l.checkRowIndex(this,e);for(var t=this.get(e,0),n=1;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n));return t}maxRowIndex(e){l.checkRowIndex(this,e);for(var t=this.get(e,0),n=[e,0],o=1;o<this.columns;o++)this.get(e,o)>t&&(t=this.get(e,o),n[1]=o);return n}minRow(e){l.checkRowIndex(this,e);for(var t=this.get(e,0),n=1;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n));return t}minRowIndex(e){l.checkRowIndex(this,e);for(var t=this.get(e,0),n=[e,0],o=1;o<this.columns;o++)this.get(e,o)<t&&(t=this.get(e,o),n[1]=o);return n}maxColumn(e){l.checkColumnIndex(this,e);for(var t=this.get(0,e),n=1;n<this.rows;n++)this.get(n,e)>t&&(t=this.get(n,e));return t}maxColumnIndex(e){l.checkColumnIndex(this,e);for(var t=this.get(0,e),n=[0,e],o=1;o<this.rows;o++)this.get(o,e)>t&&(t=this.get(o,e),n[0]=o);return n}minColumn(e){l.checkColumnIndex(this,e);for(var t=this.get(0,e),n=1;n<this.rows;n++)this.get(n,e)<t&&(t=this.get(n,e));return t}minColumnIndex(e){l.checkColumnIndex(this,e);for(var t=this.get(0,e),n=[0,e],o=1;o<this.rows;o++)this.get(o,e)<t&&(t=this.get(o,e),n[0]=o);return n}diag(){for(var e=v(this.rows,this.columns),t=Array(e),n=0;n<e;n++)t[n]=this.get(n,n);return t}sum(e){return'row'===e?l.sumByRow(this):'column'===e?l.sumByColumn(this):l.sumAll(this)}mean(){return this.sum()/this.size}prod(){for(var e=1,t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e*=this.get(t,i);return e}cumulativeSum(){for(var e=0,t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e+=this.get(t,i),this.set(t,i,e);return this}dot(e){w.isMatrix(e)&&(e=e.to1DArray());var t=this.to1DArray();if(t.length!==e.length)throw new RangeError('vectors do not have the same size');for(var n=0,o=0;o<t.length;o++)n+=t[o]*e[o];return n}mmul(e){e=this.constructor.checkMatrix(e),this.columns!==e.rows&&console.warn('Number of columns of left matrix are not equal to number of rows of right matrix.');for(var t=this.rows,o=this.columns,n=e.columns,r=new this.constructor[Symbol.species](t,n),a=Array(o),l=0;l<n;l++){for(var c=0;c<o;c++)a[c]=e.get(c,l);for(var u=0,i;u<t;u++){for(i=0,c=0;c<o;c++)i+=this.get(u,c)*a[c];r.set(u,l,i)}}return r}strassen2x2(e){var t=new this.constructor[Symbol.species](2,2),i=this.get(0,0),n=e.get(0,0),o=this.get(0,1),s=e.get(0,1),r=this.get(1,0),a=e.get(1,0),l=this.get(1,1),c=e.get(1,1),u=(i+l)*(n+c),m=(r+l)*n,d=i*(s-c),g=l*(a-n),h=(i+o)*c;return t.set(0,0,u+g-h+(o-l)*(a+c)),t.set(0,1,d+h),t.set(1,0,m+g),t.set(1,1,u-m+d+(r-i)*(n+s)),t}strassen3x3(e){var t=new this.constructor[Symbol.species](3,3),i=this.get(0,0),n=this.get(0,1),o=this.get(0,2),s=this.get(1,0),r=this.get(1,1),a=this.get(1,2),l=this.get(2,0),c=this.get(2,1),u=this.get(2,2),m=e.get(0,0),d=e.get(0,1),g=e.get(0,2),h=e.get(1,0),p=e.get(1,1),k=e.get(1,2),j=e.get(2,0),x=e.get(2,1),w=e.get(2,2),f=(i-s)*(-d+p),y=(-i+s+r)*(m-d+p),M=(s+r)*(-m+d),b=i*m,v=(-i+l+c)*(m-g+k),R=(-i+l)*(g-k),I=(l+c)*(-m+g),S=(-o+c+u)*(p+j-x),C=(o-u)*(p-x),V=o*j,D=(c+u)*(-j+x),z=(-o+r+a)*(k+j-w),_=(o-a)*(k-w),P=(r+a)*(-j+w);return t.set(0,0,b+V+n*h),t.set(0,1,(i+n+o-s-r-c-u)*p+y+M+b+S+V+D),t.set(0,2,b+v+I+(i+n+o-r-a-l-c)*k+V+z+P),t.set(1,0,f+r*(-m+d+h-p-k-j+w)+y+b+V+z+_),t.set(1,1,f+y+M+b+a*x),t.set(1,2,V+z+_+P+s*g),t.set(2,0,b+v+R+c*(-m+g+h-p-k-j+x)+S+C+V),t.set(2,1,S+C+V+D+l*d),t.set(2,2,b+v+R+I+u*w),t}mmulStrassen(e){function t(e,t,i){var n=e.rows,o=e.columns;if(n===t&&o===i)return e;var s=w.zeros(t,i);return s=s.setSubMatrix(e,0,0),s}function i(e,n,o,s){if(512>=o||512>=s)return e.mmul(n);1==o%2&&1==s%2?(e=t(e,o+1,s+1),n=t(n,o+1,s+1)):1==o%2?(e=t(e,o+1,s),n=t(n,o+1,s)):1==s%2&&(e=t(e,o,s+1),n=t(n,o,s+1));var r=parseInt(e.rows/2),a=parseInt(e.columns/2),l=e.subMatrix(0,r-1,0,a-1),c=n.subMatrix(0,r-1,0,a-1),u=e.subMatrix(0,r-1,a,e.columns-1),m=n.subMatrix(0,r-1,a,n.columns-1),d=e.subMatrix(r,e.rows-1,0,a-1),g=n.subMatrix(r,n.rows-1,0,a-1),h=e.subMatrix(r,e.rows-1,a,e.columns-1),p=n.subMatrix(r,n.rows-1,a,n.columns-1),k=i(w.add(l,h),w.add(c,p),r,a),j=i(w.add(d,h),c,r,a),x=i(l,w.sub(m,p),r,a),f=i(h,w.sub(g,c),r,a),y=i(w.add(l,u),p,r,a),M=i(w.sub(d,l),w.add(c,m),r,a),b=i(w.sub(u,h),w.add(g,p),r,a),v=w.add(k,f);v.sub(y),v.add(b);var R=w.add(x,y),I=w.add(j,f),S=w.sub(k,j);S.add(x),S.add(M);var C=w.zeros(2*v.rows,2*v.columns);return C=C.setSubMatrix(v,0,0),C=C.setSubMatrix(R,v.rows,0),C=C.setSubMatrix(I,0,v.columns),C=C.setSubMatrix(S,v.rows,v.columns),C.subMatrix(0,o-1,0,s-1)}var n=this.clone(),o=n.rows,s=n.columns,a=e.rows,l=e.columns;s!==a&&console.warn(`Multiplying ${o} x ${s} and ${a} x ${l} matrix: dimensions do not match.`);var u=M(o,a),r=M(s,l);return n=t(n,u,r),e=t(e,u,r),i(n,e,u,r)}scaleRows(e,t){if(e=void 0===e?0:e,t=void 0===t?1:t,e>=t)throw new RangeError('min should be strictly smaller than max');for(var n=this.constructor.empty(this.rows,this.columns),o=0,i;o<this.rows;o++)i=s.scale(this.getRow(o),{min:e,max:t}),n.setRow(o,i);return n}scaleColumns(e,t){if(e=void 0===e?0:e,t=void 0===t?1:t,e>=t)throw new RangeError('min should be strictly smaller than max');for(var n=this.constructor.empty(this.rows,this.columns),o=0,i;o<this.columns;o++)i=s.scale(this.getColumn(o),{min:e,max:t}),n.setColumn(o,i);return n}kroneckerProduct(e){e=this.constructor.checkMatrix(e);for(var t=this.rows,o=this.columns,n=e.rows,s=e.columns,r=new this.constructor[Symbol.species](t*n,o*s),a=0;a<t;a++)for(var i=0;i<o;i++)for(var c=0;c<n;c++)for(var u=0;u<s;u++)r[n*a+c][s*i+u]=this.get(a,i)*e.get(c,u);return r}transpose(){for(var e=new this.constructor[Symbol.species](this.columns,this.rows),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e.set(i,t,this.get(t,i));return e}sortRows(e){e===void 0&&(e=n);for(var t=0;t<this.rows;t++)this.setRow(t,this.getRow(t).sort(e));return this}sortColumns(e){e===void 0&&(e=n);for(var t=0;t<this.columns;t++)this.setColumn(t,this.getColumn(t).sort(e));return this}subMatrix(e,t,n,o){l.checkRange(this,e,t,n,o);for(var s=new this.constructor[Symbol.species](t-e+1,o-n+1),r=e;r<=t;r++)for(var i=n;i<=o;i++)s[r-e][i-n]=this.get(r,i);return s}subMatrixRow(e,t,n){if(void 0===t&&(t=0),void 0===n&&(n=this.columns-1),t>n||0>t||t>=this.columns||0>n||n>=this.columns)throw new RangeError('Argument out of range');for(var o=new this.constructor[Symbol.species](e.length,n-t+1),s=0;s<e.length;s++)for(var i=t;i<=n;i++){if(0>e[s]||e[s]>=this.rows)throw new RangeError('Row index out of range: '+e[s]);o.set(s,i-t,this.get(e[s],i))}return o}subMatrixColumn(e,t,n){if(void 0===t&&(t=0),void 0===n&&(n=this.rows-1),t>n||0>t||t>=this.rows||0>n||n>=this.rows)throw new RangeError('Argument out of range');for(var o=new this.constructor[Symbol.species](n-t+1,e.length),s=0;s<e.length;s++)for(var i=t;i<=n;i++){if(0>e[s]||e[s]>=this.columns)throw new RangeError('Column index out of range: '+e[s]);o.set(i-t,s,this.get(i,e[s]))}return o}setSubMatrix(e,t,n){e=this.constructor.checkMatrix(e);var o=t+e.rows-1,s=n+e.columns-1;l.checkRange(this,t,o,n,s);for(var r=0;r<e.rows;r++)for(var i=0;i<e.columns;i++)this[t+r][n+i]=e.get(r,i);return this}selection(e,t){for(var n=l.checkIndices(this,e,t),o=new this.constructor[Symbol.species](e.length,t.length),s=0,i;s<n.row.length;s++){i=n.row[s];for(var r=0,a;r<n.column.length;r++)a=n.column[r],o[s][r]=this.get(i,a)}return o}trace(){for(var e=v(this.rows,this.columns),t=0,n=0;n<e;n++)t+=this.get(n,n);return t}transposeView(){return new c(this)}rowView(e){return l.checkRowIndex(this,e),new m(this,e)}columnView(e){return l.checkColumnIndex(this,e),new p(this,e)}flipRowView(){return new k(this)}flipColumnView(){return new j(this)}subMatrixView(e,t,i,n){return new d(this,e,t,i,n)}selectionView(e,t){return new h(this,e,t)}det(){if(this.isSquare()){var e,t,i,n;if(2===this.columns)return e=this.get(0,0),t=this.get(0,1),i=this.get(1,0),n=this.get(1,1),e*n-t*i;if(3===this.columns){var s,r,a;return s=this.selectionView([1,2],[1,2]),r=this.selectionView([1,2],[0,2]),a=this.selectionView([1,2],[0,1]),e=this.get(0,0),t=this.get(0,1),i=this.get(0,2),e*s.det()-t*r.det()+i*a.det()}return new o(this).determinant}throw Error('Determinant can only be calculated for a square matrix.')}pseudoInverse(e){void 0===e&&(e=a);for(var t=new r(this,{autoTranspose:!0}),n=t.leftSingularVectors,o=t.rightSingularVectors,l=t.diagonal,s=0;s<l.length;s++)l[s]=u(l[s])>e?1/l[s]:0;return l=this.constructor[Symbol.species].diag(l),o.mmul(l.mmul(n.transposeView()))}}w.prototype.klass='Matrix',w.random=w.rand,w.diagonal=w.diag,w.prototype.diagonal=w.prototype.diag,w.identity=w.eye,w.prototype.negate=w.prototype.neg,w.prototype.tensorProduct=w.prototype.kroneckerProduct,w.prototype.determinant=w.prototype.det;var f=`
(function %name%(value) {
    if (typeof value === 'number') return this.%name%S(value);
    return this.%name%M(value);
})
`,y=`
(function %name%S(value) {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, this.get(i, j) %op% value);
        }
    }
    return this;
})
`,b=`
(function %name%M(matrix) {
    matrix = this.constructor.checkMatrix(matrix);
    checkDimensions(this, matrix);
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, this.get(i, j) %op% matrix.get(i, j));
        }
    }
    return this;
})
`,R=`
(function %name%(matrix, value) {
    var newMatrix = new this[Symbol.species](matrix);
    return newMatrix.%name%(value);
})
`,I=`
(function %name%() {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j)));
        }
    }
    return this;
})
`,S=`
(function %name%(matrix) {
    var newMatrix = new this[Symbol.species](matrix);
    return newMatrix.%name%();
})
`,C=`
(function %name%(%args%) {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j), %args%));
        }
    }
    return this;
})
`,V=`
(function %name%(matrix, %args%) {
    var newMatrix = new this[Symbol.species](matrix);
    return newMatrix.%name%(%args%);
})
`,D=`
(function %name%S(value) {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j), value));
        }
    }
    return this;
})
`,z=`
(function %name%M(matrix) {
    matrix = this.constructor.checkMatrix(matrix);
    checkDimensions(this, matrix);
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j), matrix.get(i, j)));
        }
    }
    return this;
})
`,_=`
(function %name%(value) {
    if (typeof value === 'number') return this.%name%S(value);
    return this.%name%M(value);
})
`,P=V,A=[['+','add'],['-','sub','subtract'],['*','mul','multiply'],['/','div','divide'],['%','mod','modulus'],['&','and'],['|','or'],['^','xor'],['<<','leftShift'],['>>','signPropagatingRightShift'],['>>>','rightShift','zeroFillRightShift']],L=!0,U=!1,F,i;try{for(var T=A[Symbol.iterator](),q;!(L=(q=T.next()).done);L=!0){var N=q.value,O=eval(x(f,{name:N[1],op:N[0]})),E=eval(x(y,{name:N[1]+'S',op:N[0]})),B=eval(x(b,{name:N[1]+'M',op:N[0]})),Q=eval(x(R,{name:N[1]}));for(F=1;F<N.length;F++)w.prototype[N[F]]=O,w.prototype[N[F]+'S']=E,w.prototype[N[F]+'M']=B,w[N[F]]=Q}}catch(e){U=!0,i=e}finally{try{!L&&T.return&&T.return()}finally{if(U)throw i}}var W=[['~','not']];['abs','acos','acosh','asin','asinh','atan','atanh','cbrt','ceil','clz32','cos','cosh','exp','expm1','floor','fround','log','log1p','log10','log2','round','sign','sin','sinh','sqrt','tan','tanh','trunc'].forEach(function(e){W.push(['Math.'+e,e])});var X=!0,J=!1,Y;try{for(var H=W[Symbol.iterator](),K;!(X=(K=H.next()).done);X=!0){var G=K.value,Z=eval(x(I,{name:G[1],method:G[0]})),$=eval(x(S,{name:G[1]}));for(F=1;F<G.length;F++)w.prototype[G[F]]=Z,w[G[F]]=$}}catch(e){J=!0,Y=e}finally{try{!X&&H.return&&H.return()}finally{if(J)throw Y}}var ee=[['Math.pow',1,'pow']],te=!0,ie=!1,ne;try{for(var oe=ee[Symbol.iterator](),se;!(te=(se=oe.next()).done);te=!0){var re=se.value,ae='arg0';for(F=1;F<re[1];F++)ae+=`, arg${F}`;if(1!==re[1]){var le=eval(x(C,{name:re[2],method:re[0],args:ae})),ce=eval(x(V,{name:re[2],args:ae}));for(F=2;F<re.length;F++)w.prototype[re[F]]=le,w[re[F]]=ce}else{var ue={name:re[2],args:ae,method:re[0]},me=eval(x(_,ue)),de=eval(x(D,ue)),ge=eval(x(z,ue)),he=eval(x(P,ue));for(F=2;F<re.length;F++)w.prototype[re[F]]=me,w.prototype[re[F]+'M']=ge,w.prototype[re[F]+'S']=de,w[re[F]]=he}}}catch(e){ie=!0,ne=e}finally{try{!te&&oe.return&&oe.return()}finally{if(ie)throw ne}}return w}e.exports=n;var o=i(84),r=i(85),s=i(1),l=i(28),c=i(258),m=i(259),d=i(260),h=i(261),p=i(262),k=i(263),j=i(264)},function(e,t,i){'use strict';function n(e){if(!(this instanceof n))return new n(e);e=o.Matrix.checkMatrix(e);var r=e.clone(),a=r.rows,l=r.columns,c=Array(a),m=1,d,i,g,h,p,s,t,k,j,x;for(d=0;d<a;d++)c[d]=d;for(j=Array(a),i=0;i<l;i++){for(d=0;d<a;d++)j[d]=r[d][i];for(d=0;d<a;d++){for(k=r[d],x=v(d,i),p=0,g=0;g<x;g++)p+=k[g]*j[g];k[i]=j[d]-=p}for(h=i,d=i+1;d<a;d++)u(j[d])>u(j[h])&&(h=d);if(h!==i){for(g=0;g<l;g++)s=r[h][g],r[h][g]=r[i][g],r[i][g]=s;t=c[h],c[h]=c[i],c[i]=t,m=-m}if(i<a&&0!==r[i][i])for(d=i+1;d<a;d++)r[d][i]/=r[i][i]}this.LU=r,this.pivotVector=c,this.pivotSign=m}var o=i(9);n.prototype={isSingular:function(){for(var e=this.LU,t=e.columns,i=0;i<t;i++)if(0===e[i][i])return!0;return!1},get determinant(){var e=this.LU;if(!e.isSquare())throw new Error('Matrix must be square');for(var t=this.pivotSign,i=e.columns,n=0;n<i;n++)t*=e[n][n];return t},get lowerTriangularMatrix(){for(var e=this.LU,t=e.rows,n=e.columns,s=new o.Matrix(t,n),r=0;r<t;r++)for(var i=0;i<n;i++)s[r][i]=r>i?e[r][i]:r===i?1:0;return s},get upperTriangularMatrix(){for(var e=this.LU,t=e.rows,n=e.columns,s=new o.Matrix(t,n),r=0;r<t;r++)for(var i=0;i<n;i++)s[r][i]=r<=i?e[r][i]:0;return s},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(e){e=o.Matrix.checkMatrix(e);var t=this.LU,n=t.rows;if(n!==e.rows)throw new Error('Invalid matrix dimensions');if(this.isSingular())throw new Error('LU matrix is singular');var s=e.columns,r=e.subMatrixRow(this.pivotVector,0,s-1),a=t.columns,l,i,c;for(c=0;c<a;c++)for(l=c+1;l<a;l++)for(i=0;i<s;i++)r[l][i]-=r[c][i]*t[l][c];for(c=a-1;0<=c;c--){for(i=0;i<s;i++)r[c][i]/=t[c][c];for(l=0;l<c;l++)for(i=0;i<s;i++)r[l][i]-=r[c][i]*t[l][c]}return r}},e.exports=n},function(e,t,i){'use strict';function o(h,x){if(!(this instanceof o))return new o(h,x);h=r.Matrix.checkMatrix(h),x=x||{};var w=h.rows,m=h.columns,n=v(w,m),y=!0,I=!0;!1===x.computeLeftSingularVectors&&(y=!1),!1===x.computeRightSingularVectors&&(I=!1);var S=!0===x.autoTranspose,C=!1,D;if(!(w<m))D=h.clone();else if(!S)D=h.clone(),console.warn('Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose');else{D=h.transpose(),w=D.rows,m=D.columns,C=!0;var a=y;y=I,I=a}var z=Array(v(w+1,m)),s=d(w,n,0),_=d(m,m,0),V=Array(m),e=Array(w),P=v(w-1,m),A=M(0,v(m-2,w)),L,i,j,k,p,U,F,f,T,q,N,O,E,B,Q,W,X,J,b,c,Y;for(j=0,q=M(P,A);j<q;j++){if(j<P){for(z[j]=0,L=j;L<w;L++)z[j]=l(z[j],D[L][j]);if(0!==z[j]){for(0>D[j][j]&&(z[j]=-z[j]),L=j;L<w;L++)D[L][j]/=z[j];D[j][j]+=1}z[j]=-z[j]}for(i=j+1;i<m;i++){if(j<P&&0!==z[j]){for(p=0,L=j;L<w;L++)p+=D[L][j]*D[L][i];for(p=-p/D[j][j],L=j;L<w;L++)D[L][i]+=p*D[L][j]}V[i]=D[j][i]}if(y&&j<P)for(L=j;L<w;L++)s[L][j]=D[L][j];if(j<A){for(V[j]=0,L=j+1;L<m;L++)V[j]=l(V[j],V[L]);if(0!==V[j]){for(0>V[j+1]&&(V[j]=0-V[j]),L=j+1;L<m;L++)V[L]/=V[j];V[j+1]+=1}if(V[j]=-V[j],j+1<w&&0!==V[j]){for(L=j+1;L<w;L++)e[L]=0;for(i=j+1;i<m;i++)for(L=j+1;L<w;L++)e[L]+=V[i]*D[L][i];for(i=j+1;i<m;i++)for(p=-V[i]/V[j+1],L=j+1;L<w;L++)D[L][i]+=p*e[L]}if(I)for(L=j+1;L<m;L++)_[L][j]=V[L]}}if(k=v(m,w+1),P<m&&(z[P]=D[P][P]),w<k&&(z[k-1]=0),A+1<k&&(V[A]=D[A][k-1]),V[k-1]=0,y){for(i=P;i<n;i++){for(L=0;L<w;L++)s[L][i]=0;s[i][i]=1}for(j=P-1;0<=j;j--)if(0!==z[j]){for(i=j+1;i<n;i++){for(p=0,L=j;L<w;L++)p+=s[L][j]*s[L][i];for(p=-p/s[j][j],L=j;L<w;L++)s[L][i]+=p*s[L][j]}for(L=j;L<w;L++)s[L][j]=-s[L][j];for(s[j][j]=1+s[j][j],L=0;L<j-1;L++)s[L][j]=0}else{for(L=0;L<w;L++)s[L][j]=0;s[j][j]=1}}if(I)for(j=m-1;0<=j;j--){if(j<A&&0!==V[j])for(i=j+1;i<m;i++){for(p=0,L=j+1;L<m;L++)p+=_[L][j]*_[L][i];for(p=-p/_[j+1][j],L=j+1;L<m;L++)_[L][i]+=p*_[L][j]}for(L=0;L<m;L++)_[L][j]=0;_[j][j]=1}for(var g=k-1,H=0,K=2.220446049250313e-16;0<k;){for(j=k-2;-1<=j&&-1!==j;j--)if(u(V[j])<=K*(u(z[j])+u(z[j+1]))){V[j]=0;break}if(j===k-2)N=4;else{for(U=k-1;U>=j&&U!==j;U--)if(p=(U===k?0:u(V[U]))+(U===j+1?0:u(V[U-1])),u(z[U])<=K*p){z[U]=0;break}U===j?N=3:U===k-1?N=1:(N=2,j=U)}switch(j++,N){case 1:{for(F=V[k-2],V[k-2]=0,i=k-2;i>=j;i--)if(p=l(z[i],F),f=z[i]/p,T=F/p,z[i]=p,i!==j&&(F=-T*V[i-1],V[i-1]=f*V[i-1]),I)for(L=0;L<m;L++)p=f*_[L][i]+T*_[L][k-1],_[L][k-1]=-T*_[L][i]+f*_[L][k-1],_[L][i]=p;break}case 2:{for(F=V[j-1],V[j-1]=0,i=j;i<k;i++)if(p=l(z[i],F),f=z[i]/p,T=F/p,z[i]=p,F=-T*V[i],V[i]=f*V[i],y)for(L=0;L<w;L++)p=f*s[L][i]+T*s[L][j-1],s[L][j-1]=-T*s[L][i]+f*s[L][j-1],s[L][i]=p;break}case 3:{for(O=M(M(M(M(u(z[k-1]),u(z[k-2])),u(V[k-2])),u(z[j])),u(V[j])),E=z[k-1]/O,B=z[k-2]/O,Q=V[k-2]/O,W=z[j]/O,X=V[j]/O,J=((B+E)*(B-E)+Q*Q)/2,b=E*Q*(E*Q),c=0,(0!==J||0!==b)&&(c=R(J*J+b),0>J&&(c=-c),c=b/(J+c)),F=(W+E)*(W-E)+c,Y=W*X,i=j;i<k-1;i++){if(p=l(F,Y),f=F/p,T=Y/p,i!==j&&(V[i-1]=p),F=f*z[i]+T*V[i],V[i]=f*V[i]-T*z[i],Y=T*z[i+1],z[i+1]=f*z[i+1],I)for(L=0;L<m;L++)p=f*_[L][i]+T*_[L][i+1],_[L][i+1]=-T*_[L][i]+f*_[L][i+1],_[L][i]=p;if(p=l(F,Y),f=F/p,T=Y/p,z[i]=p,F=f*V[i]+T*z[i+1],z[i+1]=-T*V[i]+f*z[i+1],Y=T*V[i+1],V[i+1]=f*V[i+1],y&&i<w-1)for(L=0;L<w;L++)p=f*s[L][i]+T*s[L][i+1],s[L][i+1]=-T*s[L][i]+f*s[L][i+1],s[L][i]=p}V[k-2]=F,++H;break}case 4:{if(0>=z[j]&&(z[j]=0>z[j]?-z[j]:0,I))for(L=0;L<=g;L++)_[L][j]=-_[L][j];for(;j<g&&!(z[j]>=z[j+1]);){if(p=z[j],z[j]=z[j+1],z[j+1]=p,I&&j<m-1)for(L=0;L<m;L++)p=_[L][j+1],_[L][j+1]=_[L][j],_[L][j]=p;if(y&&j<w-1)for(L=0;L<w;L++)p=s[L][j+1],s[L][j+1]=s[L][j],s[L][j]=p;j++}H=0,k--;break}}}if(C){var G=_;_=s,s=G}this.m=w,this.n=m,this.s=z,this.U=s,this.V=_}var r=i(9),n=i(43),l=n.hypotenuse,d=n.getFilled2DArray;o.prototype={get condition(){return this.s[0]/this.s[v(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var e=M(this.m,this.n)*this.s[0]*2.220446049250313e-16,t=0,n=this.s,o=0,i=n.length;o<i;o++)n[o]>e&&t++;return t},get diagonal(){return this.s},get threshold(){return 2.220446049250313e-16/2*M(this.m,this.n)*this.s[0]},get leftSingularVectors(){return r.Matrix.isMatrix(this.U)||(this.U=new r.Matrix(this.U)),this.U},get rightSingularVectors(){return r.Matrix.isMatrix(this.V)||(this.V=new r.Matrix(this.V)),this.V},get diagonalMatrix(){return r.Matrix.diag(this.s)},solve:function(t){var n=this.threshold,e=this.s.length,o=r.Matrix.zeros(e,e),s;for(s=0;s<e;s++)o[s][s]=u(this.s[s])<=n?0:1/this.s[s];var i=this.U,a=this.rightSingularVectors,l=a.mmul(o),c=a.rows,m=i.length,d=r.Matrix.zeros(c,m),g,h,p;for(s=0;s<c;s++)for(g=0;g<m;g++){for(p=0,h=0;h<e;h++)p+=l[s][h]*i[g][h];d[s][g]=p}return d.mmul(t)},solveForDiagonal:function(e){return this.solve(r.Matrix.diag(e))},inverse:function(){var t=this.V,n=this.threshold,e=t.length,o=t[0].length,s=new r.Matrix(e,this.s.length),a,i;for(a=0;a<e;a++)for(i=0;i<o;i++)s[a][i]=u(this.s[i])>n?t[a][i]/this.s[i]:0;var l=this.U,c=l.length,m=l[0].length,d=new r.Matrix(e,c),g,h;for(a=0;a<e;a++)for(i=0;i<c;i++){for(h=0,g=0;g<m;g++)h+=s[a][g]*l[i][g];d[a][i]=h}return d}},e.exports=o},function(e){'use strict';class t{constructor(e,t){if(e.length!==e[0].length)throw new Error('Confusion matrix must be square');if(t.length!==e.length)throw new Error('Confusion matrix and labels should have the same length');this.labels=t,this.matrix=e}static fromLabels(e,n,o={}){if(n.length!==e.length)throw new Error('predicted and actual must have the same length');var s;s=o.labels?new Set(o.labels):new Set([...e,...n]),s=Array.from(s),o.sort&&s.sort(o.sort);for(var r=Array.from({length:s.length}),a=0;a<r.length;a++)r[a]=Array(r.length),r[a].fill(0);for(var i=0;i<n.length;i++){var l=s.indexOf(e[i]),c=s.indexOf(n[i]);0<=l&&0<=c&&r[l][c]++}return new t(r,s)}getMatrix(){return this.matrix}getLabels(){return this.labels}getTotalCount(){for(var e=0,t=0;t<this.matrix.length;t++)for(var i=0;i<this.matrix.length;i++)e+=this.matrix[t][i];return e}getTrueCount(){for(var e=0,t=0;t<this.matrix.length;t++)e+=this.matrix[t][t];return e}getFalseCount(){return this.getTotalCount()-this.getTrueCount()}getTruePositiveCount(e){var t=this.getIndex(e);return this.matrix[t][t]}getTrueNegativeCount(e){for(var t=this.getIndex(e),n=0,o=0;o<this.matrix.length;o++)for(var i=0;i<this.matrix.length;i++)o!==t&&i!==t&&(n+=this.matrix[o][i]);return n}getFalsePositiveCount(e){for(var t=this.getIndex(e),n=0,o=0;o<this.matrix.length;o++)o!==t&&(n+=this.matrix[o][t]);return n}getFalseNegativeCount(e){for(var t=this.getIndex(e),n=0,o=0;o<this.matrix.length;o++)o!==t&&(n+=this.matrix[t][o]);return n}getPositiveCount(e){return this.getTruePositiveCount(e)+this.getFalseNegativeCount(e)}getNegativeCount(e){return this.getTrueNegativeCount(e)+this.getFalsePositiveCount(e)}getIndex(e){var t=this.labels.indexOf(e);if(-1===t)throw new Error('The label does not exist');return t}getTruePositiveRate(e){return this.getTruePositiveCount(e)/this.getPositiveCount(e)}getTrueNegativeRate(e){return this.getTrueNegativeCount(e)/this.getNegativeCount(e)}getPositivePredictiveValue(e){var t=this.getTruePositiveCount(e);return t/(t+this.getFalsePositiveCount(e))}getNegativePredictiveValue(e){var t=this.getTrueNegativeCount(e);return t/(t+this.getFalseNegativeCount(e))}getFalseNegativeRate(e){return 1-this.getTruePositiveRate(e)}getFalsePositiveRate(e){return 1-this.getTrueNegativeRate(e)}getFalseDiscoveryRate(e){var t=this.getFalsePositiveCount(e);return t/(t+this.getTruePositiveCount(e))}getFalseOmissionRate(e){var t=this.getFalseNegativeCount(e);return t/(t+this.getTruePositiveCount(e))}getF1Score(e){var t=this.getTruePositiveCount(e);return 2*t/(2*t+this.getFalsePositiveCount(e)+this.getFalseNegativeCount(e))}getMatthewsCorrelationCoefficient(e){var t=this.getTruePositiveCount(e),i=this.getTrueNegativeCount(e),n=this.getFalsePositiveCount(e),o=this.getFalseNegativeCount(e);return(t*i-n*o)/R((t+n)*(t+o)*(i+n)*(i+o))}getInformedness(e){return this.getTruePositiveRate(e)+this.getTrueNegativeRate(e)-1}getMarkedness(e){return this.getPositivePredictiveValue(e)+this.getNegativePredictiveValue(e)-1}getConfusionTable(e){return[[this.getTruePositiveCount(e),this.getFalseNegativeCount(e)],[this.getFalsePositiveCount(e),this.getTrueNegativeCount(e)]]}getAccuracy(){for(var e=0,t=0,n=0;n<this.matrix.length;n++)for(var i=0;i<this.matrix.length;i++)n===i?e+=this.matrix[n][i]:t+=this.matrix[n][i];return e/(e+t)}getCount(e,t){var i=this.getIndex(e),n=this.getIndex(t);return this.matrix[i][n]}get accuracy(){return this.getAccuracy()}get total(){return this.getTotalCount()}}e.exports=t},function(e,t,i){'use strict';function n(e,t){e&&(this.means=t.means,this.calculateProbabilities=t.calculateProbabilities)}function s(e,t,n){for(var s=0,r=-1,l=0,i;l<n.length;++l){i=n[l][0];for(var c=1;c<n[0][1].length+1;++c)i+=a(e[c-1],t[l][c-1],n[l][c][0],n[l][c][1]);i=o(i),i>s&&(s=i,r=l)}return r}function a(e,t,i,n){var e=e-t;return r(i*o(e*e/n))}function l(e,t){for(var n=e.columns,o=0,s=Array(100),r=0;r<t.length;r++)void 0===s[t[r]]&&(s[t[r]]=0,o++),s[t[r]]++;var i=Array(o),a=Array(o);for(r=0;r<o;++r)i[r]=new c(s[r],n),a[r]=0;for(r=0;r<e.rows;++r)i[t[r]].setRow(a[t[r]],e.getRow(r)),a[t[r]]++;return i}var c=i(276),u=i(2);e.exports.NaiveBayes=n,e.exports.separateClasses=l,n.prototype.train=function(e,t){var n=R(2*Math.PI);if(e=c.isMatrix(e)?e.clone():new c(e),e.rows!==t.length)throw new RangeError('the size of the training set and the training labels must be the same.');var o=l(e,t),s=Array(o.length);this.means=Array(o.length);for(var a=0;a<o.length;++a){var i=u.matrix.mean(o[a]),m=u.matrix.standardDeviation(o[a],i),d=r(o[a].rows/e.rows);s[a]=Array(i.length+1),s[a][0]=d;for(var g=1,h;g<i.length+1;++g)h=m[g-1],s[a][g]=[1/(n*h),-2*h*h];this.means[a]=i}this.calculateProbabilities=s},n.prototype.predict=function(e){if(e[0].length===this.calculateProbabilities[0].length)throw new RangeError('the dataset must have the same features as the training set');for(var t=Array(e.length),n=0;n<t.length;++n)t[n]=s(e[n],this.means,this.calculateProbabilities);return t},n.prototype.export=function(){return{modelName:'NaiveBayes',means:this.means,calculateProbabilities:this.calculateProbabilities}},n.load=function(e){if('NaiveBayes'!==e.modelName)throw new RangeError('The given model is invalid!');return new n(!0,e)}},function(e,t,i){'use strict';function n(e){function t(e,t){if(e.rows!==t.rows||e.columns!==t.columns)throw new RangeError('Matrices dimensions must be equal')}function n(e,t){return e-t}function x(e,t){for(var i in t)e=e.replace(new RegExp('%'+i+'%','g'),t[i]);return e}e===void 0&&(e=Object);class w extends e{static get[Symbol.species](){return this}static from1DArray(e,t,i){if(e*t!==i.length)throw new RangeError('Data length does not match given dimensions');for(var n=new this(e,t),o=0;o<e;o++)for(var s=0;s<t;s++)n.set(o,s,i[o*t+s]);return n}static rowVector(e){for(var t=new this(1,e.length),n=0;n<e.length;n++)t.set(0,n,e[n]);return t}static columnVector(e){for(var t=new this(e.length,1),n=0;n<e.length;n++)t.set(n,0,e[n]);return t}static empty(e,t){return new this(e,t)}static zeros(e,t){return this.empty(e,t).fill(0)}static ones(e,t){return this.empty(e,t).fill(1)}static rand(e,t,n){n===void 0&&(n=Math.random);for(var o=this.empty(e,t),s=0;s<e;s++)for(var i=0;i<t;i++)o.set(s,i,n());return o}static randInt(e,t,n,o){n===void 0&&(n=1e3),o===void 0&&(o=Math.random);for(var s=this.empty(e,t),r=0;r<e;r++)for(var i=0,a;i<t;i++)a=g(o()*n),s.set(r,i,a);return s}static eye(e,t,n){t===void 0&&(t=e),n===void 0&&(n=1);for(var o=v(e,t),s=this.zeros(e,t),r=0;r<o;r++)s.set(r,r,n);return s}static diag(e,t,n){var o=e.length;t===void 0&&(t=o),n===void 0&&(n=t);for(var s=v(o,t,n),r=this.zeros(t,n),a=0;a<s;a++)r.set(a,a,e[a]);return r}static min(e,t){e=this.checkMatrix(e),t=this.checkMatrix(t);for(var n=e.rows,o=e.columns,s=new this(n,o),r=0;r<n;r++)for(var i=0;i<o;i++)s.set(r,i,v(e.get(r,i),t.get(r,i)));return s}static max(e,t){e=this.checkMatrix(e),t=this.checkMatrix(t);for(var n=e.rows,o=e.columns,s=new this(n,o),r=0;r<n;r++)for(var i=0;i<o;i++)s.set(r,i,M(e.get(r,i),t.get(r,i)));return s}static checkMatrix(e){return w.isMatrix(e)?e:new this(e)}static isMatrix(e){return null!=e&&'Matrix'===e.klass}get size(){return this.rows*this.columns}apply(e){if('function'!=typeof e)throw new TypeError('callback must be a function');for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var i=0;i<n;i++)e.call(this,o,i);return this}to1DArray(){for(var e=Array(this.size),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e[t*this.columns+i]=this.get(t,i);return e}to2DArray(){for(var e=Array(this.rows),t=0;t<this.rows;t++){e[t]=Array(this.columns);for(var i=0;i<this.columns;i++)e[t][i]=this.get(t,i)}return e}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isSymmetric(){if(this.isSquare()){for(var e=0;e<this.rows;e++)for(var t=0;t<=e;t++)if(this.get(e,t)!==this.get(t,e))return!1;return!0}return!1}set(){throw new Error('set method is unimplemented')}get(){throw new Error('get method is unimplemented')}repeat(e,t){e=e||1,t=t||1;for(var n=new this.constructor[Symbol.species](this.rows*e,this.columns*t),o=0;o<e;o++)for(var i=0;i<t;i++)n.setSubMatrix(this,this.rows*o,this.columns*i);return n}fill(e){for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,e);return this}neg(){return this.mulS(-1)}getRow(e){l.checkRowIndex(this,e);for(var t=Array(this.columns),n=0;n<this.columns;n++)t[n]=this.get(e,n);return t}getRowVector(e){return this.constructor.rowVector(this.getRow(e))}setRow(e,t){l.checkRowIndex(this,e),t=l.checkRowVector(this,t);for(var n=0;n<this.columns;n++)this.set(e,n,t[n]);return this}swapRows(e,t){l.checkRowIndex(this,e),l.checkRowIndex(this,t);for(var n=0,i;n<this.columns;n++)i=this.get(e,n),this.set(e,n,this.get(t,n)),this.set(t,n,i);return this}getColumn(e){l.checkColumnIndex(this,e);for(var t=Array(this.rows),n=0;n<this.rows;n++)t[n]=this.get(n,e);return t}getColumnVector(e){return this.constructor.columnVector(this.getColumn(e))}setColumn(e,t){l.checkColumnIndex(this,e),t=l.checkColumnVector(this,t);for(var n=0;n<this.rows;n++)this.set(n,e,t[n]);return this}swapColumns(e,t){l.checkColumnIndex(this,e),l.checkColumnIndex(this,t);for(var n=0,i;n<this.rows;n++)i=this.get(n,e),this.set(n,e,this.get(n,t)),this.set(n,t,i);return this}addRowVector(e){e=l.checkRowVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)+e[i]);return this}subRowVector(e){e=l.checkRowVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)-e[i]);return this}mulRowVector(e){e=l.checkRowVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)*e[i]);return this}divRowVector(e){e=l.checkRowVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)/e[i]);return this}addColumnVector(e){e=l.checkColumnVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)+e[t]);return this}subColumnVector(e){e=l.checkColumnVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)-e[t]);return this}mulColumnVector(e){e=l.checkColumnVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)*e[t]);return this}divColumnVector(e){e=l.checkColumnVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)/e[t]);return this}mulRow(e,t){l.checkRowIndex(this,e);for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t);return this}mulColumn(e,t){l.checkColumnIndex(this,e);for(var n=0;n<this.rows;n++)this.set(n,e,this.get(n,e)*t);return this}max(){for(var e=this.get(0,0),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.get(t,i)>e&&(e=this.get(t,i));return e}maxIndex(){for(var e=this.get(0,0),t=[0,0],n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.get(n,i)>e&&(e=this.get(n,i),t[0]=n,t[1]=i);return t}min(){for(var e=this.get(0,0),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.get(t,i)<e&&(e=this.get(t,i));return e}minIndex(){for(var e=this.get(0,0),t=[0,0],n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.get(n,i)<e&&(e=this.get(n,i),t[0]=n,t[1]=i);return t}maxRow(e){l.checkRowIndex(this,e);for(var t=this.get(e,0),n=1;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n));return t}maxRowIndex(e){l.checkRowIndex(this,e);for(var t=this.get(e,0),n=[e,0],o=1;o<this.columns;o++)this.get(e,o)>t&&(t=this.get(e,o),n[1]=o);return n}minRow(e){l.checkRowIndex(this,e);for(var t=this.get(e,0),n=1;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n));return t}minRowIndex(e){l.checkRowIndex(this,e);for(var t=this.get(e,0),n=[e,0],o=1;o<this.columns;o++)this.get(e,o)<t&&(t=this.get(e,o),n[1]=o);return n}maxColumn(e){l.checkColumnIndex(this,e);for(var t=this.get(0,e),n=1;n<this.rows;n++)this.get(n,e)>t&&(t=this.get(n,e));return t}maxColumnIndex(e){l.checkColumnIndex(this,e);for(var t=this.get(0,e),n=[0,e],o=1;o<this.rows;o++)this.get(o,e)>t&&(t=this.get(o,e),n[0]=o);return n}minColumn(e){l.checkColumnIndex(this,e);for(var t=this.get(0,e),n=1;n<this.rows;n++)this.get(n,e)<t&&(t=this.get(n,e));return t}minColumnIndex(e){l.checkColumnIndex(this,e);for(var t=this.get(0,e),n=[0,e],o=1;o<this.rows;o++)this.get(o,e)<t&&(t=this.get(o,e),n[0]=o);return n}diag(){for(var e=v(this.rows,this.columns),t=Array(e),n=0;n<e;n++)t[n]=this.get(n,n);return t}sum(e){return'row'===e?l.sumByRow(this):'column'===e?l.sumByColumn(this):l.sumAll(this)}mean(){return this.sum()/this.size}prod(){for(var e=1,t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e*=this.get(t,i);return e}cumulativeSum(){for(var e=0,t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e+=this.get(t,i),this.set(t,i,e);return this}dot(e){w.isMatrix(e)&&(e=e.to1DArray());var t=this.to1DArray();if(t.length!==e.length)throw new RangeError('vectors do not have the same size');for(var n=0,o=0;o<t.length;o++)n+=t[o]*e[o];return n}mmul(e){e=this.constructor.checkMatrix(e),this.columns!==e.rows&&console.warn('Number of columns of left matrix are not equal to number of rows of right matrix.');for(var t=this.rows,o=this.columns,n=e.columns,r=new this.constructor[Symbol.species](t,n),a=Array(o),l=0;l<n;l++){for(var c=0;c<o;c++)a[c]=e.get(c,l);for(var u=0,i;u<t;u++){for(i=0,c=0;c<o;c++)i+=this.get(u,c)*a[c];r.set(u,l,i)}}return r}strassen2x2(e){var t=new this.constructor[Symbol.species](2,2),i=this.get(0,0),n=e.get(0,0),o=this.get(0,1),s=e.get(0,1),r=this.get(1,0),a=e.get(1,0),l=this.get(1,1),c=e.get(1,1),u=(i+l)*(n+c),m=(r+l)*n,d=i*(s-c),g=l*(a-n),h=(i+o)*c;return t.set(0,0,u+g-h+(o-l)*(a+c)),t.set(0,1,d+h),t.set(1,0,m+g),t.set(1,1,u-m+d+(r-i)*(n+s)),t}strassen3x3(e){var t=new this.constructor[Symbol.species](3,3),i=this.get(0,0),n=this.get(0,1),o=this.get(0,2),s=this.get(1,0),r=this.get(1,1),a=this.get(1,2),l=this.get(2,0),c=this.get(2,1),u=this.get(2,2),m=e.get(0,0),d=e.get(0,1),g=e.get(0,2),h=e.get(1,0),p=e.get(1,1),k=e.get(1,2),j=e.get(2,0),x=e.get(2,1),w=e.get(2,2),f=(i-s)*(-d+p),y=(-i+s+r)*(m-d+p),M=(s+r)*(-m+d),b=i*m,v=(-i+l+c)*(m-g+k),R=(-i+l)*(g-k),I=(l+c)*(-m+g),S=(-o+c+u)*(p+j-x),C=(o-u)*(p-x),V=o*j,D=(c+u)*(-j+x),z=(-o+r+a)*(k+j-w),_=(o-a)*(k-w),P=(r+a)*(-j+w);return t.set(0,0,b+V+n*h),t.set(0,1,(i+n+o-s-r-c-u)*p+y+M+b+S+V+D),t.set(0,2,b+v+I+(i+n+o-r-a-l-c)*k+V+z+P),t.set(1,0,f+r*(-m+d+h-p-k-j+w)+y+b+V+z+_),t.set(1,1,f+y+M+b+a*x),t.set(1,2,V+z+_+P+s*g),t.set(2,0,b+v+R+c*(-m+g+h-p-k-j+x)+S+C+V),t.set(2,1,S+C+V+D+l*d),t.set(2,2,b+v+R+I+u*w),t}mmulStrassen(e){function t(e,t,i){var n=e.rows,o=e.columns;if(n===t&&o===i)return e;var s=w.zeros(t,i);return s=s.setSubMatrix(e,0,0),s}function i(e,n,o,s){if(512>=o||512>=s)return e.mmul(n);1==o%2&&1==s%2?(e=t(e,o+1,s+1),n=t(n,o+1,s+1)):1==o%2?(e=t(e,o+1,s),n=t(n,o+1,s)):1==s%2&&(e=t(e,o,s+1),n=t(n,o,s+1));var r=parseInt(e.rows/2),a=parseInt(e.columns/2),l=e.subMatrix(0,r-1,0,a-1),c=n.subMatrix(0,r-1,0,a-1),u=e.subMatrix(0,r-1,a,e.columns-1),m=n.subMatrix(0,r-1,a,n.columns-1),d=e.subMatrix(r,e.rows-1,0,a-1),g=n.subMatrix(r,n.rows-1,0,a-1),h=e.subMatrix(r,e.rows-1,a,e.columns-1),p=n.subMatrix(r,n.rows-1,a,n.columns-1),k=i(w.add(l,h),w.add(c,p),r,a),j=i(w.add(d,h),c,r,a),x=i(l,w.sub(m,p),r,a),f=i(h,w.sub(g,c),r,a),y=i(w.add(l,u),p,r,a),M=i(w.sub(d,l),w.add(c,m),r,a),b=i(w.sub(u,h),w.add(g,p),r,a),v=w.add(k,f);v.sub(y),v.add(b);var R=w.add(x,y),I=w.add(j,f),S=w.sub(k,j);S.add(x),S.add(M);var C=w.zeros(2*v.rows,2*v.columns);return C=C.setSubMatrix(v,0,0),C=C.setSubMatrix(R,v.rows,0),C=C.setSubMatrix(I,0,v.columns),C=C.setSubMatrix(S,v.rows,v.columns),C.subMatrix(0,o-1,0,s-1)}var n=this.clone(),o=n.rows,s=n.columns,a=e.rows,l=e.columns;s!==a&&console.warn(`Multiplying ${o} x ${s} and ${a} x ${l} matrix: dimensions do not match.`);var u=M(o,a),r=M(s,l);return n=t(n,u,r),e=t(e,u,r),i(n,e,u,r)}scaleRows(e,t){if(e=void 0===e?0:e,t=void 0===t?1:t,e>=t)throw new RangeError('min should be strictly smaller than max');for(var n=this.constructor.empty(this.rows,this.columns),o=0,i;o<this.rows;o++)i=s.scale(this.getRow(o),{min:e,max:t}),n.setRow(o,i);return n}scaleColumns(e,t){if(e=void 0===e?0:e,t=void 0===t?1:t,e>=t)throw new RangeError('min should be strictly smaller than max');for(var n=this.constructor.empty(this.rows,this.columns),o=0,i;o<this.columns;o++)i=s.scale(this.getColumn(o),{min:e,max:t}),n.setColumn(o,i);return n}kroneckerProduct(e){e=this.constructor.checkMatrix(e);for(var t=this.rows,o=this.columns,n=e.rows,s=e.columns,r=new this.constructor[Symbol.species](t*n,o*s),a=0;a<t;a++)for(var i=0;i<o;i++)for(var c=0;c<n;c++)for(var u=0;u<s;u++)r[n*a+c][s*i+u]=this.get(a,i)*e.get(c,u);return r}transpose(){for(var e=new this.constructor[Symbol.species](this.columns,this.rows),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e.set(i,t,this.get(t,i));return e}sortRows(e){e===void 0&&(e=n);for(var t=0;t<this.rows;t++)this.setRow(t,this.getRow(t).sort(e));return this}sortColumns(e){e===void 0&&(e=n);for(var t=0;t<this.columns;t++)this.setColumn(t,this.getColumn(t).sort(e));return this}subMatrix(e,t,n,o){l.checkRange(this,e,t,n,o);for(var s=new this.constructor[Symbol.species](t-e+1,o-n+1),r=e;r<=t;r++)for(var i=n;i<=o;i++)s[r-e][i-n]=this.get(r,i);return s}subMatrixRow(e,t,n){if(void 0===t&&(t=0),void 0===n&&(n=this.columns-1),t>n||0>t||t>=this.columns||0>n||n>=this.columns)throw new RangeError('Argument out of range');for(var o=new this.constructor[Symbol.species](e.length,n-t+1),s=0;s<e.length;s++)for(var i=t;i<=n;i++){if(0>e[s]||e[s]>=this.rows)throw new RangeError('Row index out of range: '+e[s]);o.set(s,i-t,this.get(e[s],i))}return o}subMatrixColumn(e,t,n){if(void 0===t&&(t=0),void 0===n&&(n=this.rows-1),t>n||0>t||t>=this.rows||0>n||n>=this.rows)throw new RangeError('Argument out of range');for(var o=new this.constructor[Symbol.species](n-t+1,e.length),s=0;s<e.length;s++)for(var i=t;i<=n;i++){if(0>e[s]||e[s]>=this.columns)throw new RangeError('Column index out of range: '+e[s]);o.set(i-t,s,this.get(i,e[s]))}return o}setSubMatrix(e,t,n){e=this.constructor.checkMatrix(e);var o=t+e.rows-1,s=n+e.columns-1;l.checkRange(this,t,o,n,s);for(var r=0;r<e.rows;r++)for(var i=0;i<e.columns;i++)this[t+r][n+i]=e.get(r,i);return this}selection(e,t){for(var n=l.checkIndices(this,e,t),o=new this.constructor[Symbol.species](e.length,t.length),s=0,i;s<n.row.length;s++){i=n.row[s];for(var r=0,a;r<n.column.length;r++)a=n.column[r],o[s][r]=this.get(i,a)}return o}trace(){for(var e=v(this.rows,this.columns),t=0,n=0;n<e;n++)t+=this.get(n,n);return t}transposeView(){return new c(this)}rowView(e){return l.checkRowIndex(this,e),new m(this,e)}columnView(e){return l.checkColumnIndex(this,e),new p(this,e)}flipRowView(){return new k(this)}flipColumnView(){return new j(this)}subMatrixView(e,t,i,n){return new d(this,e,t,i,n)}selectionView(e,t){return new h(this,e,t)}det(){if(this.isSquare()){var e,t,i,n;if(2===this.columns)return e=this.get(0,0),t=this.get(0,1),i=this.get(1,0),n=this.get(1,1),e*n-t*i;if(3===this.columns){var s,r,a;return s=this.selectionView([1,2],[1,2]),r=this.selectionView([1,2],[0,2]),a=this.selectionView([1,2],[0,1]),e=this.get(0,0),t=this.get(0,1),i=this.get(0,2),e*s.det()-t*r.det()+i*a.det()}return new o(this).determinant}throw Error('Determinant can only be calculated for a square matrix.')}pseudoInverse(e){void 0===e&&(e=a);for(var t=new r(this,{autoTranspose:!0}),n=t.leftSingularVectors,o=t.rightSingularVectors,l=t.diagonal,s=0;s<l.length;s++)l[s]=u(l[s])>e?1/l[s]:0;return l=this.constructor[Symbol.species].diag(l),o.mmul(l.mmul(n.transposeView()))}}w.prototype.klass='Matrix',w.random=w.rand,w.diagonal=w.diag,w.prototype.diagonal=w.prototype.diag,w.identity=w.eye,w.prototype.negate=w.prototype.neg,w.prototype.tensorProduct=w.prototype.kroneckerProduct,w.prototype.determinant=w.prototype.det;var f=`
(function %name%(value) {
    if (typeof value === 'number') return this.%name%S(value);
    return this.%name%M(value);
})
`,y=`
(function %name%S(value) {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, this.get(i, j) %op% value);
        }
    }
    return this;
})
`,b=`
(function %name%M(matrix) {
    matrix = this.constructor.checkMatrix(matrix);
    checkDimensions(this, matrix);
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, this.get(i, j) %op% matrix.get(i, j));
        }
    }
    return this;
})
`,R=`
(function %name%(matrix, value) {
    var newMatrix = new this[Symbol.species](matrix);
    return newMatrix.%name%(value);
})
`,I=`
(function %name%() {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j)));
        }
    }
    return this;
})
`,S=`
(function %name%(matrix) {
    var newMatrix = new this[Symbol.species](matrix);
    return newMatrix.%name%();
})
`,C=`
(function %name%(%args%) {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j), %args%));
        }
    }
    return this;
})
`,V=`
(function %name%(matrix, %args%) {
    var newMatrix = new this[Symbol.species](matrix);
    return newMatrix.%name%(%args%);
})
`,D=`
(function %name%S(value) {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j), value));
        }
    }
    return this;
})
`,z=`
(function %name%M(matrix) {
    matrix = this.constructor.checkMatrix(matrix);
    checkDimensions(this, matrix);
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j), matrix.get(i, j)));
        }
    }
    return this;
})
`,_=`
(function %name%(value) {
    if (typeof value === 'number') return this.%name%S(value);
    return this.%name%M(value);
})
`,P=V,A=[['+','add'],['-','sub','subtract'],['*','mul','multiply'],['/','div','divide'],['%','mod','modulus'],['&','and'],['|','or'],['^','xor'],['<<','leftShift'],['>>','signPropagatingRightShift'],['>>>','rightShift','zeroFillRightShift']],L=!0,U=!1,F,i;try{for(var T=A[Symbol.iterator](),q;!(L=(q=T.next()).done);L=!0){var N=q.value,O=eval(x(f,{name:N[1],op:N[0]})),E=eval(x(y,{name:N[1]+'S',op:N[0]})),B=eval(x(b,{name:N[1]+'M',op:N[0]})),Q=eval(x(R,{name:N[1]}));for(F=1;F<N.length;F++)w.prototype[N[F]]=O,w.prototype[N[F]+'S']=E,w.prototype[N[F]+'M']=B,w[N[F]]=Q}}catch(e){U=!0,i=e}finally{try{!L&&T.return&&T.return()}finally{if(U)throw i}}var W=[['~','not']];['abs','acos','acosh','asin','asinh','atan','atanh','cbrt','ceil','clz32','cos','cosh','exp','expm1','floor','fround','log','log1p','log10','log2','round','sign','sin','sinh','sqrt','tan','tanh','trunc'].forEach(function(e){W.push(['Math.'+e,e])});var X=!0,J=!1,Y;try{for(var H=W[Symbol.iterator](),K;!(X=(K=H.next()).done);X=!0){var G=K.value,Z=eval(x(I,{name:G[1],method:G[0]})),$=eval(x(S,{name:G[1]}));for(F=1;F<G.length;F++)w.prototype[G[F]]=Z,w[G[F]]=$}}catch(e){J=!0,Y=e}finally{try{!X&&H.return&&H.return()}finally{if(J)throw Y}}var ee=[['Math.pow',1,'pow']],te=!0,ie=!1,ne;try{for(var oe=ee[Symbol.iterator](),se;!(te=(se=oe.next()).done);te=!0){var re=se.value,ae='arg0';for(F=1;F<re[1];F++)ae+=`, arg${F}`;if(1!==re[1]){var le=eval(x(C,{name:re[2],method:re[0],args:ae})),ce=eval(x(V,{name:re[2],args:ae}));for(F=2;F<re.length;F++)w.prototype[re[F]]=le,w[re[F]]=ce}else{var ue={name:re[2],args:ae,method:re[0]},me=eval(x(_,ue)),de=eval(x(D,ue)),ge=eval(x(z,ue)),he=eval(x(P,ue));for(F=2;F<re.length;F++)w.prototype[re[F]]=me,w.prototype[re[F]+'M']=ge,w.prototype[re[F]+'S']=de,w[re[F]]=he}}}catch(e){ie=!0,ne=e}finally{try{!te&&oe.return&&oe.return()}finally{if(ie)throw ne}}return w}e.exports=n;var o=i(89),r=i(90),s=i(1),l=i(29),c=i(278),m=i(279),d=i(280),h=i(281),p=i(282),k=i(283),j=i(284)},function(e,t,i){'use strict';function n(e){if(!(this instanceof n))return new n(e);e=o.Matrix.checkMatrix(e);var r=e.clone(),a=r.rows,l=r.columns,c=Array(a),m=1,d,i,g,h,p,s,t,k,j,x;for(d=0;d<a;d++)c[d]=d;for(j=Array(a),i=0;i<l;i++){for(d=0;d<a;d++)j[d]=r[d][i];for(d=0;d<a;d++){for(k=r[d],x=v(d,i),p=0,g=0;g<x;g++)p+=k[g]*j[g];k[i]=j[d]-=p}for(h=i,d=i+1;d<a;d++)u(j[d])>u(j[h])&&(h=d);if(h!==i){for(g=0;g<l;g++)s=r[h][g],r[h][g]=r[i][g],r[i][g]=s;t=c[h],c[h]=c[i],c[i]=t,m=-m}if(i<a&&0!==r[i][i])for(d=i+1;d<a;d++)r[d][i]/=r[i][i]}this.LU=r,this.pivotVector=c,this.pivotSign=m}var o=i(10);n.prototype={isSingular:function(){for(var e=this.LU,t=e.columns,i=0;i<t;i++)if(0===e[i][i])return!0;return!1},get determinant(){var e=this.LU;if(!e.isSquare())throw new Error('Matrix must be square');for(var t=this.pivotSign,i=e.columns,n=0;n<i;n++)t*=e[n][n];return t},get lowerTriangularMatrix(){for(var e=this.LU,t=e.rows,n=e.columns,s=new o.Matrix(t,n),r=0;r<t;r++)for(var i=0;i<n;i++)s[r][i]=r>i?e[r][i]:r===i?1:0;return s},get upperTriangularMatrix(){for(var e=this.LU,t=e.rows,n=e.columns,s=new o.Matrix(t,n),r=0;r<t;r++)for(var i=0;i<n;i++)s[r][i]=r<=i?e[r][i]:0;return s},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(e){e=o.Matrix.checkMatrix(e);var t=this.LU,n=t.rows;if(n!==e.rows)throw new Error('Invalid matrix dimensions');if(this.isSingular())throw new Error('LU matrix is singular');var s=e.columns,r=e.subMatrixRow(this.pivotVector,0,s-1),a=t.columns,l,i,c;for(c=0;c<a;c++)for(l=c+1;l<a;l++)for(i=0;i<s;i++)r[l][i]-=r[c][i]*t[l][c];for(c=a-1;0<=c;c--){for(i=0;i<s;i++)r[c][i]/=t[c][c];for(l=0;l<c;l++)for(i=0;i<s;i++)r[l][i]-=r[c][i]*t[l][c]}return r}},e.exports=n},function(e,t,i){'use strict';function o(h,x){if(!(this instanceof o))return new o(h,x);h=r.Matrix.checkMatrix(h),x=x||{};var w=h.rows,m=h.columns,n=v(w,m),y=!0,I=!0;!1===x.computeLeftSingularVectors&&(y=!1),!1===x.computeRightSingularVectors&&(I=!1);var S=!0===x.autoTranspose,C=!1,D;if(!(w<m))D=h.clone();else if(!S)D=h.clone(),console.warn('Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose');else{D=h.transpose(),w=D.rows,m=D.columns,C=!0;var a=y;y=I,I=a}var z=Array(v(w+1,m)),s=d(w,n,0),_=d(m,m,0),V=Array(m),e=Array(w),P=v(w-1,m),A=M(0,v(m-2,w)),L,i,j,k,p,U,F,f,T,q,N,O,E,B,Q,W,X,J,b,c,Y;for(j=0,q=M(P,A);j<q;j++){if(j<P){for(z[j]=0,L=j;L<w;L++)z[j]=l(z[j],D[L][j]);if(0!==z[j]){for(0>D[j][j]&&(z[j]=-z[j]),L=j;L<w;L++)D[L][j]/=z[j];D[j][j]+=1}z[j]=-z[j]}for(i=j+1;i<m;i++){if(j<P&&0!==z[j]){for(p=0,L=j;L<w;L++)p+=D[L][j]*D[L][i];for(p=-p/D[j][j],L=j;L<w;L++)D[L][i]+=p*D[L][j]}V[i]=D[j][i]}if(y&&j<P)for(L=j;L<w;L++)s[L][j]=D[L][j];if(j<A){for(V[j]=0,L=j+1;L<m;L++)V[j]=l(V[j],V[L]);if(0!==V[j]){for(0>V[j+1]&&(V[j]=0-V[j]),L=j+1;L<m;L++)V[L]/=V[j];V[j+1]+=1}if(V[j]=-V[j],j+1<w&&0!==V[j]){for(L=j+1;L<w;L++)e[L]=0;for(i=j+1;i<m;i++)for(L=j+1;L<w;L++)e[L]+=V[i]*D[L][i];for(i=j+1;i<m;i++)for(p=-V[i]/V[j+1],L=j+1;L<w;L++)D[L][i]+=p*e[L]}if(I)for(L=j+1;L<m;L++)_[L][j]=V[L]}}if(k=v(m,w+1),P<m&&(z[P]=D[P][P]),w<k&&(z[k-1]=0),A+1<k&&(V[A]=D[A][k-1]),V[k-1]=0,y){for(i=P;i<n;i++){for(L=0;L<w;L++)s[L][i]=0;s[i][i]=1}for(j=P-1;0<=j;j--)if(0!==z[j]){for(i=j+1;i<n;i++){for(p=0,L=j;L<w;L++)p+=s[L][j]*s[L][i];for(p=-p/s[j][j],L=j;L<w;L++)s[L][i]+=p*s[L][j]}for(L=j;L<w;L++)s[L][j]=-s[L][j];for(s[j][j]=1+s[j][j],L=0;L<j-1;L++)s[L][j]=0}else{for(L=0;L<w;L++)s[L][j]=0;s[j][j]=1}}if(I)for(j=m-1;0<=j;j--){if(j<A&&0!==V[j])for(i=j+1;i<m;i++){for(p=0,L=j+1;L<m;L++)p+=_[L][j]*_[L][i];for(p=-p/_[j+1][j],L=j+1;L<m;L++)_[L][i]+=p*_[L][j]}for(L=0;L<m;L++)_[L][j]=0;_[j][j]=1}for(var g=k-1,H=0,K=2.220446049250313e-16;0<k;){for(j=k-2;-1<=j&&-1!==j;j--)if(u(V[j])<=K*(u(z[j])+u(z[j+1]))){V[j]=0;break}if(j===k-2)N=4;else{for(U=k-1;U>=j&&U!==j;U--)if(p=(U===k?0:u(V[U]))+(U===j+1?0:u(V[U-1])),u(z[U])<=K*p){z[U]=0;break}U===j?N=3:U===k-1?N=1:(N=2,j=U)}switch(j++,N){case 1:{for(F=V[k-2],V[k-2]=0,i=k-2;i>=j;i--)if(p=l(z[i],F),f=z[i]/p,T=F/p,z[i]=p,i!==j&&(F=-T*V[i-1],V[i-1]=f*V[i-1]),I)for(L=0;L<m;L++)p=f*_[L][i]+T*_[L][k-1],_[L][k-1]=-T*_[L][i]+f*_[L][k-1],_[L][i]=p;break}case 2:{for(F=V[j-1],V[j-1]=0,i=j;i<k;i++)if(p=l(z[i],F),f=z[i]/p,T=F/p,z[i]=p,F=-T*V[i],V[i]=f*V[i],y)for(L=0;L<w;L++)p=f*s[L][i]+T*s[L][j-1],s[L][j-1]=-T*s[L][i]+f*s[L][j-1],s[L][i]=p;break}case 3:{for(O=M(M(M(M(u(z[k-1]),u(z[k-2])),u(V[k-2])),u(z[j])),u(V[j])),E=z[k-1]/O,B=z[k-2]/O,Q=V[k-2]/O,W=z[j]/O,X=V[j]/O,J=((B+E)*(B-E)+Q*Q)/2,b=E*Q*(E*Q),c=0,(0!==J||0!==b)&&(c=R(J*J+b),0>J&&(c=-c),c=b/(J+c)),F=(W+E)*(W-E)+c,Y=W*X,i=j;i<k-1;i++){if(p=l(F,Y),f=F/p,T=Y/p,i!==j&&(V[i-1]=p),F=f*z[i]+T*V[i],V[i]=f*V[i]-T*z[i],Y=T*z[i+1],z[i+1]=f*z[i+1],I)for(L=0;L<m;L++)p=f*_[L][i]+T*_[L][i+1],_[L][i+1]=-T*_[L][i]+f*_[L][i+1],_[L][i]=p;if(p=l(F,Y),f=F/p,T=Y/p,z[i]=p,F=f*V[i]+T*z[i+1],z[i+1]=-T*V[i]+f*z[i+1],Y=T*V[i+1],V[i+1]=f*V[i+1],y&&i<w-1)for(L=0;L<w;L++)p=f*s[L][i]+T*s[L][i+1],s[L][i+1]=-T*s[L][i]+f*s[L][i+1],s[L][i]=p}V[k-2]=F,++H;break}case 4:{if(0>=z[j]&&(z[j]=0>z[j]?-z[j]:0,I))for(L=0;L<=g;L++)_[L][j]=-_[L][j];for(;j<g&&!(z[j]>=z[j+1]);){if(p=z[j],z[j]=z[j+1],z[j+1]=p,I&&j<m-1)for(L=0;L<m;L++)p=_[L][j+1],_[L][j+1]=_[L][j],_[L][j]=p;if(y&&j<w-1)for(L=0;L<w;L++)p=s[L][j+1],s[L][j+1]=s[L][j],s[L][j]=p;j++}H=0,k--;break}}}if(C){var G=_;_=s,s=G}this.m=w,this.n=m,this.s=z,this.U=s,this.V=_}var r=i(10),n=i(44),l=n.hypotenuse,d=n.getFilled2DArray;o.prototype={get condition(){return this.s[0]/this.s[v(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var e=M(this.m,this.n)*this.s[0]*2.220446049250313e-16,t=0,n=this.s,o=0,i=n.length;o<i;o++)n[o]>e&&t++;return t},get diagonal(){return this.s},get threshold(){return 2.220446049250313e-16/2*M(this.m,this.n)*this.s[0]},get leftSingularVectors(){return r.Matrix.isMatrix(this.U)||(this.U=new r.Matrix(this.U)),this.U},get rightSingularVectors(){return r.Matrix.isMatrix(this.V)||(this.V=new r.Matrix(this.V)),this.V},get diagonalMatrix(){return r.Matrix.diag(this.s)},solve:function(t){var n=this.threshold,e=this.s.length,o=r.Matrix.zeros(e,e),s;for(s=0;s<e;s++)o[s][s]=u(this.s[s])<=n?0:1/this.s[s];var i=this.U,a=this.rightSingularVectors,l=a.mmul(o),c=a.rows,m=i.length,d=r.Matrix.zeros(c,m),g,h,p;for(s=0;s<c;s++)for(g=0;g<m;g++){for(p=0,h=0;h<e;h++)p+=l[s][h]*i[g][h];d[s][g]=p}return d.mmul(t)},solveForDiagonal:function(e){return this.solve(r.Matrix.diag(e))},inverse:function(){var t=this.V,n=this.threshold,e=t.length,o=t[0].length,s=new r.Matrix(e,this.s.length),a,i;for(a=0;a<e;a++)for(i=0;i<o;i++)s[a][i]=u(this.s[i])>n?t[a][i]/this.s[i]:0;var l=this.U,c=l.length,m=l[0].length,d=new r.Matrix(e,c),g,h;for(a=0;a<e;a++)for(i=0;i<c;i++){for(h=0,g=0;g<m;g++)h+=s[a][g]*l[i][g];d[a][i]=h}return d}},e.exports=o},function(e,t,i){'use strict';function n(e){function t(e,t){if(e.rows!==t.rows||e.columns!==t.columns)throw new RangeError('Matrices dimensions must be equal')}function n(e,t){return e-t}function x(e,t){for(var i in t)e=e.replace(new RegExp('%'+i+'%','g'),t[i]);return e}e===void 0&&(e=Object);class w extends e{static get[Symbol.species](){return this}static from1DArray(e,t,i){if(e*t!==i.length)throw new RangeError('Data length does not match given dimensions');for(var n=new this(e,t),o=0;o<e;o++)for(var s=0;s<t;s++)n.set(o,s,i[o*t+s]);return n}static rowVector(e){for(var t=new this(1,e.length),n=0;n<e.length;n++)t.set(0,n,e[n]);return t}static columnVector(e){for(var t=new this(e.length,1),n=0;n<e.length;n++)t.set(n,0,e[n]);return t}static empty(e,t){return new this(e,t)}static zeros(e,t){return this.empty(e,t).fill(0)}static ones(e,t){return this.empty(e,t).fill(1)}static rand(e,t,n){n===void 0&&(n=Math.random);for(var o=this.empty(e,t),s=0;s<e;s++)for(var i=0;i<t;i++)o.set(s,i,n());return o}static randInt(e,t,n,o){n===void 0&&(n=1e3),o===void 0&&(o=Math.random);for(var s=this.empty(e,t),r=0;r<e;r++)for(var i=0,a;i<t;i++)a=g(o()*n),s.set(r,i,a);return s}static eye(e,t,n){t===void 0&&(t=e),n===void 0&&(n=1);for(var o=v(e,t),s=this.zeros(e,t),r=0;r<o;r++)s.set(r,r,n);return s}static diag(e,t,n){var o=e.length;t===void 0&&(t=o),n===void 0&&(n=t);for(var s=v(o,t,n),r=this.zeros(t,n),a=0;a<s;a++)r.set(a,a,e[a]);return r}static min(e,t){e=this.checkMatrix(e),t=this.checkMatrix(t);for(var n=e.rows,o=e.columns,s=new this(n,o),r=0;r<n;r++)for(var i=0;i<o;i++)s.set(r,i,v(e.get(r,i),t.get(r,i)));return s}static max(e,t){e=this.checkMatrix(e),t=this.checkMatrix(t);for(var n=e.rows,o=e.columns,s=new this(n,o),r=0;r<n;r++)for(var i=0;i<o;i++)s.set(r,i,M(e.get(r,i),t.get(r,i)));return s}static checkMatrix(e){return w.isMatrix(e)?e:new this(e)}static isMatrix(e){return null!=e&&'Matrix'===e.klass}get size(){return this.rows*this.columns}apply(e){if('function'!=typeof e)throw new TypeError('callback must be a function');for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var i=0;i<n;i++)e.call(this,o,i);return this}to1DArray(){for(var e=Array(this.size),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e[t*this.columns+i]=this.get(t,i);return e}to2DArray(){for(var e=Array(this.rows),t=0;t<this.rows;t++){e[t]=Array(this.columns);for(var i=0;i<this.columns;i++)e[t][i]=this.get(t,i)}return e}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isSymmetric(){if(this.isSquare()){for(var e=0;e<this.rows;e++)for(var t=0;t<=e;t++)if(this.get(e,t)!==this.get(t,e))return!1;return!0}return!1}set(){throw new Error('set method is unimplemented')}get(){throw new Error('get method is unimplemented')}repeat(e,t){e=e||1,t=t||1;for(var n=new this.constructor[Symbol.species](this.rows*e,this.columns*t),o=0;o<e;o++)for(var i=0;i<t;i++)n.setSubMatrix(this,this.rows*o,this.columns*i);return n}fill(e){for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,e);return this}neg(){return this.mulS(-1)}getRow(e){l.checkRowIndex(this,e);for(var t=Array(this.columns),n=0;n<this.columns;n++)t[n]=this.get(e,n);return t}getRowVector(e){return this.constructor.rowVector(this.getRow(e))}setRow(e,t){l.checkRowIndex(this,e),t=l.checkRowVector(this,t);for(var n=0;n<this.columns;n++)this.set(e,n,t[n]);return this}swapRows(e,t){l.checkRowIndex(this,e),l.checkRowIndex(this,t);for(var n=0,i;n<this.columns;n++)i=this.get(e,n),this.set(e,n,this.get(t,n)),this.set(t,n,i);return this}getColumn(e){l.checkColumnIndex(this,e);for(var t=Array(this.rows),n=0;n<this.rows;n++)t[n]=this.get(n,e);return t}getColumnVector(e){return this.constructor.columnVector(this.getColumn(e))}setColumn(e,t){l.checkColumnIndex(this,e),t=l.checkColumnVector(this,t);for(var n=0;n<this.rows;n++)this.set(n,e,t[n]);return this}swapColumns(e,t){l.checkColumnIndex(this,e),l.checkColumnIndex(this,t);for(var n=0,i;n<this.rows;n++)i=this.get(n,e),this.set(n,e,this.get(n,t)),this.set(n,t,i);return this}addRowVector(e){e=l.checkRowVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)+e[i]);return this}subRowVector(e){e=l.checkRowVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)-e[i]);return this}mulRowVector(e){e=l.checkRowVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)*e[i]);return this}divRowVector(e){e=l.checkRowVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)/e[i]);return this}addColumnVector(e){e=l.checkColumnVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)+e[t]);return this}subColumnVector(e){e=l.checkColumnVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)-e[t]);return this}mulColumnVector(e){e=l.checkColumnVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)*e[t]);return this}divColumnVector(e){e=l.checkColumnVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)/e[t]);return this}mulRow(e,t){l.checkRowIndex(this,e);for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t);return this}mulColumn(e,t){l.checkColumnIndex(this,e);for(var n=0;n<this.rows;n++)this.set(n,e,this.get(n,e)*t);return this}max(){for(var e=this.get(0,0),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.get(t,i)>e&&(e=this.get(t,i));return e}maxIndex(){for(var e=this.get(0,0),t=[0,0],n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.get(n,i)>e&&(e=this.get(n,i),t[0]=n,t[1]=i);return t}min(){for(var e=this.get(0,0),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.get(t,i)<e&&(e=this.get(t,i));return e}minIndex(){for(var e=this.get(0,0),t=[0,0],n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.get(n,i)<e&&(e=this.get(n,i),t[0]=n,t[1]=i);return t}maxRow(e){l.checkRowIndex(this,e);for(var t=this.get(e,0),n=1;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n));return t}maxRowIndex(e){l.checkRowIndex(this,e);for(var t=this.get(e,0),n=[e,0],o=1;o<this.columns;o++)this.get(e,o)>t&&(t=this.get(e,o),n[1]=o);return n}minRow(e){l.checkRowIndex(this,e);for(var t=this.get(e,0),n=1;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n));return t}minRowIndex(e){l.checkRowIndex(this,e);for(var t=this.get(e,0),n=[e,0],o=1;o<this.columns;o++)this.get(e,o)<t&&(t=this.get(e,o),n[1]=o);return n}maxColumn(e){l.checkColumnIndex(this,e);for(var t=this.get(0,e),n=1;n<this.rows;n++)this.get(n,e)>t&&(t=this.get(n,e));return t}maxColumnIndex(e){l.checkColumnIndex(this,e);for(var t=this.get(0,e),n=[0,e],o=1;o<this.rows;o++)this.get(o,e)>t&&(t=this.get(o,e),n[0]=o);return n}minColumn(e){l.checkColumnIndex(this,e);for(var t=this.get(0,e),n=1;n<this.rows;n++)this.get(n,e)<t&&(t=this.get(n,e));return t}minColumnIndex(e){l.checkColumnIndex(this,e);for(var t=this.get(0,e),n=[0,e],o=1;o<this.rows;o++)this.get(o,e)<t&&(t=this.get(o,e),n[0]=o);return n}diag(){for(var e=v(this.rows,this.columns),t=Array(e),n=0;n<e;n++)t[n]=this.get(n,n);return t}sum(e){return'row'===e?l.sumByRow(this):'column'===e?l.sumByColumn(this):l.sumAll(this)}mean(){return this.sum()/this.size}prod(){for(var e=1,t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e*=this.get(t,i);return e}cumulativeSum(){for(var e=0,t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e+=this.get(t,i),this.set(t,i,e);return this}dot(e){w.isMatrix(e)&&(e=e.to1DArray());var t=this.to1DArray();if(t.length!==e.length)throw new RangeError('vectors do not have the same size');for(var n=0,o=0;o<t.length;o++)n+=t[o]*e[o];return n}mmul(e){e=this.constructor.checkMatrix(e),this.columns!==e.rows&&console.warn('Number of columns of left matrix are not equal to number of rows of right matrix.');for(var t=this.rows,o=this.columns,n=e.columns,r=new this.constructor[Symbol.species](t,n),a=Array(o),l=0;l<n;l++){for(var c=0;c<o;c++)a[c]=e.get(c,l);for(var u=0,i;u<t;u++){for(i=0,c=0;c<o;c++)i+=this.get(u,c)*a[c];r.set(u,l,i)}}return r}strassen2x2(e){var t=new this.constructor[Symbol.species](2,2),i=this.get(0,0),n=e.get(0,0),o=this.get(0,1),s=e.get(0,1),r=this.get(1,0),a=e.get(1,0),l=this.get(1,1),c=e.get(1,1),u=(i+l)*(n+c),m=(r+l)*n,d=i*(s-c),g=l*(a-n),h=(i+o)*c;return t.set(0,0,u+g-h+(o-l)*(a+c)),t.set(0,1,d+h),t.set(1,0,m+g),t.set(1,1,u-m+d+(r-i)*(n+s)),t}strassen3x3(e){var t=new this.constructor[Symbol.species](3,3),i=this.get(0,0),n=this.get(0,1),o=this.get(0,2),s=this.get(1,0),r=this.get(1,1),a=this.get(1,2),l=this.get(2,0),c=this.get(2,1),u=this.get(2,2),m=e.get(0,0),d=e.get(0,1),g=e.get(0,2),h=e.get(1,0),p=e.get(1,1),k=e.get(1,2),j=e.get(2,0),x=e.get(2,1),w=e.get(2,2),f=(i-s)*(-d+p),y=(-i+s+r)*(m-d+p),M=(s+r)*(-m+d),b=i*m,v=(-i+l+c)*(m-g+k),R=(-i+l)*(g-k),I=(l+c)*(-m+g),S=(-o+c+u)*(p+j-x),C=(o-u)*(p-x),V=o*j,D=(c+u)*(-j+x),z=(-o+r+a)*(k+j-w),_=(o-a)*(k-w),P=(r+a)*(-j+w);return t.set(0,0,b+V+n*h),t.set(0,1,(i+n+o-s-r-c-u)*p+y+M+b+S+V+D),t.set(0,2,b+v+I+(i+n+o-r-a-l-c)*k+V+z+P),t.set(1,0,f+r*(-m+d+h-p-k-j+w)+y+b+V+z+_),t.set(1,1,f+y+M+b+a*x),t.set(1,2,V+z+_+P+s*g),t.set(2,0,b+v+R+c*(-m+g+h-p-k-j+x)+S+C+V),t.set(2,1,S+C+V+D+l*d),t.set(2,2,b+v+R+I+u*w),t}mmulStrassen(e){function t(e,t,i){var n=e.rows,o=e.columns;if(n===t&&o===i)return e;var s=w.zeros(t,i);return s=s.setSubMatrix(e,0,0),s}function i(e,n,o,s){if(512>=o||512>=s)return e.mmul(n);1==o%2&&1==s%2?(e=t(e,o+1,s+1),n=t(n,o+1,s+1)):1==o%2?(e=t(e,o+1,s),n=t(n,o+1,s)):1==s%2&&(e=t(e,o,s+1),n=t(n,o,s+1));var r=parseInt(e.rows/2),a=parseInt(e.columns/2),l=e.subMatrix(0,r-1,0,a-1),c=n.subMatrix(0,r-1,0,a-1),u=e.subMatrix(0,r-1,a,e.columns-1),m=n.subMatrix(0,r-1,a,n.columns-1),d=e.subMatrix(r,e.rows-1,0,a-1),g=n.subMatrix(r,n.rows-1,0,a-1),h=e.subMatrix(r,e.rows-1,a,e.columns-1),p=n.subMatrix(r,n.rows-1,a,n.columns-1),k=i(w.add(l,h),w.add(c,p),r,a),j=i(w.add(d,h),c,r,a),x=i(l,w.sub(m,p),r,a),f=i(h,w.sub(g,c),r,a),y=i(w.add(l,u),p,r,a),M=i(w.sub(d,l),w.add(c,m),r,a),b=i(w.sub(u,h),w.add(g,p),r,a),v=w.add(k,f);v.sub(y),v.add(b);var R=w.add(x,y),I=w.add(j,f),S=w.sub(k,j);S.add(x),S.add(M);var C=w.zeros(2*v.rows,2*v.columns);return C=C.setSubMatrix(v,0,0),C=C.setSubMatrix(R,v.rows,0),C=C.setSubMatrix(I,0,v.columns),C=C.setSubMatrix(S,v.rows,v.columns),C.subMatrix(0,o-1,0,s-1)}var n=this.clone(),o=n.rows,s=n.columns,a=e.rows,l=e.columns;s!==a&&console.warn(`Multiplying ${o} x ${s} and ${a} x ${l} matrix: dimensions do not match.`);var u=M(o,a),r=M(s,l);return n=t(n,u,r),e=t(e,u,r),i(n,e,u,r)}scaleRows(e,t){if(e=void 0===e?0:e,t=void 0===t?1:t,e>=t)throw new RangeError('min should be strictly smaller than max');for(var n=this.constructor.empty(this.rows,this.columns),o=0,i;o<this.rows;o++)i=s.scale(this.getRow(o),{min:e,max:t}),n.setRow(o,i);return n}scaleColumns(e,t){if(e=void 0===e?0:e,t=void 0===t?1:t,e>=t)throw new RangeError('min should be strictly smaller than max');for(var n=this.constructor.empty(this.rows,this.columns),o=0,i;o<this.columns;o++)i=s.scale(this.getColumn(o),{min:e,max:t}),n.setColumn(o,i);return n}kroneckerProduct(e){e=this.constructor.checkMatrix(e);for(var t=this.rows,o=this.columns,n=e.rows,s=e.columns,r=new this.constructor[Symbol.species](t*n,o*s),a=0;a<t;a++)for(var i=0;i<o;i++)for(var c=0;c<n;c++)for(var u=0;u<s;u++)r[n*a+c][s*i+u]=this.get(a,i)*e.get(c,u);return r}transpose(){for(var e=new this.constructor[Symbol.species](this.columns,this.rows),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e.set(i,t,this.get(t,i));return e}sortRows(e){e===void 0&&(e=n);for(var t=0;t<this.rows;t++)this.setRow(t,this.getRow(t).sort(e));return this}sortColumns(e){e===void 0&&(e=n);for(var t=0;t<this.columns;t++)this.setColumn(t,this.getColumn(t).sort(e));return this}subMatrix(e,t,n,o){l.checkRange(this,e,t,n,o);for(var s=new this.constructor[Symbol.species](t-e+1,o-n+1),r=e;r<=t;r++)for(var i=n;i<=o;i++)s[r-e][i-n]=this.get(r,i);return s}subMatrixRow(e,t,n){if(void 0===t&&(t=0),void 0===n&&(n=this.columns-1),t>n||0>t||t>=this.columns||0>n||n>=this.columns)throw new RangeError('Argument out of range');for(var o=new this.constructor[Symbol.species](e.length,n-t+1),s=0;s<e.length;s++)for(var i=t;i<=n;i++){if(0>e[s]||e[s]>=this.rows)throw new RangeError('Row index out of range: '+e[s]);o.set(s,i-t,this.get(e[s],i))}return o}subMatrixColumn(e,t,n){if(void 0===t&&(t=0),void 0===n&&(n=this.rows-1),t>n||0>t||t>=this.rows||0>n||n>=this.rows)throw new RangeError('Argument out of range');for(var o=new this.constructor[Symbol.species](n-t+1,e.length),s=0;s<e.length;s++)for(var i=t;i<=n;i++){if(0>e[s]||e[s]>=this.columns)throw new RangeError('Column index out of range: '+e[s]);o.set(i-t,s,this.get(i,e[s]))}return o}setSubMatrix(e,t,n){e=this.constructor.checkMatrix(e);var o=t+e.rows-1,s=n+e.columns-1;l.checkRange(this,t,o,n,s);for(var r=0;r<e.rows;r++)for(var i=0;i<e.columns;i++)this[t+r][n+i]=e.get(r,i);return this}selection(e,t){for(var n=l.checkIndices(this,e,t),o=new this.constructor[Symbol.species](e.length,t.length),s=0,i;s<n.row.length;s++){i=n.row[s];for(var r=0,a;r<n.column.length;r++)a=n.column[r],o[s][r]=this.get(i,a)}return o}trace(){for(var e=v(this.rows,this.columns),t=0,n=0;n<e;n++)t+=this.get(n,n);return t}transposeView(){return new c(this)}rowView(e){return l.checkRowIndex(this,e),new m(this,e)}columnView(e){return l.checkColumnIndex(this,e),new p(this,e)}flipRowView(){return new k(this)}flipColumnView(){return new j(this)}subMatrixView(e,t,i,n){return new d(this,e,t,i,n)}selectionView(e,t){return new h(this,e,t)}det(){if(this.isSquare()){var e,t,i,n;if(2===this.columns)return e=this.get(0,0),t=this.get(0,1),i=this.get(1,0),n=this.get(1,1),e*n-t*i;if(3===this.columns){var s,r,a;return s=this.selectionView([1,2],[1,2]),r=this.selectionView([1,2],[0,2]),a=this.selectionView([1,2],[0,1]),e=this.get(0,0),t=this.get(0,1),i=this.get(0,2),e*s.det()-t*r.det()+i*a.det()}return new o(this).determinant}throw Error('Determinant can only be calculated for a square matrix.')}pseudoInverse(e){void 0===e&&(e=a);for(var t=new r(this,{autoTranspose:!0}),n=t.leftSingularVectors,o=t.rightSingularVectors,l=t.diagonal,s=0;s<l.length;s++)l[s]=u(l[s])>e?1/l[s]:0;return l=this.constructor[Symbol.species].diag(l),o.mmul(l.mmul(n.transposeView()))}}w.prototype.klass='Matrix',w.random=w.rand,w.diagonal=w.diag,w.prototype.diagonal=w.prototype.diag,w.identity=w.eye,w.prototype.negate=w.prototype.neg,w.prototype.tensorProduct=w.prototype.kroneckerProduct,w.prototype.determinant=w.prototype.det;var f=`
(function %name%(value) {
    if (typeof value === 'number') return this.%name%S(value);
    return this.%name%M(value);
})
`,y=`
(function %name%S(value) {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, this.get(i, j) %op% value);
        }
    }
    return this;
})
`,b=`
(function %name%M(matrix) {
    matrix = this.constructor.checkMatrix(matrix);
    checkDimensions(this, matrix);
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, this.get(i, j) %op% matrix.get(i, j));
        }
    }
    return this;
})
`,R=`
(function %name%(matrix, value) {
    var newMatrix = new this[Symbol.species](matrix);
    return newMatrix.%name%(value);
})
`,I=`
(function %name%() {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j)));
        }
    }
    return this;
})
`,S=`
(function %name%(matrix) {
    var newMatrix = new this[Symbol.species](matrix);
    return newMatrix.%name%();
})
`,C=`
(function %name%(%args%) {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j), %args%));
        }
    }
    return this;
})
`,V=`
(function %name%(matrix, %args%) {
    var newMatrix = new this[Symbol.species](matrix);
    return newMatrix.%name%(%args%);
})
`,D=`
(function %name%S(value) {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j), value));
        }
    }
    return this;
})
`,z=`
(function %name%M(matrix) {
    matrix = this.constructor.checkMatrix(matrix);
    checkDimensions(this, matrix);
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j), matrix.get(i, j)));
        }
    }
    return this;
})
`,_=`
(function %name%(value) {
    if (typeof value === 'number') return this.%name%S(value);
    return this.%name%M(value);
})
`,P=V,A=[['+','add'],['-','sub','subtract'],['*','mul','multiply'],['/','div','divide'],['%','mod','modulus'],['&','and'],['|','or'],['^','xor'],['<<','leftShift'],['>>','signPropagatingRightShift'],['>>>','rightShift','zeroFillRightShift']],L=!0,U=!1,F,i;try{for(var T=A[Symbol.iterator](),q;!(L=(q=T.next()).done);L=!0){var N=q.value,O=eval(x(f,{name:N[1],op:N[0]})),E=eval(x(y,{name:N[1]+'S',op:N[0]})),B=eval(x(b,{name:N[1]+'M',op:N[0]})),Q=eval(x(R,{name:N[1]}));for(F=1;F<N.length;F++)w.prototype[N[F]]=O,w.prototype[N[F]+'S']=E,w.prototype[N[F]+'M']=B,w[N[F]]=Q}}catch(e){U=!0,i=e}finally{try{!L&&T.return&&T.return()}finally{if(U)throw i}}var W=[['~','not']];['abs','acos','acosh','asin','asinh','atan','atanh','cbrt','ceil','clz32','cos','cosh','exp','expm1','floor','fround','log','log1p','log10','log2','round','sign','sin','sinh','sqrt','tan','tanh','trunc'].forEach(function(e){W.push(['Math.'+e,e])});var X=!0,J=!1,Y;try{for(var H=W[Symbol.iterator](),K;!(X=(K=H.next()).done);X=!0){var G=K.value,Z=eval(x(I,{name:G[1],method:G[0]})),$=eval(x(S,{name:G[1]}));for(F=1;F<G.length;F++)w.prototype[G[F]]=Z,w[G[F]]=$}}catch(e){J=!0,Y=e}finally{try{!X&&H.return&&H.return()}finally{if(J)throw Y}}var ee=[['Math.pow',1,'pow']],te=!0,ie=!1,ne;try{for(var oe=ee[Symbol.iterator](),se;!(te=(se=oe.next()).done);te=!0){var re=se.value,ae='arg0';for(F=1;F<re[1];F++)ae+=`, arg${F}`;if(1!==re[1]){var le=eval(x(C,{name:re[2],method:re[0],args:ae})),ce=eval(x(V,{name:re[2],args:ae}));for(F=2;F<re.length;F++)w.prototype[re[F]]=le,w[re[F]]=ce}else{var ue={name:re[2],args:ae,method:re[0]},me=eval(x(_,ue)),de=eval(x(D,ue)),ge=eval(x(z,ue)),he=eval(x(P,ue));for(F=2;F<re.length;F++)w.prototype[re[F]]=me,w.prototype[re[F]+'M']=ge,w.prototype[re[F]+'S']=de,w[re[F]]=he}}}catch(e){ie=!0,ne=e}finally{try{!te&&oe.return&&oe.return()}finally{if(ie)throw ne}}return w}e.exports=n;var o=i(92),r=i(93),s=i(1),l=i(30),c=i(292),m=i(293),d=i(294),h=i(295),p=i(296),k=i(297),j=i(298)},function(e,t,i){'use strict';function n(e){if(!(this instanceof n))return new n(e);e=o.Matrix.checkMatrix(e);var r=e.clone(),a=r.rows,l=r.columns,c=Array(a),m=1,d,i,g,h,p,s,t,k,j,x;for(d=0;d<a;d++)c[d]=d;for(j=Array(a),i=0;i<l;i++){for(d=0;d<a;d++)j[d]=r[d][i];for(d=0;d<a;d++){for(k=r[d],x=v(d,i),p=0,g=0;g<x;g++)p+=k[g]*j[g];k[i]=j[d]-=p}for(h=i,d=i+1;d<a;d++)u(j[d])>u(j[h])&&(h=d);if(h!==i){for(g=0;g<l;g++)s=r[h][g],r[h][g]=r[i][g],r[i][g]=s;t=c[h],c[h]=c[i],c[i]=t,m=-m}if(i<a&&0!==r[i][i])for(d=i+1;d<a;d++)r[d][i]/=r[i][i]}this.LU=r,this.pivotVector=c,this.pivotSign=m}var o=i(11);n.prototype={isSingular:function(){for(var e=this.LU,t=e.columns,i=0;i<t;i++)if(0===e[i][i])return!0;return!1},get determinant(){var e=this.LU;if(!e.isSquare())throw new Error('Matrix must be square');for(var t=this.pivotSign,i=e.columns,n=0;n<i;n++)t*=e[n][n];return t},get lowerTriangularMatrix(){for(var e=this.LU,t=e.rows,n=e.columns,s=new o.Matrix(t,n),r=0;r<t;r++)for(var i=0;i<n;i++)s[r][i]=r>i?e[r][i]:r===i?1:0;return s},get upperTriangularMatrix(){for(var e=this.LU,t=e.rows,n=e.columns,s=new o.Matrix(t,n),r=0;r<t;r++)for(var i=0;i<n;i++)s[r][i]=r<=i?e[r][i]:0;return s},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(e){e=o.Matrix.checkMatrix(e);var t=this.LU,n=t.rows;if(n!==e.rows)throw new Error('Invalid matrix dimensions');if(this.isSingular())throw new Error('LU matrix is singular');var s=e.columns,r=e.subMatrixRow(this.pivotVector,0,s-1),a=t.columns,l,i,c;for(c=0;c<a;c++)for(l=c+1;l<a;l++)for(i=0;i<s;i++)r[l][i]-=r[c][i]*t[l][c];for(c=a-1;0<=c;c--){for(i=0;i<s;i++)r[c][i]/=t[c][c];for(l=0;l<c;l++)for(i=0;i<s;i++)r[l][i]-=r[c][i]*t[l][c]}return r}},e.exports=n},function(e,t,i){'use strict';function o(h,x){if(!(this instanceof o))return new o(h,x);h=r.Matrix.checkMatrix(h),x=x||{};var w=h.rows,m=h.columns,n=v(w,m),y=!0,I=!0;!1===x.computeLeftSingularVectors&&(y=!1),!1===x.computeRightSingularVectors&&(I=!1);var S=!0===x.autoTranspose,C=!1,D;if(!(w<m))D=h.clone();else if(!S)D=h.clone(),console.warn('Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose');else{D=h.transpose(),w=D.rows,m=D.columns,C=!0;var a=y;y=I,I=a}var z=Array(v(w+1,m)),s=d(w,n,0),_=d(m,m,0),V=Array(m),e=Array(w),P=v(w-1,m),A=M(0,v(m-2,w)),L,i,j,k,p,U,F,f,T,q,N,O,E,B,Q,W,X,J,b,c,Y;for(j=0,q=M(P,A);j<q;j++){if(j<P){for(z[j]=0,L=j;L<w;L++)z[j]=l(z[j],D[L][j]);if(0!==z[j]){for(0>D[j][j]&&(z[j]=-z[j]),L=j;L<w;L++)D[L][j]/=z[j];D[j][j]+=1}z[j]=-z[j]}for(i=j+1;i<m;i++){if(j<P&&0!==z[j]){for(p=0,L=j;L<w;L++)p+=D[L][j]*D[L][i];for(p=-p/D[j][j],L=j;L<w;L++)D[L][i]+=p*D[L][j]}V[i]=D[j][i]}if(y&&j<P)for(L=j;L<w;L++)s[L][j]=D[L][j];if(j<A){for(V[j]=0,L=j+1;L<m;L++)V[j]=l(V[j],V[L]);if(0!==V[j]){for(0>V[j+1]&&(V[j]=0-V[j]),L=j+1;L<m;L++)V[L]/=V[j];V[j+1]+=1}if(V[j]=-V[j],j+1<w&&0!==V[j]){for(L=j+1;L<w;L++)e[L]=0;for(i=j+1;i<m;i++)for(L=j+1;L<w;L++)e[L]+=V[i]*D[L][i];for(i=j+1;i<m;i++)for(p=-V[i]/V[j+1],L=j+1;L<w;L++)D[L][i]+=p*e[L]}if(I)for(L=j+1;L<m;L++)_[L][j]=V[L]}}if(k=v(m,w+1),P<m&&(z[P]=D[P][P]),w<k&&(z[k-1]=0),A+1<k&&(V[A]=D[A][k-1]),V[k-1]=0,y){for(i=P;i<n;i++){for(L=0;L<w;L++)s[L][i]=0;s[i][i]=1}for(j=P-1;0<=j;j--)if(0!==z[j]){for(i=j+1;i<n;i++){for(p=0,L=j;L<w;L++)p+=s[L][j]*s[L][i];for(p=-p/s[j][j],L=j;L<w;L++)s[L][i]+=p*s[L][j]}for(L=j;L<w;L++)s[L][j]=-s[L][j];for(s[j][j]=1+s[j][j],L=0;L<j-1;L++)s[L][j]=0}else{for(L=0;L<w;L++)s[L][j]=0;s[j][j]=1}}if(I)for(j=m-1;0<=j;j--){if(j<A&&0!==V[j])for(i=j+1;i<m;i++){for(p=0,L=j+1;L<m;L++)p+=_[L][j]*_[L][i];for(p=-p/_[j+1][j],L=j+1;L<m;L++)_[L][i]+=p*_[L][j]}for(L=0;L<m;L++)_[L][j]=0;_[j][j]=1}for(var g=k-1,H=0,K=2.220446049250313e-16;0<k;){for(j=k-2;-1<=j&&-1!==j;j--)if(u(V[j])<=K*(u(z[j])+u(z[j+1]))){V[j]=0;break}if(j===k-2)N=4;else{for(U=k-1;U>=j&&U!==j;U--)if(p=(U===k?0:u(V[U]))+(U===j+1?0:u(V[U-1])),u(z[U])<=K*p){z[U]=0;break}U===j?N=3:U===k-1?N=1:(N=2,j=U)}switch(j++,N){case 1:{for(F=V[k-2],V[k-2]=0,i=k-2;i>=j;i--)if(p=l(z[i],F),f=z[i]/p,T=F/p,z[i]=p,i!==j&&(F=-T*V[i-1],V[i-1]=f*V[i-1]),I)for(L=0;L<m;L++)p=f*_[L][i]+T*_[L][k-1],_[L][k-1]=-T*_[L][i]+f*_[L][k-1],_[L][i]=p;break}case 2:{for(F=V[j-1],V[j-1]=0,i=j;i<k;i++)if(p=l(z[i],F),f=z[i]/p,T=F/p,z[i]=p,F=-T*V[i],V[i]=f*V[i],y)for(L=0;L<w;L++)p=f*s[L][i]+T*s[L][j-1],s[L][j-1]=-T*s[L][i]+f*s[L][j-1],s[L][i]=p;break}case 3:{for(O=M(M(M(M(u(z[k-1]),u(z[k-2])),u(V[k-2])),u(z[j])),u(V[j])),E=z[k-1]/O,B=z[k-2]/O,Q=V[k-2]/O,W=z[j]/O,X=V[j]/O,J=((B+E)*(B-E)+Q*Q)/2,b=E*Q*(E*Q),c=0,(0!==J||0!==b)&&(c=R(J*J+b),0>J&&(c=-c),c=b/(J+c)),F=(W+E)*(W-E)+c,Y=W*X,i=j;i<k-1;i++){if(p=l(F,Y),f=F/p,T=Y/p,i!==j&&(V[i-1]=p),F=f*z[i]+T*V[i],V[i]=f*V[i]-T*z[i],Y=T*z[i+1],z[i+1]=f*z[i+1],I)for(L=0;L<m;L++)p=f*_[L][i]+T*_[L][i+1],_[L][i+1]=-T*_[L][i]+f*_[L][i+1],_[L][i]=p;if(p=l(F,Y),f=F/p,T=Y/p,z[i]=p,F=f*V[i]+T*z[i+1],z[i+1]=-T*V[i]+f*z[i+1],Y=T*V[i+1],V[i+1]=f*V[i+1],y&&i<w-1)for(L=0;L<w;L++)p=f*s[L][i]+T*s[L][i+1],s[L][i+1]=-T*s[L][i]+f*s[L][i+1],s[L][i]=p}V[k-2]=F,++H;break}case 4:{if(0>=z[j]&&(z[j]=0>z[j]?-z[j]:0,I))for(L=0;L<=g;L++)_[L][j]=-_[L][j];for(;j<g&&!(z[j]>=z[j+1]);){if(p=z[j],z[j]=z[j+1],z[j+1]=p,I&&j<m-1)for(L=0;L<m;L++)p=_[L][j+1],_[L][j+1]=_[L][j],_[L][j]=p;if(y&&j<w-1)for(L=0;L<w;L++)p=s[L][j+1],s[L][j+1]=s[L][j],s[L][j]=p;j++}H=0,k--;break}}}if(C){var G=_;_=s,s=G}this.m=w,this.n=m,this.s=z,this.U=s,this.V=_}var r=i(11),n=i(46),l=n.hypotenuse,d=n.getFilled2DArray;o.prototype={get condition(){return this.s[0]/this.s[v(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var e=M(this.m,this.n)*this.s[0]*2.220446049250313e-16,t=0,n=this.s,o=0,i=n.length;o<i;o++)n[o]>e&&t++;return t},get diagonal(){return this.s},get threshold(){return 2.220446049250313e-16/2*M(this.m,this.n)*this.s[0]},get leftSingularVectors(){return r.Matrix.isMatrix(this.U)||(this.U=new r.Matrix(this.U)),this.U},get rightSingularVectors(){return r.Matrix.isMatrix(this.V)||(this.V=new r.Matrix(this.V)),this.V},get diagonalMatrix(){return r.Matrix.diag(this.s)},solve:function(t){var n=this.threshold,e=this.s.length,o=r.Matrix.zeros(e,e),s;for(s=0;s<e;s++)o[s][s]=u(this.s[s])<=n?0:1/this.s[s];var i=this.U,a=this.rightSingularVectors,l=a.mmul(o),c=a.rows,m=i.length,d=r.Matrix.zeros(c,m),g,h,p;for(s=0;s<c;s++)for(g=0;g<m;g++){for(p=0,h=0;h<e;h++)p+=l[s][h]*i[g][h];d[s][g]=p}return d.mmul(t)},solveForDiagonal:function(e){return this.solve(r.Matrix.diag(e))},inverse:function(){var t=this.V,n=this.threshold,e=t.length,o=t[0].length,s=new r.Matrix(e,this.s.length),a,i;for(a=0;a<e;a++)for(i=0;i<o;i++)s[a][i]=u(this.s[i])>n?t[a][i]/this.s[i]:0;var l=this.U,c=l.length,m=l[0].length,d=new r.Matrix(e,c),g,h;for(a=0;a<e;a++)for(i=0;i<c;i++){for(h=0,g=0;g<m;g++)h+=s[a][g]*l[i][g];d[a][i]=h}return d}},e.exports=o},function(e,t,i){'use strict';var n=i(305);t.updateClusterID=function(e,t,o,s){for(var r=0;r<e.length;r++)o[r]=n(t,e[r],{distanceFunction:s});return o},t.updateCenters=function(e,t,n){for(var o=e[0].length,s=Array(n),r=Array(n),a=0;a<n;a++){s[a]=Array(o),r[a]=0;for(var i=0;i<o;i++)s[a][i]=0}for(var c=0;c<e.length;c++){r[t[c]]++;for(var l=0;l<o;l++)s[t[c]][l]+=e[c][l]}for(var u=0;u<n;u++)for(var m=0;m<o;m++)s[u][m]/=r[u];return s},t.calculateDistanceMatrix=function(e,t){for(var n=Array(e.length),o=0;o<e.length;++o)for(var i=o;i<e.length;++i){n[o]||(n[o]=Array(e.length)),n[i]||(n[i]=Array(e.length));var s=t(e[o],e[i]);n[o][i]=s,n[i][o]=s}return n},t.converged=function(e,t,n,o){for(var s=0;s<e.length;s++)if(n(e[s],t[s])>o)return!1;return!0}},function(e,t,i){'use strict';function n(e){o.call(this),this.index=e,this.distance=0,this.children=[]}var o=i(48),s=i(313);s.inherits(n,o),e.exports=n},function(e){'use strict';function t(e,t,i,n){this.x=e,this.y=t,this.weights=i,this.som=n,this.neighbors={}}t.prototype.adjustWeights=function(e,t,n){for(var o=0,i=this.weights.length;o<i;o++)this.weights[o]+=t*n*(e[o]-this.weights[o])},t.prototype.getDistance=function(e){return M(u(this.x-e.x),u(this.y-e.y))},t.prototype.getDistanceTorus=function(e){var t=u(this.x-e.x),i=u(this.y-e.y);return M(v(t,this.som.gridDim.x-t),v(i,this.som.gridDim.y-i))},t.prototype.getNeighbors=function(e){if(!this.neighbors[e]){this.neighbors[e]=[,,];var t;if(0<this[e]?t=this[e]-1:this.som.torus&&(t=this.som.gridDim[e]-1),'undefined'!=typeof t){var i,n;'x'===e?(i=t,n=this.y):(i=this.x,n=t),this.neighbors[e][0]=this.som.nodes[i][n]}var o;this[e]<this.som.gridDim[e]-1?o=this[e]+1:this.som.torus&&(o=0),'undefined'!=typeof o&&('x'===e?(i=o,n=this.y):(i=this.x,n=o),this.neighbors[e][1]=this.som.nodes[i][n])}return this.neighbors[e]},t.prototype.getPos=function(e,t){var i=this.getNeighbors(e),n=this.som.distance,o,s;if(!i[0])o=i[1],s=1;else if(i[1]){var r=n(t,i[0].weights),a=n(t,i[1].weights);r<a?(o=i[0],s=-1):(o=i[1],s=1)}else o=i[0],s=-1;var l=1-n(t,this.weights),c=1-n(t,o.weights);return 0.5+0.5*((l-c)/(2-l-c))*s},t.prototype.getPosition=function(e){return[this.getPos('x',e),this.getPos('y',e)]},e.exports=t},function(e,t,i){'use strict';function n(e){function t(e,t){if(e.rows!==t.rows||e.columns!==t.columns)throw new RangeError('Matrices dimensions must be equal')}function n(e,t){return e-t}function x(e,t){for(var i in t)e=e.replace(new RegExp('%'+i+'%','g'),t[i]);return e}e===void 0&&(e=Object);class w extends e{static get[Symbol.species](){return this}static from1DArray(e,t,i){if(e*t!==i.length)throw new RangeError('Data length does not match given dimensions');for(var n=new this(e,t),o=0;o<e;o++)for(var s=0;s<t;s++)n.set(o,s,i[o*t+s]);return n}static rowVector(e){for(var t=new this(1,e.length),n=0;n<e.length;n++)t.set(0,n,e[n]);return t}static columnVector(e){for(var t=new this(e.length,1),n=0;n<e.length;n++)t.set(n,0,e[n]);return t}static empty(e,t){return new this(e,t)}static zeros(e,t){return this.empty(e,t).fill(0)}static ones(e,t){return this.empty(e,t).fill(1)}static rand(e,t,n){n===void 0&&(n=Math.random);for(var o=this.empty(e,t),s=0;s<e;s++)for(var i=0;i<t;i++)o.set(s,i,n());return o}static randInt(e,t,n,o){n===void 0&&(n=1e3),o===void 0&&(o=Math.random);for(var s=this.empty(e,t),r=0;r<e;r++)for(var i=0,a;i<t;i++)a=g(o()*n),s.set(r,i,a);return s}static eye(e,t,n){t===void 0&&(t=e),n===void 0&&(n=1);for(var o=v(e,t),s=this.zeros(e,t),r=0;r<o;r++)s.set(r,r,n);return s}static diag(e,t,n){var o=e.length;t===void 0&&(t=o),n===void 0&&(n=t);for(var s=v(o,t,n),r=this.zeros(t,n),a=0;a<s;a++)r.set(a,a,e[a]);return r}static min(e,t){e=this.checkMatrix(e),t=this.checkMatrix(t);for(var n=e.rows,o=e.columns,s=new this(n,o),r=0;r<n;r++)for(var i=0;i<o;i++)s.set(r,i,v(e.get(r,i),t.get(r,i)));return s}static max(e,t){e=this.checkMatrix(e),t=this.checkMatrix(t);for(var n=e.rows,o=e.columns,s=new this(n,o),r=0;r<n;r++)for(var i=0;i<o;i++)s.set(r,i,M(e.get(r,i),t.get(r,i)));return s}static checkMatrix(e){return w.isMatrix(e)?e:new this(e)}static isMatrix(e){return null!=e&&'Matrix'===e.klass}get size(){return this.rows*this.columns}apply(e){if('function'!=typeof e)throw new TypeError('callback must be a function');for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var i=0;i<n;i++)e.call(this,o,i);return this}to1DArray(){for(var e=Array(this.size),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e[t*this.columns+i]=this.get(t,i);return e}to2DArray(){for(var e=Array(this.rows),t=0;t<this.rows;t++){e[t]=Array(this.columns);for(var i=0;i<this.columns;i++)e[t][i]=this.get(t,i)}return e}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isSymmetric(){if(this.isSquare()){for(var e=0;e<this.rows;e++)for(var t=0;t<=e;t++)if(this.get(e,t)!==this.get(t,e))return!1;return!0}return!1}set(){throw new Error('set method is unimplemented')}get(){throw new Error('get method is unimplemented')}repeat(e,t){e=e||1,t=t||1;for(var n=new this.constructor[Symbol.species](this.rows*e,this.columns*t),o=0;o<e;o++)for(var i=0;i<t;i++)n.setSubMatrix(this,this.rows*o,this.columns*i);return n}fill(e){for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,e);return this}neg(){return this.mulS(-1)}getRow(e){l.checkRowIndex(this,e);for(var t=Array(this.columns),n=0;n<this.columns;n++)t[n]=this.get(e,n);return t}getRowVector(e){return this.constructor.rowVector(this.getRow(e))}setRow(e,t){l.checkRowIndex(this,e),t=l.checkRowVector(this,t);for(var n=0;n<this.columns;n++)this.set(e,n,t[n]);return this}swapRows(e,t){l.checkRowIndex(this,e),l.checkRowIndex(this,t);for(var n=0,i;n<this.columns;n++)i=this.get(e,n),this.set(e,n,this.get(t,n)),this.set(t,n,i);return this}getColumn(e){l.checkColumnIndex(this,e);for(var t=Array(this.rows),n=0;n<this.rows;n++)t[n]=this.get(n,e);return t}getColumnVector(e){return this.constructor.columnVector(this.getColumn(e))}setColumn(e,t){l.checkColumnIndex(this,e),t=l.checkColumnVector(this,t);for(var n=0;n<this.rows;n++)this.set(n,e,t[n]);return this}swapColumns(e,t){l.checkColumnIndex(this,e),l.checkColumnIndex(this,t);for(var n=0,i;n<this.rows;n++)i=this.get(n,e),this.set(n,e,this.get(n,t)),this.set(n,t,i);return this}addRowVector(e){e=l.checkRowVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)+e[i]);return this}subRowVector(e){e=l.checkRowVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)-e[i]);return this}mulRowVector(e){e=l.checkRowVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)*e[i]);return this}divRowVector(e){e=l.checkRowVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)/e[i]);return this}addColumnVector(e){e=l.checkColumnVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)+e[t]);return this}subColumnVector(e){e=l.checkColumnVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)-e[t]);return this}mulColumnVector(e){e=l.checkColumnVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)*e[t]);return this}divColumnVector(e){e=l.checkColumnVector(this,e);for(var t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)/e[t]);return this}mulRow(e,t){l.checkRowIndex(this,e);for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t);return this}mulColumn(e,t){l.checkColumnIndex(this,e);for(var n=0;n<this.rows;n++)this.set(n,e,this.get(n,e)*t);return this}max(){for(var e=this.get(0,0),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.get(t,i)>e&&(e=this.get(t,i));return e}maxIndex(){for(var e=this.get(0,0),t=[0,0],n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.get(n,i)>e&&(e=this.get(n,i),t[0]=n,t[1]=i);return t}min(){for(var e=this.get(0,0),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)this.get(t,i)<e&&(e=this.get(t,i));return e}minIndex(){for(var e=this.get(0,0),t=[0,0],n=0;n<this.rows;n++)for(var i=0;i<this.columns;i++)this.get(n,i)<e&&(e=this.get(n,i),t[0]=n,t[1]=i);return t}maxRow(e){l.checkRowIndex(this,e);for(var t=this.get(e,0),n=1;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n));return t}maxRowIndex(e){l.checkRowIndex(this,e);for(var t=this.get(e,0),n=[e,0],o=1;o<this.columns;o++)this.get(e,o)>t&&(t=this.get(e,o),n[1]=o);return n}minRow(e){l.checkRowIndex(this,e);for(var t=this.get(e,0),n=1;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n));return t}minRowIndex(e){l.checkRowIndex(this,e);for(var t=this.get(e,0),n=[e,0],o=1;o<this.columns;o++)this.get(e,o)<t&&(t=this.get(e,o),n[1]=o);return n}maxColumn(e){l.checkColumnIndex(this,e);for(var t=this.get(0,e),n=1;n<this.rows;n++)this.get(n,e)>t&&(t=this.get(n,e));return t}maxColumnIndex(e){l.checkColumnIndex(this,e);for(var t=this.get(0,e),n=[0,e],o=1;o<this.rows;o++)this.get(o,e)>t&&(t=this.get(o,e),n[0]=o);return n}minColumn(e){l.checkColumnIndex(this,e);for(var t=this.get(0,e),n=1;n<this.rows;n++)this.get(n,e)<t&&(t=this.get(n,e));return t}minColumnIndex(e){l.checkColumnIndex(this,e);for(var t=this.get(0,e),n=[0,e],o=1;o<this.rows;o++)this.get(o,e)<t&&(t=this.get(o,e),n[0]=o);return n}diag(){for(var e=v(this.rows,this.columns),t=Array(e),n=0;n<e;n++)t[n]=this.get(n,n);return t}sum(e){return'row'===e?l.sumByRow(this):'column'===e?l.sumByColumn(this):l.sumAll(this)}mean(){return this.sum()/this.size}prod(){for(var e=1,t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e*=this.get(t,i);return e}cumulativeSum(){for(var e=0,t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e+=this.get(t,i),this.set(t,i,e);return this}dot(e){w.isMatrix(e)&&(e=e.to1DArray());var t=this.to1DArray();if(t.length!==e.length)throw new RangeError('vectors do not have the same size');for(var n=0,o=0;o<t.length;o++)n+=t[o]*e[o];return n}mmul(e){e=this.constructor.checkMatrix(e),this.columns!==e.rows&&console.warn('Number of columns of left matrix are not equal to number of rows of right matrix.');for(var t=this.rows,o=this.columns,n=e.columns,r=new this.constructor[Symbol.species](t,n),a=Array(o),l=0;l<n;l++){for(var c=0;c<o;c++)a[c]=e.get(c,l);for(var u=0,i;u<t;u++){for(i=0,c=0;c<o;c++)i+=this.get(u,c)*a[c];r.set(u,l,i)}}return r}strassen2x2(e){var t=new this.constructor[Symbol.species](2,2),i=this.get(0,0),n=e.get(0,0),o=this.get(0,1),s=e.get(0,1),r=this.get(1,0),a=e.get(1,0),l=this.get(1,1),c=e.get(1,1),u=(i+l)*(n+c),m=(r+l)*n,d=i*(s-c),g=l*(a-n),h=(i+o)*c;return t.set(0,0,u+g-h+(o-l)*(a+c)),t.set(0,1,d+h),t.set(1,0,m+g),t.set(1,1,u-m+d+(r-i)*(n+s)),t}strassen3x3(e){var t=new this.constructor[Symbol.species](3,3),i=this.get(0,0),n=this.get(0,1),o=this.get(0,2),s=this.get(1,0),r=this.get(1,1),a=this.get(1,2),l=this.get(2,0),c=this.get(2,1),u=this.get(2,2),m=e.get(0,0),d=e.get(0,1),g=e.get(0,2),h=e.get(1,0),p=e.get(1,1),k=e.get(1,2),j=e.get(2,0),x=e.get(2,1),w=e.get(2,2),f=(i-s)*(-d+p),y=(-i+s+r)*(m-d+p),M=(s+r)*(-m+d),b=i*m,v=(-i+l+c)*(m-g+k),R=(-i+l)*(g-k),I=(l+c)*(-m+g),S=(-o+c+u)*(p+j-x),C=(o-u)*(p-x),V=o*j,D=(c+u)*(-j+x),z=(-o+r+a)*(k+j-w),_=(o-a)*(k-w),P=(r+a)*(-j+w);return t.set(0,0,b+V+n*h),t.set(0,1,(i+n+o-s-r-c-u)*p+y+M+b+S+V+D),t.set(0,2,b+v+I+(i+n+o-r-a-l-c)*k+V+z+P),t.set(1,0,f+r*(-m+d+h-p-k-j+w)+y+b+V+z+_),t.set(1,1,f+y+M+b+a*x),t.set(1,2,V+z+_+P+s*g),t.set(2,0,b+v+R+c*(-m+g+h-p-k-j+x)+S+C+V),t.set(2,1,S+C+V+D+l*d),t.set(2,2,b+v+R+I+u*w),t}mmulStrassen(e){function t(e,t,i){var n=e.rows,o=e.columns;if(n===t&&o===i)return e;var s=w.zeros(t,i);return s=s.setSubMatrix(e,0,0),s}function i(e,n,o,s){if(512>=o||512>=s)return e.mmul(n);1==o%2&&1==s%2?(e=t(e,o+1,s+1),n=t(n,o+1,s+1)):1==o%2?(e=t(e,o+1,s),n=t(n,o+1,s)):1==s%2&&(e=t(e,o,s+1),n=t(n,o,s+1));var r=parseInt(e.rows/2),a=parseInt(e.columns/2),l=e.subMatrix(0,r-1,0,a-1),c=n.subMatrix(0,r-1,0,a-1),u=e.subMatrix(0,r-1,a,e.columns-1),m=n.subMatrix(0,r-1,a,n.columns-1),d=e.subMatrix(r,e.rows-1,0,a-1),g=n.subMatrix(r,n.rows-1,0,a-1),h=e.subMatrix(r,e.rows-1,a,e.columns-1),p=n.subMatrix(r,n.rows-1,a,n.columns-1),k=i(w.add(l,h),w.add(c,p),r,a),j=i(w.add(d,h),c,r,a),x=i(l,w.sub(m,p),r,a),f=i(h,w.sub(g,c),r,a),y=i(w.add(l,u),p,r,a),M=i(w.sub(d,l),w.add(c,m),r,a),b=i(w.sub(u,h),w.add(g,p),r,a),v=w.add(k,f);v.sub(y),v.add(b);var R=w.add(x,y),I=w.add(j,f),S=w.sub(k,j);S.add(x),S.add(M);var C=w.zeros(2*v.rows,2*v.columns);return C=C.setSubMatrix(v,0,0),C=C.setSubMatrix(R,v.rows,0),C=C.setSubMatrix(I,0,v.columns),C=C.setSubMatrix(S,v.rows,v.columns),C.subMatrix(0,o-1,0,s-1)}var n=this.clone(),o=n.rows,s=n.columns,a=e.rows,l=e.columns;s!==a&&console.warn(`Multiplying ${o} x ${s} and ${a} x ${l} matrix: dimensions do not match.`);var u=M(o,a),r=M(s,l);return n=t(n,u,r),e=t(e,u,r),i(n,e,u,r)}scaleRows(e,t){if(e=void 0===e?0:e,t=void 0===t?1:t,e>=t)throw new RangeError('min should be strictly smaller than max');for(var n=this.constructor.empty(this.rows,this.columns),o=0,i;o<this.rows;o++)i=s.scale(this.getRow(o),{min:e,max:t}),n.setRow(o,i);return n}scaleColumns(e,t){if(e=void 0===e?0:e,t=void 0===t?1:t,e>=t)throw new RangeError('min should be strictly smaller than max');for(var n=this.constructor.empty(this.rows,this.columns),o=0,i;o<this.columns;o++)i=s.scale(this.getColumn(o),{min:e,max:t}),n.setColumn(o,i);return n}kroneckerProduct(e){e=this.constructor.checkMatrix(e);for(var t=this.rows,o=this.columns,n=e.rows,s=e.columns,r=new this.constructor[Symbol.species](t*n,o*s),a=0;a<t;a++)for(var i=0;i<o;i++)for(var c=0;c<n;c++)for(var u=0;u<s;u++)r[n*a+c][s*i+u]=this.get(a,i)*e.get(c,u);return r}transpose(){for(var e=new this.constructor[Symbol.species](this.columns,this.rows),t=0;t<this.rows;t++)for(var i=0;i<this.columns;i++)e.set(i,t,this.get(t,i));return e}sortRows(e){e===void 0&&(e=n);for(var t=0;t<this.rows;t++)this.setRow(t,this.getRow(t).sort(e));return this}sortColumns(e){e===void 0&&(e=n);for(var t=0;t<this.columns;t++)this.setColumn(t,this.getColumn(t).sort(e));return this}subMatrix(e,t,n,o){l.checkRange(this,e,t,n,o);for(var s=new this.constructor[Symbol.species](t-e+1,o-n+1),r=e;r<=t;r++)for(var i=n;i<=o;i++)s[r-e][i-n]=this.get(r,i);return s}subMatrixRow(e,t,n){if(void 0===t&&(t=0),void 0===n&&(n=this.columns-1),t>n||0>t||t>=this.columns||0>n||n>=this.columns)throw new RangeError('Argument out of range');for(var o=new this.constructor[Symbol.species](e.length,n-t+1),s=0;s<e.length;s++)for(var i=t;i<=n;i++){if(0>e[s]||e[s]>=this.rows)throw new RangeError('Row index out of range: '+e[s]);o.set(s,i-t,this.get(e[s],i))}return o}subMatrixColumn(e,t,n){if(void 0===t&&(t=0),void 0===n&&(n=this.rows-1),t>n||0>t||t>=this.rows||0>n||n>=this.rows)throw new RangeError('Argument out of range');for(var o=new this.constructor[Symbol.species](n-t+1,e.length),s=0;s<e.length;s++)for(var i=t;i<=n;i++){if(0>e[s]||e[s]>=this.columns)throw new RangeError('Column index out of range: '+e[s]);o.set(i-t,s,this.get(i,e[s]))}return o}setSubMatrix(e,t,n){e=this.constructor.checkMatrix(e);var o=t+e.rows-1,s=n+e.columns-1;l.checkRange(this,t,o,n,s);for(var r=0;r<e.rows;r++)for(var i=0;i<e.columns;i++)this[t+r][n+i]=e.get(r,i);return this}selection(e,t){for(var n=l.checkIndices(this,e,t),o=new this.constructor[Symbol.species](e.length,t.length),s=0,i;s<n.row.length;s++){i=n.row[s];for(var r=0,a;r<n.column.length;r++)a=n.column[r],o[s][r]=this.get(i,a)}return o}trace(){for(var e=v(this.rows,this.columns),t=0,n=0;n<e;n++)t+=this.get(n,n);return t}transposeView(){return new c(this)}rowView(e){return l.checkRowIndex(this,e),new m(this,e)}columnView(e){return l.checkColumnIndex(this,e),new p(this,e)}flipRowView(){return new k(this)}flipColumnView(){return new j(this)}subMatrixView(e,t,i,n){return new d(this,e,t,i,n)}selectionView(e,t){return new h(this,e,t)}det(){if(this.isSquare()){var e,t,i,n;if(2===this.columns)return e=this.get(0,0),t=this.get(0,1),i=this.get(1,0),n=this.get(1,1),e*n-t*i;if(3===this.columns){var s,r,a;return s=this.selectionView([1,2],[1,2]),r=this.selectionView([1,2],[0,2]),a=this.selectionView([1,2],[0,1]),e=this.get(0,0),t=this.get(0,1),i=this.get(0,2),e*s.det()-t*r.det()+i*a.det()}return new o(this).determinant}throw Error('Determinant can only be calculated for a square matrix.')}pseudoInverse(e){void 0===e&&(e=a);for(var t=new r(this,{autoTranspose:!0}),n=t.leftSingularVectors,o=t.rightSingularVectors,l=t.diagonal,s=0;s<l.length;s++)l[s]=u(l[s])>e?1/l[s]:0;return l=this.constructor[Symbol.species].diag(l),o.mmul(l.mmul(n.transposeView()))}}w.prototype.klass='Matrix',w.random=w.rand,w.diagonal=w.diag,w.prototype.diagonal=w.prototype.diag,w.identity=w.eye,w.prototype.negate=w.prototype.neg,w.prototype.tensorProduct=w.prototype.kroneckerProduct,w.prototype.determinant=w.prototype.det;var f=`
(function %name%(value) {
    if (typeof value === 'number') return this.%name%S(value);
    return this.%name%M(value);
})
`,y=`
(function %name%S(value) {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, this.get(i, j) %op% value);
        }
    }
    return this;
})
`,b=`
(function %name%M(matrix) {
    matrix = this.constructor.checkMatrix(matrix);
    checkDimensions(this, matrix);
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, this.get(i, j) %op% matrix.get(i, j));
        }
    }
    return this;
})
`,R=`
(function %name%(matrix, value) {
    var newMatrix = new this[Symbol.species](matrix);
    return newMatrix.%name%(value);
})
`,I=`
(function %name%() {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j)));
        }
    }
    return this;
})
`,S=`
(function %name%(matrix) {
    var newMatrix = new this[Symbol.species](matrix);
    return newMatrix.%name%();
})
`,C=`
(function %name%(%args%) {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j), %args%));
        }
    }
    return this;
})
`,V=`
(function %name%(matrix, %args%) {
    var newMatrix = new this[Symbol.species](matrix);
    return newMatrix.%name%(%args%);
})
`,D=`
(function %name%S(value) {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j), value));
        }
    }
    return this;
})
`,z=`
(function %name%M(matrix) {
    matrix = this.constructor.checkMatrix(matrix);
    checkDimensions(this, matrix);
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j), matrix.get(i, j)));
        }
    }
    return this;
})
`,_=`
(function %name%(value) {
    if (typeof value === 'number') return this.%name%S(value);
    return this.%name%M(value);
})
`,P=V,A=[['+','add'],['-','sub','subtract'],['*','mul','multiply'],['/','div','divide'],['%','mod','modulus'],['&','and'],['|','or'],['^','xor'],['<<','leftShift'],['>>','signPropagatingRightShift'],['>>>','rightShift','zeroFillRightShift']],L=!0,U=!1,F,i;try{for(var T=A[Symbol.iterator](),q;!(L=(q=T.next()).done);L=!0){var N=q.value,O=eval(x(f,{name:N[1],op:N[0]})),E=eval(x(y,{name:N[1]+'S',op:N[0]})),B=eval(x(b,{name:N[1]+'M',op:N[0]})),Q=eval(x(R,{name:N[1]}));for(F=1;F<N.length;F++)w.prototype[N[F]]=O,w.prototype[N[F]+'S']=E,w.prototype[N[F]+'M']=B,w[N[F]]=Q}}catch(e){U=!0,i=e}finally{try{!L&&T.return&&T.return()}finally{if(U)throw i}}var W=[['~','not']];['abs','acos','acosh','asin','asinh','atan','atanh','cbrt','ceil','clz32','cos','cosh','exp','expm1','floor','fround','log','log1p','log10','log2','round','sign','sin','sinh','sqrt','tan','tanh','trunc'].forEach(function(e){W.push(['Math.'+e,e])});var X=!0,J=!1,Y;try{for(var H=W[Symbol.iterator](),K;!(X=(K=H.next()).done);X=!0){var G=K.value,Z=eval(x(I,{name:G[1],method:G[0]})),$=eval(x(S,{name:G[1]}));for(F=1;F<G.length;F++)w.prototype[G[F]]=Z,w[G[F]]=$}}catch(e){J=!0,Y=e}finally{try{!X&&H.return&&H.return()}finally{if(J)throw Y}}var ee=[['Math.pow',1,'pow']],te=!0,ie=!1,ne;try{for(var oe=ee[Symbol.iterator](),se;!(te=(se=oe.next()).done);te=!0){var re=se.value,ae='arg0';for(F=1;F<re[1];F++)ae+=`, arg${F}`;if(1!==re[1]){var le=eval(x(C,{name:re[2],method:re[0],args:ae})),ce=eval(x(V,{name:re[2],args:ae}));for(F=2;F<re.length;F++)w.prototype[re[F]]=le,w[re[F]]=ce}else{var ue={name:re[2],args:ae,method:re[0]},me=eval(x(_,ue)),de=eval(x(D,ue)),ge=eval(x(z,ue)),he=eval(x(P,ue));for(F=2;F<re.length;F++)w.prototype[re[F]]=me,w.prototype[re[F]+'M']=ge,w.prototype[re[F]+'S']=de,w[re[F]]=he}}}catch(e){ie=!0,ne=e}finally{try{!te&&oe.return&&oe.return()}finally{if(ie)throw ne}}return w}e.exports=n;var o=i(98),r=i(99),s=i(1),l=i(31),c=i(323),m=i(324),d=i(325),h=i(326),p=i(327),k=i(328),j=i(329)},function(e,t,i){'use strict';function n(e){if(!(this instanceof n))return new n(e);e=o.Matrix.checkMatrix(e);var r=e.clone(),a=r.rows,l=r.columns,c=Array(a),m=1,d,i,g,h,p,s,t,k,j,x;for(d=0;d<a;d++)c[d]=d;for(j=Array(a),i=0;i<l;i++){for(d=0;d<a;d++)j[d]=r[d][i];for(d=0;d<a;d++){for(k=r[d],x=v(d,i),p=0,g=0;g<x;g++)p+=k[g]*j[g];k[i]=j[d]-=p}for(h=i,d=i+1;d<a;d++)u(j[d])>u(j[h])&&(h=d);if(h!==i){for(g=0;g<l;g++)s=r[h][g],r[h][g]=r[i][g],r[i][g]=s;t=c[h],c[h]=c[i],c[i]=t,m=-m}if(i<a&&0!==r[i][i])for(d=i+1;d<a;d++)r[d][i]/=r[i][i]}this.LU=r,this.pivotVector=c,this.pivotSign=m}var o=i(12);n.prototype={isSingular:function(){for(var e=this.LU,t=e.columns,i=0;i<t;i++)if(0===e[i][i])return!0;return!1},get determinant(){var e=this.LU;if(!e.isSquare())throw new Error('Matrix must be square');for(var t=this.pivotSign,i=e.columns,n=0;n<i;n++)t*=e[n][n];return t},get lowerTriangularMatrix(){for(var e=this.LU,t=e.rows,n=e.columns,s=new o.Matrix(t,n),r=0;r<t;r++)for(var i=0;i<n;i++)s[r][i]=r>i?e[r][i]:r===i?1:0;return s},get upperTriangularMatrix(){for(var e=this.LU,t=e.rows,n=e.columns,s=new o.Matrix(t,n),r=0;r<t;r++)for(var i=0;i<n;i++)s[r][i]=r<=i?e[r][i]:0;return s},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(e){e=o.Matrix.checkMatrix(e);var t=this.LU,n=t.rows;if(n!==e.rows)throw new Error('Invalid matrix dimensions');if(this.isSingular())throw new Error('LU matrix is singular');var s=e.columns,r=e.subMatrixRow(this.pivotVector,0,s-1),a=t.columns,l,i,c;for(c=0;c<a;c++)for(l=c+1;l<a;l++)for(i=0;i<s;i++)r[l][i]-=r[c][i]*t[l][c];for(c=a-1;0<=c;c--){for(i=0;i<s;i++)r[c][i]/=t[c][c];for(l=0;l<c;l++)for(i=0;i<s;i++)r[l][i]-=r[c][i]*t[l][c]}return r}},e.exports=n},function(e,t,i){'use strict';function o(h,x){if(!(this instanceof o))return new o(h,x);h=r.Matrix.checkMatrix(h),x=x||{};var w=h.rows,m=h.columns,n=v(w,m),y=!0,I=!0;!1===x.computeLeftSingularVectors&&(y=!1),!1===x.computeRightSingularVectors&&(I=!1);var S=!0===x.autoTranspose,C=!1,D;if(!(w<m))D=h.clone();else if(!S)D=h.clone(),console.warn('Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose');else{D=h.transpose(),w=D.rows,m=D.columns,C=!0;var a=y;y=I,I=a}var z=Array(v(w+1,m)),s=d(w,n,0),_=d(m,m,0),V=Array(m),e=Array(w),P=v(w-1,m),A=M(0,v(m-2,w)),L,i,j,k,p,U,F,f,T,q,N,O,E,B,Q,W,X,J,b,c,Y;for(j=0,q=M(P,A);j<q;j++){if(j<P){for(z[j]=0,L=j;L<w;L++)z[j]=l(z[j],D[L][j]);if(0!==z[j]){for(0>D[j][j]&&(z[j]=-z[j]),L=j;L<w;L++)D[L][j]/=z[j];D[j][j]+=1}z[j]=-z[j]}for(i=j+1;i<m;i++){if(j<P&&0!==z[j]){for(p=0,L=j;L<w;L++)p+=D[L][j]*D[L][i];for(p=-p/D[j][j],L=j;L<w;L++)D[L][i]+=p*D[L][j]}V[i]=D[j][i]}if(y&&j<P)for(L=j;L<w;L++)s[L][j]=D[L][j];if(j<A){for(V[j]=0,L=j+1;L<m;L++)V[j]=l(V[j],V[L]);if(0!==V[j]){for(0>V[j+1]&&(V[j]=0-V[j]),L=j+1;L<m;L++)V[L]/=V[j];V[j+1]+=1}if(V[j]=-V[j],j+1<w&&0!==V[j]){for(L=j+1;L<w;L++)e[L]=0;for(i=j+1;i<m;i++)for(L=j+1;L<w;L++)e[L]+=V[i]*D[L][i];for(i=j+1;i<m;i++)for(p=-V[i]/V[j+1],L=j+1;L<w;L++)D[L][i]+=p*e[L]}if(I)for(L=j+1;L<m;L++)_[L][j]=V[L]}}if(k=v(m,w+1),P<m&&(z[P]=D[P][P]),w<k&&(z[k-1]=0),A+1<k&&(V[A]=D[A][k-1]),V[k-1]=0,y){for(i=P;i<n;i++){for(L=0;L<w;L++)s[L][i]=0;s[i][i]=1}for(j=P-1;0<=j;j--)if(0!==z[j]){for(i=j+1;i<n;i++){for(p=0,L=j;L<w;L++)p+=s[L][j]*s[L][i];for(p=-p/s[j][j],L=j;L<w;L++)s[L][i]+=p*s[L][j]}for(L=j;L<w;L++)s[L][j]=-s[L][j];for(s[j][j]=1+s[j][j],L=0;L<j-1;L++)s[L][j]=0}else{for(L=0;L<w;L++)s[L][j]=0;s[j][j]=1}}if(I)for(j=m-1;0<=j;j--){if(j<A&&0!==V[j])for(i=j+1;i<m;i++){for(p=0,L=j+1;L<m;L++)p+=_[L][j]*_[L][i];for(p=-p/_[j+1][j],L=j+1;L<m;L++)_[L][i]+=p*_[L][j]}for(L=0;L<m;L++)_[L][j]=0;_[j][j]=1}for(var g=k-1,H=0,K=2.220446049250313e-16;0<k;){for(j=k-2;-1<=j&&-1!==j;j--)if(u(V[j])<=K*(u(z[j])+u(z[j+1]))){V[j]=0;break}if(j===k-2)N=4;else{for(U=k-1;U>=j&&U!==j;U--)if(p=(U===k?0:u(V[U]))+(U===j+1?0:u(V[U-1])),u(z[U])<=K*p){z[U]=0;break}U===j?N=3:U===k-1?N=1:(N=2,j=U)}switch(j++,N){case 1:{for(F=V[k-2],V[k-2]=0,i=k-2;i>=j;i--)if(p=l(z[i],F),f=z[i]/p,T=F/p,z[i]=p,i!==j&&(F=-T*V[i-1],V[i-1]=f*V[i-1]),I)for(L=0;L<m;L++)p=f*_[L][i]+T*_[L][k-1],_[L][k-1]=-T*_[L][i]+f*_[L][k-1],_[L][i]=p;break}case 2:{for(F=V[j-1],V[j-1]=0,i=j;i<k;i++)if(p=l(z[i],F),f=z[i]/p,T=F/p,z[i]=p,F=-T*V[i],V[i]=f*V[i],y)for(L=0;L<w;L++)p=f*s[L][i]+T*s[L][j-1],s[L][j-1]=-T*s[L][i]+f*s[L][j-1],s[L][i]=p;break}case 3:{for(O=M(M(M(M(u(z[k-1]),u(z[k-2])),u(V[k-2])),u(z[j])),u(V[j])),E=z[k-1]/O,B=z[k-2]/O,Q=V[k-2]/O,W=z[j]/O,X=V[j]/O,J=((B+E)*(B-E)+Q*Q)/2,b=E*Q*(E*Q),c=0,(0!==J||0!==b)&&(c=R(J*J+b),0>J&&(c=-c),c=b/(J+c)),F=(W+E)*(W-E)+c,Y=W*X,i=j;i<k-1;i++){if(p=l(F,Y),f=F/p,T=Y/p,i!==j&&(V[i-1]=p),F=f*z[i]+T*V[i],V[i]=f*V[i]-T*z[i],Y=T*z[i+1],z[i+1]=f*z[i+1],I)for(L=0;L<m;L++)p=f*_[L][i]+T*_[L][i+1],_[L][i+1]=-T*_[L][i]+f*_[L][i+1],_[L][i]=p;if(p=l(F,Y),f=F/p,T=Y/p,z[i]=p,F=f*V[i]+T*z[i+1],z[i+1]=-T*V[i]+f*z[i+1],Y=T*V[i+1],V[i+1]=f*V[i+1],y&&i<w-1)for(L=0;L<w;L++)p=f*s[L][i]+T*s[L][i+1],s[L][i+1]=-T*s[L][i]+f*s[L][i+1],s[L][i]=p}V[k-2]=F,++H;break}case 4:{if(0>=z[j]&&(z[j]=0>z[j]?-z[j]:0,I))for(L=0;L<=g;L++)_[L][j]=-_[L][j];for(;j<g&&!(z[j]>=z[j+1]);){if(p=z[j],z[j]=z[j+1],z[j+1]=p,I&&j<m-1)for(L=0;L<m;L++)p=_[L][j+1],_[L][j+1]=_[L][j],_[L][j]=p;if(y&&j<w-1)for(L=0;L<w;L++)p=s[L][j+1],s[L][j+1]=s[L][j],s[L][j]=p;j++}H=0,k--;break}}}if(C){var G=_;_=s,s=G}this.m=w,this.n=m,this.s=z,this.U=s,this.V=_}var r=i(12),n=i(50),l=n.hypotenuse,d=n.getFilled2DArray;o.prototype={get condition(){return this.s[0]/this.s[v(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var e=M(this.m,this.n)*this.s[0]*2.220446049250313e-16,t=0,n=this.s,o=0,i=n.length;o<i;o++)n[o]>e&&t++;return t},get diagonal(){return this.s},get threshold(){return 2.220446049250313e-16/2*M(this.m,this.n)*this.s[0]},get leftSingularVectors(){return r.Matrix.isMatrix(this.U)||(this.U=new r.Matrix(this.U)),this.U},get rightSingularVectors(){return r.Matrix.isMatrix(this.V)||(this.V=new r.Matrix(this.V)),this.V},get diagonalMatrix(){return r.Matrix.diag(this.s)},solve:function(t){var n=this.threshold,e=this.s.length,o=r.Matrix.zeros(e,e),s;for(s=0;s<e;s++)o[s][s]=u(this.s[s])<=n?0:1/this.s[s];var i=this.U,a=this.rightSingularVectors,l=a.mmul(o),c=a.rows,m=i.length,d=r.Matrix.zeros(c,m),g,h,p;for(s=0;s<c;s++)for(g=0;g<m;g++){for(p=0,h=0;h<e;h++)p+=l[s][h]*i[g][h];d[s][g]=p}return d.mmul(t)},solveForDiagonal:function(e){return this.solve(r.Matrix.diag(e))},inverse:function(){var t=this.V,n=this.threshold,e=t.length,o=t[0].length,s=new r.Matrix(e,this.s.length),a,i;for(a=0;a<e;a++)for(i=0;i<o;i++)s[a][i]=u(this.s[i])>n?t[a][i]/this.s[i]:0;var l=this.U,c=l.length,m=l[0].length,d=new r.Matrix(e,c),g,h;for(a=0;a<e;a++)for(i=0;i<c;i++){for(h=0,g=0;g<m;g++)h+=s[a][g]*l[i][g];d[a][i]=h}return d}},e.exports=o},function(e,t,i){'use strict';var n=i(49),o=i(101),s=i(102);class r{constructor(e){this.inputSize=e.inputSize,this.outputSize=e.outputSize,this.regularization=e.regularization,this.epsilon=e.epsilon,this.activation=e.activation,this.activationParam=e.activationParam;var t=s[e.activation],i=t.activation.length,o=1<i?(i)=>t.activation(i,e.activationParam):t.activation,r=1<i?(i)=>t.derivate(i,e.activationParam):t.derivate;this.activationFunction=function(e,t){this[e][t]=o(this[e][t])},this.derivate=function(e,t){this[e][t]=r(this[e][t])},e.model?(this.W=n.checkMatrix(e.W),this.b=n.checkMatrix(e.b)):(this.W=n.rand(this.inputSize,this.outputSize),this.b=n.zeros(1,this.outputSize),this.W.apply(function(t,i){this[t][i]/=R(e.inputSize)}))}forward(e){var t=e.mmul(this.W).addRowVector(this.b);return t.apply(this.activationFunction),this.a=t.clone(),t}backpropagation(e,t){this.dW=t.transposeView().mmul(e),this.db=o.sumCol(e);var i=t.clone();return e.mmul(this.W.transposeView()).mul(i.apply(this.derivate))}update(){this.dW.add(this.W.clone().mul(this.regularization)),this.W.add(this.dW.mul(-this.epsilon)),this.b.add(this.db.mul(-this.epsilon))}toJSON(){return{model:'Layer',inputSize:this.inputSize,outputSize:this.outputSize,regularization:this.regularization,epsilon:this.epsilon,activation:this.activation,W:this.W,b:this.b}}static load(e){if('Layer'!==e.model)throw new RangeError('the current model is not a Layer model');return new r(e)}}e.exports=r},function(e,t,i){'use strict';var n=i(49);e.exports={dictOutputs:function(e){for(var t={},n={},o=e.length,s=0,r=0;r<o;r+=1)void 0===t[e[r]]&&(t[e[r]]=s,n[s]=e[r],s++);return{inputs:t,outputs:n}},sumCol:function(e){for(var t=n.zeros(1,e.columns),o=0;o<e.rows;++o)for(var i=0;i<e.columns;++i)t[0][i]+=e[o][i];return t},sumRow:function(e){for(var t=n.zeros(e.rows,1),o=0;o<e.rows;++o)for(var i=0;i<e.columns;++i)t[o][0]+=e[o][i];return t}}},function(e){'use strict';function t(e){return 1/(1+o(-e))}function i(e,t){return 0>e?t*(o(e)-1):e}var s=Math.cos,a=Math.sin,l={tanh:{activation:n,derivate:(e)=>1-e*e},identity:{activation:(e)=>e,derivate:()=>1},logistic:{activation:t,derivate:(e)=>t(e)*(1-t(e))},arctan:{activation:Math.atan,derivate:(e)=>1/(e*e+1)},softsign:{activation:(e)=>e/(1+u(e)),derivate:(e)=>1/((1+u(e))*(1+u(e)))},relu:{activation:(e)=>0>e?0:e,derivate:(e)=>0>e?0:1},softplus:{activation:(e)=>r(1+o(e)),derivate:(e)=>1/(1+o(-e))},bent:{activation:(e)=>(R(e*e+1)-1)/2+e,derivate:(e)=>e/(2*R(e*e+1))+1},sinusoid:{activation:a,derivate:s},sinc:{activation:(e)=>0===e?1:a(e)/e,derivate:(e)=>0===e?0:s(e)/e-a(e)/(e*e)},gaussian:{activation:(e)=>o(-(e*e)),derivate:(e)=>-2*e*o(-(e*e))},"parametric-relu":{activation:(e,t)=>0>e?t*e:e,derivate:(e,t)=>0>e?t:1},"exponential-elu":{activation:i,derivate:(e,t)=>0>e?i(e,t)+t:1},"soft-exponential":{activation:function(e,t){return 0>t?-r(1-t*(e+t))/t:0<t?(o(t*e)-1)/t+t:e},derivate:function(e,t){return 0>t?1/(1-t*(t+e)):o(t*e)}}};e.exports=l},function(e,t,i){'use strict';var n=i(13);t.ArrayUtils=t.AU=i(1),t.BitArray=i(119),t.HashTable=i(54),t.Matrix=n.default,t.PadArray=i(57),t.Regression=i(124),t.binarySearch=i(55),t.numSort=i(56);var o=t.Math={},s=i(145);o.Distance=s.distance,o.Similarity=s.similarity,o.DistanceMatrix=i(68),o.SG=i(191),o.SGG=i(205),o.Matrix=n,o.SparseMatrix=i(208),o.Kernel=i(37);var r=t.Stat={};r.array=i(2).array,r.matrix=i(2).matrix,r.PCA=i(209),r.Performance=i(223);var a=t.Optimization={};a.BellOptimizer=i(225),a.LevenbergMarquardt=i(253);var l=t.RNG={};l.XSadd=i(269);var c=t.SL={};c.CV=i(270),c.CrossValidation=c.CV,c.CM=i(86),c.ConfusionMatrix=c.CM,c.SVM=i(272),c.KNN=i(273),c.NaiveBayes=i(275),c.PLS=i(289);var u=t.Clust={};u.kmeans=i(304),u.hclust=i(309);var m=t.NN=t.nn={};m.SOM=i(319),m.FNN=i(321)},function(){'use strict';Symbol.species||(Symbol.species=Symbol.for('@@species'))},function(e,t,i){'use strict';function n(e){for(var t=Array(e[0].length),n=0;n<t.length;++n)t[n]=Array(e.length);for(n=0;n<e.length;++n)for(var i=0;i<e[0].length;++i)t[i][n]=e[n][i];return t}var o=i(2).array;e.exports={coordArrayToPoints:function(e,t){if(0!=e.length%t)throw new RangeError('Dimensions number must be accordance with the size of the array.');for(var n=e.length/t,o=Array(n),s=0,r=0,i;r<e.length;r+=t){i=Array(t);for(var a=0;a<t;++a)i[a]=e[r+a];o[s]=i,s++}return o},coordArrayToCoordMatrix:function(e,t){if(0!=e.length%t)throw new RangeError('Dimensions number must be accordance with the size of the array.');for(var n=Array(t),o=e.length/t,s=0;s<n.length;s++)n[s]=Array(o);for(s=0;s<e.length;s+=t)for(var i=0,r;i<t;++i)r=g(s/t),n[i][r]=e[s+i];return n},coordMatrixToCoordArray:function(e){for(var t=Array(e.length*e[0].length),n=0,o=0;o<e[0].length;++o)for(var i=0;i<e.length;++i)t[n]=e[i][o],++n;return t},coordMatrixToPoints:n,pointsToCoordArray:function(e){for(var t=Array(e.length*e[0].length),n=0,o=0;o<e.length;++o)for(var i=0;i<e[0].length;++i)t[n]=e[o][i],++n;return t},pointsToCoordMatrix:n,applyDotProduct:function(e,t){var n,o;e.length<=t.length?(o=e,n=t):(o=t,n=e);for(var s=n.length-o.length+1,r=Array(s),a=0,i;a<s;++a){i=0;for(var l=0;l<o.length;++l)i+=o[l]*n[a+l];r[a]=i}return r},scale:function(e,t){var n=t.inPlace?e:Array(e.length);var s=t.max,r=t.min;if('number'==typeof s){if('number'==typeof r)for(var a=o.minMax(e),l=(s-r)/(a.max-a.min),c=0;c<n.length;c++)n[c]=(e[c]-a.min)*l+r;else for(var i=o.max(e),l=s/i,c=0;c<n.length;c++)n[c]=e[c]*l;}else if('number'==typeof r)for(var i=o.min(e),l=r/i,c=0;c<n.length;c++)n[c]=e[c]*l;return n}}},function(e,t,i){'use strict';function n(e,t){return e-t}var o=i(52);t.max=function(e){for(var t=-Infinity,n=0;n<e.length;n++)for(var i=0;i<e[n].length;i++)e[n][i]>t&&(t=e[n][i]);return t},t.min=function(e){for(var t=Infinity,n=0;n<e.length;n++)for(var i=0;i<e[n].length;i++)e[n][i]<t&&(t=e[n][i]);return t},t.minMax=function(e){for(var t=Infinity,n=-Infinity,o=0;o<e.length;o++)for(var i=0;i<e[o].length;i++)e[o][i]<t&&(t=e[o][i]),e[o][i]>n&&(n=e[o][i]);return{min:t,max:n}},t.entropy=function(e,t){'undefined'==typeof t&&(t=0);for(var n=0,o=e.length,s=e[0].length,a=0;a<o;a++)for(var i=0;i<s;i++)n+=e[a][i]*r(e[a][i]+t);return-n},t.mean=function(e,t){'undefined'==typeof t&&(t=0);var n=e.length,o=e[0].length,s,r,a,i;if(-1===t){for(s=[0],r=n*o,a=0;a<n;a++)for(i=0;i<o;i++)s[0]+=e[a][i];s[0]/=r}else if(0===t)for(s=Array(o),r=n,i=0;i<o;i++){for(s[i]=0,a=0;a<n;a++)s[i]+=e[a][i];s[i]/=r}else if(1===t)for(s=Array(n),r=o,i=0;i<n;i++){for(s[i]=0,a=0;a<o;a++)s[i]+=e[i][a];s[i]/=r}else throw new Error('Invalid dimension');return s},t.sum=function(e,t){'undefined'==typeof t&&(t=0);var n=e.length,o=e[0].length,s,r,i;if(-1===t)for(s=[0],r=0;r<n;r++)for(i=0;i<o;i++)s[0]+=e[r][i];else if(0===t)for(s=Array(o),i=0;i<o;i++)for(s[i]=0,r=0;r<n;r++)s[i]+=e[r][i];else if(1===t)for(s=Array(n),i=0;i<n;i++)for(s[i]=0,r=0;r<o;r++)s[i]+=e[i][r];else throw new Error('Invalid dimension');return s},t.product=function(e,t){'undefined'==typeof t&&(t=0);var n=e.length,o=e[0].length,s,r,i;if(-1===t)for(s=[1],r=0;r<n;r++)for(i=0;i<o;i++)s[0]*=e[r][i];else if(0===t)for(s=Array(o),i=0;i<o;i++)for(s[i]=1,r=0;r<n;r++)s[i]*=e[r][i];else if(1===t)for(s=Array(n),i=0;i<n;i++)for(s[i]=1,r=0;r<o;r++)s[i]*=e[i][r];else throw new Error('Invalid dimension');return s},t.standardDeviation=function(e,n,o){for(var s=t.variance(e,n,o),r=s.length,a=0;a<r;a++)s[a]=R(s[a]);return s},t.variance=function(e,n,o){'undefined'==typeof o&&(o=!0),n=n||t.mean(e);var s=e.length;if(0===s)return[];for(var r=e[0].length,a=Array(r),l=0;l<r;l++){for(var c=0,u=0,m=0,d=0;d<s;d++)m=e[d][l]-n[l],c+=m,u+=m*m;a[l]=o?(u-c*c/s)/(s-1):(u-c*c/s)/s}return a},t.median=function(e){for(var t=e.length,o=e[0].length,s=Array(o),r=0,i;r<o;r++){i=Array(t);for(var a=0;a<t;a++)i[a]=e[a][r];i.sort(n);var l=i.length;s[r]=0==l%2?0.5*(i[l/2]+i[l/2-1]):i[g(l/2)]}return s},t.mode=function(e){var t=e.length,n=e[0].length,o=Array(n),s,i;for(s=0;s<n;s++){for(var r=Array(t),a=0;a<t;a++)r[a]=0;var l=Array(t),c=0;for(i=0;i<t;i++){var u=l.indexOf(e[i][s]);0<=u?r[u]++:(l[c]=e[i][s],r[c]=1,c++)}var m=0,d=0;for(i=0;i<c;i++)r[i]>m&&(m=r[i],d=i);o[s]=l[d]}return o},t.skewness=function(e,o){'undefined'==typeof o&&(o=!0);for(var s=t.mean(e),r=e.length,n=s.length,l=Array(n),u=0;u<n;u++){for(var m=0,d=0,h=0,i;h<r;h++)i=e[h][u]-s[u],m+=i*i,d+=i*i*i;var p=m/r,k=d/r,j=k/c(p,3/2);if(o){var g=R(r*(r-1));l[u]=g/(r-2)*j}else l[u]=j}return l},t.kurtosis=function(e,o){'undefined'==typeof o&&(o=!0);for(var s=t.mean(e),r=e.length,n=e[0].length,a=Array(n),l=0;l<n;l++){for(var c=0,u=0,m=0,i;m<r;m++)i=e[m][l]-s[l],c+=i*i,u+=i*i*i*i;var d=c/r,g=u/r;if(o){var h=c/(r-1),p=u/(h*h);a[l]=r*(r+1)/((r-1)*(r-2)*(r-3))*p-3*((r-1)*(r-1)/((r-2)*(r-3)))}else a[l]=g/(d*d)-3}return a},t.standardError=function(e){for(var n=e.length,o=t.standardDeviation(e),s=o.length,r=Array(s),a=R(n),l=0;l<s;l++)r[l]=o[l]/a;return r},t.covariance=function(e,i){return t.scatter(e,void 0,i)},t.scatter=function(e,n,o){'undefined'==typeof o&&(o=0),'undefined'==typeof n&&(0===o?n=e.length-1:1===o&&(n=e[0].length-1));var r=t.mean(e,o),a=e.length;if(0===a)return[[]];var l=e[0].length,c,u,i,m,s;if(0===o){for(c=Array(l),u=0;u<l;u++)c[u]=Array(l);for(u=0;u<l;u++)for(i=u;i<l;i++){for(m=0,s=0;s<a;s++)m+=(e[s][i]-r[i])*(e[s][u]-r[u]);m/=n,c[u][i]=m,c[i][u]=m}}else if(1===o){for(c=Array(a),u=0;u<a;u++)c[u]=Array(a);for(u=0;u<a;u++)for(i=u;i<a;i++){for(m=0,s=0;s<l;s++)m+=(e[i][s]-r[i])*(e[u][s]-r[u]);m/=n,c[u][i]=m,c[i][u]=m}}else throw new Error('Invalid dimension');return c},t.correlation=function(e){var n=t.mean(e),o=t.standardDeviation(e,!0,n),s=t.zScores(e,n,o),r=e.length,a=e[0].length,u=Array(a),m,i;for(m=0;m<a;m++)u[m]=Array(a);for(m=0;m<a;m++)for(i=m;i<a;i++){for(var d=0,c=0,g=s.length;c<g;c++)d+=s[c][i]*s[c][m];d/=r-1,u[m][i]=d,u[i][m]=d}return u},t.zScores=function(e,i,n){return i=i||t.mean(e),'undefined'==typeof n&&(n=t.standardDeviation(e,!0,i)),t.standardize(t.center(e,i,!1),n,!0)},t.center=function(e,n,o){n=n||t.mean(e);var s=e,r=e.length,a,i,l;if(!o)for(s=Array(r),a=0;a<r;a++)s[a]=Array(e[a].length);for(a=0;a<r;a++){var c=s[a];for(i=0,l=c.length;i<l;i++)c[i]=e[a][i]-n[i]}return s},t.standardize=function(e,n,o){'undefined'==typeof n&&(n=t.standardDeviation(e));var s=e,r=e.length,a,i,l;if(!o)for(s=Array(r),a=0;a<r;a++)s[a]=Array(e[a].length);for(a=0;a<r;a++){var c=s[a],u=e[a];for(i=0,l=c.length;i<l;i++)0===n[i]||isNaN(n[i])||(c[i]=u[i]/n[i])}return s},t.weightedVariance=function(e,n){var o=t.mean(e),s=e.length;if(0===s)return[];for(var r=e[0].length,l=Array(r),c=0;c<r;c++){for(var u=0,m=0,a=0,d=0;d<s;d++){var i=e[d][c]-o[c],g=n[d];u+=g*(i*i),a+=g,m+=g*g}l[c]=u*(a/(a*a-m))}return l},t.weightedMean=function(e,t,n){'undefined'==typeof n&&(n=0);var s=e.length;if(0===s)return[];var r=e[0].length,a,l,i,c,u,m;if(0===n){for(a=Array(r),l=0;l<r;l++)a[l]=0;for(l=0;l<s;l++)for(m=e[l],u=t[l],c=0;c<r;c++)a[c]+=m[c]*u}else if(1===n){for(a=Array(s),l=0;l<s;l++)a[l]=0;for(c=0;c<s;c++)for(m=e[c],u=t[c],l=0;l<r;l++)a[c]+=m[l]*u}else throw new Error('Invalid dimension');var d=o.sum(t);if(0!==d)for(l=0,i=a.length;l<i;l++)a[l]/=d;return a},t.weightedCovariance=function(e,n,o,s){s=s||0,o=o||t.weightedMean(e,n,s);for(var r=0,a=0,l=0,i=n.length;l<i;l++)r+=n[l],a+=n[l]*n[l];var c=r/(r*r-a);return t.weightedScatter(e,n,o,c,s)},t.weightedScatter=function(e,n,o,r,a){a=a||0,o=o||t.weightedMean(e,n,a),'undefined'==typeof r&&(r=1);var l=e.length;if(0===l)return[[]];var c=e[0].length,u,m,i,d,g;if(0===a){for(u=Array(c),m=0;m<c;m++)u[m]=Array(c);for(m=0;m<c;m++)for(i=m;i<c;i++){for(g=0,d=0;d<l;d++)g+=n[d]*(e[d][i]-o[i])*(e[d][m]-o[m]);u[m][i]=g*r,u[i][m]=g*r}}else if(1===a){for(u=Array(l),m=0;m<l;m++)u[m]=Array(l);for(m=0;m<l;m++)for(i=m;i<l;i++){for(g=0,d=0;d<c;d++)g+=n[d]*(e[i][d]-o[i])*(e[m][d]-o[m]);u[m][i]=g*r,u[i][m]=g*r}}else throw new Error('Invalid dimension');return u}},function(i,n){'use strict';function o(e,n,o,s,a){function l(e,t,i,n){return(n-t)/(i-e)}var c=e.length,u=(s-o)/(a-1),m=o-u/2,d=Array(a),g=e[1]-e[0],h=e[e.length-1]-e[e.length-2],p=m,k=m+u,x=t,w=0,f=e[0]-g,y=0,M=0,b=0,v=0,R=0,I=0,S=0,i=0;main:for(;;){for(;0<=f-k;){var j=r(0,k-x,b,w);if(I=M+j,d[i]=(I-R)/u,i++,i===a)break main;p=k,k+=u,R=I}x<=p&&p<=f&&(j=r(0,p-x,b,w),R=M+j),M+=r(x,f,b,v),x=f,w=y,S<c?(f=e[S],y=n[S],S++):S===c&&(f+=h,y=0),b=l(x,w,f,y),v=-b*x+w}return d}function s(t,n,o,s,r){var a=t.length,l=(s-o)/(r-1),c=t[t.length-1]-t[t.length-2],u=o-l/2,m=Array(r),d=u,g=u+l,h=-e,p=0,k=t[0],x=n[0],w=0,f=!0,y=0,M=0,b=1,i=0;main:for(;;){if(h>=k)throw new Error('x must be an increasing serie');for(;0<h-g;){if(f&&(M++,f=!1),m[i]=0>=M?0:y/M,i++,i===r)break main;d=g,g+=l,y=0,M=0}h>d&&(y+=p,M++),(h==-e||1<w)&&M--,h=k,p=x,b<a?(k=t[b],x=n[b],b++):(k+=c,x=0,w++)}return m}function r(e,t,i,n){return 0.5*i*t*t+n*t-(0.5*i*e*e+n*e)}n.getEquallySpacedData=function(e,t,i){1<e.length&&e[0]>e[1]&&(e=e.slice().reverse(),t=t.slice().reverse());var n=e.length;if(n!==t.length)throw new RangeError('the x and y vector doesn\'t have the same size.');i===void 0&&(i={});var r=i.from===void 0?e[0]:i.from;if(isNaN(r)||!isFinite(r))throw new RangeError('\'From\' value must be a number');var a=i.to===void 0?e[e.length-1]:i.to;if(isNaN(a)||!isFinite(a))throw new RangeError('\'To\' value must be a number');var l=r>a;if(l){var c=r;r=a,a=c}var u=i.numberOfPoints===void 0?100:i.numberOfPoints;if(isNaN(u)||!isFinite(u))throw new RangeError('\'Number of points\' value must be a number');if(1>u)throw new RangeError('the number of point must be higher than 1');var m='slot'===i.variant?'slot':'smooth',d='slot'==m?s(e,t,r,a,u):o(e,t,r,a,u);return l?d.reverse():d},n.integral=r},function(e,t,i){'use strict';t.SNV=function(e){for(var t=n.mean(e),o=n.standardDeviation(e),s=e.slice(),r=0;r<e.length;r++)s[r]=(s[r]-t)/o;return s};var n=i(2).array},function(e,t,i){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var n=i(14),o=function(e){return e&&e.__esModule?e:{default:e}}(n);class s extends o.default{constructor(e){super(e,e.columns,e.rows)}set(e,t,i){return this.matrix.set(t,e,i),this}get(e,t){return this.matrix.get(t,e)}}t.default=s},function(e,t,i){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var n=i(14),o=function(e){return e&&e.__esModule?e:{default:e}}(n);class s extends o.default{constructor(e,t){super(e,1,e.columns),this.row=t}set(e,t,i){return this.matrix.set(this.row,t,i),this}get(e,t){return this.matrix.get(this.row,t)}}t.default=s},function(e,t,i){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var n=i(14),o=function(e){return e&&e.__esModule?e:{default:e}}(n),s=i(23);class r extends o.default{constructor(e,t,i,n,o){(0,s.checkRange)(e,t,i,n,o),super(e,i-t+1,o-n+1),this.startRow=t,this.startColumn=n}set(e,t,i){return this.matrix.set(this.startRow+e,this.startColumn+t,i),this}get(e,t){return this.matrix.get(this.startRow+e,this.startColumn+t)}}t.default=r},function(e,t,i){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var n=i(14),o=function(e){return e&&e.__esModule?e:{default:e}}(n),s=i(23);class r extends o.default{constructor(e,t,i){var n=(0,s.checkIndices)(e,t,i);super(e,n.row.length,n.column.length),this.rowIndices=n.row,this.columnIndices=n.column}set(e,t,i){return this.matrix.set(this.rowIndices[e],this.columnIndices[t],i),this}get(e,t){return this.matrix.get(this.rowIndices[e],this.columnIndices[t])}}t.default=r},function(e,t,i){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var n=i(14),o=function(e){return e&&e.__esModule?e:{default:e}}(n);class s extends o.default{constructor(e,t){super(e,e.rows,1),this.column=t}set(e,t,i){return this.matrix.set(e,this.column,i),this}get(e){return this.matrix.get(e,this.column)}}t.default=s},function(e,t,i){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var n=i(14),o=function(e){return e&&e.__esModule?e:{default:e}}(n);class s extends o.default{constructor(e){super(e,e.rows,e.columns)}set(e,t,i){return this.matrix.set(this.rows-e-1,t,i),this}get(e,t){return this.matrix.get(this.rows-e-1,t)}}t.default=s},function(e,t,i){'use strict';Object.defineProperty(t,'__esModule',{value:!0});var n=i(14),o=function(e){return e&&e.__esModule?e:{default:e}}(n);class s extends o.default{constructor(e){super(e,e.rows,e.columns)}set(e,t,i){return this.matrix.set(e,this.columns-t-1,i),this}get(e,t){return this.matrix.get(e,this.columns-t-1)}}t.default=s},function(e,t,i){'use strict';function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){return e=r.default.checkMatrix(e),t=r.default.checkMatrix(t),e.isSquare()?new l.default(e).solve(t):new u.default(e).solve(t)}Object.defineProperty(t,'__esModule',{value:!0}),t.inverse=function(e){return e=r.default.checkMatrix(e),o(e,r.default.eye(e.rows))},t.solve=o;var s=i(4),r=n(s),a=i(33),l=n(a),c=i(53),u=n(c)},function(e,t,i){'use strict';function o(t,c){if(c=Object.assign({},g,c),!(this instanceof o))return new o(t,c);if(t=m.default.checkMatrix(t),!t.isSquare())throw new Error('Matrix is not a square matrix');var u=t.columns,n=(0,x.getFilled2DArray)(u,u,0),h=Array(u),d=Array(u),e=t,p=!1,k,i;if(p=!!c.assumeSymmetric||t.isSymmetric(),p){for(k=0;k<u;k++)for(i=0;i<u;i++)n[k][i]=e.get(k,i);s(u,d,h,n),r(u,d,h,n)}else{var j=(0,x.getFilled2DArray)(u,u,0),w=Array(u);for(i=0;i<u;i++)for(k=0;k<u;k++)j[k][i]=e.get(k,i);a(u,j,w,n),l(u,d,h,n,j)}this.n=u,this.e=d,this.d=h,this.V=n}function s(t,n,e,o){var s,r,a,l,i,c,m,d;for(i=0;i<t;i++)e[i]=o[t-1][i];for(l=t-1;0<l;l--){for(d=0,a=0,c=0;c<l;c++)d+=u(e[c]);if(0===d)for(n[l]=e[l-1],i=0;i<l;i++)e[i]=o[l-1][i],o[l][i]=0,o[i][l]=0;else{for(c=0;c<l;c++)e[c]/=d,a+=e[c]*e[c];for(s=e[l-1],r=R(a),0<s&&(r=-r),n[l]=d*r,a-=s*r,e[l-1]=s-r,i=0;i<l;i++)n[i]=0;for(i=0;i<l;i++){for(s=e[i],o[i][l]=s,r=n[i]+o[i][i]*s,c=i+1;c<=l-1;c++)r+=o[c][i]*e[c],n[c]+=o[c][i]*s;n[i]=r}for(s=0,i=0;i<l;i++)n[i]/=a,s+=n[i]*e[i];for(m=s/(a+a),i=0;i<l;i++)n[i]-=m*e[i];for(i=0;i<l;i++){for(s=e[i],r=n[i],c=i;c<=l-1;c++)o[c][i]-=s*n[c]+r*e[c];e[i]=o[l-1][i],o[l][i]=0}}e[l]=a}for(l=0;l<t-1;l++){if(o[t-1][l]=o[l][l],o[l][l]=1,a=e[l+1],0!==a){for(c=0;c<=l;c++)e[c]=o[c][l+1]/a;for(i=0;i<=l;i++){for(r=0,c=0;c<=l;c++)r+=o[c][l+1]*o[c][i];for(c=0;c<=l;c++)o[c][i]-=r*e[c]}}for(c=0;c<=l;c++)o[c][l+1]=0}for(i=0;i<t;i++)e[i]=o[t-1][i],o[t-1][i]=0;o[t-1][t-1]=1,n[0]=0}function r(t,n,e,o){var a,d,g,i,h,k,l,m,p,j,w,c,y,b,v,R,I;for(g=1;g<t;g++)n[g-1]=n[g];n[t-1]=0;var S=0,f=0,C=2.220446049250313e-16;for(k=0;k<t;k++){for(f=M(f,u(e[k])+u(n[k])),l=k;l<t&&!(u(n[l])<=C*f);)l++;if(l>k){I=0;do{for(++I,a=e[k],m=(e[k+1]-a)/(2*n[k]),p=(0,x.hypotenuse)(m,1),0>m&&(p=-p),e[k]=n[k]/(m+p),e[k+1]=n[k]*(m+p),j=e[k+1],d=a-e[k],g=k+2;g<t;g++)e[g]-=d;for(S+=d,m=e[l],w=1,c=w,y=w,b=n[k+1],v=0,R=0,g=l-1;g>=k;g--)for(y=c,c=w,R=v,a=w*n[g],d=w*m,p=(0,x.hypotenuse)(m,n[g]),n[g+1]=v*p,v=n[g]/p,w=m/p,m=w*e[g]-v*a,e[g+1]=d+v*(w*a+v*e[g]),h=0;h<t;h++)d=o[h][g+1],o[h][g+1]=v*o[h][g]+w*d,o[h][g]=w*o[h][g]-v*d;m=-v*R*y*b*n[k]/j,n[k]=v*m,e[k]=w*m}while(u(n[k])>C*f)}e[k]+=S,n[k]=0}for(g=0;g<t-1;g++){for(h=g,m=e[g],i=g+1;i<t;i++)e[i]<m&&(h=i,m=e[i]);if(h!==g)for(e[h]=e[g],e[g]=m,i=0;i<t;i++)m=o[i][g],o[i][g]=o[i][h],o[i][h]=m}}function a(e,t,n,o){var s=0,r=e-1,a,l,c,d,i,h,m;for(h=s+1;h<=r-1;h++){for(m=0,d=h;d<=r;d++)m+=u(t[d][h-1]);if(0!==m){for(c=0,d=r;d>=h;d--)n[d]=t[d][h-1]/m,c+=n[d]*n[d];for(l=R(c),0<n[h]&&(l=-l),c-=n[h]*l,n[h]-=l,i=h;i<e;i++){for(a=0,d=r;d>=h;d--)a+=n[d]*t[d][i];for(a/=c,d=h;d<=r;d++)t[d][i]-=a*n[d]}for(d=0;d<=r;d++){for(a=0,i=r;i>=h;i--)a+=n[i]*t[d][i];for(a/=c,i=h;i<=r;i++)t[d][i]-=a*n[i]}n[h]=m*n[h],t[h][h-1]=m*l}}for(d=0;d<e;d++)for(i=0;i<e;i++)o[d][i]=d===i?1:0;for(h=r-1;h>=s+1;h--)if(0!==t[h][h-1]){for(d=h+1;d<=r;d++)n[d]=t[d][h-1];for(i=h;i<=r;i++){for(l=0,d=h;d<=r;d++)l+=n[d]*o[d][i];for(l=l/n[h]/t[h][h-1],d=h;d<=r;d++)o[d][i]+=l*n[d]}}}function l(o,a,e,d,g){var h=o-1,n=0,f=o-1,b=2.220446049250313e-16,I=0,S=0,C=0,p=0,V=0,D=0,_=0,P=0,A,i,j,k,l,m,t,w,x,y,L,U,F,T,q;for(A=0;A<o;A++)for((A<n||A>f)&&(e[A]=g[A][A],a[A]=0),i=M(A-1,0);i<o;i++)S+=u(g[A][i]);for(;h>=n;){for(k=h;k>n&&(D=u(g[k-1][k-1])+u(g[k][k]),0===D&&(D=S),!(u(g[k][k-1])<b*D));)k--;if(k===h)g[h][h]+=I,e[h]=g[h][h],a[h]=0,h--,P=0;else if(k===h-1){if(t=g[h][h-1]*g[h-1][h],C=(g[h-1][h-1]-g[h][h])/2,p=C*C+t,_=R(u(p)),g[h][h]+=I,g[h-1][h-1]=g[h-1][h-1]+I,w=g[h][h],0<=p){for(_=0<=C?C+_:C-_,e[h-1]=w+_,e[h]=e[h-1],0!==_&&(e[h]=w-t/_),a[h-1]=0,a[h]=0,w=g[h][h-1],D=u(w)+u(_),C=w/D,p=_/D,V=R(C*C+p*p),C/=V,p/=V,i=h-1;i<o;i++)_=g[h-1][i],g[h-1][i]=p*_+C*g[h][i],g[h][i]=p*g[h][i]-C*_;for(A=0;A<=h;A++)_=g[A][h-1],g[A][h-1]=p*_+C*g[A][h],g[A][h]=p*g[A][h]-C*_;for(A=n;A<=f;A++)_=d[A][h-1],d[A][h-1]=p*_+C*d[A][h],d[A][h]=p*d[A][h]-C*_}else e[h-1]=w+C,e[h]=w+C,a[h-1]=_,a[h]=-_;h-=2,P=0}else{if(w=g[h][h],x=0,t=0,k<h&&(x=g[h-1][h-1],t=g[h][h-1]*g[h-1][h]),10==P){for(I+=w,A=n;A<=h;A++)g[A][A]-=w;D=u(g[h][h-1])+u(g[h-1][h-2]),w=x=0.75*D,t=-0.4375*D*D}if(30==P&&(D=(x-w)/2,D=D*D+t,0<D)){for(D=R(D),x<w&&(D=-D),D=w-t/((x-w)/2+D),A=n;A<=h;A++)g[A][A]-=D;I+=D,w=x=t=0.964}for(++P,l=h-2;l>=k&&(_=g[l][l],V=w-_,D=x-_,C=(V*D-t)/g[l+1][l]+g[l][l+1],p=g[l+1][l+1]-_-V-D,V=g[l+2][l+1],D=u(C)+u(p)+u(V),C/=D,p/=D,V/=D,l!==k)&&!(u(g[l][l-1])*(u(p)+u(V))<b*(u(C)*(u(g[l-1][l-1])+u(_)+u(g[l+1][l+1]))));)l--;for(A=l+2;A<=h;A++)g[A][A-2]=0,A>l+2&&(g[A][A-3]=0);for(j=l;j<=h-1&&(T=j!==h-1,j!==l&&(C=g[j][j-1],p=g[j+1][j-1],V=T?g[j+2][j-1]:0,w=u(C)+u(p)+u(V),0!==w&&(C/=w,p/=w,V/=w)),0!==w);j++)if(D=R(C*C+p*p+V*V),0>C&&(D=-D),0!==D){for(j===l?k!==l&&(g[j][j-1]=-g[j][j-1]):g[j][j-1]=-D*w,C+=D,w=C/D,x=p/D,_=V/D,p/=C,V/=C,i=j;i<o;i++)C=g[j][i]+p*g[j+1][i],T&&(C+=V*g[j+2][i],g[j+2][i]=g[j+2][i]-C*_),g[j][i]-=C*w,g[j+1][i]=g[j+1][i]-C*x;for(A=0;A<=v(h,j+3);A++)C=w*g[A][j]+x*g[A][j+1],T&&(C+=_*g[A][j+2],g[A][j+2]=g[A][j+2]-C*V),g[A][j]-=C,g[A][j+1]=g[A][j+1]-C*p;for(A=n;A<=f;A++)C=w*d[A][j]+x*d[A][j+1],T&&(C+=_*d[A][j+2],d[A][j+2]=d[A][j+2]-C*V),d[A][j]-=C,d[A][j+1]=d[A][j+1]-C*p}}}if(0!==S){for(h=o-1;0<=h;h--)if(C=e[h],p=a[h],0===p)for(k=h,g[h][h]=1,A=h-1;0<=A;A--){for(t=g[A][A]-C,V=0,i=k;i<=h;i++)V+=g[A][i]*g[i][h];if(0>a[A])_=t,D=V;else if(k=A,0===a[A]?g[A][h]=0===t?-V/(b*S):-V/t:(w=g[A][A+1],x=g[A+1][A],p=(e[A]-C)*(e[A]-C)+a[A]*a[A],m=(w*D-_*V)/p,g[A][h]=m,g[A+1][h]=u(w)>u(_)?(-V-t*m)/w:(-D-x*m)/_),m=u(g[A][h]),1<b*m*m)for(i=A;i<=h;i++)g[i][h]/=m}else if(0>p)for(k=h-1,u(g[h][h-1])>u(g[h-1][h])?(g[h-1][h-1]=p/g[h][h-1],g[h-1][h]=-(g[h][h]-C)/g[h][h-1]):(q=c(0,-g[h-1][h],g[h-1][h-1]-C,p),g[h-1][h-1]=q[0],g[h-1][h]=q[1]),g[h][h-1]=0,g[h][h]=1,A=h-2;0<=A;A--){for(y=0,L=0,i=k;i<=h;i++)y+=g[A][i]*g[i][h-1],L+=g[A][i]*g[i][h];if(t=g[A][A]-C,0>a[A])_=t,V=y,D=L;else if(k=A,0===a[A]?(q=c(-y,-L,t,p),g[A][h-1]=q[0],g[A][h]=q[1]):(w=g[A][A+1],x=g[A+1][A],U=(e[A]-C)*(e[A]-C)+a[A]*a[A]-p*p,F=2*(e[A]-C)*p,0===U&&0===F&&(U=b*S*(u(t)+u(p)+u(w)+u(x)+u(_))),q=c(w*V-_*y+p*L,w*D-_*L-p*y,U,F),g[A][h-1]=q[0],g[A][h]=q[1],u(w)>u(_)+u(p)?(g[A+1][h-1]=(-y-t*g[A][h-1]+p*g[A][h])/w,g[A+1][h]=(-L-t*g[A][h]-p*g[A][h-1])/w):(q=c(-V-x*g[A][h-1],-D-x*g[A][h],_,p),g[A+1][h-1]=q[0],g[A+1][h]=q[1])),m=M(u(g[A][h-1]),u(g[A][h])),1<b*m*m)for(i=A;i<=h;i++)g[i][h-1]=g[i][h-1]/m,g[i][h]/=m}for(A=0;A<o;A++)if(A<n||A>f)for(i=A;i<o;i++)d[A][i]=g[A][i];for(i=o-1;i>=n;i--)for(A=n;A<=f;A++){for(_=0,j=n;j<=v(i,f);j++)_+=d[A][j]*g[j][i];d[A][i]=_}}}function c(e,t,i,n){var o,s;return u(i)>u(n)?(o=n/i,s=i+o*n,[(e+o*t)/s,(t-o*e)/s]):(o=i/n,s=n+o*i,[(o*e+t)/s,(o*t-e)/s])}Object.defineProperty(t,'__esModule',{value:!0});var n=i(4),m=function(e){return e&&e.__esModule?e:{default:e}}(n),x=i(34),g={assumeSymmetric:!1};o.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return m.default.isMatrix(this.V)||(this.V=new m.default(this.V)),this.V},get diagonalMatrix(){var t=this.n,n=this.e,e=this.d,o=new m.default(t,t),s,i;for(s=0;s<t;s++){for(i=0;i<t;i++)o[s][i]=0;o[s][s]=e[s],0<n[s]?o[s][s+1]=n[s]:0>n[s]&&(o[s][s-1]=n[s])}return o}},t.default=o},function(e,t,i){'use strict';function n(e){if(!(this instanceof n))return new n(e);if(e=r.default.checkMatrix(e),!e.isSymmetric())throw new Error('Matrix is not symmetric');var t=e,o=t.rows,a=new r.default(o,o),l=!0,c,i,u;for(i=0;i<o;i++){var m=a[i],g=0;for(u=0;u<i;u++){var d=a[u],h=0;for(c=0;c<u;c++)h+=d[c]*m[c];m[u]=h=(t[i][u]-h)/a[u][u],g+=h*h}for(g=t[i][i]-g,l&=0<g,a[i][i]=R(M(g,0)),u=i+1;u<o;u++)a[i][u]=0}if(!l)throw new Error('Matrix is not positive definite');this.L=a}Object.defineProperty(t,'__esModule',{value:!0});var o=i(4),r=function(e){return e&&e.__esModule?e:{default:e}}(o);n.prototype={get lowerTriangularMatrix(){return this.L},solve:function(e){e=r.default.checkMatrix(e);var t=this.L,n=t.rows;if(e.rows!==n)throw new Error('Matrix dimensions do not match');var o=e.columns,s=e.clone(),a,i,l;for(l=0;l<n;l++)for(i=0;i<o;i++){for(a=0;a<l;a++)s[l][i]-=s[a][i]*t[l][a];s[l][i]/=t[l][l]}for(l=n-1;0<=l;l--)for(i=0;i<o;i++){for(a=l+1;a<n;a++)s[l][i]-=s[a][i]*t[a][l];s[l][i]/=t[l][l]}return s}},t.default=n},function(e,t,i){'use strict';function n(e){for(var t='',n=0,i;n<e.length;n++)i=(e[n]>>>0).toString(2),t+='00000000000000000000000000000000'.substr(i.length)+i;return t}var o=i(120);e.exports={count:function(e){for(var t=0,n=0;n<e.length;n++)t+=o[255&e[n]]+o[255&e[n]>>8]+o[255&e[n]>>16]+o[255&e[n]>>24];return t},and:function(e,t){for(var n=Array(e.length),o=0;o<e.length;o++)n[o]=e[o]&t[o];return n},or:function(e,t){for(var n=Array(e.length),o=0;o<e.length;o++)n[o]=e[o]|t[o];return n},xor:function(e,t){for(var n=Array(e.length),o=0;o<e.length;o++)n[o]=e[o]^t[o];return n},not:function(e){for(var t=Array(e.length),n=0;n<t.length;n++)t[n]=~e[n];return t},getBit:function(e,t){return!!(e[t>>5]&1<<31-t%32)},setBit:function(e,t,i){var n=t>>5,o=1<<31-t%32;return e[n]=i?o|e[n]:~o&e[n],e},toBinaryString:n,parseBinaryString:function(e){for(var t=e.length/32,n=Array(t),o=0;o<t;o++)n[o]=0|parseInt(e.substr(32*o,32),2);return n},toHexString:function(e){for(var t='',n=0,i;n<e.length;n++)i=(e[n]>>>0).toString(16),t+='00000000'.substr(i.length)+i;return t},parseHexString:function(e){for(var t=e.length/8,n=Array(t),o=0;o<t;o++)n[o]=0|parseInt(e.substr(8*o,8),16);return n},toDebug:function(e){for(var t=n(e),o='',s=0;s<e.length;s++){o+='0000'.substr((32*s).toString(16).length)+(32*s).toString(16)+':';for(var i=0;32>i;i+=4)o+=' '+t.substr(32*s+i,4);s<e.length-1&&(o+='\n')}return o}}},function(e){'use strict';for(var t=Array(256),n=0;256>n;n++){for(var i=n,o=0;i;)i&=i-1,o++;t[n]=o}e.exports=t},function(e){'use strict';e.exports=function(e,t){e=e||0;for(var n=Array(e),o=0;o<e;o++)n[o]=t;return n}},function(e,t,i){'use strict';var n=i(55),o=i(56).asc,s=2147483647,r=[s,5,11,23,47,97,197,397,797,1597,3203,6421,12853,25717,51437,102877,205759,411527,823117,1646237,3292489,6584983,13169977,26339969,52679969,105359939,210719881,421439783,842879579,1685759167,433,877,1759,3527,7057,14143,28289,56591,113189,226379,452759,905551,1811107,3622219,7244441,14488931,28977863,57955739,115911563,231823147,463646329,927292699,1854585413,953,1907,3821,7643,15287,30577,61169,122347,244703,489407,978821,1957651,3915341,7830701,15661423,31322867,62645741,125291483,250582987,501165979,1002331963,2004663929,1039,2081,4177,8363,16729,33461,66923,133853,267713,535481,1070981,2141977,4283963,8567929,17135863,34271747,68543509,137087021,274174111,548348231,1096696463,31,67,137,277,557,1117,2237,4481,8963,17929,35863,71741,143483,286973,573953,1147921,2295859,4591721,9183457,18366923,36733847,73467739,146935499,293871013,587742049,1175484103,599,1201,2411,4831,9677,19373,38747,77509,155027,310081,620171,1240361,2480729,4961459,9922933,19845871,39691759,79383533,158767069,317534141,635068283,1270136683,311,631,1277,2557,5119,10243,20507,41017,82037,164089,328213,656429,1312867,2625761,5251529,10503061,21006137,42012281,84024581,168049163,336098327,672196673,1344393353,3,7,17,37,79,163,331,673,1361,2729,5471,10949,21911,43853,87719,175447,350899,701819,1403641,2807303,5614657,11229331,22458671,44917381,89834777,179669557,359339171,718678369,1437356741,43,89,179,359,719,1439,2879,5779,11579,23159,46327,92657,185323,370661,741337,1482707,2965421,5930887,11861791,23723597,47447201,94894427,189788857,379577741,759155483,1518310967,379,761,1523,3049,6101,12203,24407,48817,97649,195311,390647,781301,1562611,3125257,6250537,12501169,25002389,50004791,100009607,200019221,400038451,800076929,1600153859,13,29,59,127,257,521,1049,2099,4201,8419,16843,33703,67409,134837,269683,539389,1078787,2157587,4315183,8630387,17260781,34521589,69043189,138086407,276172823,552345671,1104691373,19,41,83,167,337,677,1361,2729,5471,10949,21911,43853,87719,175447,350899,701819,1403641,2807303,5614657,11229331,22458671,44917381,89834777,179669557,359339171,718678369,1437356741,53,107,223,449,907,1823,3659,7321,14653,29311,58631,117269,234539,469099,938207,1876417,3752839,7505681,15011389,30022781,60045577,120091177,240182359,480364727,960729461,1921458943];r.sort(o),t.nextPrime=function(e){var t=n(r,e,o);return 0>t&&(t=~t),r[t]},t.largestPrime=s},function(e){'use strict';e.exports=Number.isNaN||function(e){return e!==e}},function(e,t,i){'use strict';function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0}),t.RobustPolynomialRegression=t.TheilSenRegression=t.PolinomialFitting2D=t.KRR=t.KernelRidgeRegression=t.NonLinearRegression=t.NLR=t.MultivariateLinearRegression=t.PowerRegression=t.ExponentialRegression=t.PolynomialRegression=t.SLR=t.SimpleLinearRegression=void 0;var o=i(36);Object.defineProperty(t,'SimpleLinearRegression',{enumerable:!0,get:function(){return n(o).default}}),Object.defineProperty(t,'SLR',{enumerable:!0,get:function(){return n(o).default}});var s=i(58);Object.defineProperty(t,'PolynomialRegression',{enumerable:!0,get:function(){return n(s).default}});var r=i(127);Object.defineProperty(t,'ExponentialRegression',{enumerable:!0,get:function(){return n(r).default}});var a=i(128);Object.defineProperty(t,'PowerRegression',{enumerable:!0,get:function(){return n(a).default}});var l=i(129);Object.defineProperty(t,'MultivariateLinearRegression',{enumerable:!0,get:function(){return n(l).default}});var c=i(130);Object.defineProperty(t,'KernelRidgeRegression',{enumerable:!0,get:function(){return n(c).default}}),Object.defineProperty(t,'KRR',{enumerable:!0,get:function(){return n(c).default}});var u=i(141);Object.defineProperty(t,'PolinomialFitting2D',{enumerable:!0,get:function(){return n(u).default}});var m=i(142);Object.defineProperty(t,'TheilSenRegression',{enumerable:!0,get:function(){return n(m).default}});var d=i(143);Object.defineProperty(t,'RobustPolynomialRegression',{enumerable:!0,get:function(){return n(d).default}});var g=i(144),h=n(g),p={PotentialRegression:h.default};t.NLR=p,t.NonLinearRegression=p},function(e,t){'use strict';Object.defineProperty(t,'__esModule',{value:!0}),t.default=function(e,t){return 0>e?(e=0-e,'number'==typeof t?'- '+e.toPrecision(t):'- '+e.toString()):'number'==typeof t?e.toPrecision(t):e.toString()}},function(e,t){'use strict';Object.defineProperty(t,'__esModule',{value:!0}),t.default=function(e,t){if(!Array.isArray(e)||!Array.isArray(t))throw new TypeError('x and y must be arrays');if(e.length!==t.length)throw new RangeError('x and y arrays must have the same length')}},function(e,t,i){'use strict';function n(e){return e&&e.__esModule?e:{default:e}}function s(e,t,s){for(var a=t.length,n=Array(a),l=0;l<a;l++)n[l]=r(s[l]);var i=new u.default(t,n);e.A=i.slope,e.B=o(i.intercept)}Object.defineProperty(t,'__esModule',{value:!0});var a=i(3),l=n(a),c=i(36),u=n(c);class m extends l.default{constructor(e,t){super(),!0===e?(this.A=t.A,this.B=t.B):((0,a.checkArrayLength)(e,t),s(this,e,t))}_predict(e){return this.B*o(e*this.A)}toJSON(){return{name:'exponentialRegression',A:this.A,B:this.B}}toString(e){return'f(x) = '+(0,a.maybeToPrecision)(this.B,e)+' * e^('+(0,a.maybeToPrecision)(this.A,e)+' * x)'}toLaTeX(e){return 0<=this.A?'f(x) = '+(0,a.maybeToPrecision)(this.B,e)+'e^{'+(0,a.maybeToPrecision)(this.A,e)+'x}':'f(x) = \\frac{'+(0,a.maybeToPrecision)(this.B,e)+'}{e^{'+(0,a.maybeToPrecision)(-this.A,e)+'x}}'}static load(e){if('exponentialRegression'!==e.name)throw new TypeError('not a exponential regression model');return new m(!0,e)}}t.default=m},function(e,t,i){'use strict';function n(e){return e&&e.__esModule?e:{default:e}}function s(e,t,s){for(var a=t.length,n=Array(a),l=Array(a),c=0;c<a;c++)n[c]=r(t[c]),l[c]=r(s[c]);var i=new m.default(n,l);e.A=o(i.intercept),e.B=i.slope}Object.defineProperty(t,'__esModule',{value:!0});var a=i(3),l=n(a),u=i(36),m=n(u);class d extends l.default{constructor(e,t){super(),!0===e?(this.A=t.A,this.B=t.B):((0,a.checkArrayLength)(e,t),s(this,e,t))}_predict(e){return this.A*c(e,this.B)}toJSON(){return{name:'powerRegression',A:this.A,B:this.B}}toString(e){return'f(x) = '+(0,a.maybeToPrecision)(this.A,e)+' * x^'+(0,a.maybeToPrecision)(this.B,e)}toLaTeX(e){return 0<=this.B?'f(x) = '+(0,a.maybeToPrecision)(this.A,e)+'x^{'+(0,a.maybeToPrecision)(this.B,e)+'}':'f(x) = \\frac{'+(0,a.maybeToPrecision)(this.A,e)+'}{x^{'+(0,a.maybeToPrecision)(-this.B,e)+'}}'}static load(e){if('powerRegression'!==e.name)throw new TypeError('not a power regression model');return new d(!0,e)}}t.default=d},function(e,t,i){'use strict';function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var o=i(13),s=n(o),r=i(3),a=n(r);class l extends a.default{constructor(e,t,i={}){var n=i.intercept,r=!(n!==void 0)||n;super(),!0===e?(this.weights=t.weights,this.inputs=t.inputs,this.outputs=t.outputs,this.intercept=t.intercept):(r&&(e=new s.default(e),e.addColumn(Array(e.length).fill(1))),this.weights=new o.SVD(e,{autoTranspose:!0}).solve(t).to2DArray(),this.inputs=e[0].length,this.outputs=t[0].length,r&&this.inputs--,this.intercept=r)}predict(e){if(Array.isArray(e)){if('number'==typeof e[0])return this._predict(e);if(Array.isArray(e[0])){for(var t=Array(e.length),n=0;n<e.length;n++)t[n]=this._predict(e[n]);return t}}throw new TypeError('x must be a matrix or array of numbers')}_predict(e){var t=Array(this.outputs);if(this.intercept)for(var n=0;n<this.outputs;n++)t[n]=this.weights[this.inputs][n];else t.fill(0);for(var i=0;i<this.inputs;i++)for(var o=0;o<this.outputs;o++)t[o]+=this.weights[i][o]*e[i];return t}score(){throw new Error('score method is not implemented yet')}toJSON(){return{name:'multivariateLinearRegression',weights:this.weights,inputs:this.inputs,outputs:this.outputs,intercept:this.intercept}}static load(e){if('multivariateLinearRegression'!==e.name)throw new Error('not a MLR model');return new l(!0,e)}}t.default=l},function(e,t,i){'use strict';function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var o=i(13),s=i(37),r=n(s),a=i(3),l=n(a),c={lambda:0.1,kernelType:'gaussian',kernelOptions:{},computeCoefficient:!1};class u extends l.default{constructor(e,t,i){if(super(),!0===e)this.alpha=t.alpha,this.inputs=t.inputs,this.kernelType=t.kernelType,this.kernelOptions=t.kernelOptions,this.kernel=new r.default(t.kernelType,t.kernelOptions);else{i=Object.assign({},c,i);var s=new r.default(i.kernelType,i.kernelOptions),a=s.compute(e),l=e.length;a.add(o.Matrix.eye(l,l).mul(i.lambda)),this.alpha=(0,o.solve)(a,t),this.inputs=e,this.kernelType=i.kernelType,this.kernelOptions=i.kernelOptions,this.kernel=s}}_predict(e){return this.kernel.compute([e],this.inputs).mmul(this.alpha)[0]}toJSON(){return{name:'kernelRidgeRegression',alpha:this.alpha,inputs:this.inputs,kernelType:this.kernelType,kernelOptions:this.kernelOptions}}static load(e){if('kernelRidgeRegression'!==e.name)throw new TypeError('not a KRR model');return new u(!0,e)}}t.default=u},function(e,t,i){'use strict';var n=i(0).squared,s={sigma:1};e.exports=class{constructor(e){e=Object.assign({},s,e),this.sigma=e.sigma,this.divisor=2*e.sigma*e.sigma}compute(e,t){var i=n(e,t);return o(-i/this.divisor)}}},function(e){'use strict';var t={degree:1,constant:1,scale:1};e.exports=class{constructor(e){e=Object.assign({},t,e),this.degree=e.degree,this.constant=e.constant,this.scale=e.scale}compute(e,t){for(var n=0,o=0;o<e.length;o++)n+=e[o]*t[o];return c(this.scale*n+this.constant,this.degree)}}},function(e){'use strict';var t={sigma:1,degree:1};e.exports=class{constructor(e){e=Object.assign({},t,e),this.sigma=e.sigma,this.degree=e.degree}compute(e,t){for(var n=0,s=v(e.length,t.length),r=1;r<=s;++r)n+=c(o(-this.sigma*c(c(e[r-1],r)-c(t[r-1],r),2)),this.degree);return n}}},function(e,t,i){'use strict';var n=i(0).squared,o={sigma:1};e.exports=class{constructor(e){e=Object.assign({},o,e),this.sigma=e.sigma}compute(e,t){return 1/(1+n(e,t)/(this.sigma*this.sigma))}}},function(e,t,i){'use strict';var n=i(0),s={sigma:1};e.exports=class{constructor(e){e=Object.assign({},s,e),this.sigma=e.sigma,this.divisor=2*e.sigma*e.sigma}compute(e,t){var i=n(e,t);return o(-i/this.divisor)}}},function(e){'use strict';e.exports=class{compute(e,t){for(var n=v(e.length,t.length),o=0,s=0;s<n;++s)o+=v(e[s],t[s]);return o}}},function(e,t,i){'use strict';var n=i(0),s={sigma:1};e.exports=class{constructor(e){e=Object.assign({},s,e),this.sigma=e.sigma}compute(e,t){var i=n(e,t);return o(-i/this.sigma)}}},function(e,t,i){'use strict';var n=i(0).squared,o={constant:1};e.exports=class{constructor(e){e=Object.assign({},o,e),this.constant=e.constant}compute(e,t){return R(n(e,t)+this.constant*this.constant)}}},function(e,t,i){'use strict';var n=i(0).squared,o={constant:1};e.exports=class{constructor(e){e=Object.assign({},o,e),this.constant=e.constant}compute(e,t){var i=n(e,t);return 1-i/(i+this.constant)}}},function(e){'use strict';var t={alpha:0.01,constant:-Math.E};e.exports=class{constructor(e){e=Object.assign({},t,e),this.alpha=e.alpha,this.constant=e.constant}compute(e,t){for(var o=0,s=0;s<e.length;s++)o+=e[s]*t[s];return n(this.alpha*o+this.constant)}}},function(e,t,i){'use strict';function n(e,t){for(var n=e.clone(),o=0;o<e.rows;++o)n[o][0]=c(n[o][0],t);return n}function o(e,t){this[e][t]=u(this[e][t])}Object.defineProperty(t,'__esModule',{value:!0});var s=i(13),r=i(3),a=function(e){return e&&e.__esModule?e:{default:e}}(r),l={order:2};class m extends a.default{constructor(e,t,i){super(),!0===e?(this.coefficients=s.Matrix.columnVector(t.coefficients),this.order=t.order,t.r&&(this.r=t.r,this.r2=t.r2),t.chi2&&(this.chi2=t.chi2)):(i=Object.assign({},l,i),this.order=i.order,this.coefficients=[],this.X=e,this.y=t,this.train(this.X,this.y,i))}train(e,t){if(s.Matrix.isMatrix(e)||(e=new s.Matrix(e)),s.Matrix.isMatrix(t)||(t=s.Matrix.columnVector(t)),t.rows!==e.rows&&(t=t.transpose()),2!==e.columns)throw new RangeError('You give X with '+e.columns+' columns and it must be 2');if(e.rows!==t.rows)throw new RangeError('X and y must have the same rows');var r=e.rows,a=(this.order+2)*(this.order+1)/2;this.coefficients=Array(a);var l=e.getColumnVector(0),u=e.getColumnVector(1),m=1/l.clone().apply(o).max(),d=1/u.clone().apply(o).max(),g=1/t.clone().apply(o).max();l.mulColumn(0,m),u.mulColumn(0,d),t.mulColumn(0,g);for(var h=new s.Matrix(r,a),p=0,k=0,i;k<=this.order;++k){i=this.order-k;for(var x=0,j;x<=i;++x)j=n(l,k).mulColumnVector(n(u,x)),h.setColumn(p,j),p++}var w=new s.SVD(h.transpose(),{computeLeftSingularVectors:!0,computeRightSingularVectors:!0,autoTranspose:!1}),f=s.Matrix.rowVector(w.diagonal);f=f.apply(function(e,t){this[e][t]=1e-15<=this[e][t]?1/this[e][t]:0});var y=s.Matrix.zeros(r,a);for(k=0;k<a;++k)y[k][k]=f[0][k];f=y;var M=w.rightSingularVectors,b=w.leftSingularVectors;for(this.coefficients=b.mmul(f.transpose()).mmul(M.transpose()).mmul(t),p=0,k=0;k<=a;++k)for(i=this.order-k,x=0;x<=i;++x)this.coefficients[p][0]=this.coefficients[p][0]*c(m,k)*c(d,x)/g,p++}_predict(e){for(var t=e[0],n=e[1],o=0,s=0,r=0;r<=this.order;r++)for(var i=0;i<=this.order-r;i++)o+=c(t,r)*c(n,i)*this.coefficients[s][0],s++;return o}toJSON(){return{name:'polyfit2D',order:this.order,coefficients:this.coefficients}}static load(e){if('polyfit2D'!==e.name)throw new TypeError('not a polyfit2D model');return new m(!0,e)}}t.default=m},function(e,t,i){'use strict';function n(e,t,n){for(var o=t.length,s=Array(o*o),r=0,l=0;l<o;++l)for(var i=l+1;i<o;++i)t[l]!==t[i]&&(s[r++]=(n[i]-n[l])/(t[i]-t[l]));s.length=r;for(var c=a(s),u=Array(o),m=0;m<o;++m)u[m]=n[m]-c*t[m];e.slope=c,e.intercept=a(u),e.coefficients=[e.intercept,e.slope]}Object.defineProperty(t,'__esModule',{value:!0});var o=i(3),s=function(e){return e&&e.__esModule?e:{default:e}}(o),r=i(2),a=r.array.median;class l extends s.default{constructor(e,t){super(),!0===e?(this.slope=t.slope,this.intercept=t.intercept,this.coefficients=t.coefficients):((0,o.checkArrayLength)(e,t),n(this,e,t))}toJSON(){return{name:'TheilSenRegression',slope:this.slope,intercept:this.intercept}}_predict(e){return this.slope*e+this.intercept}computeX(e){return(e-this.intercept)/this.slope}toString(e){var t='f(x) = ';if(this.slope){var i=(0,o.maybeToPrecision)(this.slope,e);if(t+=(1e-5>u(i-1)?'':i+' * ')+'x',this.intercept){var n=u(this.intercept),s=n===this.intercept?'+':'-';t+=' '+s+' '+(0,o.maybeToPrecision)(n,e)}}else t+=(0,o.maybeToPrecision)(this.intercept,e);return t}toLaTeX(e){return this.toString(e)}static load(e){if('TheilSenRegression'!==e.name)throw new TypeError('not a Theil-Sen model');return new l(!0,e)}}t.default=l},function(e,t,i){'use strict';function n(e,t,n,l){for(var c=Array(l),u=0;u<l;u++)c[u]=u;for(var m=o(t,n,l),d=0,i;d<m.length;d++){for(var g=m[d],h=s(g,c),p=t.slice(),k=0;k<t.length;k++)p[k]=n[k]-r(t[k],c,h),p[k]={residual:p[k]*p[k],coefficients:h};var j=a(p);(!i||j.residual<i.residual)&&(i=j)}e.degree=l,e.powers=c,e.coefficients=i.coefficients}function o(e,t,n){for(var o=g(e.length/n),s=Array(o),r=0;r<e.length;r++){for(var i=g(Math.random()*o),a=0;a<e.length;)if(!s[i]){s[i]=[{x:e[r],y:t[r]}];break}else if(s[i].length<n){s[i].push({x:e[r],y:t[r]});break}else a++,i=(i+1)%o;if(a===e.length)return s}return s}function s(e,t){for(var n=e.slice(),o=e.slice(),s=0;s<n.length;s++){o[s]=[e[s].y],n[s]=Array(t.length);for(var i=0;i<t.length;i++)n[s][i]=c(e[s].x,t[i])}return(0,m.solve)(n,o).to1DArray()}function r(e,t,i){for(var n=0,o=0;o<t.length;o++)n+=i[o]*c(e,t[o]);return n}function a(e){e.sort((e,t)=>e.residual-t.residual);var t=e.length,i=g(t/2);return 0==t%2?e[i-1]:e[i]}Object.defineProperty(t,'__esModule',{value:!0});var l=i(3),u=function(e){return e&&e.__esModule?e:{default:e}}(l),m=i(13);class d extends u.default{constructor(e,t,i){super(),!0===e?(this.degree=t.degree,this.powers=t.powers,this.coefficients=t.coefficients):((0,l.checkArrayLength)(e,t),n(this,e,t,i))}toJSON(){return{name:'robustPolynomialRegression',degree:this.degree,powers:this.powers,coefficients:this.coefficients}}_predict(e){return r(e,this.powers,this.coefficients)}toString(e){return this._toFormula(e,!1)}toLaTeX(e){return this._toFormula(e,!0)}_toFormula(e,t){var i='^',n='',o=' * ';t&&(i='^{',n='}',o='');for(var s='',r='',a=0;a<this.coefficients.length;a++)r='',0!==this.coefficients[a]&&(r=0===this.powers[a]?(0,l.maybeToPrecision)(this.coefficients[a],e):1===this.powers[a]?(0,l.maybeToPrecision)(this.coefficients[a],e)+o+'x':(0,l.maybeToPrecision)(this.coefficients[a],e)+o+'x'+i+this.powers[a]+n,0<this.coefficients[a]&&a!==this.coefficients.length-1?r=' + '+r:a!==this.coefficients.length-1&&(r=' '+r)),s=r+s;return'+'===s.charAt(0)&&(s=s.slice(1)),'f(x) = '+s}static load(e){if('robustPolynomialRegression'!==e.name)throw new TypeError('not a RobustPolynomialRegression model');return new d(!0,e)}}t.default=d},function(e,t,i){'use strict';function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,'__esModule',{value:!0});var o=i(3),s=n(o),r=i(58),a=n(r);class l extends s.default{constructor(e,t,i){if(super(),!0===e)this.A=t.A,this.M=t.M;else{var o=e.length;if(o!==t.length)throw new RangeError('input and output array have a different length');var n=new a.default(e,t,[i]);this.A=n.coefficients[0],this.M=i}}_predict(e){return this.A*c(e,this.M)}toJSON(){return{name:'potentialRegression',A:this.A,M:this.M}}toString(e){return'f(x) = '+(0,o.maybeToPrecision)(this.A,e)+' * x^'+this.M}toLaTeX(e){return 0<=this.M?'f(x) = '+(0,o.maybeToPrecision)(this.A,e)+'x^{'+this.M+'}':'f(x) = \\frac{'+(0,o.maybeToPrecision)(this.A,e)+'}{x^{'+-this.M+'}}'}static load(e){if('potentialRegression'!==e.name)throw new TypeError('not a potential regression model');return new l(!0,e)}}t.default=l},function(e,t,i){'use strict';t.distance=i(146),t.similarity=i(183)},function(e,t,i){'use strict';t.additiveSymmetric=i(147),t.avg=i(148),t.bhattacharyya=i(149),t.canberra=i(150),t.chebyshev=i(151),t.clark=i(152),t.czekanowski=i(153),t.dice=i(60),t.divergence=i(154),t.euclidean=i(0),t.fidelity=i(155),t.gower=i(156),t.harmonicMean=i(157),t.hellinger=i(158),t.innerProduct=i(159),t.intersection=i(61),t.jaccard=i(62),t.jeffreys=i(160),t.jensenDifference=i(161),t.jensenShannon=i(162),t.kdivergence=i(163),t.kulczynski=i(63),t.kullbackLeibler=i(164),t.kumarHassebrook=i(165),t.kumarJohnson=i(166),t.lorentzian=i(167),t.manhattan=i(168),t.matusita=i(169),t.minkowski=i(170),t.motyka=i(64),t.neyman=i(171),t.pearson=i(172),t.probabilisticSymmetric=i(173),t.ruzicka=i(174),t.soergel=i(175),t.sorensen=i(176),t.squared=i(177),t.squaredChord=i(65),t.squaredEuclidean=i(0).squared,t.taneja=i(178),t.tanimoto=i(179),t.topsoe=i(180),t.tree=i(181),t.waveHedges=i(182)},function(e){'use strict';e.exports=function(e,t){for(var n=0,i=e.length,o=0;n<i;n++)o+=(e[n]-t[n])*(e[n]-t[n])*(e[n]+t[n])/(e[n]*t[n]);return 2*o}},function(e){'use strict';e.exports=function(e,t){for(var n=e.length,o=0,s=0,r=0,a=0;a<n;a++)r=u(e[a]-t[a]),s+=r,o<r&&(o=r);return(o+s)/2}},function(e){'use strict';e.exports=function(e,t){for(var n=e.length,o=0,s=0;s<n;s++)o+=R(e[s]*t[s]);return-r(o)}},function(e){'use strict';e.exports=function(e,t){for(var n=e.length,o=0,s=0;s<n;s++)o+=u(e[s]-t[s])/(e[s]+t[s]);return o}},function(e){'use strict';e.exports=function(e,t){for(var n=e.length,o=0,s=0,r=0;r<n;r++)s=u(e[r]-t[r]),o<s&&(o=s);return o}},function(e){'use strict';e.exports=function(e,t){for(var n=0,i=e.length,o=0;n<i;n++)o+=R((e[n]-t[n])*(e[n]-t[n])/((e[n]+t[n])*(e[n]+t[n])));return 2*o}},function(e,t,i){'use strict';var n=i(59);e.exports=function(e,t){return 1-n(e,t)}},function(e){'use strict';e.exports=function(e,t){for(var n=0,i=e.length,o=0;n<i;n++)o+=(e[n]-t[n])*(e[n]-t[n])/((e[n]+t[n])*(e[n]+t[n]));return 2*o}},function(e){'use strict';e.exports=function(e,t){for(var n=e.length,o=0,s=0;s<n;s++)o+=R(e[s]*t[s]);return o}},function(e){'use strict';e.exports=function(e,t){for(var n=e.length,o=0,s=0;s<n;s++)o+=u(e[s]-t[s]);return o/n}},function(e){'use strict';e.exports=function(e,t){for(var n=e.length,o=0,s=0;s<n;s++)o+=e[s]*t[s]/(e[s]+t[s]);return 2*o}},function(e){'use strict';e.exports=function(e,t){for(var n=e.length,o=0,s=0;s<n;s++)o+=R(e[s]*t[s]);return 2*R(1-o)}},function(e){'use strict';e.exports=function(e,t){for(var n=e.length,o=0,s=0;s<n;s++)o+=e[s]*t[s];return o}},function(e){'use strict';e.exports=function(e,t){for(var n=e.length,o=0,s=0;s<n;s++)o+=(e[s]-t[s])*r(e[s]/t[s]);return o}},function(e){'use strict';e.exports=function(e,t){for(var n=e.length,o=0,s=0;s<n;s++)o+=(e[s]*r(e[s])+t[s]*r(t[s]))/2-(e[s]+t[s])/2*r((e[s]+t[s])/2);return o}},function(e){'use strict';e.exports=function(e,t){for(var n=e.length,o=0,s=0,a=0;a<n;a++)o+=e[a]*r(2*e[a]/(e[a]+t[a])),s+=t[a]*r(2*t[a]/(e[a]+t[a]));return(o+s)/2}},function(e){'use strict';e.exports=function(e,t){for(var n=e.length,o=0,s=0;s<n;s++)o+=e[s]*r(2*e[s]/(e[s]+t[s]));return o}},function(e){'use strict';e.exports=function(e,t){for(var n=e.length,o=0,s=0;s<n;s++)o+=e[s]*r(e[s]/t[s]);return o}},function(e){'use strict';e.exports=function(e,t){for(var n=e.length,o=0,s=0,r=0,a=0;a<n;a++)o+=e[a]*t[a],s+=e[a]*e[a],r+=t[a]*t[a];return o/(s+r-o)}},function(e){'use strict';e.exports=function(e,t){for(var n=e.length,o=0,s=0;s<n;s++)o+=c(e[s]*e[s]-t[s]*t[s],2)/(2*c(e[s]*t[s],1.5));return o}},function(e){'use strict';e.exports=function(e,t){for(var n=e.length,o=0,s=0;s<n;s++)o+=r(u(e[s]-t[s])+1);return o}},function(e){'use strict';e.exports=function(e,t){for(var n=0,i=e.length,o=0;n<i;n++)o+=u(e[n]-t[n]);return o}},function(e){'use strict';e.exports=function(e,t){for(var n=e.length,o=0,s=0;s<n;s++)o+=R(e[s]*t[s]);return R(2-2*o)}},function(e){'use strict';e.exports=function(e,t,n){for(var o=0,i=e.length,s=0;o<i;o++)s+=c(u(e[o]-t[o]),n);return c(s,1/n)}},function(e){'use strict';e.exports=function(e,t){for(var n=0,i=e.length,o=0;n<i;n++)o+=(e[n]-t[n])*(e[n]-t[n])/e[n];return o}},function(e){'use strict';e.exports=function(e,t){for(var n=0,i=e.length,o=0;n<i;n++)o+=(e[n]-t[n])*(e[n]-t[n])/t[n];return o}},function(e){'use strict';e.exports=function(e,t){for(var n=0,i=e.length,o=0;n<i;n++)o+=(e[n]-t[n])*(e[n]-t[n])/(e[n]+t[n]);return 2*o}},function(e){'use strict';e.exports=function(e,t){for(var n=e.length,o=0,s=0,r=0;r<n;r++)o+=v(e[r],t[r]),s+=M(e[r],t[r]);return o/s}},function(e){'use strict';e.exports=function(e,t){for(var n=e.length,o=0,s=0,r=0;r<n;r++)o+=u(e[r]-t[r]),s+=M(e[r],t[r]);return o/s}},function(e){'use strict';e.exports=function(e,t){for(var n=e.length,o=0,s=0,r=0;r<n;r++)o+=u(e[r]-t[r]),s+=e[r]+t[r];return o/s}},function(e){'use strict';e.exports=function(e,t){for(var n=0,i=e.length,o=0;n<i;n++)o+=(e[n]-t[n])*(e[n]-t[n])/(e[n]+t[n]);return o}},function(e){'use strict';e.exports=function(e,t){for(var n=e.length,o=0,s=0;s<n;s++)o+=(e[s]+t[s])/2*r((e[s]+t[s])/(2*R(e[s]*t[s])));return o}},function(e,t,i){'use strict';var n=i(66);e.exports=function(e,t,o){if(o)return 1-n(e,t,o);for(var s=e.length,r=0,a=0,l=0,c=0;c<s;c++)r+=e[c],a+=t[c],l+=v(e[c],t[c]);return(r+a-2*l)/(r+a-l)}},function(e){'use strict';e.exports=function(e,t){for(var n=e.length,o=0,s=0;s<n;s++)o+=e[s]*r(2*e[s]/(e[s]+t[s]))+t[s]*r(2*t[s]/(e[s]+t[s]));return o}},function(e){'use strict';function t(e,n,o,s,r,a){if(r=r||0.16,a=a||0.01,!(s-o<r)){for(var l=0,c=0;e[c]<s;c++)e[c]>o&&(l+=n[c]);if(!(l<a)){for(var i=0,u=0;e[u]<s;u++)e[c]>o&&(i+=e[u]*n[u]);return i/=l,1e-5>i-o||1e-5>s-i?void 0:i-o<r/4?t(e,n,i,s,r,a):s-i<r/4?t(e,n,o,i,r,a):{sum:l,center:i,left:t(e,n,o,i,r,a),right:t(e,n,i,s,r,a)}}}}function i(e,t,n,s,r){if(e===void 0||t===void 0)return 0;var a=n*v(e.sum,t.sum)/M(e.sum,t.sum)+(1-n)*o(-r*u(e.center-t.center));return s*a+(1-s)*(i(e.left,t.left,n,s,r)+i(e.right,t.right,n,s,r))}var n={minWindow:0.16,threshold:0.01,alpha:0.1,beta:0.33,gamma:1e-3};e.exports={calc:function(e,s,r,a,l){for(var c in l=l||{},n)l.hasOwnProperty(c)||(l[c]=n[c]);var o,u;return o=e.sum?e:t(e.x,e.y,r,a,l.minWindow,l.threshold),u=s.sum?s:t(s.x,s.y,r,a,l.minWindow,l.threshold),i(o,u,l.alpha,l.beta,l.gamma)},createTree:t}},function(e){'use strict';e.exports=function(e,t){for(var n=e.length,o=0,s=0;s<n;s++)o+=1-v(e[s],t[s])/M(e[s],t[s]);return o}},function(e,t,i){'use strict';t.cosine=i(67),t.czekanowski=i(59),t.dice=i(184),t.intersection=i(185),t.jaccard=i(186),t.kulczynski=i(187),t.motyka=i(188),t.pearson=i(189),t.squaredChord=i(190),t.tanimoto=i(66)},function(e,t,i){'use strict';var n=i(60);e.exports=function(e,t){return 1-n(e,t)}},function(e,t,i){'use strict';var n=i(61);e.exports=function(e,t){return 1-n(e,t)}},function(e,t,i){'use strict';var n=i(62);e.exports=function(e,t){return 1-n(e,t)}},function(e,t,i){'use strict';var n=i(63);e.exports=function(e,t){return 1/n(e,t)}},function(e,t,i){'use strict';var n=i(64);e.exports=function(e,t){return 1-n(e,t)}},function(e,t,i){'use strict';var n=i(2).array,o=i(67);e.exports=function(e,t){for(var s=n.mean(e),r=n.mean(t),a=Array(e.length),l=Array(t.length),c=0;c<a.length;c++)a[c]=e[c]-s,l[c]=t[c]-r;return o(a,l)}},function(e,t,i){'use strict';var n=i(65);e.exports=function(e,t){return 1-n(e,t)}},function(e,t,i){'use strict';var n=i(192),o=i(57),s=i(35),r={windowSize:5,derivative:1,polynomial:2,pad:'none',padValue:'replicate'};e.exports=function(e,t,a){if(a=s({},r,a),0==a.windowSize%2||5>a.windowSize||!m(a.windowSize))throw new RangeError('Invalid window size (should be odd and at least 5 integer number)');if(0>a.derivative||!m(a.derivative))throw new RangeError('Derivative should be a positive integer');if(1>a.polynomial||!m(a.polynomial))throw new RangeError('Polynomial should be a positive integer');var u=g(a.windowSize/2),h,p;'pre'===a.pad&&(e=o(e,{size:u,value:a.padValue}));var x=Array(e.length-2*u);if(5===a.windowSize&&2===a.polynomial&&(1===a.derivative||2===a.derivative))1===a.derivative?(h=[-2,-1,0,1,2],p=10):(h=[2,-1,-2,-1,2],p=7);else{for(var w=n.ones(a.windowSize,a.polynomial+1),f=-(a.windowSize-1)/2,y=0;y<w.length;y++)for(var i=0;i<w[y].length;i++)(0!=f+1||0!==i)&&(w[y][i]=c(f+y,i));var j=w.transposeView(),M=j.mmul(w).inverse();h=M.mmul(j),h=h[a.derivative],p=1}for(var b=p*c(t,a.derivative),v=u,k;v<e.length-u;v++){k=0;for(var d=0;d<h.length;d++)k+=h[d]*e[d+v-u]/b;x[v-u]=k}return'post'===a.pad&&(x=o(x,{size:u,value:a.padValue})),x}},function(e,t,i){'use strict';e.exports=i(5).Matrix,e.exports.Decompositions=e.exports.DC=i(201)},function(){'use strict';Symbol.species||(Symbol.species=Symbol.for('@@species'))},function(e,t,i){'use strict';var n=i(15);e.exports=class extends n{constructor(e){super(e,e.columns,e.rows)}set(e,t,i){return this.matrix.set(t,e,i),this}get(e,t){return this.matrix.get(t,e)}}},function(e,t,i){'use strict';var n=i(15);e.exports=class extends n{constructor(e,t){super(e,1,e.columns),this.row=t}set(e,t,i){return this.matrix.set(this.row,t,i),this}get(e,t){return this.matrix.get(this.row,t)}}},function(e,t,i){'use strict';var n=i(15),o=i(24);e.exports=class extends n{constructor(e,t,i,n,s){o.checkRange(e,t,i,n,s),super(e,i-t+1,s-n+1),this.startRow=t,this.startColumn=n}set(e,t,i){return this.matrix.set(this.startRow+e,this.startColumn+t,i),this}get(e,t){return this.matrix.get(this.startRow+e,this.startColumn+t)}}},function(e,t,i){'use strict';var n=i(15),o=i(24);e.exports=class extends n{constructor(e,t,i){var n=o.checkIndices(e,t,i);super(e,n.row.length,n.column.length),this.rowIndices=n.row,this.columnIndices=n.column}set(e,t,i){return this.matrix.set(this.rowIndices[e],this.columnIndices[t],i),this}get(e,t){return this.matrix.get(this.rowIndices[e],this.columnIndices[t])}}},function(e,t,i){'use strict';var n=i(15);e.exports=class extends n{constructor(e,t){super(e,e.rows,1),this.column=t}set(e,t,i){return this.matrix.set(e,this.column,i),this}get(e){return this.matrix.get(e,this.column)}}},function(e,t,i){'use strict';var n=i(15);e.exports=class extends n{constructor(e){super(e,e.rows,e.columns)}set(e,t,i){return this.matrix.set(this.rows-e-1,t,i),this}get(e,t){return this.matrix.get(this.rows-e-1,t)}}},function(e,t,i){'use strict';var n=i(15);e.exports=class extends n{constructor(e){super(e,e.rows,e.columns)}set(e,t,i){return this.matrix.set(e,this.columns-t-1,i),this}get(e,t){return this.matrix.get(e,this.columns-t-1)}}},function(e,t,i){'use strict';function n(e){return e=s.checkMatrix(e),o(e,s.eye(e.rows))}function o(e,t){return e=s.checkMatrix(e),t=s.checkMatrix(t),e.isSquare()?new l(e).solve(t):new c(e).solve(t)}var s=i(5).Matrix,r=i(71),a=i(202),l=i(70),c=i(203),u=i(204);s.inverse=s.inv=n,s.prototype.inverse=s.prototype.inv=function(){return n(this)},s.solve=o,s.prototype.solve=function(e){return o(this,e)},e.exports={SingularValueDecomposition:r,SVD:r,EigenvalueDecomposition:a,EVD:a,LuDecomposition:l,LU:l,QrDecomposition:c,QR:c,CholeskyDecomposition:u,CHO:u,inverse:n,solve:o}},function(e,t,i){'use strict';function o(t,c){if(c=Object.assign({},h,c),!(this instanceof o))return new o(t,c);if(t=m.checkMatrix(t),!t.isSquare())throw new Error('Matrix is not a square matrix');var u=t.columns,n=g(u,u,0),p=Array(u),d=Array(u),e=t,k=!1,x,i;if(k=!!c.assumeSymmetric||t.isSymmetric(),k){for(x=0;x<u;x++)for(i=0;i<u;i++)n[x][i]=e.get(x,i);s(u,d,p,n),r(u,d,p,n)}else{var j=g(u,u,0),w=Array(u);for(i=0;i<u;i++)for(x=0;x<u;x++)j[x][i]=e.get(x,i);a(u,j,w,n),l(u,d,p,n,j)}this.n=u,this.e=d,this.d=p,this.V=n}function s(t,n,e,o){var s,r,a,l,i,c,m,d;for(i=0;i<t;i++)e[i]=o[t-1][i];for(l=t-1;0<l;l--){for(d=0,a=0,c=0;c<l;c++)d+=u(e[c]);if(0===d)for(n[l]=e[l-1],i=0;i<l;i++)e[i]=o[l-1][i],o[l][i]=0,o[i][l]=0;else{for(c=0;c<l;c++)e[c]/=d,a+=e[c]*e[c];for(s=e[l-1],r=R(a),0<s&&(r=-r),n[l]=d*r,a-=s*r,e[l-1]=s-r,i=0;i<l;i++)n[i]=0;for(i=0;i<l;i++){for(s=e[i],o[i][l]=s,r=n[i]+o[i][i]*s,c=i+1;c<=l-1;c++)r+=o[c][i]*e[c],n[c]+=o[c][i]*s;n[i]=r}for(s=0,i=0;i<l;i++)n[i]/=a,s+=n[i]*e[i];for(m=s/(a+a),i=0;i<l;i++)n[i]-=m*e[i];for(i=0;i<l;i++){for(s=e[i],r=n[i],c=i;c<=l-1;c++)o[c][i]-=s*n[c]+r*e[c];e[i]=o[l-1][i],o[l][i]=0}}e[l]=a}for(l=0;l<t-1;l++){if(o[t-1][l]=o[l][l],o[l][l]=1,a=e[l+1],0!==a){for(c=0;c<=l;c++)e[c]=o[c][l+1]/a;for(i=0;i<=l;i++){for(r=0,c=0;c<=l;c++)r+=o[c][l+1]*o[c][i];for(c=0;c<=l;c++)o[c][i]-=r*e[c]}}for(c=0;c<=l;c++)o[c][l+1]=0}for(i=0;i<t;i++)e[i]=o[t-1][i],o[t-1][i]=0;o[t-1][t-1]=1,n[0]=0}function r(t,n,e,o){var a,d,g,i,h,k,l,m,p,x,w,c,y,b,v,R,I;for(g=1;g<t;g++)n[g-1]=n[g];n[t-1]=0;var S=0,f=0,C=2.220446049250313e-16;for(k=0;k<t;k++){for(f=M(f,u(e[k])+u(n[k])),l=k;l<t&&!(u(n[l])<=C*f);)l++;if(l>k){I=0;do{for(++I,a=e[k],m=(e[k+1]-a)/(2*n[k]),p=j(m,1),0>m&&(p=-p),e[k]=n[k]/(m+p),e[k+1]=n[k]*(m+p),x=e[k+1],d=a-e[k],g=k+2;g<t;g++)e[g]-=d;for(S+=d,m=e[l],w=1,c=w,y=w,b=n[k+1],v=0,R=0,g=l-1;g>=k;g--)for(y=c,c=w,R=v,a=w*n[g],d=w*m,p=j(m,n[g]),n[g+1]=v*p,v=n[g]/p,w=m/p,m=w*e[g]-v*a,e[g+1]=d+v*(w*a+v*e[g]),h=0;h<t;h++)d=o[h][g+1],o[h][g+1]=v*o[h][g]+w*d,o[h][g]=w*o[h][g]-v*d;m=-v*R*y*b*n[k]/x,n[k]=v*m,e[k]=w*m}while(u(n[k])>C*f)}e[k]+=S,n[k]=0}for(g=0;g<t-1;g++){for(h=g,m=e[g],i=g+1;i<t;i++)e[i]<m&&(h=i,m=e[i]);if(h!==g)for(e[h]=e[g],e[g]=m,i=0;i<t;i++)m=o[i][g],o[i][g]=o[i][h],o[i][h]=m}}function a(e,t,n,o){var s=0,r=e-1,a,l,c,d,i,h,m;for(h=s+1;h<=r-1;h++){for(m=0,d=h;d<=r;d++)m+=u(t[d][h-1]);if(0!==m){for(c=0,d=r;d>=h;d--)n[d]=t[d][h-1]/m,c+=n[d]*n[d];for(l=R(c),0<n[h]&&(l=-l),c-=n[h]*l,n[h]-=l,i=h;i<e;i++){for(a=0,d=r;d>=h;d--)a+=n[d]*t[d][i];for(a/=c,d=h;d<=r;d++)t[d][i]-=a*n[d]}for(d=0;d<=r;d++){for(a=0,i=r;i>=h;i--)a+=n[i]*t[d][i];for(a/=c,i=h;i<=r;i++)t[d][i]-=a*n[i]}n[h]=m*n[h],t[h][h-1]=m*l}}for(d=0;d<e;d++)for(i=0;i<e;i++)o[d][i]=d===i?1:0;for(h=r-1;h>=s+1;h--)if(0!==t[h][h-1]){for(d=h+1;d<=r;d++)n[d]=t[d][h-1];for(i=h;i<=r;i++){for(l=0,d=h;d<=r;d++)l+=n[d]*o[d][i];for(l=l/n[h]/t[h][h-1],d=h;d<=r;d++)o[d][i]+=l*n[d]}}}function l(o,a,e,d,g){var h=o-1,n=0,f=o-1,b=2.220446049250313e-16,I=0,S=0,C=0,p=0,V=0,D=0,_=0,P=0,A,i,j,k,l,m,t,w,x,y,L,U,F,T,q;for(A=0;A<o;A++)for((A<n||A>f)&&(e[A]=g[A][A],a[A]=0),i=M(A-1,0);i<o;i++)S+=u(g[A][i]);for(;h>=n;){for(k=h;k>n&&(D=u(g[k-1][k-1])+u(g[k][k]),0===D&&(D=S),!(u(g[k][k-1])<b*D));)k--;if(k===h)g[h][h]+=I,e[h]=g[h][h],a[h]=0,h--,P=0;else if(k===h-1){if(t=g[h][h-1]*g[h-1][h],C=(g[h-1][h-1]-g[h][h])/2,p=C*C+t,_=R(u(p)),g[h][h]+=I,g[h-1][h-1]=g[h-1][h-1]+I,w=g[h][h],0<=p){for(_=0<=C?C+_:C-_,e[h-1]=w+_,e[h]=e[h-1],0!==_&&(e[h]=w-t/_),a[h-1]=0,a[h]=0,w=g[h][h-1],D=u(w)+u(_),C=w/D,p=_/D,V=R(C*C+p*p),C/=V,p/=V,i=h-1;i<o;i++)_=g[h-1][i],g[h-1][i]=p*_+C*g[h][i],g[h][i]=p*g[h][i]-C*_;for(A=0;A<=h;A++)_=g[A][h-1],g[A][h-1]=p*_+C*g[A][h],g[A][h]=p*g[A][h]-C*_;for(A=n;A<=f;A++)_=d[A][h-1],d[A][h-1]=p*_+C*d[A][h],d[A][h]=p*d[A][h]-C*_}else e[h-1]=w+C,e[h]=w+C,a[h-1]=_,a[h]=-_;h-=2,P=0}else{if(w=g[h][h],x=0,t=0,k<h&&(x=g[h-1][h-1],t=g[h][h-1]*g[h-1][h]),10==P){for(I+=w,A=n;A<=h;A++)g[A][A]-=w;D=u(g[h][h-1])+u(g[h-1][h-2]),w=x=0.75*D,t=-0.4375*D*D}if(30==P&&(D=(x-w)/2,D=D*D+t,0<D)){for(D=R(D),x<w&&(D=-D),D=w-t/((x-w)/2+D),A=n;A<=h;A++)g[A][A]-=D;I+=D,w=x=t=0.964}for(++P,l=h-2;l>=k&&(_=g[l][l],V=w-_,D=x-_,C=(V*D-t)/g[l+1][l]+g[l][l+1],p=g[l+1][l+1]-_-V-D,V=g[l+2][l+1],D=u(C)+u(p)+u(V),C/=D,p/=D,V/=D,l!==k)&&!(u(g[l][l-1])*(u(p)+u(V))<b*(u(C)*(u(g[l-1][l-1])+u(_)+u(g[l+1][l+1]))));)l--;for(A=l+2;A<=h;A++)g[A][A-2]=0,A>l+2&&(g[A][A-3]=0);for(j=l;j<=h-1&&(T=j!==h-1,j!==l&&(C=g[j][j-1],p=g[j+1][j-1],V=T?g[j+2][j-1]:0,w=u(C)+u(p)+u(V),0!==w&&(C/=w,p/=w,V/=w)),0!==w);j++)if(D=R(C*C+p*p+V*V),0>C&&(D=-D),0!==D){for(j===l?k!==l&&(g[j][j-1]=-g[j][j-1]):g[j][j-1]=-D*w,C+=D,w=C/D,x=p/D,_=V/D,p/=C,V/=C,i=j;i<o;i++)C=g[j][i]+p*g[j+1][i],T&&(C+=V*g[j+2][i],g[j+2][i]=g[j+2][i]-C*_),g[j][i]-=C*w,g[j+1][i]=g[j+1][i]-C*x;for(A=0;A<=v(h,j+3);A++)C=w*g[A][j]+x*g[A][j+1],T&&(C+=_*g[A][j+2],g[A][j+2]=g[A][j+2]-C*V),g[A][j]-=C,g[A][j+1]=g[A][j+1]-C*p;for(A=n;A<=f;A++)C=w*d[A][j]+x*d[A][j+1],T&&(C+=_*d[A][j+2],d[A][j+2]=d[A][j+2]-C*V),d[A][j]-=C,d[A][j+1]=d[A][j+1]-C*p}}}if(0!==S){for(h=o-1;0<=h;h--)if(C=e[h],p=a[h],0===p)for(k=h,g[h][h]=1,A=h-1;0<=A;A--){for(t=g[A][A]-C,V=0,i=k;i<=h;i++)V+=g[A][i]*g[i][h];if(0>a[A])_=t,D=V;else if(k=A,0===a[A]?g[A][h]=0===t?-V/(b*S):-V/t:(w=g[A][A+1],x=g[A+1][A],p=(e[A]-C)*(e[A]-C)+a[A]*a[A],m=(w*D-_*V)/p,g[A][h]=m,g[A+1][h]=u(w)>u(_)?(-V-t*m)/w:(-D-x*m)/_),m=u(g[A][h]),1<b*m*m)for(i=A;i<=h;i++)g[i][h]/=m}else if(0>p)for(k=h-1,u(g[h][h-1])>u(g[h-1][h])?(g[h-1][h-1]=p/g[h][h-1],g[h-1][h]=-(g[h][h]-C)/g[h][h-1]):(q=c(0,-g[h-1][h],g[h-1][h-1]-C,p),g[h-1][h-1]=q[0],g[h-1][h]=q[1]),g[h][h-1]=0,g[h][h]=1,A=h-2;0<=A;A--){for(y=0,L=0,i=k;i<=h;i++)y+=g[A][i]*g[i][h-1],L+=g[A][i]*g[i][h];if(t=g[A][A]-C,0>a[A])_=t,V=y,D=L;else if(k=A,0===a[A]?(q=c(-y,-L,t,p),g[A][h-1]=q[0],g[A][h]=q[1]):(w=g[A][A+1],x=g[A+1][A],U=(e[A]-C)*(e[A]-C)+a[A]*a[A]-p*p,F=2*(e[A]-C)*p,0===U&&0===F&&(U=b*S*(u(t)+u(p)+u(w)+u(x)+u(_))),q=c(w*V-_*y+p*L,w*D-_*L-p*y,U,F),g[A][h-1]=q[0],g[A][h]=q[1],u(w)>u(_)+u(p)?(g[A+1][h-1]=(-y-t*g[A][h-1]+p*g[A][h])/w,g[A+1][h]=(-L-t*g[A][h]-p*g[A][h-1])/w):(q=c(-V-x*g[A][h-1],-D-x*g[A][h],_,p),g[A+1][h-1]=q[0],g[A+1][h]=q[1])),m=M(u(g[A][h-1]),u(g[A][h])),1<b*m*m)for(i=A;i<=h;i++)g[i][h-1]=g[i][h-1]/m,g[i][h]/=m}for(A=0;A<o;A++)if(A<n||A>f)for(i=A;i<o;i++)d[A][i]=g[A][i];for(i=o-1;i>=n;i--)for(A=n;A<=f;A++){for(_=0,j=n;j<=v(i,f);j++)_+=d[A][j]*g[j][i];d[A][i]=_}}}function c(e,t,i,n){var o,s;return u(i)>u(n)?(o=n/i,s=i+o*n,[(e+o*t)/s,(t-o*e)/s]):(o=i/n,s=n+o*i,[(o*e+t)/s,(o*t-e)/s])}var m=i(5).Matrix,n=i(38),j=n.hypotenuse,g=n.getFilled2DArray,h={assumeSymmetric:!1};o.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return m.isMatrix(this.V)||(this.V=new m(this.V)),this.V},get diagonalMatrix(){var t=this.n,n=this.e,e=this.d,o=new m(t,t),s,i;for(s=0;s<t;s++){for(i=0;i<t;i++)o[s][i]=0;o[s][s]=e[s],0<n[s]?o[s][s+1]=n[s]:0>n[s]&&(o[s][s-1]=n[s])}return o}},e.exports=o},function(e,t,i){'use strict';function o(e){if(!(this instanceof o))return new o(e);e=r.checkMatrix(e);var t=e.clone(),a=e.rows,l=e.columns,c=Array(l),u,i,m,d;for(m=0;m<l;m++){var g=0;for(u=m;u<a;u++)g=n(g,t[u][m]);if(0!==g){for(0>t[m][m]&&(g=-g),u=m;u<a;u++)t[u][m]/=g;for(t[m][m]+=1,i=m+1;i<l;i++){for(d=0,u=m;u<a;u++)d+=t[u][m]*t[u][i];for(d=-d/t[m][m],u=m;u<a;u++)t[u][i]+=d*t[u][m]}}c[m]=-g}this.QR=t,this.Rdiag=c}var r=i(5).Matrix,n=i(38).hypotenuse;o.prototype={solve:function(e){e=r.checkMatrix(e);var t=this.QR,o=t.rows;if(e.rows!==o)throw new Error('Matrix row dimensions must agree');if(!this.isFullRank())throw new Error('Matrix is rank deficient');var a=e.columns,l=e.clone(),c=t.columns,n,i,u,m;for(u=0;u<c;u++)for(i=0;i<a;i++){for(m=0,n=u;n<o;n++)m+=t[n][u]*l[n][i];for(m=-m/t[u][u],n=u;n<o;n++)l[n][i]+=m*t[n][u]}for(u=c-1;0<=u;u--){for(i=0;i<a;i++)l[u][i]/=this.Rdiag[u];for(n=0;n<u;n++)for(i=0;i<a;i++)l[n][i]-=l[u][i]*t[n][u]}return l.subMatrix(0,c-1,0,a-1)},isFullRank:function(){for(var e=this.QR.columns,t=0;t<e;t++)if(0===this.Rdiag[t])return!1;return!0},get upperTriangularMatrix(){var e=this.QR,t=e.columns,n=new r(t,t),o,i;for(o=0;o<t;o++)for(i=0;i<t;i++)n[o][i]=o<i?e[o][i]:o===i?this.Rdiag[o]:0;return n},get orthogonalMatrix(){var e=this.QR,t=e.rows,n=e.columns,o=new r(t,n),a,i,l,c;for(l=n-1;0<=l;l--){for(a=0;a<t;a++)o[a][l]=0;for(o[l][l]=1,i=l;i<n;i++)if(0!==e[l][l]){for(c=0,a=l;a<t;a++)c+=e[a][l]*o[a][i];for(c=-c/e[l][l],a=l;a<t;a++)o[a][i]+=c*e[a][l]}}return o}},e.exports=o},function(e,t,i){'use strict';function n(e){if(!(this instanceof n))return new n(e);if(e=o.checkMatrix(e),!e.isSymmetric())throw new Error('Matrix is not symmetric');var t=e,r=t.rows,a=new o(r,r),l=!0,c,i,u;for(i=0;i<r;i++){var m=a[i],g=0;for(u=0;u<i;u++){var d=a[u],h=0;for(c=0;c<u;c++)h+=d[c]*m[c];m[u]=h=(t[i][u]-h)/a[u][u],g+=h*h}for(g=t[i][i]-g,l&=0<g,a[i][i]=R(M(g,0)),u=i+1;u<r;u++)a[i][u]=0}if(!l)throw new Error('Matrix is not positive definite');this.L=a}var o=i(5).Matrix;n.prototype={get lowerTriangularMatrix(){return this.L},solve:function(e){e=o.checkMatrix(e);var t=this.L,n=t.rows;if(e.rows!==n)throw new Error('Matrix dimensions do not match');var s=e.columns,r=e.clone(),a,i,l;for(l=0;l<n;l++)for(i=0;i<s;i++){for(a=0;a<l;a++)r[l][i]-=r[a][i]*t[l][a];r[l][i]/=t[l][l]}for(l=n-1;0<=l;l--)for(i=0;i<s;i++){for(a=l+1;a<n;a++)r[l][i]-=r[a][i]*t[a][l];r[l][i]/=t[l][l]}return r}},e.exports=n},function(e,t,i){'use strict';function n(e,t,n,o){for(var s=0,r=0,a=t-n;a<t+n;a++)0<=a&&a<e.length-1&&(s+=e[a+1]-e[a],r++);return c(s/r,o)}function o(e,t,i,n){var s=0;return s=0<i?(4*i-2)/(i*(2*t-i+1))*(e*o(e,t,i-1,n)+n*o(e,t,i-1,n-1))-(i-1)*(2*t+i)/(i*(2*t-i+1))*o(e,t,i-2,n):0==i&&0==n?1:0,s}function r(e,t){var i=1;if(e>=t)for(var n=e-t+1;n<=e;n++)i*=n;return i}function a(e,i,t,a,n){for(var s=0,l=0;l<=a;l++)s+=(2*l+1)*(r(2*t,l)/r(2*t+l+1,l+1))*o(e,t,l,0)*o(i,t,l,n);return s}function s(e,i,n){for(var o=Array(e),s=g(e/2),r=-s;r<=s;r++){o[r+s]=Array(e);for(var t=-s;t<=s;t++)o[r+s][t+s]=a(t,r,s,i,n)}return o}var u=i(35),l=i(206),p={windowSize:9,derivative:0,polynomial:3};e.exports=function(e,t,o){if(o=u({},p,o),0==o.windowSize%2||5>o.windowSize||!m(o.windowSize))throw new RangeError('Invalid window size (should be odd and at least 5 integer number)');if(o.windowSize>e.length)throw new RangeError('Window size is higher than the data length '+o.windowSize+'>'+e.length);if(0>o.derivative||!m(o.derivative))throw new RangeError('Derivative should be a positive integer');if(1>o.polynomial||!m(o.polynomial))throw new RangeError('Polynomial should be a positive integer');6<=o.polynomial&&console.warn('You should not use polynomial grade higher than 5 if you are not sure that your data arises from such a model. Possible polynomial oscillation problems');var r=o.windowSize,a=g(r/2),h=e.length,k=Array(h),j=s(r,o.polynomial,o.derivative),x=0,w=!0;'[object Array]'===Object.prototype.toString.call(t)?w=!1:x=c(t,o.derivative);for(var f=0;f<a;f++){for(var i=j[a-f-1],y=j[a+f+1],M=0,b=0,v=0;v<r;v++)M+=i[v]*e[v],b+=y[v]*e[h-r+v-1];w?(k[a-f-1]=M/x,k[h-a+f]=b/x):(x=n(t,a-f-1,a,o.derivative),k[a-f-1]=M/x,x=n(t,h-a+f,a,o.derivative),k[h-a+f]=b/x)}for(var l=j[a],f=r,R;f<h+1;f++){R=0;for(var v=0;v<r;v++)R+=l[v]*e[v+f-r];w||(x=n(t,f-a-1,a,o.derivative)),k[f-a-1]=R/x}return k}},function(e,t,i){'use strict';t.array=i(72),t.matrix=i(207)},function(e,t,i){'use strict';function o(e,t){'undefined'==typeof t&&(t=0);var n=e.length,o=e[0].length,s,r,a,i;if(-1===t){for(s=[0],r=n*o,a=0;a<n;a++)for(i=0;i<o;i++)s[0]+=e[a][i];s[0]/=r}else if(0===t)for(s=Array(o),r=n,i=0;i<o;i++){for(s[i]=0,a=0;a<n;a++)s[i]+=e[a][i];s[i]/=r}else if(1===t)for(s=Array(n),r=o,i=0;i<n;i++){for(s[i]=0,a=0;a<o;a++)s[i]+=e[i][a];s[i]/=r}else throw new Error('Invalid dimension');return s}function n(e,t,n){for(var o=s(e,t,n),r=o.length,a=0;a<r;a++)o[a]=R(o[a]);return o}function s(e,t,n){'undefined'==typeof n&&(n=!0),t=t||o(e);var s=e.length;if(0===s)return[];for(var r=e[0].length,a=Array(r),l=0;l<r;l++){for(var c=0,u=0,m=0,d=0;d<s;d++)m=e[d][l]-t[l],c+=m,u+=m*m;a[l]=n?(u-c*c/s)/(s-1):(u-c*c/s)/s}return a}function a(e,t,n){'undefined'==typeof n&&(n=0),'undefined'==typeof t&&(0===n?t=e.length-1:1===n&&(t=e[0].length-1));var r=o(e,n),a=e.length;if(0===a)return[[]];var l=e[0].length,c,u,i,m,s;if(0===n){for(c=Array(l),u=0;u<l;u++)c[u]=Array(l);for(u=0;u<l;u++)for(i=u;i<l;i++){for(m=0,s=0;s<a;s++)m+=(e[s][i]-r[i])*(e[s][u]-r[u]);m/=t,c[u][i]=m,c[i][u]=m}}else if(1===n){for(c=Array(a),u=0;u<a;u++)c[u]=Array(a);for(u=0;u<a;u++)for(i=u;i<a;i++){for(m=0,s=0;s<l;s++)m+=(e[i][s]-r[i])*(e[u][s]-r[u]);m/=t,c[u][i]=m,c[i][u]=m}}else throw new Error('Invalid dimension');return c}function u(e,t,i){return t=t||o(e),'undefined'==typeof i&&(i=n(e,!0,t)),m(l(e,t,!1),i,!0)}function l(e,t,n){t=t||o(e);var s=e,r=e.length,a,i,l;if(!n)for(s=Array(r),a=0;a<r;a++)s[a]=Array(e[a].length);for(a=0;a<r;a++){var c=s[a];for(i=0,l=c.length;i<l;i++)c[i]=e[a][i]-t[i]}return s}function m(e,t,o){'undefined'==typeof t&&(t=n(e));var s=e,r=e.length,a,i,l;if(!o)for(s=Array(r),a=0;a<r;a++)s[a]=Array(e[a].length);for(a=0;a<r;a++){var c=s[a],u=e[a];for(i=0,l=c.length;i<l;i++)0===t[i]||isNaN(t[i])||(c[i]=u[i]/t[i])}return s}function d(e,t,n){'undefined'==typeof n&&(n=0);var o=e.length;if(0===o)return[];var s=e[0].length,r,a,i,l,c,u;if(0===n){for(r=Array(s),a=0;a<s;a++)r[a]=0;for(a=0;a<o;a++)for(u=e[a],c=t[a],l=0;l<s;l++)r[l]+=u[l]*c}else if(1===n){for(r=Array(o),a=0;a<o;a++)r[a]=0;for(l=0;l<o;l++)for(u=e[l],c=t[l],a=0;a<s;a++)r[l]+=u[a]*c}else throw new Error('Invalid dimension');var m=p.sum(t);if(0!==m)for(a=0,i=r.length;a<i;a++)r[a]/=m;return r}function h(e,t,n,o,r){r=r||0,n=n||d(e,t,r),'undefined'==typeof o&&(o=1);var a=e.length;if(0===a)return[[]];var l=e[0].length,c,u,i,m,g;if(0===r){for(c=Array(l),u=0;u<l;u++)c[u]=Array(l);for(u=0;u<l;u++)for(i=u;i<l;i++){for(g=0,m=0;m<a;m++)g+=t[m]*(e[m][i]-n[i])*(e[m][u]-n[u]);c[u][i]=g*o,c[i][u]=g*o}}else if(1===r){for(c=Array(a),u=0;u<a;u++)c[u]=Array(a);for(u=0;u<a;u++)for(i=u;i<a;i++){for(g=0,m=0;m<l;m++)g+=t[m]*(e[i][m]-n[i])*(e[u][m]-n[u]);c[u][i]=g*o,c[i][u]=g*o}}else throw new Error('Invalid dimension');return c}var p=i(72);e.exports={entropy:function(e,t){'undefined'==typeof t&&(t=0);for(var n=0,o=e.length,s=e[0].length,a=0;a<o;a++)for(var i=0;i<s;i++)n+=e[a][i]*r(e[a][i]+t);return-n},mean:o,standardDeviation:n,variance:s,median:function(e){for(var t=e.length,n=e[0].length,o=Array(n),s=0,i;s<n;s++){i=Array(t);for(var r=0;r<t;r++)i[r]=e[r][s];i.sort();var a=i.length;o[s]=0==a%2?0.5*(i[a/2]+i[a/2-1]):i[g(a/2)]}return o},mode:function(e){var t=e.length,n=e[0].length,o=Array(n),s,i;for(s=0;s<n;s++){for(var r=Array(t),a=0;a<t;a++)r[a]=0;var l=Array(t),c=0;for(i=0;i<t;i++){var u=l.indexOf(e[i][s]);0<=u?r[u]++:(l[c]=e[i][s],r[c]=1,c++)}var m=0,d=0;for(i=0;i<c;i++)r[i]>m&&(m=r[i],d=i);o[s]=l[d]}return o},skewness:function(e,t){'undefined'==typeof t&&(t=!0);for(var s=o(e),r=e.length,n=s.length,l=Array(n),u=0;u<n;u++){for(var m=0,d=0,h=0,i;h<r;h++)i=e[h][u]-s[u],m+=i*i,d+=i*i*i;var p=m/r,k=d/r,j=k/c(p,3/2);if(t){var g=R(r*(r-1));l[u]=g/(r-2)*j}else l[u]=j}return l},kurtosis:function(e,t){'undefined'==typeof t&&(t=!0);for(var s=o(e),r=e.length,n=e[0].length,a=Array(n),l=0;l<n;l++){for(var c=0,u=0,m=0,i;m<r;m++)i=e[m][l]-s[l],c+=i*i,u+=i*i*i*i;var d=c/r,g=u/r;if(t){var h=c/(r-1),p=u/(h*h);a[l]=r*(r+1)/((r-1)*(r-2)*(r-3))*p-3*((r-1)*(r-1)/((r-2)*(r-3)))}else a[l]=g/(d*d)-3}return a},standardError:function(e){for(var t=e.length,o=n(e),s=o.length,r=Array(s),a=R(t),l=0;l<s;l++)r[l]=o[l]/a;return r},covariance:function(e,t){return a(e,void 0,t)},scatter:a,correlation:function(e){var t=o(e),s=n(e,!0,t),r=u(e,t,s),a=e.length,m=e[0].length,d=Array(m),g,i;for(g=0;g<m;g++)d[g]=Array(m);for(g=0;g<m;g++)for(i=g;i<m;i++){for(var h=0,c=0,p=r.length;c<p;c++)h+=r[c][i]*r[c][g];h/=a-1,d[g][i]=h,d[i][g]=h}return d},zScores:u,center:l,standardize:m,weightedVariance:function(e,t){var n=o(e),s=e.length;if(0===s)return[];for(var r=e[0].length,l=Array(r),c=0;c<r;c++){for(var u=0,m=0,a=0,d=0;d<s;d++){var i=e[d][c]-n[c],g=t[d];u+=g*(i*i),a+=g,m+=g*g}l[c]=u*(a/(a*a-m))}return l},weightedMean:d,weightedCovariance:function(e,t,n,o){o=o||0,n=n||d(e,t,o);for(var s=0,r=0,a=0,i=t.length;a<i;a++)s+=t[a],r+=t[a]*t[a];var l=s/(s*s-r);return h(e,t,n,l,o)},weightedScatter:h}},function(e,t,n){'use strict';function o(e,t){for(var n in t)e=e.replace(new RegExp('%'+n+'%','g'),t[n]);return e}var s=n(54);class r{constructor(e,t,n={}){if(e instanceof r){var o=e;return void this._init(o.rows,o.columns,o.elements.clone(),o.threshold)}if(Array.isArray(e)){var a=e;e=a.length,n=t||{},t=a[0].length,this._init(e,t,new s(n),n.threshold);for(var l=0;l<e;l++)for(var i=0,c;i<t;i++)c=a[l][i],this.threshold&&u(c)<this.threshold&&(c=0),0!==c&&this.elements.set(l*t+i,a[l][i])}else this._init(e,t,new s(n),n.threshold)}_init(e,t,i,n){this.rows=e,this.columns=t,this.elements=i,this.threshold=n||0}static eye(e=1,t=e){for(var n=v(e,t),o=new r(e,t,{initialCapacity:n}),s=0;s<n;s++)o.set(s,s,1);return o}clone(){return new r(this)}to2DArray(){for(var e=Array(this.rows),t=0;t<this.rows;t++){e[t]=Array(this.columns);for(var i=0;i<this.columns;i++)e[t][i]=this.get(t,i)}return e}isSquare(){return this.rows===this.columns}isSymmetric(){if(!this.isSquare())return!1;var e=!0;return this.forEachNonZero((t,i,n)=>{return this.get(i,t)===n?n:(e=!1,!1)}),e}get cardinality(){return this.elements.size}get size(){return this.rows*this.columns}get(e,t){return this.elements.get(e*this.columns+t)}set(e,t,i){return this.threshold&&u(i)<this.threshold&&(i=0),0===i?this.elements.remove(e*this.columns+t):this.elements.set(e*this.columns+t,i),this}mmul(e){this.columns!==e.rows&&console.warn('Number of columns of left matrix are not equal to number of rows of right matrix.');var t=this.rows,i=e.columns,n=new r(t,i);return this.forEachNonZero((t,i,o)=>{return e.forEachNonZero((e,s,r)=>{return i===e&&n.set(t,s,n.get(t,s)+o*r),r}),o}),n}kroneckerProduct(e){var t=this.rows,i=this.columns,n=e.rows,o=e.columns,s=new r(t*n,i*o,{initialCapacity:this.cardinality*e.cardinality});return this.forEachNonZero((t,i,r)=>{return e.forEachNonZero((e,a,l)=>{return s.set(n*t+e,o*i+a,r*l),l}),r}),s}forEachNonZero(e){return this.elements.forEachPair((t,n)=>{var o=0|t/this.columns,i=t%this.columns,s=e(o,i,n);return!1!==s&&(this.threshold&&u(s)<this.threshold&&(s=0),s!==n&&(0===s?this.elements.remove(t,!0):this.elements.set(t,s)),!0)}),this.elements.maybeShrinkCapacity(),this}getNonZeros(){var e=this.cardinality,t=Array(e),n=Array(e),o=Array(e),s=0;return this.forEachNonZero((e,i,r)=>{return t[s]=e,n[s]=i,o[s]=r,s++,r}),{rows:t,columns:n,values:o}}setThreshold(e){return 0!==e&&e!==this.threshold&&(this.threshold=e,this.forEachNonZero((e,t,i)=>i)),this}}r.prototype.klass='Matrix',r.identity=r.eye,r.prototype.tensorProduct=r.prototype.kroneckerProduct,e.exports=r;var a=`
(function %name%(value) {
    if (typeof value === 'number') return this.%name%S(value);
    return this.%name%M(value);
})
`,l=`
(function %name%S(value) {
    this.forEachNonZero((i, j, v) => v %op% value);
    return this;
})
`,c=`
(function %name%M(matrix) {
    matrix.forEachNonZero((i, j, v) => {
        this.set(i, j, this.get(i, j) %op% v);
        return v;
    });
    return this;
})
`,m=`
(function %name%(matrix, value) {
    var newMatrix = new SparseMatrix(matrix);
    return newMatrix.%name%(value);
})
`,d=`
(function %name%() {
    this.forEachNonZero((i, j, v) => %method%(v));
    return this;
})
`,g=`
(function %name%(matrix) {
    var newMatrix = new SparseMatrix(matrix);
    return newMatrix.%name%();
})
`,h=[['+','add'],['-','sub','subtract'],['*','mul','multiply'],['/','div','divide'],['%','mod','modulus'],['&','and'],['|','or'],['^','xor'],['<<','leftShift'],['>>','signPropagatingRightShift'],['>>>','rightShift','zeroFillRightShift']],p=!0,k=!1,j;try{for(var x=h[Symbol.iterator](),w,f;!(p=(w=x.next()).done);p=!0){f=w.value;for(var y=1;y<f.length;y++)r.prototype[f[y]]=eval(o(a,{name:f[y],op:f[0]})),r.prototype[f[y]+'S']=eval(o(l,{name:f[y]+'S',op:f[0]})),r.prototype[f[y]+'M']=eval(o(c,{name:f[y]+'M',op:f[0]})),r[f[y]]=eval(o(m,{name:f[y]}))}}catch(e){k=!0,j=e}finally{try{!p&&x.return&&x.return()}finally{if(k)throw j}}var i=[['~','not']];['abs','acos','acosh','asin','asinh','atan','atanh','cbrt','ceil','clz32','cos','cosh','exp','expm1','floor','fround','log','log1p','log10','log2','round','sign','sin','sinh','sqrt','tan','tanh','trunc'].forEach(function(e){i.push(['Math.'+e,e])});var M=!0,b=!1,R;try{for(var I=i[Symbol.iterator](),S,C;!(M=(S=I.next()).done);M=!0){C=S.value;for(var y=1;y<C.length;y++)r.prototype[C[y]]=eval(o(d,{name:C[y],method:C[0]})),r[C[y]]=eval(o(g,{name:C[y]}))}}catch(e){b=!0,R=e}finally{try{!M&&I.return&&I.return()}finally{if(b)throw R}}},function(e,t,i){'use strict';var n=i(210),o=n.DC.EVD,s=n.DC.SVD,r=i(2).matrix,a=r.mean,l=r.standardDeviation,c={isCovarianceMatrix:!1,center:!0,scale:!1};class u{constructor(e,t){if(!0===e){var o=t;return this.center=o.center,this.scale=o.scale,this.means=o.means,this.stdevs=o.stdevs,this.U=n.checkMatrix(o.U),void(this.S=o.S)}if(t=Object.assign({},c,t),this.center=!1,this.scale=!1,this.means=null,this.stdevs=null,t.isCovarianceMatrix)return void this._computeFromCovarianceMatrix(e);var r;if(r='boolean'==typeof t.useCovarianceMatrix?t.useCovarianceMatrix:e.length>e[0].length,r){e=this._adjust(e,t);var a=e.transposeView().mmul(e).div(e.rows-1);this._computeFromCovarianceMatrix(a)}else{e=this._adjust(e,t);var l=new s(e,{computeLeftSingularVectors:!1,computeRightSingularVectors:!0,autoTranspose:!0});this.U=l.rightSingularVectors;for(var u=l.diagonal,m=Array(u.length),d=0;d<u.length;d++)m[d]=u[d]*u[d]/(e.length-1);this.S=m}}static load(e){if('PCA'!==e.name)throw new RangeError('Invalid model: '+e.name);return new u(!0,e)}predict(e){return e=new n(e),this.center&&(e.subRowVector(this.means),this.scale&&e.divRowVector(this.stdevs)),e.mmul(this.U)}getExplainedVariance(){for(var e=0,t=0;t<this.S.length;t++)e+=this.S[t];return this.S.map((t)=>t/e)}getCumulativeVariance(){for(var e=this.getExplainedVariance(),t=1;t<e.length;t++)e[t]+=e[t-1];return e}getEigenvectors(){return this.U}getEigenvalues(){return this.S}getStandardDeviations(){return this.S.map((e)=>R(e))}getLoadings(){return this.U.transpose()}toJSON(){return{name:'PCA',center:this.center,scale:this.scale,means:this.means,stdevs:this.stdevs,U:this.U,S:this.S}}_adjust(e,t){if(this.center=!!t.center,this.scale=!!t.scale,e=new n(e),this.center){var o=a(e),s=this.scale?l(e,o,!0):null;if(this.means=o,e.subRowVector(o),this.scale){for(var r=0;r<s.length;r++)if(0===s[r])throw new RangeError('Cannot scale the dataset (standard deviation is zero at index '+r);this.stdevs=s,e.divRowVector(s)}}return e}_computeFromCovarianceMatrix(e){var t=new o(e,{assumeSymmetric:!0});this.U=t.eigenvectorMatrix;for(var n=0;n<this.U.length;n++)this.U[n].reverse();this.S=t.realEigenvalues.reverse()}}e.exports=u},function(e,t,i){'use strict';e.exports=i(6).Matrix,e.exports.Decompositions=e.exports.DC=i(219)},function(){'use strict';Symbol.species||(Symbol.species=Symbol.for('@@species'))},function(e,t,i){'use strict';var n=i(16);e.exports=class extends n{constructor(e){super(e,e.columns,e.rows)}set(e,t,i){return this.matrix.set(t,e,i),this}get(e,t){return this.matrix.get(t,e)}}},function(e,t,i){'use strict';var n=i(16);e.exports=class extends n{constructor(e,t){super(e,1,e.columns),this.row=t}set(e,t,i){return this.matrix.set(this.row,t,i),this}get(e,t){return this.matrix.get(this.row,t)}}},function(e,t,i){'use strict';var n=i(16),o=i(25);e.exports=class extends n{constructor(e,t,i,n,s){o.checkRange(e,t,i,n,s),super(e,i-t+1,s-n+1),this.startRow=t,this.startColumn=n}set(e,t,i){return this.matrix.set(this.startRow+e,this.startColumn+t,i),this}get(e,t){return this.matrix.get(this.startRow+e,this.startColumn+t)}}},function(e,t,i){'use strict';var n=i(16),o=i(25);e.exports=class extends n{constructor(e,t,i){var n=o.checkIndices(e,t,i);super(e,n.row.length,n.column.length),this.rowIndices=n.row,this.columnIndices=n.column}set(e,t,i){return this.matrix.set(this.rowIndices[e],this.columnIndices[t],i),this}get(e,t){return this.matrix.get(this.rowIndices[e],this.columnIndices[t])}}},function(e,t,i){'use strict';var n=i(16);e.exports=class extends n{constructor(e,t){super(e,e.rows,1),this.column=t}set(e,t,i){return this.matrix.set(e,this.column,i),this}get(e){return this.matrix.get(e,this.column)}}},function(e,t,i){'use strict';var n=i(16);e.exports=class extends n{constructor(e){super(e,e.rows,e.columns)}set(e,t,i){return this.matrix.set(this.rows-e-1,t,i),this}get(e,t){return this.matrix.get(this.rows-e-1,t)}}},function(e,t,i){'use strict';var n=i(16);e.exports=class extends n{constructor(e){super(e,e.rows,e.columns)}set(e,t,i){return this.matrix.set(e,this.columns-t-1,i),this}get(e,t){return this.matrix.get(e,this.columns-t-1)}}},function(e,t,i){'use strict';function n(e){return e=s.checkMatrix(e),o(e,s.eye(e.rows))}function o(e,t){return e=s.checkMatrix(e),t=s.checkMatrix(t),e.isSquare()?new l(e).solve(t):new c(e).solve(t)}var s=i(6).Matrix,r=i(75),a=i(220),l=i(74),c=i(221),u=i(222);s.inverse=s.inv=n,s.prototype.inverse=s.prototype.inv=function(){return n(this)},s.solve=o,s.prototype.solve=function(e){return o(this,e)},e.exports={SingularValueDecomposition:r,SVD:r,EigenvalueDecomposition:a,EVD:a,LuDecomposition:l,LU:l,QrDecomposition:c,QR:c,CholeskyDecomposition:u,CHO:u,inverse:n,solve:o}},function(e,t,i){'use strict';function o(t,c){if(c=Object.assign({},h,c),!(this instanceof o))return new o(t,c);if(t=m.checkMatrix(t),!t.isSquare())throw new Error('Matrix is not a square matrix');var u=t.columns,n=g(u,u,0),p=Array(u),d=Array(u),e=t,k=!1,x,i;if(k=!!c.assumeSymmetric||t.isSymmetric(),k){for(x=0;x<u;x++)for(i=0;i<u;i++)n[x][i]=e.get(x,i);s(u,d,p,n),r(u,d,p,n)}else{var j=g(u,u,0),w=Array(u);for(i=0;i<u;i++)for(x=0;x<u;x++)j[x][i]=e.get(x,i);a(u,j,w,n),l(u,d,p,n,j)}this.n=u,this.e=d,this.d=p,this.V=n}function s(t,n,e,o){var s,r,a,l,i,c,m,d;for(i=0;i<t;i++)e[i]=o[t-1][i];for(l=t-1;0<l;l--){for(d=0,a=0,c=0;c<l;c++)d+=u(e[c]);if(0===d)for(n[l]=e[l-1],i=0;i<l;i++)e[i]=o[l-1][i],o[l][i]=0,o[i][l]=0;else{for(c=0;c<l;c++)e[c]/=d,a+=e[c]*e[c];for(s=e[l-1],r=R(a),0<s&&(r=-r),n[l]=d*r,a-=s*r,e[l-1]=s-r,i=0;i<l;i++)n[i]=0;for(i=0;i<l;i++){for(s=e[i],o[i][l]=s,r=n[i]+o[i][i]*s,c=i+1;c<=l-1;c++)r+=o[c][i]*e[c],n[c]+=o[c][i]*s;n[i]=r}for(s=0,i=0;i<l;i++)n[i]/=a,s+=n[i]*e[i];for(m=s/(a+a),i=0;i<l;i++)n[i]-=m*e[i];for(i=0;i<l;i++){for(s=e[i],r=n[i],c=i;c<=l-1;c++)o[c][i]-=s*n[c]+r*e[c];e[i]=o[l-1][i],o[l][i]=0}}e[l]=a}for(l=0;l<t-1;l++){if(o[t-1][l]=o[l][l],o[l][l]=1,a=e[l+1],0!==a){for(c=0;c<=l;c++)e[c]=o[c][l+1]/a;for(i=0;i<=l;i++){for(r=0,c=0;c<=l;c++)r+=o[c][l+1]*o[c][i];for(c=0;c<=l;c++)o[c][i]-=r*e[c]}}for(c=0;c<=l;c++)o[c][l+1]=0}for(i=0;i<t;i++)e[i]=o[t-1][i],o[t-1][i]=0;o[t-1][t-1]=1,n[0]=0}function r(t,n,e,o){var a,d,g,i,h,k,l,m,p,x,w,c,y,b,v,R,I;for(g=1;g<t;g++)n[g-1]=n[g];n[t-1]=0;var S=0,f=0,C=2.220446049250313e-16;for(k=0;k<t;k++){for(f=M(f,u(e[k])+u(n[k])),l=k;l<t&&!(u(n[l])<=C*f);)l++;if(l>k){I=0;do{for(++I,a=e[k],m=(e[k+1]-a)/(2*n[k]),p=j(m,1),0>m&&(p=-p),e[k]=n[k]/(m+p),e[k+1]=n[k]*(m+p),x=e[k+1],d=a-e[k],g=k+2;g<t;g++)e[g]-=d;for(S+=d,m=e[l],w=1,c=w,y=w,b=n[k+1],v=0,R=0,g=l-1;g>=k;g--)for(y=c,c=w,R=v,a=w*n[g],d=w*m,p=j(m,n[g]),n[g+1]=v*p,v=n[g]/p,w=m/p,m=w*e[g]-v*a,e[g+1]=d+v*(w*a+v*e[g]),h=0;h<t;h++)d=o[h][g+1],o[h][g+1]=v*o[h][g]+w*d,o[h][g]=w*o[h][g]-v*d;m=-v*R*y*b*n[k]/x,n[k]=v*m,e[k]=w*m}while(u(n[k])>C*f)}e[k]+=S,n[k]=0}for(g=0;g<t-1;g++){for(h=g,m=e[g],i=g+1;i<t;i++)e[i]<m&&(h=i,m=e[i]);if(h!==g)for(e[h]=e[g],e[g]=m,i=0;i<t;i++)m=o[i][g],o[i][g]=o[i][h],o[i][h]=m}}function a(e,t,n,o){var s=0,r=e-1,a,l,c,d,i,h,m;for(h=s+1;h<=r-1;h++){for(m=0,d=h;d<=r;d++)m+=u(t[d][h-1]);if(0!==m){for(c=0,d=r;d>=h;d--)n[d]=t[d][h-1]/m,c+=n[d]*n[d];for(l=R(c),0<n[h]&&(l=-l),c-=n[h]*l,n[h]-=l,i=h;i<e;i++){for(a=0,d=r;d>=h;d--)a+=n[d]*t[d][i];for(a/=c,d=h;d<=r;d++)t[d][i]-=a*n[d]}for(d=0;d<=r;d++){for(a=0,i=r;i>=h;i--)a+=n[i]*t[d][i];for(a/=c,i=h;i<=r;i++)t[d][i]-=a*n[i]}n[h]=m*n[h],t[h][h-1]=m*l}}for(d=0;d<e;d++)for(i=0;i<e;i++)o[d][i]=d===i?1:0;for(h=r-1;h>=s+1;h--)if(0!==t[h][h-1]){for(d=h+1;d<=r;d++)n[d]=t[d][h-1];for(i=h;i<=r;i++){for(l=0,d=h;d<=r;d++)l+=n[d]*o[d][i];for(l=l/n[h]/t[h][h-1],d=h;d<=r;d++)o[d][i]+=l*n[d]}}}function l(o,a,e,d,g){var h=o-1,n=0,f=o-1,b=2.220446049250313e-16,I=0,S=0,C=0,p=0,V=0,D=0,_=0,P=0,A,i,j,k,l,m,t,w,x,y,L,U,F,T,q;for(A=0;A<o;A++)for((A<n||A>f)&&(e[A]=g[A][A],a[A]=0),i=M(A-1,0);i<o;i++)S+=u(g[A][i]);for(;h>=n;){for(k=h;k>n&&(D=u(g[k-1][k-1])+u(g[k][k]),0===D&&(D=S),!(u(g[k][k-1])<b*D));)k--;if(k===h)g[h][h]+=I,e[h]=g[h][h],a[h]=0,h--,P=0;else if(k===h-1){if(t=g[h][h-1]*g[h-1][h],C=(g[h-1][h-1]-g[h][h])/2,p=C*C+t,_=R(u(p)),g[h][h]+=I,g[h-1][h-1]=g[h-1][h-1]+I,w=g[h][h],0<=p){for(_=0<=C?C+_:C-_,e[h-1]=w+_,e[h]=e[h-1],0!==_&&(e[h]=w-t/_),a[h-1]=0,a[h]=0,w=g[h][h-1],D=u(w)+u(_),C=w/D,p=_/D,V=R(C*C+p*p),C/=V,p/=V,i=h-1;i<o;i++)_=g[h-1][i],g[h-1][i]=p*_+C*g[h][i],g[h][i]=p*g[h][i]-C*_;for(A=0;A<=h;A++)_=g[A][h-1],g[A][h-1]=p*_+C*g[A][h],g[A][h]=p*g[A][h]-C*_;for(A=n;A<=f;A++)_=d[A][h-1],d[A][h-1]=p*_+C*d[A][h],d[A][h]=p*d[A][h]-C*_}else e[h-1]=w+C,e[h]=w+C,a[h-1]=_,a[h]=-_;h-=2,P=0}else{if(w=g[h][h],x=0,t=0,k<h&&(x=g[h-1][h-1],t=g[h][h-1]*g[h-1][h]),10==P){for(I+=w,A=n;A<=h;A++)g[A][A]-=w;D=u(g[h][h-1])+u(g[h-1][h-2]),w=x=0.75*D,t=-0.4375*D*D}if(30==P&&(D=(x-w)/2,D=D*D+t,0<D)){for(D=R(D),x<w&&(D=-D),D=w-t/((x-w)/2+D),A=n;A<=h;A++)g[A][A]-=D;I+=D,w=x=t=0.964}for(++P,l=h-2;l>=k&&(_=g[l][l],V=w-_,D=x-_,C=(V*D-t)/g[l+1][l]+g[l][l+1],p=g[l+1][l+1]-_-V-D,V=g[l+2][l+1],D=u(C)+u(p)+u(V),C/=D,p/=D,V/=D,l!==k)&&!(u(g[l][l-1])*(u(p)+u(V))<b*(u(C)*(u(g[l-1][l-1])+u(_)+u(g[l+1][l+1]))));)l--;for(A=l+2;A<=h;A++)g[A][A-2]=0,A>l+2&&(g[A][A-3]=0);for(j=l;j<=h-1&&(T=j!==h-1,j!==l&&(C=g[j][j-1],p=g[j+1][j-1],V=T?g[j+2][j-1]:0,w=u(C)+u(p)+u(V),0!==w&&(C/=w,p/=w,V/=w)),0!==w);j++)if(D=R(C*C+p*p+V*V),0>C&&(D=-D),0!==D){for(j===l?k!==l&&(g[j][j-1]=-g[j][j-1]):g[j][j-1]=-D*w,C+=D,w=C/D,x=p/D,_=V/D,p/=C,V/=C,i=j;i<o;i++)C=g[j][i]+p*g[j+1][i],T&&(C+=V*g[j+2][i],g[j+2][i]=g[j+2][i]-C*_),g[j][i]-=C*w,g[j+1][i]=g[j+1][i]-C*x;for(A=0;A<=v(h,j+3);A++)C=w*g[A][j]+x*g[A][j+1],T&&(C+=_*g[A][j+2],g[A][j+2]=g[A][j+2]-C*V),g[A][j]-=C,g[A][j+1]=g[A][j+1]-C*p;for(A=n;A<=f;A++)C=w*d[A][j]+x*d[A][j+1],T&&(C+=_*d[A][j+2],d[A][j+2]=d[A][j+2]-C*V),d[A][j]-=C,d[A][j+1]=d[A][j+1]-C*p}}}if(0!==S){for(h=o-1;0<=h;h--)if(C=e[h],p=a[h],0===p)for(k=h,g[h][h]=1,A=h-1;0<=A;A--){for(t=g[A][A]-C,V=0,i=k;i<=h;i++)V+=g[A][i]*g[i][h];if(0>a[A])_=t,D=V;else if(k=A,0===a[A]?g[A][h]=0===t?-V/(b*S):-V/t:(w=g[A][A+1],x=g[A+1][A],p=(e[A]-C)*(e[A]-C)+a[A]*a[A],m=(w*D-_*V)/p,g[A][h]=m,g[A+1][h]=u(w)>u(_)?(-V-t*m)/w:(-D-x*m)/_),m=u(g[A][h]),1<b*m*m)for(i=A;i<=h;i++)g[i][h]/=m}else if(0>p)for(k=h-1,u(g[h][h-1])>u(g[h-1][h])?(g[h-1][h-1]=p/g[h][h-1],g[h-1][h]=-(g[h][h]-C)/g[h][h-1]):(q=c(0,-g[h-1][h],g[h-1][h-1]-C,p),g[h-1][h-1]=q[0],g[h-1][h]=q[1]),g[h][h-1]=0,g[h][h]=1,A=h-2;0<=A;A--){for(y=0,L=0,i=k;i<=h;i++)y+=g[A][i]*g[i][h-1],L+=g[A][i]*g[i][h];if(t=g[A][A]-C,0>a[A])_=t,V=y,D=L;else if(k=A,0===a[A]?(q=c(-y,-L,t,p),g[A][h-1]=q[0],g[A][h]=q[1]):(w=g[A][A+1],x=g[A+1][A],U=(e[A]-C)*(e[A]-C)+a[A]*a[A]-p*p,F=2*(e[A]-C)*p,0===U&&0===F&&(U=b*S*(u(t)+u(p)+u(w)+u(x)+u(_))),q=c(w*V-_*y+p*L,w*D-_*L-p*y,U,F),g[A][h-1]=q[0],g[A][h]=q[1],u(w)>u(_)+u(p)?(g[A+1][h-1]=(-y-t*g[A][h-1]+p*g[A][h])/w,g[A+1][h]=(-L-t*g[A][h]-p*g[A][h-1])/w):(q=c(-V-x*g[A][h-1],-D-x*g[A][h],_,p),g[A+1][h-1]=q[0],g[A+1][h]=q[1])),m=M(u(g[A][h-1]),u(g[A][h])),1<b*m*m)for(i=A;i<=h;i++)g[i][h-1]=g[i][h-1]/m,g[i][h]/=m}for(A=0;A<o;A++)if(A<n||A>f)for(i=A;i<o;i++)d[A][i]=g[A][i];for(i=o-1;i>=n;i--)for(A=n;A<=f;A++){for(_=0,j=n;j<=v(i,f);j++)_+=d[A][j]*g[j][i];d[A][i]=_}}}function c(e,t,i,n){var o,s;return u(i)>u(n)?(o=n/i,s=i+o*n,[(e+o*t)/s,(t-o*e)/s]):(o=i/n,s=n+o*i,[(o*e+t)/s,(o*t-e)/s])}var m=i(6).Matrix,n=i(39),j=n.hypotenuse,g=n.getFilled2DArray,h={assumeSymmetric:!1};o.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return m.isMatrix(this.V)||(this.V=new m(this.V)),this.V},get diagonalMatrix(){var t=this.n,n=this.e,e=this.d,o=new m(t,t),s,i;for(s=0;s<t;s++){for(i=0;i<t;i++)o[s][i]=0;o[s][s]=e[s],0<n[s]?o[s][s+1]=n[s]:0>n[s]&&(o[s][s-1]=n[s])}return o}},e.exports=o},function(e,t,i){'use strict';function o(e){if(!(this instanceof o))return new o(e);e=r.checkMatrix(e);var t=e.clone(),a=e.rows,l=e.columns,c=Array(l),u,i,m,d;for(m=0;m<l;m++){var g=0;for(u=m;u<a;u++)g=n(g,t[u][m]);if(0!==g){for(0>t[m][m]&&(g=-g),u=m;u<a;u++)t[u][m]/=g;for(t[m][m]+=1,i=m+1;i<l;i++){for(d=0,u=m;u<a;u++)d+=t[u][m]*t[u][i];for(d=-d/t[m][m],u=m;u<a;u++)t[u][i]+=d*t[u][m]}}c[m]=-g}this.QR=t,this.Rdiag=c}var r=i(6).Matrix,n=i(39).hypotenuse;o.prototype={solve:function(e){e=r.checkMatrix(e);var t=this.QR,o=t.rows;if(e.rows!==o)throw new Error('Matrix row dimensions must agree');if(!this.isFullRank())throw new Error('Matrix is rank deficient');var a=e.columns,l=e.clone(),c=t.columns,n,i,u,m;for(u=0;u<c;u++)for(i=0;i<a;i++){for(m=0,n=u;n<o;n++)m+=t[n][u]*l[n][i];for(m=-m/t[u][u],n=u;n<o;n++)l[n][i]+=m*t[n][u]}for(u=c-1;0<=u;u--){for(i=0;i<a;i++)l[u][i]/=this.Rdiag[u];for(n=0;n<u;n++)for(i=0;i<a;i++)l[n][i]-=l[u][i]*t[n][u]}return l.subMatrix(0,c-1,0,a-1)},isFullRank:function(){for(var e=this.QR.columns,t=0;t<e;t++)if(0===this.Rdiag[t])return!1;return!0},get upperTriangularMatrix(){var e=this.QR,t=e.columns,n=new r(t,t),o,i;for(o=0;o<t;o++)for(i=0;i<t;i++)n[o][i]=o<i?e[o][i]:o===i?this.Rdiag[o]:0;return n},get orthogonalMatrix(){var e=this.QR,t=e.rows,n=e.columns,o=new r(t,n),a,i,l,c;for(l=n-1;0<=l;l--){for(a=0;a<t;a++)o[a][l]=0;for(o[l][l]=1,i=l;i<n;i++)if(0!==e[l][l]){for(c=0,a=l;a<t;a++)c+=e[a][l]*o[a][i];for(c=-c/e[l][l],a=l;a<t;a++)o[a][i]+=c*e[a][l]}}return o}},e.exports=o},function(e,t,i){'use strict';function n(e){if(!(this instanceof n))return new n(e);if(e=o.checkMatrix(e),!e.isSymmetric())throw new Error('Matrix is not symmetric');var t=e,r=t.rows,a=new o(r,r),l=!0,c,i,u;for(i=0;i<r;i++){var m=a[i],g=0;for(u=0;u<i;u++){var d=a[u],h=0;for(c=0;c<u;c++)h+=d[c]*m[c];m[u]=h=(t[i][u]-h)/a[u][u],g+=h*h}for(g=t[i][i]-g,l&=0<g,a[i][i]=R(M(g,0)),u=i+1;u<r;u++)a[i][u]=0}if(!l)throw new Error('Matrix is not positive definite');this.L=a}var o=i(6).Matrix;n.prototype={get lowerTriangularMatrix(){return this.L},solve:function(e){e=o.checkMatrix(e);var t=this.L,n=t.rows;if(e.rows!==n)throw new Error('Matrix dimensions do not match');var s=e.columns,r=e.clone(),a,i,l;for(l=0;l<n;l++)for(i=0;i<s;i++){for(a=0;a<l;a++)r[l][i]-=r[a][i]*t[l][a];r[l][i]/=t[l][l]}for(l=n-1;0<=l;l--)for(i=0;i<s;i++){for(a=l+1;a<n;a++)r[l][i]-=r[a][i]*t[a][l];r[l][i]/=t[l][l]}return r}},e.exports=n},function(i,n,o){'use strict';var r=o(224);class a{constructor(n,o,s){if(s=s||{},n.length!==o.length||n[0].length!==o[0].length)throw new Error('dimensions of prediction and target do not match');var r=n.length,a=n[0].length,c=!s.max,u=[];if(s.all)for(var m=0;m<r;m++)for(var i=0;i<a;i++)u.push({pred:n[m][i],targ:o[m][i]});else{if(3>r||r!==a)throw new Error('When "all" option is false, the prediction matrix must be square and have at least 3 columns');for(var m=0;m<r-1;m++)for(var i=m+1;i<a;i++)u.push({pred:n[m][i],targ:o[m][i]})}c?u.sort((e,t)=>e.pred-t.pred):u.sort((e,t)=>t.pred-e.pred);for(var d=this.cutoffs=[c?t:e],g=this.fp=[0],h=this.tp=[0],p=0,k=0,j=u[0].pred,x=0,w=0,m=0;m<u.length;m++)u[m].pred!==j&&(d.push(j),g.push(w),h.push(x),j=u[m].pred),u[m].targ?(p++,x++):(k++,w++);d.push(j),g.push(w),h.push(x);for(var f=d.length,l=this.fn=Array(f),y=this.tn=Array(f),M=this.nPosPred=Array(f),b=this.nNegPred=Array(f),m=0;m<f;m++)l[m]=p-h[m],y[m]=k-g[m],M[m]=h[m]+g[m],b[m]=y[m]+l[m];this.nPos=p,this.nNeg=k,this.nSamples=p+k}getMeasure(e){if('string'!=typeof e)throw new Error('No measure specified');if(!r[e])throw new Error(`The specified measure (${e}) does not exist`);return r[e](this)}getAURC(){for(var e=this.cutoffs.length,t=Array(e),n=Array(e),o=0;o<e;o++)t[o]=this.fp[o]/this.nNeg,n[o]=this.tp[o]/this.nPos;var i=0;for(o=1;o<e;o++)i+=0.5*(t[o]-t[o-1])*(n[o]+n[o-1]);return i}getAUDC(){for(var e=this.cutoffs.length,t=Array(e),n=Array(e),o=0;o<e;o++)t[o]=this.fn[o]/this.nPos,n[o]=this.fp[o]/this.nNeg;var i=0;for(o=1;o<e;o++)i+=0.5*(t[o]+t[o-1])*(n[o]-n[o-1]);return i}getDistribution(e){e=e||{};for(var t=this.cutoffs.length,n=e.xMin||g(100*this.cutoffs[t-1])/100,o=e.xMax||s(100*this.cutoffs[1])/100,r=e.interval||g(1e7*((o-n)/20)-1)/1e7,a=[],l=[],c=[],u=[],m=[],d=this.tp[t-1],h=0,p=this.fp[t-1],k=0,x=n,i=t-1;x<=o;x+=r){for(;this.cutoffs[i]<x;)i--;a.push(x);var j=d-h-this.tp[i],w=p-k-this.fp[i];h+=j,k+=w,l.push(w),c.push(j),u.push(100-100*((p-this.fp[i])/p)),m.push(100-100*((d-this.tp[i])/d))}return{xLabels:a,interValues:l,intraValues:c,interCumPercent:u,intraCumPercent:m}}}a.names={acc:'Accuracy',err:'Error rate',fpr:'False positive rate',tpr:'True positive rate',fnr:'False negative rate',tnr:'True negative rate',ppv:'Positive predictive value',npv:'Negative predictive value',pcfall:'Prediction-conditioned fallout',pcmiss:'Prediction-conditioned miss',lift:'Lift value',rpp:'Rate of positive predictions',rnp:'Rate of negative predictions',threshold:'Threshold'},i.exports=a},function(e,t){'use strict';t.acc=(e)=>{for(var t=e.cutoffs.length,n=Array(t),o=0;o<t;o++)n[o]=(e.tn[o]+e.tp[o])/(t-1);return n},t.err=(e)=>{for(var t=e.cutoffs.length,n=Array(t),o=0;o<t;o++)n[o]=e.fn[o]+e.fp[o]/(t-1);return n},t.fpr=(e)=>{for(var t=e.cutoffs.length,n=Array(t),o=0;o<t;o++)n[o]=e.fp[o]/e.nNeg;return n},t.tpr=(e)=>{for(var t=e.cutoffs.length,n=Array(t),o=0;o<t;o++)n[o]=e.tp[o]/e.nPos;return n},t.fnr=(e)=>{for(var t=e.cutoffs.length,n=Array(t),o=0;o<t;o++)n[o]=e.fn[o]/e.nPos;return n},t.tnr=(e)=>{for(var t=e.cutoffs.length,n=Array(t),o=0;o<t;o++)n[o]=e.tn[o]/e.nNeg;return n},t.ppv=(e)=>{for(var t=e.cutoffs.length,n=Array(t),o=0;o<t;o++)n[o]=0===e.fp[o]+e.tp[o]?0:e.tp[o]/(e.fp[o]+e.tp[o]);return n},t.npv=(e)=>{for(var t=e.cutoffs.length,n=Array(t),o=0;o<t;o++)n[o]=0===e.fn[o]+e.tn[o]?0:e.tn[o]/(e.fn[o]+e.tn[o]);return n},t.pcfall=(e)=>{for(var t=e.cutoffs.length,n=Array(t),o=0;o<t;o++)n[o]=0===e.fp[o]+e.tp[o]?1:1-e.tp[o]/(e.fp[o]+e.tp[o]);return n},t.pcmiss=(e)=>{for(var t=e.cutoffs.length,n=Array(t),o=0;o<t;o++)n[o]=0===e.fn[o]+e.tn[o]?1:1-e.tn[o]/(e.fn[o]+e.tn[o]);return n},t.lift=(e)=>{for(var t=e.cutoffs.length,n=Array(t),o=0;o<t;o++)n[o]=0===e.nPosPred[o]?0:e.tp[o]/e.nPos/(e.nPosPred[o]/e.nSamples);return n},t.rpp=(e)=>{for(var t=e.cutoffs.length,n=Array(t),o=0;o<t;o++)n[o]=e.nPosPred[o]/e.nSamples;return n},t.rnp=(e)=>{for(var t=e.cutoffs.length,n=Array(t),o=0;o<t;o++)n[o]=e.nNegPred[o]/e.nSamples;return n},t.threshold=(e)=>{var t=e.cutoffs.slice();return t[0]=t[1],t}},function(e,t,i){'use strict';function n(e,t){var n=t.length/3,o=e.rows,s=h.zeros(e.length,1),r,a,i,l;for(a=0;a<n;a++)for(l=c(t[a+2*n][0]/2,2),r=t[a+n][0]*l,i=0;i<o;i++)s[i][0]+=r/(c(e[i][0]-t[a][0],2)+l);return s}function s(e,t){for(var n=t[1][0]*c(t[2][0]/2,2),o=e.rows,s=new h(e.rows,e.columns),r=0;r<o;r++)s[r][0]=n/(c(e[r][0]-t[0][0],2)+c(t[2][0]/2,2));return s}function r(e,t){for(var n=t[2][0]*t[2][0]/2,s=e.rows,r=new h(e.rows,e.columns),a=0;a<s;a++)r[a][0]=t[1][0]*o(-(e[a][0]-t[0][0])*(e[a][0]-t[0][0])/n);return r}function a(e,i,n){n=n||{};var o=m(e,n.percentage||0);if(null===o||3>o[0].rows)return null;var r=o[0],t=o[1],a=o[2],l=r.rows,c=[l/R(t.dot(t))],n=Object.create(n.LMOptions||[3,100,0.001,0.001,0.001,0.01,0.01,11,9,1]),g=u(r[0][0]-r[1][0]),p=new h([[-g/1e4],[-0.001],[-g/1e4]]),k=new h([[i.x],[1],[i.width]]),j=new h([[i.x-g],[0.75],[i.width/4]]),x=new h([[i.x+g],[1.25],[4*i.width]]),w=d.optimize(s,k,r,t,c,p,j,x,[],n);return w=w.p,[w[0],[w[1][0]*a],w[2]]}function l(e,i,n){n=n||{};var o=m(e,n.percentage||0);if(null===o||3>o[0].rows)return null;var s=o[0],t=o[1],a=o[2],l=s.rows,c=[l/R(t.dot(t))],n=Object.create(n.LMOptions||[3,100,0.001,0.001,0.001,0.01,0.01,11,9,1]),g=u(s[0][0]-s[1][0]),p=new h([[-g/1e4],[-0.001],[-g/1e4]]),p=new h([[-u(s[0][0]-s[1][0])/1e3],[-0.001],[-i.width/1e3]]),k=new h([[i.x],[1],[i.width]]),j=new h([[i.x-g],[0.75],[i.width/4]]),x=new h([[i.x+g],[1.25],[4*i.width]]),w=d.optimize(r,k,s,t,c,p,j,x,[],n);return w=w.p,[w[0],[w[1][0]*a],w[2]]}function m(e,n){var o=e.length,s=null,t=null,r=0,a,l,c;if(2==o){var i=e[0].length;if(s=Array(i),t=Array(i),a=e[0],l=e[1],'number'==typeof a[0])for(c=0;c<i;c++)s[c]=a[c],t[c]=l[c],l[c]>r&&(r=l[c]);else if('object'==typeof a[0])for(c=0;c<i;c++)s[c]=a[c][0],t[c]=l[c][0],l[c][0]>r&&(r=l[c][0])}else{var i=o;for(s=Array(i),t=Array(i),c=0;c<i;c++)s[c]=e[c][0],t[c]=e[c][1],t[c]>r&&(r=t[c])}for(c=0;c<i;c++)t[c]/=r;if(n)for(c=i-1;0<=c;c--)t[c]<n&&(t.splice(c,1),s.splice(c,1));return 0<s.length?[new h([s]).transpose(),new h([t]).transpose(),r]:null}var d=i(226),g=d.Matrix.algebra,h=i(240);e.exports.optimizeSingleLorentzian=a,e.exports.optimizeLorentzianSum=function(e,o,s){var r=m(e);if(null===r||3>r[0].rows)return null;var a=r[0],t=r[1],l=r[2],c=a.rows,p=[c/g.sqrt(t.dot(t))],s=Object.create(s||[3,100,0.001,0.001,0.001,0.01,0.01,11,9,1]),k=o.length,j=new h(3*k,1),x=new h(3*k,1),w=new h(3*k,1),f=new h(3*k,1),y=u(a[0][0]-a[1][0]),M;for(M=0;M<k;M++)j[M][0]=o[M].x,j[M+k][0]=1,j[M+2*k][0]=o[M].width,x[M][0]=o[M].x-y,x[M+k][0]=0,x[M+2*k][0]=o[M].width/4,w[M][0]=o[M].x+y,w[M+k][0]=1.5,w[M+2*k][0]=4*o[M].width,f[M][0]=-y/1e3,f[M+k][0]=-1e-3,f[M+2*k][0]=-y/1e3;var f=-u(a[0][0]-a[1][0])/1e4,i=d.optimize(n,j,a,t,p,f,x,w,[],s);i=i.p;var b=Array(k);for(M=0;M<k;M++)b[M]=[i[M],[i[M+k][0]*l],i[M+2*k]];return b},e.exports.optimizeSingleGaussian=l,e.exports.optimizeGaussianSum=function(e,o,s){var r=m(e);if(null===r||3>r[0].rows)return null;var a=r[0],t=r[1],l=r[2],c=a.rows,p=new h(c,1),j=c/g.sqrt(t.dot(t)),k;for(k=0;k<c;k++)p[k][0]=j;var s=Object.create(s||[3,100,0.001,0.001,0.001,0.01,0.01,11,9,2]),i=o.length,x=new h(3*i,1),w=new h(3*i,1),f=new h(3*i,1),y=new h(3*i,1),M=u(a[0][0]-a[1][0]);for(k=0;k<i;k++)x[k][0]=o[k].x,x[k+i][0]=o[k].y/l,x[k+2*i][0]=o[k].width,w[k][0]=o[k].x-M,w[k+i][0]=0.8*o[k].y/l,w[k+2*i][0]=o[k].width/2,f[k][0]=o[k].x+M,f[k+i][0]=1.2*o[k].y/l,f[k+2*i][0]=2*o[k].width,y[k][0]=-M/1e3,y[k+i][0]=-1e-3,y[k+2*i][0]=-M/1e3;var b=d.optimize(n,x,a,t,p,y,w,f,[],s);b=b.p;var v=Array(i);for(k=0;k<i;k++)v[k]=[b[k],[b[k+i][0]*l],b[k+2*i]];return v},e.exports.singleGaussian=r,e.exports.singleLorentzian=s,e.exports.optimizeGaussianTrain=function(e,n,o){var s=m(e);if(null===s||3>s[0].rows)return null;for(var r=s[0],t=s[1],a=s[2],c=0,u=r.length,d=[],g=0,i,h,p,a,k;g<n.length;g++){for(i=n[g].x-1.5*n[g].width;r[c++]<i&&c<u;);for(i=n[g].x+1.5*n[g].width,h=[],p=[];r[c]<=i&&c<u;)h.push(r[c][0]),p.push(t[c][0]*a),c++;k=l([h,p],n[g],o),k?d.push({x:k[0][0],y:k[1][0],width:k[2][0],opt:!0}):d.push({x:n[g].x,y:n[g].y,width:n[g].width,opt:!1})}return d},e.exports.optimizeLorentzianTrain=function(e,n,o){var s=m(e);if(null===s||3>s[0].rows)return null;for(var r=s[0],t=s[1],l=s[2],c=0,u=r.length,d=[],g=0,i,h,p,l,k;g<n.length;g++){for(i=n[g].x-1.5*n[g].width;r[c++]<i&&c<u;);for(i=n[g].x+1.5*n[g].width,h=[],p=[];r[c]<=i&&c<u;)h.push(r[c][0]),p.push(t[c][0]*l),c++;k=a([h,p],n[g],o),k?d.push({x:k[0][0],y:k[1][0],width:k[2][0],opt:!0}):d.push({x:n[g].x,y:n[g].y,width:n[g].width,opt:!1})}return d}},function(e,t,i){'use strict';e.exports=i(227),e.exports.Matrix=i(40),e.exports.Matrix.algebra=i(79)},function(e,t,i){'use strict';var o=i(40),s=i(79);e.exports={optimize:function(e,n,r,t,a,l,m,d,g,c){var j=0;if('object'!=typeof n[0])for(var x=0;x<n.length;x++)n[x]=[n[x]];var i=-50,w=n.length,f=t.length,y=o.zeros(w,1),b=o.zeros(f,1),I=0.01/i,S=0.01/i,C=o.zeros(f,w),x,V;if(r.length!=t.length){console.log('lm.m error: the length of t must equal the length of y_dat'),length_t=r.length,length_y_dat=t.length;var I=0;return}a=a||R((f-w+1)/s.multiply(s.transpose(t),t)),l=l||1e-3,m=m||s.multiply(u(n),-100),d=d||s.multiply(u(n),100),g=g||1,c=c||[3,10*w,1e-3,1e-3,1e-3,0.01,0.01,11,9,1];var k=c[0],D=c[1],z=c[2],_=c[3],P=c[4],A=c[5],L=c[6],U=c[7],F=c[8],T=c[9];if(0,!l.length||1==l.length){for(var q=Array(w),x=0;x<w;x++)q[x]=[l];l=q}var N=[];for(x=0;x<l.length;x++)0!=l[x][0]&&N.push(x);var O=N.length,E=!1,B=null;if(!a.length||a.length<f){var Q=s.multiply(o.ones(f,1),a[0]);B=s.dotMultiply(Q,Q)}else B=s.dotMultiply(a,a);var W=this.lm_matx(e,r,y,b,1,C,n,t,B,l,g),X=W.JtWJ,J=W.JtWdy,I=W.Chi_sq,Y=W.y_hat,C=W.J;M(u(J))<z&&(console.log(' *** Your Initial Guess is Extremely Close to Optimal ***'),console.log(' *** epsilon_1 = ',z),E=!0),1===T?lambda=L:(lambda=L*M(s.diag(X)),nu=2),S=I;for(var H=null;!E&&j<=D;){++j,H=1===T?s.solve(s.add(X,s.multiply(s.diag(s.diag(X)),lambda)),J):s.solve(s.add(X,s.multiply(o.eye(w),lambda)),J);var h=Array(N.length);for(V=0;V<N.length;V++)h[V]=H[N[V]];var K=s.add(n,h);for(V=0;V<K.length;V++)K[V][0]=v(M(m[V][0],K[V][0]),d[V][0]);var G=s.subtract(t,e(r,K,g)),Z=s.multiply(s.transpose(G),s.dotMultiply(G,B));if(2==T){var $=s.multiply(s.transpose(J),H),ee=s.multiply($,s.inv(s.add(s.multiply(s.subtract(Z-I),1/2)),s.multiply($,2)));H=s.multiply(ee,H);for(var V=0;V<N.length;V++)h[V]=H[N[V]];K=s.add(n,h),K=s.min(s.max(m,K),d),G=s.subtract(t,e(r,K,g)),Z=s.multiply(s.transpose(G),mat.dotMultiply(G,B))}var te=(I-Z)/s.multiply(s.multiply(s.transpose(H),2),s.add(s.multiply(lambda,H),J));te>A?(dX2=I-S,S=I,y=n,b=Y,n=K,W=this.lm_matx(e,r,y,b,dX2,C,n,t,B,l,g),X=W.JtWJ,J=W.JtWdy,I=W.Chi_sq,Y=W.y_hat,C=W.J,1===T?lambda=M(lambda/F,1e-7):2===T?lambda=M(lambda/(1+ee),1e-7):3===T?(lambda=s.multiply(M(1/3,3^1-(2*te-1)),lambda),nu=2):void 0):(I=S,0==j%(2*w)&&(W=this.lm_matx(e,r,y,b,-1,C,n,t,B,l,g),X=W.JtWJ,J=W.JtWdy,dX2=W.Chi_sq,Y=W.y_hat,C=W.J),1===T?lambda=v(lambda*U,1e7):2===T?lambda+=u((Z-I)/2/ee):3===T?(lambda*=nu,nu=2*nu):void 0)}return B=s.multiply(s.multiply(s.transpose(G),G),o.ones(f,1)),B.apply(function(e,t){B[e][t]=(f-O+1)/B[e][t]}),W=this.lm_matx(e,r,y,b,-1,C,n,t,B,l,g),X=W.JtWJ,J=W.JtWdy,I=W.Chi_sq,Y=W.y_hat,C=W.J,{p:n,X2:I}},lm_FD_J:function(e,i,t,r,a,l){var c=r.length,m=t.length;a=a||s.multiply(o.ones(m,1),1e-3);for(var n=t.clone(),d=new o(c,m),g=Array(m),h=0;h<m;h++){if(g[h]=a[h]*(1+u(t[h][0])),t[h]=[n[h][0]+g[h]],0!=g[h])if(y1=e(i,t,l),0>a[h][0])for(var p=s.dotDivide(s.subtract(y1,r),g[h]),j=0;j<c;j++)d[j][h]=p[j][0];else{t[h][0]=n[h][0]-g[h];for(var p=s.dotDivide(s.subtract(y1,e(i,t,l)),2*g[h]),j=0;j<c;j++)d[j][h]=p[j][0]}t[h]=n[h]}return d},lm_Broyden_J:function(e,t,i,n,o){var r=s.subtract(n,e),a=s.transpose(r);return a.div(s.multiply(a,r)),i=s.add(i,s.multiply(s.subtract(o,s.add(t,s.multiply(i,r))),a)),i},lm_matx:function(e,i,t,n,r,a,l,u,m,d,g,c){var h=u.length,p=l.length;d=d||1e-3;var k=e(i,l,g);a=0==c%(2*p)||0<r?this.lm_FD_J(e,i,l,k,d,g):this.lm_Broyden_J(t,n,a,l,k);var j=s.subtract(u,k),x=s.multiply(s.transpose(j),s.dotMultiply(j,m)),w=s.transpose(a),f=s.multiply(w,s.dotMultiply(a,s.multiply(m,o.ones(1,p)))),y=s.multiply(w,s.dotMultiply(m,j));return{JtWJ:f,JtWdy:y,Chi_sq:x,y_hat:k,J:a}}}},function(){'use strict';Symbol.species||(Symbol.species=Symbol.for('@@species'))},function(e,t,i){'use strict';var n=i(17);e.exports=class extends n{constructor(e){super(e,e.columns,e.rows)}set(e,t,i){return this.matrix.set(t,e,i),this}get(e,t){return this.matrix.get(t,e)}}},function(e,t,i){'use strict';var n=i(17);e.exports=class extends n{constructor(e,t){super(e,1,e.columns),this.row=t}set(e,t,i){return this.matrix.set(this.row,t,i),this}get(e,t){return this.matrix.get(this.row,t)}}},function(e,t,i){'use strict';var n=i(17),o=i(26);e.exports=class extends n{constructor(e,t,i,n,s){o.checkRange(e,t,i,n,s),super(e,i-t+1,s-n+1),this.startRow=t,this.startColumn=n}set(e,t,i){return this.matrix.set(this.startRow+e,this.startColumn+t,i),this}get(e,t){return this.matrix.get(this.startRow+e,this.startColumn+t)}}},function(e,t,i){'use strict';var n=i(17),o=i(26);e.exports=class extends n{constructor(e,t,i){var n=o.checkIndices(e,t,i);super(e,n.row.length,n.column.length),this.rowIndices=n.row,this.columnIndices=n.column}set(e,t,i){return this.matrix.set(this.rowIndices[e],this.columnIndices[t],i),this}get(e,t){return this.matrix.get(this.rowIndices[e],this.columnIndices[t])}}},function(e,t,i){'use strict';var n=i(17);e.exports=class extends n{constructor(e,t){super(e,e.rows,1),this.column=t}set(e,t,i){return this.matrix.set(e,this.column,i),this}get(e){return this.matrix.get(e,this.column)}}},function(e,t,i){'use strict';var n=i(17);e.exports=class extends n{constructor(e){super(e,e.rows,e.columns)}set(e,t,i){return this.matrix.set(this.rows-e-1,t,i),this}get(e,t){return this.matrix.get(this.rows-e-1,t)}}},function(e,t,i){'use strict';var n=i(17);e.exports=class extends n{constructor(e){super(e,e.rows,e.columns)}set(e,t,i){return this.matrix.set(e,this.columns-t-1,i),this}get(e,t){return this.matrix.get(e,this.columns-t-1)}}},function(e,t,i){'use strict';function n(e){return e=s.checkMatrix(e),o(e,s.eye(e.rows))}function o(e,t){return e=s.checkMatrix(e),t=s.checkMatrix(t),e.isSquare()?new l(e).solve(t):new c(e).solve(t)}var s=i(7).Matrix,r=i(78),a=i(237),l=i(77),c=i(238),u=i(239);s.inverse=s.inv=n,s.prototype.inverse=s.prototype.inv=function(){return n(this)},s.solve=o,s.prototype.solve=function(e){return o(this,e)},e.exports={SingularValueDecomposition:r,SVD:r,EigenvalueDecomposition:a,EVD:a,LuDecomposition:l,LU:l,QrDecomposition:c,QR:c,CholeskyDecomposition:u,CHO:u,inverse:n,solve:o}},function(e,t,i){'use strict';function o(t,c){if(c=Object.assign({},h,c),!(this instanceof o))return new o(t,c);if(t=m.checkMatrix(t),!t.isSquare())throw new Error('Matrix is not a square matrix');var u=t.columns,n=g(u,u,0),p=Array(u),d=Array(u),e=t,k=!1,x,i;if(k=!!c.assumeSymmetric||t.isSymmetric(),k){for(x=0;x<u;x++)for(i=0;i<u;i++)n[x][i]=e.get(x,i);s(u,d,p,n),r(u,d,p,n)}else{var j=g(u,u,0),w=Array(u);for(i=0;i<u;i++)for(x=0;x<u;x++)j[x][i]=e.get(x,i);a(u,j,w,n),l(u,d,p,n,j)}this.n=u,this.e=d,this.d=p,this.V=n}function s(t,n,e,o){var s,r,a,l,i,c,m,d;for(i=0;i<t;i++)e[i]=o[t-1][i];for(l=t-1;0<l;l--){for(d=0,a=0,c=0;c<l;c++)d+=u(e[c]);if(0===d)for(n[l]=e[l-1],i=0;i<l;i++)e[i]=o[l-1][i],o[l][i]=0,o[i][l]=0;else{for(c=0;c<l;c++)e[c]/=d,a+=e[c]*e[c];for(s=e[l-1],r=R(a),0<s&&(r=-r),n[l]=d*r,a-=s*r,e[l-1]=s-r,i=0;i<l;i++)n[i]=0;for(i=0;i<l;i++){for(s=e[i],o[i][l]=s,r=n[i]+o[i][i]*s,c=i+1;c<=l-1;c++)r+=o[c][i]*e[c],n[c]+=o[c][i]*s;n[i]=r}for(s=0,i=0;i<l;i++)n[i]/=a,s+=n[i]*e[i];for(m=s/(a+a),i=0;i<l;i++)n[i]-=m*e[i];for(i=0;i<l;i++){for(s=e[i],r=n[i],c=i;c<=l-1;c++)o[c][i]-=s*n[c]+r*e[c];e[i]=o[l-1][i],o[l][i]=0}}e[l]=a}for(l=0;l<t-1;l++){if(o[t-1][l]=o[l][l],o[l][l]=1,a=e[l+1],0!==a){for(c=0;c<=l;c++)e[c]=o[c][l+1]/a;for(i=0;i<=l;i++){for(r=0,c=0;c<=l;c++)r+=o[c][l+1]*o[c][i];for(c=0;c<=l;c++)o[c][i]-=r*e[c]}}for(c=0;c<=l;c++)o[c][l+1]=0}for(i=0;i<t;i++)e[i]=o[t-1][i],o[t-1][i]=0;o[t-1][t-1]=1,n[0]=0}function r(t,n,e,o){var a,d,g,i,h,k,l,m,p,x,w,c,y,b,v,R,I;for(g=1;g<t;g++)n[g-1]=n[g];n[t-1]=0;var S=0,f=0,C=2.220446049250313e-16;for(k=0;k<t;k++){for(f=M(f,u(e[k])+u(n[k])),l=k;l<t&&!(u(n[l])<=C*f);)l++;if(l>k){I=0;do{for(++I,a=e[k],m=(e[k+1]-a)/(2*n[k]),p=j(m,1),0>m&&(p=-p),e[k]=n[k]/(m+p),e[k+1]=n[k]*(m+p),x=e[k+1],d=a-e[k],g=k+2;g<t;g++)e[g]-=d;for(S+=d,m=e[l],w=1,c=w,y=w,b=n[k+1],v=0,R=0,g=l-1;g>=k;g--)for(y=c,c=w,R=v,a=w*n[g],d=w*m,p=j(m,n[g]),n[g+1]=v*p,v=n[g]/p,w=m/p,m=w*e[g]-v*a,e[g+1]=d+v*(w*a+v*e[g]),h=0;h<t;h++)d=o[h][g+1],o[h][g+1]=v*o[h][g]+w*d,o[h][g]=w*o[h][g]-v*d;m=-v*R*y*b*n[k]/x,n[k]=v*m,e[k]=w*m}while(u(n[k])>C*f)}e[k]+=S,n[k]=0}for(g=0;g<t-1;g++){for(h=g,m=e[g],i=g+1;i<t;i++)e[i]<m&&(h=i,m=e[i]);if(h!==g)for(e[h]=e[g],e[g]=m,i=0;i<t;i++)m=o[i][g],o[i][g]=o[i][h],o[i][h]=m}}function a(e,t,n,o){var s=0,r=e-1,a,l,c,d,i,h,m;for(h=s+1;h<=r-1;h++){for(m=0,d=h;d<=r;d++)m+=u(t[d][h-1]);if(0!==m){for(c=0,d=r;d>=h;d--)n[d]=t[d][h-1]/m,c+=n[d]*n[d];for(l=R(c),0<n[h]&&(l=-l),c-=n[h]*l,n[h]-=l,i=h;i<e;i++){for(a=0,d=r;d>=h;d--)a+=n[d]*t[d][i];for(a/=c,d=h;d<=r;d++)t[d][i]-=a*n[d]}for(d=0;d<=r;d++){for(a=0,i=r;i>=h;i--)a+=n[i]*t[d][i];for(a/=c,i=h;i<=r;i++)t[d][i]-=a*n[i]}n[h]=m*n[h],t[h][h-1]=m*l}}for(d=0;d<e;d++)for(i=0;i<e;i++)o[d][i]=d===i?1:0;for(h=r-1;h>=s+1;h--)if(0!==t[h][h-1]){for(d=h+1;d<=r;d++)n[d]=t[d][h-1];for(i=h;i<=r;i++){for(l=0,d=h;d<=r;d++)l+=n[d]*o[d][i];for(l=l/n[h]/t[h][h-1],d=h;d<=r;d++)o[d][i]+=l*n[d]}}}function l(o,a,e,d,g){var h=o-1,n=0,f=o-1,b=2.220446049250313e-16,I=0,S=0,C=0,p=0,V=0,D=0,_=0,P=0,A,i,j,k,l,m,t,w,x,y,L,U,F,T,q;for(A=0;A<o;A++)for((A<n||A>f)&&(e[A]=g[A][A],a[A]=0),i=M(A-1,0);i<o;i++)S+=u(g[A][i]);for(;h>=n;){for(k=h;k>n&&(D=u(g[k-1][k-1])+u(g[k][k]),0===D&&(D=S),!(u(g[k][k-1])<b*D));)k--;if(k===h)g[h][h]+=I,e[h]=g[h][h],a[h]=0,h--,P=0;else if(k===h-1){if(t=g[h][h-1]*g[h-1][h],C=(g[h-1][h-1]-g[h][h])/2,p=C*C+t,_=R(u(p)),g[h][h]+=I,g[h-1][h-1]=g[h-1][h-1]+I,w=g[h][h],0<=p){for(_=0<=C?C+_:C-_,e[h-1]=w+_,e[h]=e[h-1],0!==_&&(e[h]=w-t/_),a[h-1]=0,a[h]=0,w=g[h][h-1],D=u(w)+u(_),C=w/D,p=_/D,V=R(C*C+p*p),C/=V,p/=V,i=h-1;i<o;i++)_=g[h-1][i],g[h-1][i]=p*_+C*g[h][i],g[h][i]=p*g[h][i]-C*_;for(A=0;A<=h;A++)_=g[A][h-1],g[A][h-1]=p*_+C*g[A][h],g[A][h]=p*g[A][h]-C*_;for(A=n;A<=f;A++)_=d[A][h-1],d[A][h-1]=p*_+C*d[A][h],d[A][h]=p*d[A][h]-C*_}else e[h-1]=w+C,e[h]=w+C,a[h-1]=_,a[h]=-_;h-=2,P=0}else{if(w=g[h][h],x=0,t=0,k<h&&(x=g[h-1][h-1],t=g[h][h-1]*g[h-1][h]),10==P){for(I+=w,A=n;A<=h;A++)g[A][A]-=w;D=u(g[h][h-1])+u(g[h-1][h-2]),w=x=0.75*D,t=-0.4375*D*D}if(30==P&&(D=(x-w)/2,D=D*D+t,0<D)){for(D=R(D),x<w&&(D=-D),D=w-t/((x-w)/2+D),A=n;A<=h;A++)g[A][A]-=D;I+=D,w=x=t=0.964}for(++P,l=h-2;l>=k&&(_=g[l][l],V=w-_,D=x-_,C=(V*D-t)/g[l+1][l]+g[l][l+1],p=g[l+1][l+1]-_-V-D,V=g[l+2][l+1],D=u(C)+u(p)+u(V),C/=D,p/=D,V/=D,l!==k)&&!(u(g[l][l-1])*(u(p)+u(V))<b*(u(C)*(u(g[l-1][l-1])+u(_)+u(g[l+1][l+1]))));)l--;for(A=l+2;A<=h;A++)g[A][A-2]=0,A>l+2&&(g[A][A-3]=0);for(j=l;j<=h-1&&(T=j!==h-1,j!==l&&(C=g[j][j-1],p=g[j+1][j-1],V=T?g[j+2][j-1]:0,w=u(C)+u(p)+u(V),0!==w&&(C/=w,p/=w,V/=w)),0!==w);j++)if(D=R(C*C+p*p+V*V),0>C&&(D=-D),0!==D){for(j===l?k!==l&&(g[j][j-1]=-g[j][j-1]):g[j][j-1]=-D*w,C+=D,w=C/D,x=p/D,_=V/D,p/=C,V/=C,i=j;i<o;i++)C=g[j][i]+p*g[j+1][i],T&&(C+=V*g[j+2][i],g[j+2][i]=g[j+2][i]-C*_),g[j][i]-=C*w,g[j+1][i]=g[j+1][i]-C*x;for(A=0;A<=v(h,j+3);A++)C=w*g[A][j]+x*g[A][j+1],T&&(C+=_*g[A][j+2],g[A][j+2]=g[A][j+2]-C*V),g[A][j]-=C,g[A][j+1]=g[A][j+1]-C*p;for(A=n;A<=f;A++)C=w*d[A][j]+x*d[A][j+1],T&&(C+=_*d[A][j+2],d[A][j+2]=d[A][j+2]-C*V),d[A][j]-=C,d[A][j+1]=d[A][j+1]-C*p}}}if(0!==S){for(h=o-1;0<=h;h--)if(C=e[h],p=a[h],0===p)for(k=h,g[h][h]=1,A=h-1;0<=A;A--){for(t=g[A][A]-C,V=0,i=k;i<=h;i++)V+=g[A][i]*g[i][h];if(0>a[A])_=t,D=V;else if(k=A,0===a[A]?g[A][h]=0===t?-V/(b*S):-V/t:(w=g[A][A+1],x=g[A+1][A],p=(e[A]-C)*(e[A]-C)+a[A]*a[A],m=(w*D-_*V)/p,g[A][h]=m,g[A+1][h]=u(w)>u(_)?(-V-t*m)/w:(-D-x*m)/_),m=u(g[A][h]),1<b*m*m)for(i=A;i<=h;i++)g[i][h]/=m}else if(0>p)for(k=h-1,u(g[h][h-1])>u(g[h-1][h])?(g[h-1][h-1]=p/g[h][h-1],g[h-1][h]=-(g[h][h]-C)/g[h][h-1]):(q=c(0,-g[h-1][h],g[h-1][h-1]-C,p),g[h-1][h-1]=q[0],g[h-1][h]=q[1]),g[h][h-1]=0,g[h][h]=1,A=h-2;0<=A;A--){for(y=0,L=0,i=k;i<=h;i++)y+=g[A][i]*g[i][h-1],L+=g[A][i]*g[i][h];if(t=g[A][A]-C,0>a[A])_=t,V=y,D=L;else if(k=A,0===a[A]?(q=c(-y,-L,t,p),g[A][h-1]=q[0],g[A][h]=q[1]):(w=g[A][A+1],x=g[A+1][A],U=(e[A]-C)*(e[A]-C)+a[A]*a[A]-p*p,F=2*(e[A]-C)*p,0===U&&0===F&&(U=b*S*(u(t)+u(p)+u(w)+u(x)+u(_))),q=c(w*V-_*y+p*L,w*D-_*L-p*y,U,F),g[A][h-1]=q[0],g[A][h]=q[1],u(w)>u(_)+u(p)?(g[A+1][h-1]=(-y-t*g[A][h-1]+p*g[A][h])/w,g[A+1][h]=(-L-t*g[A][h]-p*g[A][h-1])/w):(q=c(-V-x*g[A][h-1],-D-x*g[A][h],_,p),g[A+1][h-1]=q[0],g[A+1][h]=q[1])),m=M(u(g[A][h-1]),u(g[A][h])),1<b*m*m)for(i=A;i<=h;i++)g[i][h-1]=g[i][h-1]/m,g[i][h]/=m}for(A=0;A<o;A++)if(A<n||A>f)for(i=A;i<o;i++)d[A][i]=g[A][i];for(i=o-1;i>=n;i--)for(A=n;A<=f;A++){for(_=0,j=n;j<=v(i,f);j++)_+=d[A][j]*g[j][i];d[A][i]=_}}}function c(e,t,i,n){var o,s;return u(i)>u(n)?(o=n/i,s=i+o*n,[(e+o*t)/s,(t-o*e)/s]):(o=i/n,s=n+o*i,[(o*e+t)/s,(o*t-e)/s])}var m=i(7).Matrix,n=i(41),j=n.hypotenuse,g=n.getFilled2DArray,h={assumeSymmetric:!1};o.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return m.isMatrix(this.V)||(this.V=new m(this.V)),this.V},get diagonalMatrix(){var t=this.n,n=this.e,e=this.d,o=new m(t,t),s,i;for(s=0;s<t;s++){for(i=0;i<t;i++)o[s][i]=0;o[s][s]=e[s],0<n[s]?o[s][s+1]=n[s]:0>n[s]&&(o[s][s-1]=n[s])}return o}},e.exports=o},function(e,t,i){'use strict';function o(e){if(!(this instanceof o))return new o(e);e=r.checkMatrix(e);var t=e.clone(),a=e.rows,l=e.columns,c=Array(l),u,i,m,d;for(m=0;m<l;m++){var g=0;for(u=m;u<a;u++)g=n(g,t[u][m]);if(0!==g){for(0>t[m][m]&&(g=-g),u=m;u<a;u++)t[u][m]/=g;for(t[m][m]+=1,i=m+1;i<l;i++){for(d=0,u=m;u<a;u++)d+=t[u][m]*t[u][i];for(d=-d/t[m][m],u=m;u<a;u++)t[u][i]+=d*t[u][m]}}c[m]=-g}this.QR=t,this.Rdiag=c}var r=i(7).Matrix,n=i(41).hypotenuse;o.prototype={solve:function(e){e=r.checkMatrix(e);var t=this.QR,o=t.rows;if(e.rows!==o)throw new Error('Matrix row dimensions must agree');if(!this.isFullRank())throw new Error('Matrix is rank deficient');var a=e.columns,l=e.clone(),c=t.columns,n,i,u,m;for(u=0;u<c;u++)for(i=0;i<a;i++){for(m=0,n=u;n<o;n++)m+=t[n][u]*l[n][i];for(m=-m/t[u][u],n=u;n<o;n++)l[n][i]+=m*t[n][u]}for(u=c-1;0<=u;u--){for(i=0;i<a;i++)l[u][i]/=this.Rdiag[u];for(n=0;n<u;n++)for(i=0;i<a;i++)l[n][i]-=l[u][i]*t[n][u]}return l.subMatrix(0,c-1,0,a-1)},isFullRank:function(){for(var e=this.QR.columns,t=0;t<e;t++)if(0===this.Rdiag[t])return!1;return!0},get upperTriangularMatrix(){var e=this.QR,t=e.columns,n=new r(t,t),o,i;for(o=0;o<t;o++)for(i=0;i<t;i++)n[o][i]=o<i?e[o][i]:o===i?this.Rdiag[o]:0;return n},get orthogonalMatrix(){var e=this.QR,t=e.rows,n=e.columns,o=new r(t,n),a,i,l,c;for(l=n-1;0<=l;l--){for(a=0;a<t;a++)o[a][l]=0;for(o[l][l]=1,i=l;i<n;i++)if(0!==e[l][l]){for(c=0,a=l;a<t;a++)c+=e[a][l]*o[a][i];for(c=-c/e[l][l],a=l;a<t;a++)o[a][i]+=c*e[a][l]}}return o}},e.exports=o},function(e,t,i){'use strict';function n(e){if(!(this instanceof n))return new n(e);if(e=o.checkMatrix(e),!e.isSymmetric())throw new Error('Matrix is not symmetric');var t=e,r=t.rows,a=new o(r,r),l=!0,c,i,u;for(i=0;i<r;i++){var m=a[i],g=0;for(u=0;u<i;u++){var d=a[u],h=0;for(c=0;c<u;c++)h+=d[c]*m[c];m[u]=h=(t[i][u]-h)/a[u][u],g+=h*h}for(g=t[i][i]-g,l&=0<g,a[i][i]=R(M(g,0)),u=i+1;u<r;u++)a[i][u]=0}if(!l)throw new Error('Matrix is not positive definite');this.L=a}var o=i(7).Matrix;n.prototype={get lowerTriangularMatrix(){return this.L},solve:function(e){e=o.checkMatrix(e);var t=this.L,n=t.rows;if(e.rows!==n)throw new Error('Matrix dimensions do not match');var s=e.columns,r=e.clone(),a,i,l;for(l=0;l<n;l++)for(i=0;i<s;i++){for(a=0;a<l;a++)r[l][i]-=r[a][i]*t[l][a];r[l][i]/=t[l][l]}for(l=n-1;0<=l;l--)for(i=0;i<s;i++){for(a=l+1;a<n;a++)r[l][i]-=r[a][i]*t[a][l];r[l][i]/=t[l][l]}return r}},e.exports=n},function(e,t,i){'use strict';e.exports=i(8).Matrix,e.exports.Decompositions=e.exports.DC=i(249)},function(){'use strict';Symbol.species||(Symbol.species=Symbol.for('@@species'))},function(e,t,i){'use strict';var n=i(18);e.exports=class extends n{constructor(e){super(e,e.columns,e.rows)}set(e,t,i){return this.matrix.set(t,e,i),this}get(e,t){return this.matrix.get(t,e)}}},function(e,t,i){'use strict';var n=i(18);e.exports=class extends n{constructor(e,t){super(e,1,e.columns),this.row=t}set(e,t,i){return this.matrix.set(this.row,t,i),this}get(e,t){return this.matrix.get(this.row,t)}}},function(e,t,i){'use strict';var n=i(18),o=i(27);e.exports=class extends n{constructor(e,t,i,n,s){o.checkRange(e,t,i,n,s),super(e,i-t+1,s-n+1),this.startRow=t,this.startColumn=n}set(e,t,i){return this.matrix.set(this.startRow+e,this.startColumn+t,i),this}get(e,t){return this.matrix.get(this.startRow+e,this.startColumn+t)}}},function(e,t,i){'use strict';var n=i(18),o=i(27);e.exports=class extends n{constructor(e,t,i){var n=o.checkIndices(e,t,i);super(e,n.row.length,n.column.length),this.rowIndices=n.row,this.columnIndices=n.column}set(e,t,i){return this.matrix.set(this.rowIndices[e],this.columnIndices[t],i),this}get(e,t){return this.matrix.get(this.rowIndices[e],this.columnIndices[t])}}},function(e,t,i){'use strict';var n=i(18);e.exports=class extends n{constructor(e,t){super(e,e.rows,1),this.column=t}set(e,t,i){return this.matrix.set(e,this.column,i),this}get(e){return this.matrix.get(e,this.column)}}},function(e,t,i){'use strict';var n=i(18);e.exports=class extends n{constructor(e){super(e,e.rows,e.columns)}set(e,t,i){return this.matrix.set(this.rows-e-1,t,i),this}get(e,t){return this.matrix.get(this.rows-e-1,t)}}},function(e,t,i){'use strict';var n=i(18);e.exports=class extends n{constructor(e){super(e,e.rows,e.columns)}set(e,t,i){return this.matrix.set(e,this.columns-t-1,i),this}get(e,t){return this.matrix.get(e,this.columns-t-1)}}},function(e,t,i){'use strict';function n(e){return e=s.checkMatrix(e),o(e,s.eye(e.rows))}function o(e,t){return e=s.checkMatrix(e),t=s.checkMatrix(t),e.isSquare()?new l(e).solve(t):new c(e).solve(t)}var s=i(8).Matrix,r=i(82),a=i(250),l=i(81),c=i(251),u=i(252);s.inverse=s.inv=n,s.prototype.inverse=s.prototype.inv=function(){return n(this)},s.solve=o,s.prototype.solve=function(e){return o(this,e)},e.exports={SingularValueDecomposition:r,SVD:r,EigenvalueDecomposition:a,EVD:a,LuDecomposition:l,LU:l,QrDecomposition:c,QR:c,CholeskyDecomposition:u,CHO:u,inverse:n,solve:o}},function(e,t,i){'use strict';function o(t,c){if(c=Object.assign({},h,c),!(this instanceof o))return new o(t,c);if(t=m.checkMatrix(t),!t.isSquare())throw new Error('Matrix is not a square matrix');var u=t.columns,n=g(u,u,0),p=Array(u),d=Array(u),e=t,k=!1,x,i;if(k=!!c.assumeSymmetric||t.isSymmetric(),k){for(x=0;x<u;x++)for(i=0;i<u;i++)n[x][i]=e.get(x,i);s(u,d,p,n),r(u,d,p,n)}else{var j=g(u,u,0),w=Array(u);for(i=0;i<u;i++)for(x=0;x<u;x++)j[x][i]=e.get(x,i);a(u,j,w,n),l(u,d,p,n,j)}this.n=u,this.e=d,this.d=p,this.V=n}function s(t,n,e,o){var s,r,a,l,i,c,m,d;for(i=0;i<t;i++)e[i]=o[t-1][i];for(l=t-1;0<l;l--){for(d=0,a=0,c=0;c<l;c++)d+=u(e[c]);if(0===d)for(n[l]=e[l-1],i=0;i<l;i++)e[i]=o[l-1][i],o[l][i]=0,o[i][l]=0;else{for(c=0;c<l;c++)e[c]/=d,a+=e[c]*e[c];for(s=e[l-1],r=R(a),0<s&&(r=-r),n[l]=d*r,a-=s*r,e[l-1]=s-r,i=0;i<l;i++)n[i]=0;for(i=0;i<l;i++){for(s=e[i],o[i][l]=s,r=n[i]+o[i][i]*s,c=i+1;c<=l-1;c++)r+=o[c][i]*e[c],n[c]+=o[c][i]*s;n[i]=r}for(s=0,i=0;i<l;i++)n[i]/=a,s+=n[i]*e[i];for(m=s/(a+a),i=0;i<l;i++)n[i]-=m*e[i];for(i=0;i<l;i++){for(s=e[i],r=n[i],c=i;c<=l-1;c++)o[c][i]-=s*n[c]+r*e[c];e[i]=o[l-1][i],o[l][i]=0}}e[l]=a}for(l=0;l<t-1;l++){if(o[t-1][l]=o[l][l],o[l][l]=1,a=e[l+1],0!==a){for(c=0;c<=l;c++)e[c]=o[c][l+1]/a;for(i=0;i<=l;i++){for(r=0,c=0;c<=l;c++)r+=o[c][l+1]*o[c][i];for(c=0;c<=l;c++)o[c][i]-=r*e[c]}}for(c=0;c<=l;c++)o[c][l+1]=0}for(i=0;i<t;i++)e[i]=o[t-1][i],o[t-1][i]=0;o[t-1][t-1]=1,n[0]=0}function r(t,n,e,o){var a,d,g,i,h,k,l,m,p,x,w,c,y,b,v,R,I;for(g=1;g<t;g++)n[g-1]=n[g];n[t-1]=0;var S=0,f=0,C=2.220446049250313e-16;for(k=0;k<t;k++){for(f=M(f,u(e[k])+u(n[k])),l=k;l<t&&!(u(n[l])<=C*f);)l++;if(l>k){I=0;do{for(++I,a=e[k],m=(e[k+1]-a)/(2*n[k]),p=j(m,1),0>m&&(p=-p),e[k]=n[k]/(m+p),e[k+1]=n[k]*(m+p),x=e[k+1],d=a-e[k],g=k+2;g<t;g++)e[g]-=d;for(S+=d,m=e[l],w=1,c=w,y=w,b=n[k+1],v=0,R=0,g=l-1;g>=k;g--)for(y=c,c=w,R=v,a=w*n[g],d=w*m,p=j(m,n[g]),n[g+1]=v*p,v=n[g]/p,w=m/p,m=w*e[g]-v*a,e[g+1]=d+v*(w*a+v*e[g]),h=0;h<t;h++)d=o[h][g+1],o[h][g+1]=v*o[h][g]+w*d,o[h][g]=w*o[h][g]-v*d;m=-v*R*y*b*n[k]/x,n[k]=v*m,e[k]=w*m}while(u(n[k])>C*f)}e[k]+=S,n[k]=0}for(g=0;g<t-1;g++){for(h=g,m=e[g],i=g+1;i<t;i++)e[i]<m&&(h=i,m=e[i]);if(h!==g)for(e[h]=e[g],e[g]=m,i=0;i<t;i++)m=o[i][g],o[i][g]=o[i][h],o[i][h]=m}}function a(e,t,n,o){var s=0,r=e-1,a,l,c,d,i,h,m;for(h=s+1;h<=r-1;h++){for(m=0,d=h;d<=r;d++)m+=u(t[d][h-1]);if(0!==m){for(c=0,d=r;d>=h;d--)n[d]=t[d][h-1]/m,c+=n[d]*n[d];for(l=R(c),0<n[h]&&(l=-l),c-=n[h]*l,n[h]-=l,i=h;i<e;i++){for(a=0,d=r;d>=h;d--)a+=n[d]*t[d][i];for(a/=c,d=h;d<=r;d++)t[d][i]-=a*n[d]}for(d=0;d<=r;d++){for(a=0,i=r;i>=h;i--)a+=n[i]*t[d][i];for(a/=c,i=h;i<=r;i++)t[d][i]-=a*n[i]}n[h]=m*n[h],t[h][h-1]=m*l}}for(d=0;d<e;d++)for(i=0;i<e;i++)o[d][i]=d===i?1:0;for(h=r-1;h>=s+1;h--)if(0!==t[h][h-1]){for(d=h+1;d<=r;d++)n[d]=t[d][h-1];for(i=h;i<=r;i++){for(l=0,d=h;d<=r;d++)l+=n[d]*o[d][i];for(l=l/n[h]/t[h][h-1],d=h;d<=r;d++)o[d][i]+=l*n[d]}}}function l(o,a,e,d,g){var h=o-1,n=0,f=o-1,b=2.220446049250313e-16,I=0,S=0,C=0,p=0,V=0,D=0,_=0,P=0,A,i,j,k,l,m,t,w,x,y,L,U,F,T,q;for(A=0;A<o;A++)for((A<n||A>f)&&(e[A]=g[A][A],a[A]=0),i=M(A-1,0);i<o;i++)S+=u(g[A][i]);for(;h>=n;){for(k=h;k>n&&(D=u(g[k-1][k-1])+u(g[k][k]),0===D&&(D=S),!(u(g[k][k-1])<b*D));)k--;if(k===h)g[h][h]+=I,e[h]=g[h][h],a[h]=0,h--,P=0;else if(k===h-1){if(t=g[h][h-1]*g[h-1][h],C=(g[h-1][h-1]-g[h][h])/2,p=C*C+t,_=R(u(p)),g[h][h]+=I,g[h-1][h-1]=g[h-1][h-1]+I,w=g[h][h],0<=p){for(_=0<=C?C+_:C-_,e[h-1]=w+_,e[h]=e[h-1],0!==_&&(e[h]=w-t/_),a[h-1]=0,a[h]=0,w=g[h][h-1],D=u(w)+u(_),C=w/D,p=_/D,V=R(C*C+p*p),C/=V,p/=V,i=h-1;i<o;i++)_=g[h-1][i],g[h-1][i]=p*_+C*g[h][i],g[h][i]=p*g[h][i]-C*_;for(A=0;A<=h;A++)_=g[A][h-1],g[A][h-1]=p*_+C*g[A][h],g[A][h]=p*g[A][h]-C*_;for(A=n;A<=f;A++)_=d[A][h-1],d[A][h-1]=p*_+C*d[A][h],d[A][h]=p*d[A][h]-C*_}else e[h-1]=w+C,e[h]=w+C,a[h-1]=_,a[h]=-_;h-=2,P=0}else{if(w=g[h][h],x=0,t=0,k<h&&(x=g[h-1][h-1],t=g[h][h-1]*g[h-1][h]),10==P){for(I+=w,A=n;A<=h;A++)g[A][A]-=w;D=u(g[h][h-1])+u(g[h-1][h-2]),w=x=0.75*D,t=-0.4375*D*D}if(30==P&&(D=(x-w)/2,D=D*D+t,0<D)){for(D=R(D),x<w&&(D=-D),D=w-t/((x-w)/2+D),A=n;A<=h;A++)g[A][A]-=D;I+=D,w=x=t=0.964}for(++P,l=h-2;l>=k&&(_=g[l][l],V=w-_,D=x-_,C=(V*D-t)/g[l+1][l]+g[l][l+1],p=g[l+1][l+1]-_-V-D,V=g[l+2][l+1],D=u(C)+u(p)+u(V),C/=D,p/=D,V/=D,l!==k)&&!(u(g[l][l-1])*(u(p)+u(V))<b*(u(C)*(u(g[l-1][l-1])+u(_)+u(g[l+1][l+1]))));)l--;for(A=l+2;A<=h;A++)g[A][A-2]=0,A>l+2&&(g[A][A-3]=0);for(j=l;j<=h-1&&(T=j!==h-1,j!==l&&(C=g[j][j-1],p=g[j+1][j-1],V=T?g[j+2][j-1]:0,w=u(C)+u(p)+u(V),0!==w&&(C/=w,p/=w,V/=w)),0!==w);j++)if(D=R(C*C+p*p+V*V),0>C&&(D=-D),0!==D){for(j===l?k!==l&&(g[j][j-1]=-g[j][j-1]):g[j][j-1]=-D*w,C+=D,w=C/D,x=p/D,_=V/D,p/=C,V/=C,i=j;i<o;i++)C=g[j][i]+p*g[j+1][i],T&&(C+=V*g[j+2][i],g[j+2][i]=g[j+2][i]-C*_),g[j][i]-=C*w,g[j+1][i]=g[j+1][i]-C*x;for(A=0;A<=v(h,j+3);A++)C=w*g[A][j]+x*g[A][j+1],T&&(C+=_*g[A][j+2],g[A][j+2]=g[A][j+2]-C*V),g[A][j]-=C,g[A][j+1]=g[A][j+1]-C*p;for(A=n;A<=f;A++)C=w*d[A][j]+x*d[A][j+1],T&&(C+=_*d[A][j+2],d[A][j+2]=d[A][j+2]-C*V),d[A][j]-=C,d[A][j+1]=d[A][j+1]-C*p}}}if(0!==S){for(h=o-1;0<=h;h--)if(C=e[h],p=a[h],0===p)for(k=h,g[h][h]=1,A=h-1;0<=A;A--){for(t=g[A][A]-C,V=0,i=k;i<=h;i++)V+=g[A][i]*g[i][h];if(0>a[A])_=t,D=V;else if(k=A,0===a[A]?g[A][h]=0===t?-V/(b*S):-V/t:(w=g[A][A+1],x=g[A+1][A],p=(e[A]-C)*(e[A]-C)+a[A]*a[A],m=(w*D-_*V)/p,g[A][h]=m,g[A+1][h]=u(w)>u(_)?(-V-t*m)/w:(-D-x*m)/_),m=u(g[A][h]),1<b*m*m)for(i=A;i<=h;i++)g[i][h]/=m}else if(0>p)for(k=h-1,u(g[h][h-1])>u(g[h-1][h])?(g[h-1][h-1]=p/g[h][h-1],g[h-1][h]=-(g[h][h]-C)/g[h][h-1]):(q=c(0,-g[h-1][h],g[h-1][h-1]-C,p),g[h-1][h-1]=q[0],g[h-1][h]=q[1]),g[h][h-1]=0,g[h][h]=1,A=h-2;0<=A;A--){for(y=0,L=0,i=k;i<=h;i++)y+=g[A][i]*g[i][h-1],L+=g[A][i]*g[i][h];if(t=g[A][A]-C,0>a[A])_=t,V=y,D=L;else if(k=A,0===a[A]?(q=c(-y,-L,t,p),g[A][h-1]=q[0],g[A][h]=q[1]):(w=g[A][A+1],x=g[A+1][A],U=(e[A]-C)*(e[A]-C)+a[A]*a[A]-p*p,F=2*(e[A]-C)*p,0===U&&0===F&&(U=b*S*(u(t)+u(p)+u(w)+u(x)+u(_))),q=c(w*V-_*y+p*L,w*D-_*L-p*y,U,F),g[A][h-1]=q[0],g[A][h]=q[1],u(w)>u(_)+u(p)?(g[A+1][h-1]=(-y-t*g[A][h-1]+p*g[A][h])/w,g[A+1][h]=(-L-t*g[A][h]-p*g[A][h-1])/w):(q=c(-V-x*g[A][h-1],-D-x*g[A][h],_,p),g[A+1][h-1]=q[0],g[A+1][h]=q[1])),m=M(u(g[A][h-1]),u(g[A][h])),1<b*m*m)for(i=A;i<=h;i++)g[i][h-1]=g[i][h-1]/m,g[i][h]/=m}for(A=0;A<o;A++)if(A<n||A>f)for(i=A;i<o;i++)d[A][i]=g[A][i];for(i=o-1;i>=n;i--)for(A=n;A<=f;A++){for(_=0,j=n;j<=v(i,f);j++)_+=d[A][j]*g[j][i];d[A][i]=_}}}function c(e,t,i,n){var o,s;return u(i)>u(n)?(o=n/i,s=i+o*n,[(e+o*t)/s,(t-o*e)/s]):(o=i/n,s=n+o*i,[(o*e+t)/s,(o*t-e)/s])}var m=i(8).Matrix,n=i(42),j=n.hypotenuse,g=n.getFilled2DArray,h={assumeSymmetric:!1};o.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return m.isMatrix(this.V)||(this.V=new m(this.V)),this.V},get diagonalMatrix(){var t=this.n,n=this.e,e=this.d,o=new m(t,t),s,i;for(s=0;s<t;s++){for(i=0;i<t;i++)o[s][i]=0;o[s][s]=e[s],0<n[s]?o[s][s+1]=n[s]:0>n[s]&&(o[s][s-1]=n[s])}return o}},e.exports=o},function(e,t,i){'use strict';function o(e){if(!(this instanceof o))return new o(e);e=r.checkMatrix(e);var t=e.clone(),a=e.rows,l=e.columns,c=Array(l),u,i,m,d;for(m=0;m<l;m++){var g=0;for(u=m;u<a;u++)g=n(g,t[u][m]);if(0!==g){for(0>t[m][m]&&(g=-g),u=m;u<a;u++)t[u][m]/=g;for(t[m][m]+=1,i=m+1;i<l;i++){for(d=0,u=m;u<a;u++)d+=t[u][m]*t[u][i];for(d=-d/t[m][m],u=m;u<a;u++)t[u][i]+=d*t[u][m]}}c[m]=-g}this.QR=t,this.Rdiag=c}var r=i(8).Matrix,n=i(42).hypotenuse;o.prototype={solve:function(e){e=r.checkMatrix(e);var t=this.QR,o=t.rows;if(e.rows!==o)throw new Error('Matrix row dimensions must agree');if(!this.isFullRank())throw new Error('Matrix is rank deficient');var a=e.columns,l=e.clone(),c=t.columns,n,i,u,m;for(u=0;u<c;u++)for(i=0;i<a;i++){for(m=0,n=u;n<o;n++)m+=t[n][u]*l[n][i];for(m=-m/t[u][u],n=u;n<o;n++)l[n][i]+=m*t[n][u]}for(u=c-1;0<=u;u--){for(i=0;i<a;i++)l[u][i]/=this.Rdiag[u];for(n=0;n<u;n++)for(i=0;i<a;i++)l[n][i]-=l[u][i]*t[n][u]}return l.subMatrix(0,c-1,0,a-1)},isFullRank:function(){for(var e=this.QR.columns,t=0;t<e;t++)if(0===this.Rdiag[t])return!1;return!0},get upperTriangularMatrix(){var e=this.QR,t=e.columns,n=new r(t,t),o,i;for(o=0;o<t;o++)for(i=0;i<t;i++)n[o][i]=o<i?e[o][i]:o===i?this.Rdiag[o]:0;return n},get orthogonalMatrix(){var e=this.QR,t=e.rows,n=e.columns,o=new r(t,n),a,i,l,c;for(l=n-1;0<=l;l--){for(a=0;a<t;a++)o[a][l]=0;for(o[l][l]=1,i=l;i<n;i++)if(0!==e[l][l]){for(c=0,a=l;a<t;a++)c+=e[a][l]*o[a][i];for(c=-c/e[l][l],a=l;a<t;a++)o[a][i]+=c*e[a][l]}}return o}},e.exports=o},function(e,t,i){'use strict';function n(e){if(!(this instanceof n))return new n(e);if(e=o.checkMatrix(e),!e.isSymmetric())throw new Error('Matrix is not symmetric');var t=e,r=t.rows,a=new o(r,r),l=!0,c,i,u;for(i=0;i<r;i++){var m=a[i],g=0;for(u=0;u<i;u++){var d=a[u],h=0;for(c=0;c<u;c++)h+=d[c]*m[c];m[u]=h=(t[i][u]-h)/a[u][u],g+=h*h}for(g=t[i][i]-g,l&=0<g,a[i][i]=R(M(g,0)),u=i+1;u<r;u++)a[i][u]=0}if(!l)throw new Error('Matrix is not positive definite');this.L=a}var o=i(8).Matrix;n.prototype={get lowerTriangularMatrix(){return this.L},solve:function(e){e=o.checkMatrix(e);var t=this.L,n=t.rows;if(e.rows!==n)throw new Error('Matrix dimensions do not match');var s=e.columns,r=e.clone(),a,i,l;for(l=0;l<n;l++)for(i=0;i<s;i++){for(a=0;a<l;a++)r[l][i]-=r[a][i]*t[l][a];r[l][i]/=t[l][l]}for(l=n-1;0<=l;l--)for(i=0;i<s;i++){for(a=l+1;a<n;a++)r[l][i]-=r[a][i]*t[a][l];r[l][i]/=t[l][l]}return r}},e.exports=n},function(e,t,i){'use strict';var n=i(254),o=i(255),s={damping:void 0,gradientDifference:0.1,initialValues:void 0,maxIterations:100,errorTolerance:0.01};e.exports=function(e,t,r){if(!r||!r.damping||0>=r.damping)throw new TypeError('The damping option should be a positive number');if(r=Object.assign({},s,r),!r.initialValues){r.initialValues=Array(t.length);for(var a=0;a<t.length;a++)r.initialValues[a]=1}if(!e.x||!e.y)throw new TypeError('The data parameter should have a x and y elements');else if(e.x.constructor!==Array||2>e.x.length||e.y.constructor!==Array||2>e.y.length)throw new TypeError('The data parameter elements should be an array with more than 2 points');var i=e.x.length;if(i!==e.y.length)throw new RangeError('The data parameter elements should have the same size');for(var l=r.initialValues,c=n(e,l,t),u=c<=r.errorTolerance,m=0;m<r.maxIterations&&!u;m++)l=o(e,l,r.damping,r.gradientDifference,t),c=n(e,l,t),u=c<=r.errorTolerance;return{parameterValues:l,parameterError:c,iterations:m}}},function(e){'use strict';e.exports=function(e,t,n){for(var o=0,s=n(...t),r=0;r<e.x.length;r++)o+=u(e.y[r]-s(e.x[r]));return o}},function(e,t,i){'use strict';function n(e,t,i,o){for(var r=o.length,n=e.x.length,a=Array(r),l=o(...t),c=0;c<r;c++){a[c]=Array(n);var u=t.concat();u[c]+=i;for(var m=o(...u),d=0;d<n;d++)a[c][d]=l(e.x[d])-m(e.x[d])}return new s(a)}function o(e,t,i){for(var n=e.x.length,o=Array(n),r=i(...t),a=0;a<n;a++)o[a]=e.y[a]-r(e.x[a]);return new s([o])}var s=i(256);e.exports=function(e,t,i,r,a){var l=s.eye(a.length).mul(i*r*r),c=n(e,t,r,a),u=o(e,t,a).transpose();t=new s([t]);var m=s.inv(l.add(c.mmul(c.transposeView())));return t=t.sub(m.mmul(c).mmul(u).mul(r).transposeView()),t.to1DArray()}},function(e,t,i){'use strict';e.exports=i(9).Matrix,e.exports.Decompositions=e.exports.DC=i(265)},function(){'use strict';Symbol.species||(Symbol.species=Symbol.for('@@species'))},function(e,t,i){'use strict';var n=i(19);e.exports=class extends n{constructor(e){super(e,e.columns,e.rows)}set(e,t,i){return this.matrix.set(t,e,i),this}get(e,t){return this.matrix.get(t,e)}}},function(e,t,i){'use strict';var n=i(19);e.exports=class extends n{constructor(e,t){super(e,1,e.columns),this.row=t}set(e,t,i){return this.matrix.set(this.row,t,i),this}get(e,t){return this.matrix.get(this.row,t)}}},function(e,t,i){'use strict';var n=i(19),o=i(28);e.exports=class extends n{constructor(e,t,i,n,s){o.checkRange(e,t,i,n,s),super(e,i-t+1,s-n+1),this.startRow=t,this.startColumn=n}set(e,t,i){return this.matrix.set(this.startRow+e,this.startColumn+t,i),this}get(e,t){return this.matrix.get(this.startRow+e,this.startColumn+t)}}},function(e,t,i){'use strict';var n=i(19),o=i(28);e.exports=class extends n{constructor(e,t,i){var n=o.checkIndices(e,t,i);super(e,n.row.length,n.column.length),this.rowIndices=n.row,this.columnIndices=n.column}set(e,t,i){return this.matrix.set(this.rowIndices[e],this.columnIndices[t],i),this}get(e,t){return this.matrix.get(this.rowIndices[e],this.columnIndices[t])}}},function(e,t,i){'use strict';var n=i(19);e.exports=class extends n{constructor(e,t){super(e,e.rows,1),this.column=t}set(e,t,i){return this.matrix.set(e,this.column,i),this}get(e){return this.matrix.get(e,this.column)}}},function(e,t,i){'use strict';var n=i(19);e.exports=class extends n{constructor(e){super(e,e.rows,e.columns)}set(e,t,i){return this.matrix.set(this.rows-e-1,t,i),this}get(e,t){return this.matrix.get(this.rows-e-1,t)}}},function(e,t,i){'use strict';var n=i(19);e.exports=class extends n{constructor(e){super(e,e.rows,e.columns)}set(e,t,i){return this.matrix.set(e,this.columns-t-1,i),this}get(e,t){return this.matrix.get(e,this.columns-t-1)}}},function(e,t,i){'use strict';function n(e){return e=s.checkMatrix(e),o(e,s.eye(e.rows))}function o(e,t){return e=s.checkMatrix(e),t=s.checkMatrix(t),e.isSquare()?new l(e).solve(t):new c(e).solve(t)}var s=i(9).Matrix,r=i(85),a=i(266),l=i(84),c=i(267),u=i(268);s.inverse=s.inv=n,s.prototype.inverse=s.prototype.inv=function(){return n(this)},s.solve=o,s.prototype.solve=function(e){return o(this,e)},e.exports={SingularValueDecomposition:r,SVD:r,EigenvalueDecomposition:a,EVD:a,LuDecomposition:l,LU:l,QrDecomposition:c,QR:c,CholeskyDecomposition:u,CHO:u,inverse:n,solve:o}},function(e,t,i){'use strict';function o(t,c){if(c=Object.assign({},h,c),!(this instanceof o))return new o(t,c);if(t=m.checkMatrix(t),!t.isSquare())throw new Error('Matrix is not a square matrix');var u=t.columns,n=g(u,u,0),p=Array(u),d=Array(u),e=t,k=!1,x,i;if(k=!!c.assumeSymmetric||t.isSymmetric(),k){for(x=0;x<u;x++)for(i=0;i<u;i++)n[x][i]=e.get(x,i);s(u,d,p,n),r(u,d,p,n)}else{var j=g(u,u,0),w=Array(u);for(i=0;i<u;i++)for(x=0;x<u;x++)j[x][i]=e.get(x,i);a(u,j,w,n),l(u,d,p,n,j)}this.n=u,this.e=d,this.d=p,this.V=n}function s(t,n,e,o){var s,r,a,l,i,c,m,d;for(i=0;i<t;i++)e[i]=o[t-1][i];for(l=t-1;0<l;l--){for(d=0,a=0,c=0;c<l;c++)d+=u(e[c]);if(0===d)for(n[l]=e[l-1],i=0;i<l;i++)e[i]=o[l-1][i],o[l][i]=0,o[i][l]=0;else{for(c=0;c<l;c++)e[c]/=d,a+=e[c]*e[c];for(s=e[l-1],r=R(a),0<s&&(r=-r),n[l]=d*r,a-=s*r,e[l-1]=s-r,i=0;i<l;i++)n[i]=0;for(i=0;i<l;i++){for(s=e[i],o[i][l]=s,r=n[i]+o[i][i]*s,c=i+1;c<=l-1;c++)r+=o[c][i]*e[c],n[c]+=o[c][i]*s;n[i]=r}for(s=0,i=0;i<l;i++)n[i]/=a,s+=n[i]*e[i];for(m=s/(a+a),i=0;i<l;i++)n[i]-=m*e[i];for(i=0;i<l;i++){for(s=e[i],r=n[i],c=i;c<=l-1;c++)o[c][i]-=s*n[c]+r*e[c];e[i]=o[l-1][i],o[l][i]=0}}e[l]=a}for(l=0;l<t-1;l++){if(o[t-1][l]=o[l][l],o[l][l]=1,a=e[l+1],0!==a){for(c=0;c<=l;c++)e[c]=o[c][l+1]/a;for(i=0;i<=l;i++){for(r=0,c=0;c<=l;c++)r+=o[c][l+1]*o[c][i];for(c=0;c<=l;c++)o[c][i]-=r*e[c]}}for(c=0;c<=l;c++)o[c][l+1]=0}for(i=0;i<t;i++)e[i]=o[t-1][i],o[t-1][i]=0;o[t-1][t-1]=1,n[0]=0}function r(t,n,e,o){var a,d,g,i,h,k,l,m,p,x,w,c,y,b,v,R,I;for(g=1;g<t;g++)n[g-1]=n[g];n[t-1]=0;var S=0,f=0,C=2.220446049250313e-16;for(k=0;k<t;k++){for(f=M(f,u(e[k])+u(n[k])),l=k;l<t&&!(u(n[l])<=C*f);)l++;if(l>k){I=0;do{for(++I,a=e[k],m=(e[k+1]-a)/(2*n[k]),p=j(m,1),0>m&&(p=-p),e[k]=n[k]/(m+p),e[k+1]=n[k]*(m+p),x=e[k+1],d=a-e[k],g=k+2;g<t;g++)e[g]-=d;for(S+=d,m=e[l],w=1,c=w,y=w,b=n[k+1],v=0,R=0,g=l-1;g>=k;g--)for(y=c,c=w,R=v,a=w*n[g],d=w*m,p=j(m,n[g]),n[g+1]=v*p,v=n[g]/p,w=m/p,m=w*e[g]-v*a,e[g+1]=d+v*(w*a+v*e[g]),h=0;h<t;h++)d=o[h][g+1],o[h][g+1]=v*o[h][g]+w*d,o[h][g]=w*o[h][g]-v*d;m=-v*R*y*b*n[k]/x,n[k]=v*m,e[k]=w*m}while(u(n[k])>C*f)}e[k]+=S,n[k]=0}for(g=0;g<t-1;g++){for(h=g,m=e[g],i=g+1;i<t;i++)e[i]<m&&(h=i,m=e[i]);if(h!==g)for(e[h]=e[g],e[g]=m,i=0;i<t;i++)m=o[i][g],o[i][g]=o[i][h],o[i][h]=m}}function a(e,t,n,o){var s=0,r=e-1,a,l,c,d,i,h,m;for(h=s+1;h<=r-1;h++){for(m=0,d=h;d<=r;d++)m+=u(t[d][h-1]);if(0!==m){for(c=0,d=r;d>=h;d--)n[d]=t[d][h-1]/m,c+=n[d]*n[d];for(l=R(c),0<n[h]&&(l=-l),c-=n[h]*l,n[h]-=l,i=h;i<e;i++){for(a=0,d=r;d>=h;d--)a+=n[d]*t[d][i];for(a/=c,d=h;d<=r;d++)t[d][i]-=a*n[d]}for(d=0;d<=r;d++){for(a=0,i=r;i>=h;i--)a+=n[i]*t[d][i];for(a/=c,i=h;i<=r;i++)t[d][i]-=a*n[i]}n[h]=m*n[h],t[h][h-1]=m*l}}for(d=0;d<e;d++)for(i=0;i<e;i++)o[d][i]=d===i?1:0;for(h=r-1;h>=s+1;h--)if(0!==t[h][h-1]){for(d=h+1;d<=r;d++)n[d]=t[d][h-1];for(i=h;i<=r;i++){for(l=0,d=h;d<=r;d++)l+=n[d]*o[d][i];for(l=l/n[h]/t[h][h-1],d=h;d<=r;d++)o[d][i]+=l*n[d]}}}function l(o,a,e,d,g){var h=o-1,n=0,f=o-1,b=2.220446049250313e-16,I=0,S=0,C=0,p=0,V=0,D=0,_=0,P=0,A,i,j,k,l,m,t,w,x,y,L,U,F,T,q;for(A=0;A<o;A++)for((A<n||A>f)&&(e[A]=g[A][A],a[A]=0),i=M(A-1,0);i<o;i++)S+=u(g[A][i]);for(;h>=n;){for(k=h;k>n&&(D=u(g[k-1][k-1])+u(g[k][k]),0===D&&(D=S),!(u(g[k][k-1])<b*D));)k--;if(k===h)g[h][h]+=I,e[h]=g[h][h],a[h]=0,h--,P=0;else if(k===h-1){if(t=g[h][h-1]*g[h-1][h],C=(g[h-1][h-1]-g[h][h])/2,p=C*C+t,_=R(u(p)),g[h][h]+=I,g[h-1][h-1]=g[h-1][h-1]+I,w=g[h][h],0<=p){for(_=0<=C?C+_:C-_,e[h-1]=w+_,e[h]=e[h-1],0!==_&&(e[h]=w-t/_),a[h-1]=0,a[h]=0,w=g[h][h-1],D=u(w)+u(_),C=w/D,p=_/D,V=R(C*C+p*p),C/=V,p/=V,i=h-1;i<o;i++)_=g[h-1][i],g[h-1][i]=p*_+C*g[h][i],g[h][i]=p*g[h][i]-C*_;for(A=0;A<=h;A++)_=g[A][h-1],g[A][h-1]=p*_+C*g[A][h],g[A][h]=p*g[A][h]-C*_;for(A=n;A<=f;A++)_=d[A][h-1],d[A][h-1]=p*_+C*d[A][h],d[A][h]=p*d[A][h]-C*_}else e[h-1]=w+C,e[h]=w+C,a[h-1]=_,a[h]=-_;h-=2,P=0}else{if(w=g[h][h],x=0,t=0,k<h&&(x=g[h-1][h-1],t=g[h][h-1]*g[h-1][h]),10==P){for(I+=w,A=n;A<=h;A++)g[A][A]-=w;D=u(g[h][h-1])+u(g[h-1][h-2]),w=x=0.75*D,t=-0.4375*D*D}if(30==P&&(D=(x-w)/2,D=D*D+t,0<D)){for(D=R(D),x<w&&(D=-D),D=w-t/((x-w)/2+D),A=n;A<=h;A++)g[A][A]-=D;I+=D,w=x=t=0.964}for(++P,l=h-2;l>=k&&(_=g[l][l],V=w-_,D=x-_,C=(V*D-t)/g[l+1][l]+g[l][l+1],p=g[l+1][l+1]-_-V-D,V=g[l+2][l+1],D=u(C)+u(p)+u(V),C/=D,p/=D,V/=D,l!==k)&&!(u(g[l][l-1])*(u(p)+u(V))<b*(u(C)*(u(g[l-1][l-1])+u(_)+u(g[l+1][l+1]))));)l--;for(A=l+2;A<=h;A++)g[A][A-2]=0,A>l+2&&(g[A][A-3]=0);for(j=l;j<=h-1&&(T=j!==h-1,j!==l&&(C=g[j][j-1],p=g[j+1][j-1],V=T?g[j+2][j-1]:0,w=u(C)+u(p)+u(V),0!==w&&(C/=w,p/=w,V/=w)),0!==w);j++)if(D=R(C*C+p*p+V*V),0>C&&(D=-D),0!==D){for(j===l?k!==l&&(g[j][j-1]=-g[j][j-1]):g[j][j-1]=-D*w,C+=D,w=C/D,x=p/D,_=V/D,p/=C,V/=C,i=j;i<o;i++)C=g[j][i]+p*g[j+1][i],T&&(C+=V*g[j+2][i],g[j+2][i]=g[j+2][i]-C*_),g[j][i]-=C*w,g[j+1][i]=g[j+1][i]-C*x;for(A=0;A<=v(h,j+3);A++)C=w*g[A][j]+x*g[A][j+1],T&&(C+=_*g[A][j+2],g[A][j+2]=g[A][j+2]-C*V),g[A][j]-=C,g[A][j+1]=g[A][j+1]-C*p;for(A=n;A<=f;A++)C=w*d[A][j]+x*d[A][j+1],T&&(C+=_*d[A][j+2],d[A][j+2]=d[A][j+2]-C*V),d[A][j]-=C,d[A][j+1]=d[A][j+1]-C*p}}}if(0!==S){for(h=o-1;0<=h;h--)if(C=e[h],p=a[h],0===p)for(k=h,g[h][h]=1,A=h-1;0<=A;A--){for(t=g[A][A]-C,V=0,i=k;i<=h;i++)V+=g[A][i]*g[i][h];if(0>a[A])_=t,D=V;else if(k=A,0===a[A]?g[A][h]=0===t?-V/(b*S):-V/t:(w=g[A][A+1],x=g[A+1][A],p=(e[A]-C)*(e[A]-C)+a[A]*a[A],m=(w*D-_*V)/p,g[A][h]=m,g[A+1][h]=u(w)>u(_)?(-V-t*m)/w:(-D-x*m)/_),m=u(g[A][h]),1<b*m*m)for(i=A;i<=h;i++)g[i][h]/=m}else if(0>p)for(k=h-1,u(g[h][h-1])>u(g[h-1][h])?(g[h-1][h-1]=p/g[h][h-1],g[h-1][h]=-(g[h][h]-C)/g[h][h-1]):(q=c(0,-g[h-1][h],g[h-1][h-1]-C,p),g[h-1][h-1]=q[0],g[h-1][h]=q[1]),g[h][h-1]=0,g[h][h]=1,A=h-2;0<=A;A--){for(y=0,L=0,i=k;i<=h;i++)y+=g[A][i]*g[i][h-1],L+=g[A][i]*g[i][h];if(t=g[A][A]-C,0>a[A])_=t,V=y,D=L;else if(k=A,0===a[A]?(q=c(-y,-L,t,p),g[A][h-1]=q[0],g[A][h]=q[1]):(w=g[A][A+1],x=g[A+1][A],U=(e[A]-C)*(e[A]-C)+a[A]*a[A]-p*p,F=2*(e[A]-C)*p,0===U&&0===F&&(U=b*S*(u(t)+u(p)+u(w)+u(x)+u(_))),q=c(w*V-_*y+p*L,w*D-_*L-p*y,U,F),g[A][h-1]=q[0],g[A][h]=q[1],u(w)>u(_)+u(p)?(g[A+1][h-1]=(-y-t*g[A][h-1]+p*g[A][h])/w,g[A+1][h]=(-L-t*g[A][h]-p*g[A][h-1])/w):(q=c(-V-x*g[A][h-1],-D-x*g[A][h],_,p),g[A+1][h-1]=q[0],g[A+1][h]=q[1])),m=M(u(g[A][h-1]),u(g[A][h])),1<b*m*m)for(i=A;i<=h;i++)g[i][h-1]=g[i][h-1]/m,g[i][h]/=m}for(A=0;A<o;A++)if(A<n||A>f)for(i=A;i<o;i++)d[A][i]=g[A][i];for(i=o-1;i>=n;i--)for(A=n;A<=f;A++){for(_=0,j=n;j<=v(i,f);j++)_+=d[A][j]*g[j][i];d[A][i]=_}}}function c(e,t,i,n){var o,s;return u(i)>u(n)?(o=n/i,s=i+o*n,[(e+o*t)/s,(t-o*e)/s]):(o=i/n,s=n+o*i,[(o*e+t)/s,(o*t-e)/s])}var m=i(9).Matrix,n=i(43),j=n.hypotenuse,g=n.getFilled2DArray,h={assumeSymmetric:!1};o.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return m.isMatrix(this.V)||(this.V=new m(this.V)),this.V},get diagonalMatrix(){var t=this.n,n=this.e,e=this.d,o=new m(t,t),s,i;for(s=0;s<t;s++){for(i=0;i<t;i++)o[s][i]=0;o[s][s]=e[s],0<n[s]?o[s][s+1]=n[s]:0>n[s]&&(o[s][s-1]=n[s])}return o}},e.exports=o},function(e,t,i){'use strict';function o(e){if(!(this instanceof o))return new o(e);e=r.checkMatrix(e);var t=e.clone(),a=e.rows,l=e.columns,c=Array(l),u,i,m,d;for(m=0;m<l;m++){var g=0;for(u=m;u<a;u++)g=n(g,t[u][m]);if(0!==g){for(0>t[m][m]&&(g=-g),u=m;u<a;u++)t[u][m]/=g;for(t[m][m]+=1,i=m+1;i<l;i++){for(d=0,u=m;u<a;u++)d+=t[u][m]*t[u][i];for(d=-d/t[m][m],u=m;u<a;u++)t[u][i]+=d*t[u][m]}}c[m]=-g}this.QR=t,this.Rdiag=c}var r=i(9).Matrix,n=i(43).hypotenuse;o.prototype={solve:function(e){e=r.checkMatrix(e);var t=this.QR,o=t.rows;if(e.rows!==o)throw new Error('Matrix row dimensions must agree');if(!this.isFullRank())throw new Error('Matrix is rank deficient');var a=e.columns,l=e.clone(),c=t.columns,n,i,u,m;for(u=0;u<c;u++)for(i=0;i<a;i++){for(m=0,n=u;n<o;n++)m+=t[n][u]*l[n][i];for(m=-m/t[u][u],n=u;n<o;n++)l[n][i]+=m*t[n][u]}for(u=c-1;0<=u;u--){for(i=0;i<a;i++)l[u][i]/=this.Rdiag[u];for(n=0;n<u;n++)for(i=0;i<a;i++)l[n][i]-=l[u][i]*t[n][u]}return l.subMatrix(0,c-1,0,a-1)},isFullRank:function(){for(var e=this.QR.columns,t=0;t<e;t++)if(0===this.Rdiag[t])return!1;return!0},get upperTriangularMatrix(){var e=this.QR,t=e.columns,n=new r(t,t),o,i;for(o=0;o<t;o++)for(i=0;i<t;i++)n[o][i]=o<i?e[o][i]:o===i?this.Rdiag[o]:0;return n},get orthogonalMatrix(){var e=this.QR,t=e.rows,n=e.columns,o=new r(t,n),a,i,l,c;for(l=n-1;0<=l;l--){for(a=0;a<t;a++)o[a][l]=0;for(o[l][l]=1,i=l;i<n;i++)if(0!==e[l][l]){for(c=0,a=l;a<t;a++)c+=e[a][l]*o[a][i];for(c=-c/e[l][l],a=l;a<t;a++)o[a][i]+=c*e[a][l]}}return o}},e.exports=o},function(e,t,i){'use strict';function n(e){if(!(this instanceof n))return new n(e);if(e=o.checkMatrix(e),!e.isSymmetric())throw new Error('Matrix is not symmetric');var t=e,r=t.rows,a=new o(r,r),l=!0,c,i,u;for(i=0;i<r;i++){var m=a[i],g=0;for(u=0;u<i;u++){var d=a[u],h=0;for(c=0;c<u;c++)h+=d[c]*m[c];m[u]=h=(t[i][u]-h)/a[u][u],g+=h*h}for(g=t[i][i]-g,l&=0<g,a[i][i]=R(M(g,0)),u=i+1;u<r;u++)a[i][u]=0}if(!l)throw new Error('Matrix is not positive definite');this.L=a}var o=i(9).Matrix;n.prototype={get lowerTriangularMatrix(){return this.L},solve:function(e){e=o.checkMatrix(e);var t=this.L,n=t.rows;if(e.rows!==n)throw new Error('Matrix dimensions do not match');var s=e.columns,r=e.clone(),a,i,l;for(l=0;l<n;l++)for(i=0;i<s;i++){for(a=0;a<l;a++)r[l][i]-=r[a][i]*t[l][a];r[l][i]/=t[l][l]}for(l=n-1;0<=l;l--)for(i=0;i<s;i++){for(a=l+1;a<n;a++)r[l][i]-=r[a][i]*t[a][l];r[l][i]/=t[l][l]}return r}},e.exports=n},function(e,t){'use strict';function i(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function n(e,t){e>>>=0,t>>>=0;var i=65535&e,n=e-i;return(n*t>>>0)+i*t>>>0}function o(e){0===e.state[0]&&0===e.state[1]&&0===e.state[2]&&0===e.state[3]&&(e.state[0]=88,e.state[1]=83,e.state[2]=65,e.state[3]=68)}function s(e){var i=e.state[0];i^=i<<c,i^=i>>>u,i^=e.state[3]<<m,e.state[0]=e.state[1],e.state[1]=e.state[2],e.state[2]=e.state[3],e.state[3]=i}Object.defineProperty(t,'__esModule',{value:!0});var r=function(){function e(e,t){for(var n=0,i;n<t.length;n++)i=t[n],i.enumerable=i.enumerable||!1,i.configurable=!0,'value'in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=8,l=function(){function e(){var t=0>=arguments.length||void 0===arguments[0]?Date.now():arguments[0];i(this,e),this.state=new Uint32Array(4),this.init(t)}return r(e,[{key:'init',value:function(e){this.state[0]=e,this.state[1]=0,this.state[2]=0,this.state[3]=0;for(var t=1;t<a;t++)this.state[3&t]^=t+n(1812433253,this.state[3&t-1]^this.state[3&t-1]>>>30>>>0)>>>0;o(this);for(var t=0;t<a;t++)s(this)}},{key:'getUint32',value:function(){return s(this),this.state[3]+this.state[2]>>>0}},{key:'getFloat',value:function(){return(this.getUint32()>>>8)*(1/16777216)}},{key:'random',get:function(){return this._random||(this._random=this.getFloat.bind(this)),this._random}}]),e}();t['default']=l;var c=15,u=18,m=11;e.exports=t['default']},function(e,t,i){'use strict';function n(e,t){if(e.length!==t.length)throw new Error('features and labels should have the same length')}function o(e,t){return Array(e).fill(0).map(()=>Array(t).fill(0))}function s(e){for(var t=new Set,n=0;n<e.length;n++)t.add(e[n]);return Array.from(t)}function r(e,t,n,o,s,r,a,l){var c=s.map(function(e){return t[e]}),u=r.map(function(e){return t[e]}),m=s.map(function(e){return n[e]}),d=r.map(function(e){return n[e]}),g;e.prototype.train?(g=new e(o),g.train(u,d)):g=new e(u,d,o);for(var h=g.predict(c),p=0;p<h.length;p++)a[l.indexOf(m[p])][l.indexOf(h[p])]++}var a=i(86),l={},c=i(271);l.leaveOneOut=function(e,t,i,n){return l.leavePOut(e,t,i,n,1)},l.leavePOut=function(e,t,l,u,m){n(t,l);for(var d=s(l),g=o(d.length,d.length),h=t.length,p=c(m,h),k=Array(h),j=0;j<h;j++)k[j]=j;var i=!0,x=!1,w;try{for(var f=p[Symbol.iterator](),y;!(i=(y=f.next()).done);i=!0){for(var M=y.value,b=k.slice(),v=M.length-1;0<=v;v--)b.splice(M[v],1);r(e,t,l,u,M,b,g,d)}}catch(e){x=!0,w=e}finally{try{!i&&f.return&&f.return()}finally{if(x)throw w}}return new a(g,d)},l.kFold=function(e,t,c,u,m){n(t,c);for(var d=s(c),h=o(d.length,d.length),p=t.length,k=Array(p),x=0;x<p;x++)k[x]=x;for(var i=g(p/m),l=[],w=[];k.length;){var f=g(Math.random()*k.length);l.push(k[f]),k.splice(f,1),l.length===i&&(w.push(l),l=[])}for(l.length&&w.push(l),w=w.slice(0,m),x=0;x<w.length;x++){for(var y=w[x],M=[],b=0;b<w.length;b++)b!==x&&(M=M.concat(w[b]));r(e,t,c,u,y,M,h,d)}return new a(h,d)},e.exports=l},function(e){'use strict';var t={mode:'index'};e.exports=function*(e,n,o){function s(){var e,t,i;for(t=1;0>=c[t];)t++;if(0===c[t-1]){for(e=t-1;1!==e;e--)c[e]=-1;c[t]=0,m=g=0,c[1]=1,d=t-1}else{1<t&&(c[t-1]=0);do t++;while(0<c[t]);for(i=t-1,e=t;0===c[e];)c[e++]=-1;if(-1===c[e])c[e]=c[i],g=c[i]-1,m=e-1,d=i-1,c[i]=-1;else{if(e===c[0])return 0;c[t]=c[e],g=c[e]-1,c[e]=0,m=t-1,d=e-1}}return 1}o=Object.assign({},t,o);for(var r=Array(n),a=Array(e),l=Array(n),c=Array(n+2),u=0,m,d,g;u<n;u++)r[u]=u,l[u]=u<n-e?0:1;for(u=0;u<e;u++)a[u]=n-e+u;for(u=0;u<c.length;u++)c[u]=0===u?n+1:u<=n-e?0:u<=n?u-n+e:-2;if('index'===o.mode)for(yield a.slice();s();)a[g]=r[m],yield a.slice();else if('mask'===o.mode)for(yield l.slice();s();)l[m]=1,l[d]=0,yield l.slice();else throw new Error('Invalid mode')}},function(e,t,i){'use strict';function n(e){this.options=Object.assign({},r,e),this.kernel=new o(this.options.kernel,this.options.kernelOptions),this.b=0}var o=i(37),s=i(2).array,r={C:1,tol:1e-4,maxPasses:10,maxIterations:1e4,kernel:'linear',alphaTol:1e-6,random:Math.random,whitening:!0};n.prototype.train=function(e,t){if(e.length!==t.length)throw new Error('Features and labels should have the same length');if(2>e.length)throw new Error('Cannot train with less than 2 observations');if(this._trained=!1,this._loaded=!1,this.N=t.length,this.D=e[0].length,this.options.whitening){this.X=Array(this.N);for(var n=0;n<this.N;n++)this.X[n]=Array(this.D);this.minMax=Array(this.D);for(var i=0,o;i<this.D;i++){for(o=Array(this.N),n=0;n<this.N;n++)o[n]=e[n][i];for(this.minMax[i]=s.minMax(o),n=0;n<this.N;n++)this.X[n][i]=(e[n][i]-this.minMax[i].min)/(this.minMax[i].max-this.minMax[i].min)}}else this.X=e;this.Y=t,this.b=0,this.W=void 0;var l=this.kernel.compute(this.X),c=t.length,m=Array(c).fill(0);this.alphas=m;for(var d=0;d<c;d++)m[d]=0;for(var a=0,h=0,p=0,k=0,j=0,x=0,f=0,y=0,b=0,R=0,I=0,S;k<this.options.maxPasses&&p<this.options.maxIterations;){for(S=0,n=0;n<c;n++)if(j=this._marginOnePrecomputed(n,l)-t[n],t[n]*j<-this.options.tol&&m[n]<this.options.C||t[n]*j>this.options.tol&&0<m[n]){for(i=n;i===n;)i=g(this.options.random()*c);if(x=this._marginOnePrecomputed(i,l)-t[i],f=m[n],y=m[i],t[n]===t[i]?(b=M(0,f+y-this.options.C),R=v(this.options.C,f+y)):(b=M(0,y-f),R=v(this.options.C,this.options.C+y+f)),1e-4>u(b-R))continue;if(I=2*l[n][i]-l[n][n]-l[i][i],0<=I)continue;var C=m[i]-t[i]*(j-x)/I;if(C>R?C=R:C<b&&(C=b),1e-3>u(y-C))continue;m[i]=C,m[n]+=t[n]*t[i]*(y-C),a=this.b-j-t[n]*(m[n]-f)*l[n][n]-t[i]*(m[i]-y)*l[n][i],h=this.b-x-t[n]*(m[n]-f)*l[n][i]-t[i]*(m[i]-y)*l[i][i],this.b=(a+h)/2,m[n]<this.options.C&&0<m[n]&&(this.b=a),m[i]<this.options.C&&0<m[i]&&(this.b=h),S+=1}p++,0==S?k+=1:k=0}if(p===this.options.maxIterations)throw new Error('max iterations reached');if(this.iterations=p,'linear'===this.options.kernel){this.W=Array(this.D);for(var V=0;V<this.D;V++){this.W[V]=0;for(var r=0;r<c;r++)this.W[V]+=t[r]*m[r]*this.X[r][V]}}var w=[],D=[],z=[];for(this._supportVectorIdx=[],n=0;n<this.N;n++)this.alphas[n]>this.options.alphaTol&&(w.push(this.X[n]),D.push(t[n]),z.push(this.alphas[n]),this._supportVectorIdx.push(n));this.X=w,this.Y=D,this.N=w.length,this.alphas=z,this._trained=!0},n.prototype.predictOne=function(e){var t=this.marginOne(e);return 0<t?1:-1},n.prototype.predict=function(e){if(!this._trained&&!this._loaded)throw new Error('Cannot predict, you need to train the SVM first');return Array.isArray(e)&&Array.isArray(e[0])?e.map(this.predictOne.bind(this)):this.predictOne(e)},n.prototype.marginOne=function(e,t){this.options.whitening&&!t&&(e=this._applyWhitening(e));var n=this.b,o;if('linear'===this.options.kernel&&this.W)for(o=0;o<this.W.length;o++)n+=this.W[o]*e[o];else for(o=0;o<this.N;o++)n+=this.alphas[o]*this.Y[o]*this.kernel.compute([e],[this.X[o]])[0][0];return n},n.prototype._marginOnePrecomputed=function(e,t){var n=this.b,o;for(o=0;o<this.N;o++)n+=this.alphas[o]*this.Y[o]*t[e][o];return n},n.prototype.margin=function(e){return Array.isArray(e)?e.map(this.marginOne.bind(this)):this.marginOne(e)},n.prototype.supportVectors=function(){if(!this._trained&&!this._loaded)throw new Error('Cannot get support vectors, you need to train the SVM first');if(this._loaded&&'linear'===this.options.kernel)throw new Error('Cannot get support vectors from saved linear model, you need to train the SVM to have them');return this._supportVectorIdx},n.load=function(e){this._loaded=!0,this._trained=!1;var t=new n(e.options);return'linear'===e.options.kernel?(t.W=e.W.slice(),t.D=t.W.length):(t.X=e.X.slice(),t.Y=e.Y.slice(),t.alphas=e.alphas.slice(),t.N=t.X.length,t.D=t.X[0].length),t.minMax=e.minMax,t.b=e.b,t._loaded=!0,t._trained=!1,t},n.prototype.toJSON=function(){if(!this._trained&&!this._loaded)throw new Error('Cannot export, you need to train the SVM first');var e={};return e.options=Object.assign({},this.options),e.b=this.b,e.minMax=this.minMax,'linear'===e.options.kernel?e.W=this.W.slice():(e.X=this.X.slice(),e.Y=this.Y.slice(),e.alphas=this.alphas.slice()),e},n.prototype._applyWhitening=function(e){if(!this.minMax)throw new Error('Could not apply whitening');for(var t=Array(e.length),i=0;i<e.length;i++)t[i]=(e[i]-this.minMax[i].min)/(this.minMax[i].max-this.minMax[i].min);return t},e.exports=n},function(e,t,i){'use strict';function n(e,t){for(var n=e.kdTree.nearest(t,e.k),o=Array(e.classes),s=-1,r=-1,a=n[0][0].length-1,l=0;l<o.length;++l)o[l]=0;for(l=0;l<n.length;++l){var i=n[l][0][a],c=++o[i];c>r&&(s=i,r=c)}return s}Object.defineProperty(t,'__esModule',{value:!0});var o=i(274),s=i(0),r=function(e){return e&&e.__esModule?e:{default:e}}(s);class a{constructor(e,t,n={}){if(!0===e){var s=t;return this.kdTree=new o.kdTree(s.kdTree,n),this.k=s.k,this.classes=s.classes,void(this.isEuclidean=s.isEuclidean)}for(var a=n.distance,l=a===void 0?r.default:a,c=n.k,u=c===void 0?e[0].length+1:c,m=new Set(t).size,d=Array(e.length),g=0;g<d.length;++g)d[g]=e[g].slice();for(g=0;g<t.length;++g)d[g].push(t[g]);this.kdTree=new o.kdTree(d,l),this.k=u,this.classes=m,this.isEuclidean=l===r.default}static load(e,t=r.default){if('KNN'!==e.name)throw new Error('invalid model: '+e.name);if(!e.isEuclidean&&t===r.default)throw new Error('a custom distance function was used to create the model. Please provide it again');if(e.isEuclidean&&t!==r.default)throw new Error('the model was created with the default distance function. Do not load it with another one');return new a(!0,e,t)}toJSON(){return{name:'KNN',kdTree:this.kdTree.toJSON(),k:this.k,classes:this.classes,isEuclidean:this.isEuclidean}}predict(e){if(Array.isArray(e)){if('number'==typeof e[0])return n(this,e);if(Array.isArray(e[0])&&'number'==typeof e[0][0]){for(var t=Array(e.length),o=0;o<e.length;o++)t[o]=n(this,e[o]);return t}}throw new TypeError('dataset to predict must be an array or a matrix')}}t.default=a},function(e,t){'use strict';/**
* k-d Tree JavaScript - V 1.01
*
* https://github.com/ubilabs/kd-tree-javascript
*
* @author Mircea Pricop <pricop@ubilabs.net>, 2012
* @author Martin Kleppe <kleppe@ubilabs.net>, 2012
* @author Ubilabs http://ubilabs.net, 2012
* @license MIT License <http://www.opensource.org/licenses/mit-license.php>
*/function i(e,t,i){this.obj=e,this.left=null,this.right=null,this.parent=i,this.dimension=t}function n(e){this.content=[],this.scoreFunction=e}Object.defineProperty(t,'__esModule',{value:!0}),n.prototype={push:function(e){this.content.push(e),this.bubbleUp(this.content.length-1)},pop:function(){var e=this.content[0],t=this.content.pop();return 0<this.content.length&&(this.content[0]=t,this.sinkDown(0)),e},peek:function(){return this.content[0]},remove:function(e){for(var t=this.content.length,n=0;n<t;n++)if(this.content[n]==e){var i=this.content.pop();return void(n!=t-1&&(this.content[n]=i,this.scoreFunction(i)<this.scoreFunction(e)?this.bubbleUp(n):this.sinkDown(n)))}throw new Error('Node not found.')},size:function(){return this.content.length},bubbleUp:function(e){for(var t=this.content[e];0<e;){var i=g((e+1)/2)-1,n=this.content[i];if(this.scoreFunction(t)<this.scoreFunction(n))this.content[i]=t,this.content[e]=n,e=i;else break}},sinkDown:function(e){for(var t=this.content.length,i=this.content[e],n=this.scoreFunction(i);;){var o=2*(e+1),s=o-1,r=null;if(s<t){var a=this.content[s],l=this.scoreFunction(a);l<n&&(r=s)}if(o<t){var c=this.content[o],u=this.scoreFunction(c);u<(null==r?n:l)&&(r=o)}if(null!=r)this.content[e]=this.content[r],this.content[r]=i,e=r;else break}}},t.kdTree=function(e,t){function o(e,t,n){var s=t%l.length,r,a;return 0===e.length?null:1===e.length?new i(e[0],s,n):(e.sort(function(e,t){return e[l[s]]-t[l[s]]}),r=g(e.length/2),a=new i(e[r],s,n),a.left=o(e.slice(0,r),t+1,a),a.right=o(e.slice(r+1),t+1,a),a)}var s=this,l;if(!Array.isArray(e))l=e.dimensions,function(e){function t(e){e.left&&(e.left.parent=e,t(e.left)),e.right&&(e.right.parent=e,t(e.right))}s.root=e,t(s.root)}(e,t);else{l=Array(e[0].length);for(var a=0;a<l.length;++a)l[a]=a;this.root=o(e,0,null)}this.toJSON=function(e,t=!0){e||(e=this.root);var n=new i(e.obj,e.dimension,null);return e.left&&(n.left=s.toJSON(e.left,!1)),e.right&&(n.right=s.toJSON(e.right,!1)),t&&(n.dimensions=l),n},this.insert=function(e){function t(i,n){if(null===i)return n;var o=l[i.dimension];return e[o]<i.obj[o]?t(i.left,i):t(i.right,i)}var n=t(this.root,null),o,s;return null===n?void(this.root=new i(e,0,null)):void(o=new i(e,(n.dimension+1)%l.length,n),s=l[n.dimension],e[s]<n.obj[s]?n.left=o:n.right=o)},this.remove=function(e){function t(i){if(null===i)return null;if(i.obj===e)return i;var n=l[i.dimension];return e[n]<i.obj[n]?t(i.left,i):t(i.right,i)}function i(e){function t(e,i){var n,o,s,r,a;return null===e?null:(n=l[i],e.dimension===i)?null===e.left?e:t(e.left,i):(o=e.obj[n],s=t(e.left,i),r=t(e.right,i),a=e,null!==s&&s.obj[n]<o&&(a=s),null!==r&&r.obj[n]<a.obj[n]&&(a=r),a)}var n,o,r;return null===e.left&&null===e.right?null===e.parent?void(s.root=null):(r=l[e.parent.dimension],void(e.obj[r]<e.parent.obj[r]?e.parent.left=null:e.parent.right=null)):void(null===e.right?(n=t(e.left,e.dimension),o=n.obj,i(n),e.right=e.left,e.left=null,e.obj=o):(n=t(e.right,e.dimension),o=n.obj,i(n),e.obj=o))}var n=t(s.root);null===n||i(n)},this.nearest=function(e,o,r){function a(n){function s(e,t){m.push([e,t]),m.size()>o&&m.pop()}var r=l[n.dimension],c=t(e,n.obj),d={},g,h,p,k;for(k=0;k<l.length;k+=1)d[l[k]]=k===n.dimension?e[l[k]]:n.obj[l[k]];return h=t(d,n.obj),null===n.right&&null===n.left?void((m.size()<o||c<m.peek()[1])&&s(n,c)):void(g=null===n.right?n.left:null===n.left?n.right:e[r]<n.obj[r]?n.left:n.right,a(g),(m.size()<o||c<m.peek()[1])&&s(n,c),(m.size()<o||u(h)<m.peek()[1])&&(p=g===n.left?n.right:n.left,null!==p&&a(p)))}var c,i,m;if(m=new n(function(t){return-t[1]}),r)for(c=0;c<o;c+=1)m.push([null,r]);for(s.root&&a(s.root),i=[],c=0;c<v(o,m.content.length);c+=1)m.content[c][0]&&i.push([m.content[c][0].obj,m.content[c][1]]);return i},this.balanceFactor=function(){function e(t){return null===t?0:M(e(t.left),e(t.right))+1}function t(e){return null===e?0:t(e.left)+t(e.right)+1}return e(s.root)/(r(t(s.root))/0.6931471805599453)}},t.BinaryHeap=n},function(e,t,i){'use strict';e.exports=t=i(87).NaiveBayes,t.separateClasses=i(87).separateClasses},function(e,t,i){'use strict';e.exports=i(10).Matrix,e.exports.Decompositions=e.exports.DC=i(285)},function(){'use strict';Symbol.species||(Symbol.species=Symbol.for('@@species'))},function(e,t,i){'use strict';var n=i(20);e.exports=class extends n{constructor(e){super(e,e.columns,e.rows)}set(e,t,i){return this.matrix.set(t,e,i),this}get(e,t){return this.matrix.get(t,e)}}},function(e,t,i){'use strict';var n=i(20);e.exports=class extends n{constructor(e,t){super(e,1,e.columns),this.row=t}set(e,t,i){return this.matrix.set(this.row,t,i),this}get(e,t){return this.matrix.get(this.row,t)}}},function(e,t,i){'use strict';var n=i(20),o=i(29);e.exports=class extends n{constructor(e,t,i,n,s){o.checkRange(e,t,i,n,s),super(e,i-t+1,s-n+1),this.startRow=t,this.startColumn=n}set(e,t,i){return this.matrix.set(this.startRow+e,this.startColumn+t,i),this}get(e,t){return this.matrix.get(this.startRow+e,this.startColumn+t)}}},function(e,t,i){'use strict';var n=i(20),o=i(29);e.exports=class extends n{constructor(e,t,i){var n=o.checkIndices(e,t,i);super(e,n.row.length,n.column.length),this.rowIndices=n.row,this.columnIndices=n.column}set(e,t,i){return this.matrix.set(this.rowIndices[e],this.columnIndices[t],i),this}get(e,t){return this.matrix.get(this.rowIndices[e],this.columnIndices[t])}}},function(e,t,i){'use strict';var n=i(20);e.exports=class extends n{constructor(e,t){super(e,e.rows,1),this.column=t}set(e,t,i){return this.matrix.set(e,this.column,i),this}get(e){return this.matrix.get(e,this.column)}}},function(e,t,i){'use strict';var n=i(20);e.exports=class extends n{constructor(e){super(e,e.rows,e.columns)}set(e,t,i){return this.matrix.set(this.rows-e-1,t,i),this}get(e,t){return this.matrix.get(this.rows-e-1,t)}}},function(e,t,i){'use strict';var n=i(20);e.exports=class extends n{constructor(e){super(e,e.rows,e.columns)}set(e,t,i){return this.matrix.set(e,this.columns-t-1,i),this}get(e,t){return this.matrix.get(e,this.columns-t-1)}}},function(e,t,i){'use strict';function n(e){return e=s.checkMatrix(e),o(e,s.eye(e.rows))}function o(e,t){return e=s.checkMatrix(e),t=s.checkMatrix(t),e.isSquare()?new l(e).solve(t):new c(e).solve(t)}var s=i(10).Matrix,r=i(90),a=i(286),l=i(89),c=i(287),u=i(288);s.inverse=s.inv=n,s.prototype.inverse=s.prototype.inv=function(){return n(this)},s.solve=o,s.prototype.solve=function(e){return o(this,e)},e.exports={SingularValueDecomposition:r,SVD:r,EigenvalueDecomposition:a,EVD:a,LuDecomposition:l,LU:l,QrDecomposition:c,QR:c,CholeskyDecomposition:u,CHO:u,inverse:n,solve:o}},function(e,t,i){'use strict';function o(t,c){if(c=Object.assign({},h,c),!(this instanceof o))return new o(t,c);if(t=m.checkMatrix(t),!t.isSquare())throw new Error('Matrix is not a square matrix');var u=t.columns,n=g(u,u,0),p=Array(u),d=Array(u),e=t,k=!1,x,i;if(k=!!c.assumeSymmetric||t.isSymmetric(),k){for(x=0;x<u;x++)for(i=0;i<u;i++)n[x][i]=e.get(x,i);s(u,d,p,n),r(u,d,p,n)}else{var j=g(u,u,0),w=Array(u);for(i=0;i<u;i++)for(x=0;x<u;x++)j[x][i]=e.get(x,i);a(u,j,w,n),l(u,d,p,n,j)}this.n=u,this.e=d,this.d=p,this.V=n}function s(t,n,e,o){var s,r,a,l,i,c,m,d;for(i=0;i<t;i++)e[i]=o[t-1][i];for(l=t-1;0<l;l--){for(d=0,a=0,c=0;c<l;c++)d+=u(e[c]);if(0===d)for(n[l]=e[l-1],i=0;i<l;i++)e[i]=o[l-1][i],o[l][i]=0,o[i][l]=0;else{for(c=0;c<l;c++)e[c]/=d,a+=e[c]*e[c];for(s=e[l-1],r=R(a),0<s&&(r=-r),n[l]=d*r,a-=s*r,e[l-1]=s-r,i=0;i<l;i++)n[i]=0;for(i=0;i<l;i++){for(s=e[i],o[i][l]=s,r=n[i]+o[i][i]*s,c=i+1;c<=l-1;c++)r+=o[c][i]*e[c],n[c]+=o[c][i]*s;n[i]=r}for(s=0,i=0;i<l;i++)n[i]/=a,s+=n[i]*e[i];for(m=s/(a+a),i=0;i<l;i++)n[i]-=m*e[i];for(i=0;i<l;i++){for(s=e[i],r=n[i],c=i;c<=l-1;c++)o[c][i]-=s*n[c]+r*e[c];e[i]=o[l-1][i],o[l][i]=0}}e[l]=a}for(l=0;l<t-1;l++){if(o[t-1][l]=o[l][l],o[l][l]=1,a=e[l+1],0!==a){for(c=0;c<=l;c++)e[c]=o[c][l+1]/a;for(i=0;i<=l;i++){for(r=0,c=0;c<=l;c++)r+=o[c][l+1]*o[c][i];for(c=0;c<=l;c++)o[c][i]-=r*e[c]}}for(c=0;c<=l;c++)o[c][l+1]=0}for(i=0;i<t;i++)e[i]=o[t-1][i],o[t-1][i]=0;o[t-1][t-1]=1,n[0]=0}function r(t,n,e,o){var a,d,g,i,h,k,l,m,p,x,w,c,y,b,v,R,I;for(g=1;g<t;g++)n[g-1]=n[g];n[t-1]=0;var S=0,f=0,C=2.220446049250313e-16;for(k=0;k<t;k++){for(f=M(f,u(e[k])+u(n[k])),l=k;l<t&&!(u(n[l])<=C*f);)l++;if(l>k){I=0;do{for(++I,a=e[k],m=(e[k+1]-a)/(2*n[k]),p=j(m,1),0>m&&(p=-p),e[k]=n[k]/(m+p),e[k+1]=n[k]*(m+p),x=e[k+1],d=a-e[k],g=k+2;g<t;g++)e[g]-=d;for(S+=d,m=e[l],w=1,c=w,y=w,b=n[k+1],v=0,R=0,g=l-1;g>=k;g--)for(y=c,c=w,R=v,a=w*n[g],d=w*m,p=j(m,n[g]),n[g+1]=v*p,v=n[g]/p,w=m/p,m=w*e[g]-v*a,e[g+1]=d+v*(w*a+v*e[g]),h=0;h<t;h++)d=o[h][g+1],o[h][g+1]=v*o[h][g]+w*d,o[h][g]=w*o[h][g]-v*d;m=-v*R*y*b*n[k]/x,n[k]=v*m,e[k]=w*m}while(u(n[k])>C*f)}e[k]+=S,n[k]=0}for(g=0;g<t-1;g++){for(h=g,m=e[g],i=g+1;i<t;i++)e[i]<m&&(h=i,m=e[i]);if(h!==g)for(e[h]=e[g],e[g]=m,i=0;i<t;i++)m=o[i][g],o[i][g]=o[i][h],o[i][h]=m}}function a(e,t,n,o){var s=0,r=e-1,a,l,c,d,i,h,m;for(h=s+1;h<=r-1;h++){for(m=0,d=h;d<=r;d++)m+=u(t[d][h-1]);if(0!==m){for(c=0,d=r;d>=h;d--)n[d]=t[d][h-1]/m,c+=n[d]*n[d];for(l=R(c),0<n[h]&&(l=-l),c-=n[h]*l,n[h]-=l,i=h;i<e;i++){for(a=0,d=r;d>=h;d--)a+=n[d]*t[d][i];for(a/=c,d=h;d<=r;d++)t[d][i]-=a*n[d]}for(d=0;d<=r;d++){for(a=0,i=r;i>=h;i--)a+=n[i]*t[d][i];for(a/=c,i=h;i<=r;i++)t[d][i]-=a*n[i]}n[h]=m*n[h],t[h][h-1]=m*l}}for(d=0;d<e;d++)for(i=0;i<e;i++)o[d][i]=d===i?1:0;for(h=r-1;h>=s+1;h--)if(0!==t[h][h-1]){for(d=h+1;d<=r;d++)n[d]=t[d][h-1];for(i=h;i<=r;i++){for(l=0,d=h;d<=r;d++)l+=n[d]*o[d][i];for(l=l/n[h]/t[h][h-1],d=h;d<=r;d++)o[d][i]+=l*n[d]}}}function l(o,a,e,d,g){var h=o-1,n=0,f=o-1,b=2.220446049250313e-16,I=0,S=0,C=0,p=0,V=0,D=0,_=0,P=0,A,i,j,k,l,m,t,w,x,y,L,U,F,T,q;for(A=0;A<o;A++)for((A<n||A>f)&&(e[A]=g[A][A],a[A]=0),i=M(A-1,0);i<o;i++)S+=u(g[A][i]);for(;h>=n;){for(k=h;k>n&&(D=u(g[k-1][k-1])+u(g[k][k]),0===D&&(D=S),!(u(g[k][k-1])<b*D));)k--;if(k===h)g[h][h]+=I,e[h]=g[h][h],a[h]=0,h--,P=0;else if(k===h-1){if(t=g[h][h-1]*g[h-1][h],C=(g[h-1][h-1]-g[h][h])/2,p=C*C+t,_=R(u(p)),g[h][h]+=I,g[h-1][h-1]=g[h-1][h-1]+I,w=g[h][h],0<=p){for(_=0<=C?C+_:C-_,e[h-1]=w+_,e[h]=e[h-1],0!==_&&(e[h]=w-t/_),a[h-1]=0,a[h]=0,w=g[h][h-1],D=u(w)+u(_),C=w/D,p=_/D,V=R(C*C+p*p),C/=V,p/=V,i=h-1;i<o;i++)_=g[h-1][i],g[h-1][i]=p*_+C*g[h][i],g[h][i]=p*g[h][i]-C*_;for(A=0;A<=h;A++)_=g[A][h-1],g[A][h-1]=p*_+C*g[A][h],g[A][h]=p*g[A][h]-C*_;for(A=n;A<=f;A++)_=d[A][h-1],d[A][h-1]=p*_+C*d[A][h],d[A][h]=p*d[A][h]-C*_}else e[h-1]=w+C,e[h]=w+C,a[h-1]=_,a[h]=-_;h-=2,P=0}else{if(w=g[h][h],x=0,t=0,k<h&&(x=g[h-1][h-1],t=g[h][h-1]*g[h-1][h]),10==P){for(I+=w,A=n;A<=h;A++)g[A][A]-=w;D=u(g[h][h-1])+u(g[h-1][h-2]),w=x=0.75*D,t=-0.4375*D*D}if(30==P&&(D=(x-w)/2,D=D*D+t,0<D)){for(D=R(D),x<w&&(D=-D),D=w-t/((x-w)/2+D),A=n;A<=h;A++)g[A][A]-=D;I+=D,w=x=t=0.964}for(++P,l=h-2;l>=k&&(_=g[l][l],V=w-_,D=x-_,C=(V*D-t)/g[l+1][l]+g[l][l+1],p=g[l+1][l+1]-_-V-D,V=g[l+2][l+1],D=u(C)+u(p)+u(V),C/=D,p/=D,V/=D,l!==k)&&!(u(g[l][l-1])*(u(p)+u(V))<b*(u(C)*(u(g[l-1][l-1])+u(_)+u(g[l+1][l+1]))));)l--;for(A=l+2;A<=h;A++)g[A][A-2]=0,A>l+2&&(g[A][A-3]=0);for(j=l;j<=h-1&&(T=j!==h-1,j!==l&&(C=g[j][j-1],p=g[j+1][j-1],V=T?g[j+2][j-1]:0,w=u(C)+u(p)+u(V),0!==w&&(C/=w,p/=w,V/=w)),0!==w);j++)if(D=R(C*C+p*p+V*V),0>C&&(D=-D),0!==D){for(j===l?k!==l&&(g[j][j-1]=-g[j][j-1]):g[j][j-1]=-D*w,C+=D,w=C/D,x=p/D,_=V/D,p/=C,V/=C,i=j;i<o;i++)C=g[j][i]+p*g[j+1][i],T&&(C+=V*g[j+2][i],g[j+2][i]=g[j+2][i]-C*_),g[j][i]-=C*w,g[j+1][i]=g[j+1][i]-C*x;for(A=0;A<=v(h,j+3);A++)C=w*g[A][j]+x*g[A][j+1],T&&(C+=_*g[A][j+2],g[A][j+2]=g[A][j+2]-C*V),g[A][j]-=C,g[A][j+1]=g[A][j+1]-C*p;for(A=n;A<=f;A++)C=w*d[A][j]+x*d[A][j+1],T&&(C+=_*d[A][j+2],d[A][j+2]=d[A][j+2]-C*V),d[A][j]-=C,d[A][j+1]=d[A][j+1]-C*p}}}if(0!==S){for(h=o-1;0<=h;h--)if(C=e[h],p=a[h],0===p)for(k=h,g[h][h]=1,A=h-1;0<=A;A--){for(t=g[A][A]-C,V=0,i=k;i<=h;i++)V+=g[A][i]*g[i][h];if(0>a[A])_=t,D=V;else if(k=A,0===a[A]?g[A][h]=0===t?-V/(b*S):-V/t:(w=g[A][A+1],x=g[A+1][A],p=(e[A]-C)*(e[A]-C)+a[A]*a[A],m=(w*D-_*V)/p,g[A][h]=m,g[A+1][h]=u(w)>u(_)?(-V-t*m)/w:(-D-x*m)/_),m=u(g[A][h]),1<b*m*m)for(i=A;i<=h;i++)g[i][h]/=m}else if(0>p)for(k=h-1,u(g[h][h-1])>u(g[h-1][h])?(g[h-1][h-1]=p/g[h][h-1],g[h-1][h]=-(g[h][h]-C)/g[h][h-1]):(q=c(0,-g[h-1][h],g[h-1][h-1]-C,p),g[h-1][h-1]=q[0],g[h-1][h]=q[1]),g[h][h-1]=0,g[h][h]=1,A=h-2;0<=A;A--){for(y=0,L=0,i=k;i<=h;i++)y+=g[A][i]*g[i][h-1],L+=g[A][i]*g[i][h];if(t=g[A][A]-C,0>a[A])_=t,V=y,D=L;else if(k=A,0===a[A]?(q=c(-y,-L,t,p),g[A][h-1]=q[0],g[A][h]=q[1]):(w=g[A][A+1],x=g[A+1][A],U=(e[A]-C)*(e[A]-C)+a[A]*a[A]-p*p,F=2*(e[A]-C)*p,0===U&&0===F&&(U=b*S*(u(t)+u(p)+u(w)+u(x)+u(_))),q=c(w*V-_*y+p*L,w*D-_*L-p*y,U,F),g[A][h-1]=q[0],g[A][h]=q[1],u(w)>u(_)+u(p)?(g[A+1][h-1]=(-y-t*g[A][h-1]+p*g[A][h])/w,g[A+1][h]=(-L-t*g[A][h]-p*g[A][h-1])/w):(q=c(-V-x*g[A][h-1],-D-x*g[A][h],_,p),g[A+1][h-1]=q[0],g[A+1][h]=q[1])),m=M(u(g[A][h-1]),u(g[A][h])),1<b*m*m)for(i=A;i<=h;i++)g[i][h-1]=g[i][h-1]/m,g[i][h]/=m}for(A=0;A<o;A++)if(A<n||A>f)for(i=A;i<o;i++)d[A][i]=g[A][i];for(i=o-1;i>=n;i--)for(A=n;A<=f;A++){for(_=0,j=n;j<=v(i,f);j++)_+=d[A][j]*g[j][i];d[A][i]=_}}}function c(e,t,i,n){var o,s;return u(i)>u(n)?(o=n/i,s=i+o*n,[(e+o*t)/s,(t-o*e)/s]):(o=i/n,s=n+o*i,[(o*e+t)/s,(o*t-e)/s])}var m=i(10).Matrix,n=i(44),j=n.hypotenuse,g=n.getFilled2DArray,h={assumeSymmetric:!1};o.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return m.isMatrix(this.V)||(this.V=new m(this.V)),this.V},get diagonalMatrix(){var t=this.n,n=this.e,e=this.d,o=new m(t,t),s,i;for(s=0;s<t;s++){for(i=0;i<t;i++)o[s][i]=0;o[s][s]=e[s],0<n[s]?o[s][s+1]=n[s]:0>n[s]&&(o[s][s-1]=n[s])}return o}},e.exports=o},function(e,t,i){'use strict';function o(e){if(!(this instanceof o))return new o(e);e=r.checkMatrix(e);var t=e.clone(),a=e.rows,l=e.columns,c=Array(l),u,i,m,d;for(m=0;m<l;m++){var g=0;for(u=m;u<a;u++)g=n(g,t[u][m]);if(0!==g){for(0>t[m][m]&&(g=-g),u=m;u<a;u++)t[u][m]/=g;for(t[m][m]+=1,i=m+1;i<l;i++){for(d=0,u=m;u<a;u++)d+=t[u][m]*t[u][i];for(d=-d/t[m][m],u=m;u<a;u++)t[u][i]+=d*t[u][m]}}c[m]=-g}this.QR=t,this.Rdiag=c}var r=i(10).Matrix,n=i(44).hypotenuse;o.prototype={solve:function(e){e=r.checkMatrix(e);var t=this.QR,o=t.rows;if(e.rows!==o)throw new Error('Matrix row dimensions must agree');if(!this.isFullRank())throw new Error('Matrix is rank deficient');var a=e.columns,l=e.clone(),c=t.columns,n,i,u,m;for(u=0;u<c;u++)for(i=0;i<a;i++){for(m=0,n=u;n<o;n++)m+=t[n][u]*l[n][i];for(m=-m/t[u][u],n=u;n<o;n++)l[n][i]+=m*t[n][u]}for(u=c-1;0<=u;u--){for(i=0;i<a;i++)l[u][i]/=this.Rdiag[u];for(n=0;n<u;n++)for(i=0;i<a;i++)l[n][i]-=l[u][i]*t[n][u]}return l.subMatrix(0,c-1,0,a-1)},isFullRank:function(){for(var e=this.QR.columns,t=0;t<e;t++)if(0===this.Rdiag[t])return!1;return!0},get upperTriangularMatrix(){var e=this.QR,t=e.columns,n=new r(t,t),o,i;for(o=0;o<t;o++)for(i=0;i<t;i++)n[o][i]=o<i?e[o][i]:o===i?this.Rdiag[o]:0;return n},get orthogonalMatrix(){var e=this.QR,t=e.rows,n=e.columns,o=new r(t,n),a,i,l,c;for(l=n-1;0<=l;l--){for(a=0;a<t;a++)o[a][l]=0;for(o[l][l]=1,i=l;i<n;i++)if(0!==e[l][l]){for(c=0,a=l;a<t;a++)c+=e[a][l]*o[a][i];for(c=-c/e[l][l],a=l;a<t;a++)o[a][i]+=c*e[a][l]}}return o}},e.exports=o},function(e,t,i){'use strict';function n(e){if(!(this instanceof n))return new n(e);if(e=o.checkMatrix(e),!e.isSymmetric())throw new Error('Matrix is not symmetric');var t=e,r=t.rows,a=new o(r,r),l=!0,c,i,u;for(i=0;i<r;i++){var m=a[i],g=0;for(u=0;u<i;u++){var d=a[u],h=0;for(c=0;c<u;c++)h+=d[c]*m[c];m[u]=h=(t[i][u]-h)/a[u][u],g+=h*h}for(g=t[i][i]-g,l&=0<g,a[i][i]=R(M(g,0)),u=i+1;u<r;u++)a[i][u]=0}if(!l)throw new Error('Matrix is not positive definite');this.L=a}var o=i(10).Matrix;n.prototype={get lowerTriangularMatrix(){return this.L},solve:function(e){e=o.checkMatrix(e);var t=this.L,n=t.rows;if(e.rows!==n)throw new Error('Matrix dimensions do not match');var s=e.columns,r=e.clone(),a,i,l;for(l=0;l<n;l++)for(i=0;i<s;i++){for(a=0;a<l;a++)r[l][i]-=r[a][i]*t[l][a];r[l][i]/=t[l][l]}for(l=n-1;0<=l;l--)for(i=0;i<s;i++){for(a=l+1;a<n;a++)r[l][i]-=r[a][i]*t[a][l];r[l][i]/=t[l][l]}return r}},e.exports=n},function(e,t,i){'use strict';e.exports=t=i(290),t.Utils=i(47),t.OPLS=i(303)},function(e,t,i){'use strict';function n(e,t){for(var n=0,o=0;o<e.rows;o++)n+=e[o][t];return n}function o(e){for(var t=0,o=-Infinity,s=0,i;s<e.columns;++s)i=n(e,s),i>o&&(o=i,t=s);return t}var s=i(45),r=i(47);class a{constructor(e,t){if(!0===e){var i=t;this.meanX=i.meanX,this.stdDevX=i.stdDevX,this.meanY=i.meanY,this.stdDevY=i.stdDevY,this.PBQ=s.checkMatrix(i.PBQ),this.R2X=i.R2X}else{if(e.length!==t.length)throw new RangeError('The number of X rows must be equal to the number of Y rows');var n=r.featureNormalize(e);this.X=n.result,this.meanX=n.means,this.stdDevX=n.std;var o=r.featureNormalize(t);this.Y=o.result,this.meanY=o.means,this.stdDevY=o.std}}train(e){e===void 0&&(e={});var i=e.latentVectors;i===void 0&&(i=v(this.X.length-1,this.X[0].length));var a=e.tolerance;a===void 0&&(a=1e-5);for(var l=this.X,c=this.Y,m=l.rows,d=l.columns,g=c.rows,h=c.columns,j=l.clone().mul(l).sum(),x=c.clone().mul(c).sum(),f=i,n=s.zeros(m,f),y=s.zeros(d,f),M=s.zeros(g,f),R=s.zeros(h,f),I=s.zeros(f,f),S=y.clone(),C=0;r.norm(c)>a&&C<f;){for(var k=l.transpose(),V=c.transpose(),D=o(l.clone().mulM(l)),z=o(c.clone().mulM(c)),_=l.getColumnVector(D),P=c.getColumnVector(z),u=s.zeros(m,1);r.norm(_.clone().sub(u))>a;){var t=k.mmul(P);t.div(r.norm(t)),u=_,_=l.mmul(t);var w=V.mmul(_);w.div(r.norm(w)),P=c.mmul(w)}u=_;var A=k.mmul(u),L=u.transpose().mmul(u)[0][0],U=A.div(L),p=r.norm(U);U.div(p),u.mul(p),t.mul(p),A=P.transpose().mmul(u),L=u.transpose().mmul(u)[0][0];var F=A.div(L)[0][0];l.sub(u.mmul(U.transpose())),c.sub(u.clone().mul(F).mmul(w.transpose())),n.setColumn(C,u),y.setColumn(C,U),M.setColumn(C,P),R.setColumn(C,w),S.setColumn(C,t),I[C][C]=F,C++}C--,n=n.subMatrix(0,n.rows-1,0,C),y=y.subMatrix(0,y.rows-1,0,C),M=M.subMatrix(0,M.rows-1,0,C),R=R.subMatrix(0,R.rows-1,0,C),S=S.subMatrix(0,S.rows-1,0,C),I=I.subMatrix(0,C,0,C),this.ssqYcal=x,this.E=l,this.F=c,this.T=n,this.P=y,this.U=M,this.Q=R,this.W=S,this.B=I,this.PBQ=y.mmul(I).mmul(R.transpose()),this.R2X=u.transpose().mmul(u).mmul(U.transpose().mmul(U)).div(j)[0][0]}predict(e){var t=s.checkMatrix(e);t=t.subRowVector(this.meanX).divRowVector(this.stdDevX);var i=t.mmul(this.PBQ);return i=i.mulRowVector(this.stdDevY).addRowVector(this.meanY),i}getExplainedVariance(){return this.R2X}toJSON(){return{name:'PLS',R2X:this.R2X,meanX:this.meanX,stdDevX:this.stdDevX,meanY:this.meanY,stdDevY:this.stdDevY,PBQ:this.PBQ}}static load(e){if('PLS'!==e.name)throw new RangeError('Invalid model: '+e.name);return new a(!0,e)}}e.exports=a},function(){'use strict';Symbol.species||(Symbol.species=Symbol.for('@@species'))},function(e,t,i){'use strict';var n=i(21);e.exports=class extends n{constructor(e){super(e,e.columns,e.rows)}set(e,t,i){return this.matrix.set(t,e,i),this}get(e,t){return this.matrix.get(t,e)}}},function(e,t,i){'use strict';var n=i(21);e.exports=class extends n{constructor(e,t){super(e,1,e.columns),this.row=t}set(e,t,i){return this.matrix.set(this.row,t,i),this}get(e,t){return this.matrix.get(this.row,t)}}},function(e,t,i){'use strict';var n=i(21),o=i(30);e.exports=class extends n{constructor(e,t,i,n,s){o.checkRange(e,t,i,n,s),super(e,i-t+1,s-n+1),this.startRow=t,this.startColumn=n}set(e,t,i){return this.matrix.set(this.startRow+e,this.startColumn+t,i),this}get(e,t){return this.matrix.get(this.startRow+e,this.startColumn+t)}}},function(e,t,i){'use strict';var n=i(21),o=i(30);e.exports=class extends n{constructor(e,t,i){var n=o.checkIndices(e,t,i);super(e,n.row.length,n.column.length),this.rowIndices=n.row,this.columnIndices=n.column}set(e,t,i){return this.matrix.set(this.rowIndices[e],this.columnIndices[t],i),this}get(e,t){return this.matrix.get(this.rowIndices[e],this.columnIndices[t])}}},function(e,t,i){'use strict';var n=i(21);e.exports=class extends n{constructor(e,t){super(e,e.rows,1),this.column=t}set(e,t,i){return this.matrix.set(e,this.column,i),this}get(e){return this.matrix.get(e,this.column)}}},function(e,t,i){'use strict';var n=i(21);e.exports=class extends n{constructor(e){super(e,e.rows,e.columns)}set(e,t,i){return this.matrix.set(this.rows-e-1,t,i),this}get(e,t){return this.matrix.get(this.rows-e-1,t)}}},function(e,t,i){'use strict';var n=i(21);e.exports=class extends n{constructor(e){super(e,e.rows,e.columns)}set(e,t,i){return this.matrix.set(e,this.columns-t-1,i),this}get(e,t){return this.matrix.get(e,this.columns-t-1)}}},function(e,t,i){'use strict';function n(e){return e=s.checkMatrix(e),o(e,s.eye(e.rows))}function o(e,t){return e=s.checkMatrix(e),t=s.checkMatrix(t),e.isSquare()?new l(e).solve(t):new c(e).solve(t)}var s=i(11).Matrix,r=i(93),a=i(300),l=i(92),c=i(301),u=i(302);s.inverse=s.inv=n,s.prototype.inverse=s.prototype.inv=function(){return n(this)},s.solve=o,s.prototype.solve=function(e){return o(this,e)},e.exports={SingularValueDecomposition:r,SVD:r,EigenvalueDecomposition:a,EVD:a,LuDecomposition:l,LU:l,QrDecomposition:c,QR:c,CholeskyDecomposition:u,CHO:u,inverse:n,solve:o}},function(e,t,i){'use strict';function o(t,c){if(c=Object.assign({},h,c),!(this instanceof o))return new o(t,c);if(t=m.checkMatrix(t),!t.isSquare())throw new Error('Matrix is not a square matrix');var u=t.columns,n=g(u,u,0),p=Array(u),d=Array(u),e=t,k=!1,x,i;if(k=!!c.assumeSymmetric||t.isSymmetric(),k){for(x=0;x<u;x++)for(i=0;i<u;i++)n[x][i]=e.get(x,i);s(u,d,p,n),r(u,d,p,n)}else{var j=g(u,u,0),w=Array(u);for(i=0;i<u;i++)for(x=0;x<u;x++)j[x][i]=e.get(x,i);a(u,j,w,n),l(u,d,p,n,j)}this.n=u,this.e=d,this.d=p,this.V=n}function s(t,n,e,o){var s,r,a,l,i,c,m,d;for(i=0;i<t;i++)e[i]=o[t-1][i];for(l=t-1;0<l;l--){for(d=0,a=0,c=0;c<l;c++)d+=u(e[c]);if(0===d)for(n[l]=e[l-1],i=0;i<l;i++)e[i]=o[l-1][i],o[l][i]=0,o[i][l]=0;else{for(c=0;c<l;c++)e[c]/=d,a+=e[c]*e[c];for(s=e[l-1],r=R(a),0<s&&(r=-r),n[l]=d*r,a-=s*r,e[l-1]=s-r,i=0;i<l;i++)n[i]=0;for(i=0;i<l;i++){for(s=e[i],o[i][l]=s,r=n[i]+o[i][i]*s,c=i+1;c<=l-1;c++)r+=o[c][i]*e[c],n[c]+=o[c][i]*s;n[i]=r}for(s=0,i=0;i<l;i++)n[i]/=a,s+=n[i]*e[i];for(m=s/(a+a),i=0;i<l;i++)n[i]-=m*e[i];for(i=0;i<l;i++){for(s=e[i],r=n[i],c=i;c<=l-1;c++)o[c][i]-=s*n[c]+r*e[c];e[i]=o[l-1][i],o[l][i]=0}}e[l]=a}for(l=0;l<t-1;l++){if(o[t-1][l]=o[l][l],o[l][l]=1,a=e[l+1],0!==a){for(c=0;c<=l;c++)e[c]=o[c][l+1]/a;for(i=0;i<=l;i++){for(r=0,c=0;c<=l;c++)r+=o[c][l+1]*o[c][i];for(c=0;c<=l;c++)o[c][i]-=r*e[c]}}for(c=0;c<=l;c++)o[c][l+1]=0}for(i=0;i<t;i++)e[i]=o[t-1][i],o[t-1][i]=0;o[t-1][t-1]=1,n[0]=0}function r(t,n,e,o){var a,d,g,i,h,k,l,m,p,x,w,c,y,b,v,R,I;for(g=1;g<t;g++)n[g-1]=n[g];n[t-1]=0;var S=0,f=0,C=2.220446049250313e-16;for(k=0;k<t;k++){for(f=M(f,u(e[k])+u(n[k])),l=k;l<t&&!(u(n[l])<=C*f);)l++;if(l>k){I=0;do{for(++I,a=e[k],m=(e[k+1]-a)/(2*n[k]),p=j(m,1),0>m&&(p=-p),e[k]=n[k]/(m+p),e[k+1]=n[k]*(m+p),x=e[k+1],d=a-e[k],g=k+2;g<t;g++)e[g]-=d;for(S+=d,m=e[l],w=1,c=w,y=w,b=n[k+1],v=0,R=0,g=l-1;g>=k;g--)for(y=c,c=w,R=v,a=w*n[g],d=w*m,p=j(m,n[g]),n[g+1]=v*p,v=n[g]/p,w=m/p,m=w*e[g]-v*a,e[g+1]=d+v*(w*a+v*e[g]),h=0;h<t;h++)d=o[h][g+1],o[h][g+1]=v*o[h][g]+w*d,o[h][g]=w*o[h][g]-v*d;m=-v*R*y*b*n[k]/x,n[k]=v*m,e[k]=w*m}while(u(n[k])>C*f)}e[k]+=S,n[k]=0}for(g=0;g<t-1;g++){for(h=g,m=e[g],i=g+1;i<t;i++)e[i]<m&&(h=i,m=e[i]);if(h!==g)for(e[h]=e[g],e[g]=m,i=0;i<t;i++)m=o[i][g],o[i][g]=o[i][h],o[i][h]=m}}function a(e,t,n,o){var s=0,r=e-1,a,l,c,d,i,h,m;for(h=s+1;h<=r-1;h++){for(m=0,d=h;d<=r;d++)m+=u(t[d][h-1]);if(0!==m){for(c=0,d=r;d>=h;d--)n[d]=t[d][h-1]/m,c+=n[d]*n[d];for(l=R(c),0<n[h]&&(l=-l),c-=n[h]*l,n[h]-=l,i=h;i<e;i++){for(a=0,d=r;d>=h;d--)a+=n[d]*t[d][i];for(a/=c,d=h;d<=r;d++)t[d][i]-=a*n[d]}for(d=0;d<=r;d++){for(a=0,i=r;i>=h;i--)a+=n[i]*t[d][i];for(a/=c,i=h;i<=r;i++)t[d][i]-=a*n[i]}n[h]=m*n[h],t[h][h-1]=m*l}}for(d=0;d<e;d++)for(i=0;i<e;i++)o[d][i]=d===i?1:0;for(h=r-1;h>=s+1;h--)if(0!==t[h][h-1]){for(d=h+1;d<=r;d++)n[d]=t[d][h-1];for(i=h;i<=r;i++){for(l=0,d=h;d<=r;d++)l+=n[d]*o[d][i];for(l=l/n[h]/t[h][h-1],d=h;d<=r;d++)o[d][i]+=l*n[d]}}}function l(o,a,e,d,g){var h=o-1,n=0,f=o-1,b=2.220446049250313e-16,I=0,S=0,C=0,p=0,V=0,D=0,_=0,P=0,A,i,j,k,l,m,t,w,x,y,L,U,F,T,q;for(A=0;A<o;A++)for((A<n||A>f)&&(e[A]=g[A][A],a[A]=0),i=M(A-1,0);i<o;i++)S+=u(g[A][i]);for(;h>=n;){for(k=h;k>n&&(D=u(g[k-1][k-1])+u(g[k][k]),0===D&&(D=S),!(u(g[k][k-1])<b*D));)k--;if(k===h)g[h][h]+=I,e[h]=g[h][h],a[h]=0,h--,P=0;else if(k===h-1){if(t=g[h][h-1]*g[h-1][h],C=(g[h-1][h-1]-g[h][h])/2,p=C*C+t,_=R(u(p)),g[h][h]+=I,g[h-1][h-1]=g[h-1][h-1]+I,w=g[h][h],0<=p){for(_=0<=C?C+_:C-_,e[h-1]=w+_,e[h]=e[h-1],0!==_&&(e[h]=w-t/_),a[h-1]=0,a[h]=0,w=g[h][h-1],D=u(w)+u(_),C=w/D,p=_/D,V=R(C*C+p*p),C/=V,p/=V,i=h-1;i<o;i++)_=g[h-1][i],g[h-1][i]=p*_+C*g[h][i],g[h][i]=p*g[h][i]-C*_;for(A=0;A<=h;A++)_=g[A][h-1],g[A][h-1]=p*_+C*g[A][h],g[A][h]=p*g[A][h]-C*_;for(A=n;A<=f;A++)_=d[A][h-1],d[A][h-1]=p*_+C*d[A][h],d[A][h]=p*d[A][h]-C*_}else e[h-1]=w+C,e[h]=w+C,a[h-1]=_,a[h]=-_;h-=2,P=0}else{if(w=g[h][h],x=0,t=0,k<h&&(x=g[h-1][h-1],t=g[h][h-1]*g[h-1][h]),10==P){for(I+=w,A=n;A<=h;A++)g[A][A]-=w;D=u(g[h][h-1])+u(g[h-1][h-2]),w=x=0.75*D,t=-0.4375*D*D}if(30==P&&(D=(x-w)/2,D=D*D+t,0<D)){for(D=R(D),x<w&&(D=-D),D=w-t/((x-w)/2+D),A=n;A<=h;A++)g[A][A]-=D;I+=D,w=x=t=0.964}for(++P,l=h-2;l>=k&&(_=g[l][l],V=w-_,D=x-_,C=(V*D-t)/g[l+1][l]+g[l][l+1],p=g[l+1][l+1]-_-V-D,V=g[l+2][l+1],D=u(C)+u(p)+u(V),C/=D,p/=D,V/=D,l!==k)&&!(u(g[l][l-1])*(u(p)+u(V))<b*(u(C)*(u(g[l-1][l-1])+u(_)+u(g[l+1][l+1]))));)l--;for(A=l+2;A<=h;A++)g[A][A-2]=0,A>l+2&&(g[A][A-3]=0);for(j=l;j<=h-1&&(T=j!==h-1,j!==l&&(C=g[j][j-1],p=g[j+1][j-1],V=T?g[j+2][j-1]:0,w=u(C)+u(p)+u(V),0!==w&&(C/=w,p/=w,V/=w)),0!==w);j++)if(D=R(C*C+p*p+V*V),0>C&&(D=-D),0!==D){for(j===l?k!==l&&(g[j][j-1]=-g[j][j-1]):g[j][j-1]=-D*w,C+=D,w=C/D,x=p/D,_=V/D,p/=C,V/=C,i=j;i<o;i++)C=g[j][i]+p*g[j+1][i],T&&(C+=V*g[j+2][i],g[j+2][i]=g[j+2][i]-C*_),g[j][i]-=C*w,g[j+1][i]=g[j+1][i]-C*x;for(A=0;A<=v(h,j+3);A++)C=w*g[A][j]+x*g[A][j+1],T&&(C+=_*g[A][j+2],g[A][j+2]=g[A][j+2]-C*V),g[A][j]-=C,g[A][j+1]=g[A][j+1]-C*p;for(A=n;A<=f;A++)C=w*d[A][j]+x*d[A][j+1],T&&(C+=_*d[A][j+2],d[A][j+2]=d[A][j+2]-C*V),d[A][j]-=C,d[A][j+1]=d[A][j+1]-C*p}}}if(0!==S){for(h=o-1;0<=h;h--)if(C=e[h],p=a[h],0===p)for(k=h,g[h][h]=1,A=h-1;0<=A;A--){for(t=g[A][A]-C,V=0,i=k;i<=h;i++)V+=g[A][i]*g[i][h];if(0>a[A])_=t,D=V;else if(k=A,0===a[A]?g[A][h]=0===t?-V/(b*S):-V/t:(w=g[A][A+1],x=g[A+1][A],p=(e[A]-C)*(e[A]-C)+a[A]*a[A],m=(w*D-_*V)/p,g[A][h]=m,g[A+1][h]=u(w)>u(_)?(-V-t*m)/w:(-D-x*m)/_),m=u(g[A][h]),1<b*m*m)for(i=A;i<=h;i++)g[i][h]/=m}else if(0>p)for(k=h-1,u(g[h][h-1])>u(g[h-1][h])?(g[h-1][h-1]=p/g[h][h-1],g[h-1][h]=-(g[h][h]-C)/g[h][h-1]):(q=c(0,-g[h-1][h],g[h-1][h-1]-C,p),g[h-1][h-1]=q[0],g[h-1][h]=q[1]),g[h][h-1]=0,g[h][h]=1,A=h-2;0<=A;A--){for(y=0,L=0,i=k;i<=h;i++)y+=g[A][i]*g[i][h-1],L+=g[A][i]*g[i][h];if(t=g[A][A]-C,0>a[A])_=t,V=y,D=L;else if(k=A,0===a[A]?(q=c(-y,-L,t,p),g[A][h-1]=q[0],g[A][h]=q[1]):(w=g[A][A+1],x=g[A+1][A],U=(e[A]-C)*(e[A]-C)+a[A]*a[A]-p*p,F=2*(e[A]-C)*p,0===U&&0===F&&(U=b*S*(u(t)+u(p)+u(w)+u(x)+u(_))),q=c(w*V-_*y+p*L,w*D-_*L-p*y,U,F),g[A][h-1]=q[0],g[A][h]=q[1],u(w)>u(_)+u(p)?(g[A+1][h-1]=(-y-t*g[A][h-1]+p*g[A][h])/w,g[A+1][h]=(-L-t*g[A][h]-p*g[A][h-1])/w):(q=c(-V-x*g[A][h-1],-D-x*g[A][h],_,p),g[A+1][h-1]=q[0],g[A+1][h]=q[1])),m=M(u(g[A][h-1]),u(g[A][h])),1<b*m*m)for(i=A;i<=h;i++)g[i][h-1]=g[i][h-1]/m,g[i][h]/=m}for(A=0;A<o;A++)if(A<n||A>f)for(i=A;i<o;i++)d[A][i]=g[A][i];for(i=o-1;i>=n;i--)for(A=n;A<=f;A++){for(_=0,j=n;j<=v(i,f);j++)_+=d[A][j]*g[j][i];d[A][i]=_}}}function c(e,t,i,n){var o,s;return u(i)>u(n)?(o=n/i,s=i+o*n,[(e+o*t)/s,(t-o*e)/s]):(o=i/n,s=n+o*i,[(o*e+t)/s,(o*t-e)/s])}var m=i(11).Matrix,n=i(46),j=n.hypotenuse,g=n.getFilled2DArray,h={assumeSymmetric:!1};o.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return m.isMatrix(this.V)||(this.V=new m(this.V)),this.V},get diagonalMatrix(){var t=this.n,n=this.e,e=this.d,o=new m(t,t),s,i;for(s=0;s<t;s++){for(i=0;i<t;i++)o[s][i]=0;o[s][s]=e[s],0<n[s]?o[s][s+1]=n[s]:0>n[s]&&(o[s][s-1]=n[s])}return o}},e.exports=o},function(e,t,i){'use strict';function o(e){if(!(this instanceof o))return new o(e);e=r.checkMatrix(e);var t=e.clone(),a=e.rows,l=e.columns,c=Array(l),u,i,m,d;for(m=0;m<l;m++){var g=0;for(u=m;u<a;u++)g=n(g,t[u][m]);if(0!==g){for(0>t[m][m]&&(g=-g),u=m;u<a;u++)t[u][m]/=g;for(t[m][m]+=1,i=m+1;i<l;i++){for(d=0,u=m;u<a;u++)d+=t[u][m]*t[u][i];for(d=-d/t[m][m],u=m;u<a;u++)t[u][i]+=d*t[u][m]}}c[m]=-g}this.QR=t,this.Rdiag=c}var r=i(11).Matrix,n=i(46).hypotenuse;o.prototype={solve:function(e){e=r.checkMatrix(e);var t=this.QR,o=t.rows;if(e.rows!==o)throw new Error('Matrix row dimensions must agree');if(!this.isFullRank())throw new Error('Matrix is rank deficient');var a=e.columns,l=e.clone(),c=t.columns,n,i,u,m;for(u=0;u<c;u++)for(i=0;i<a;i++){for(m=0,n=u;n<o;n++)m+=t[n][u]*l[n][i];for(m=-m/t[u][u],n=u;n<o;n++)l[n][i]+=m*t[n][u]}for(u=c-1;0<=u;u--){for(i=0;i<a;i++)l[u][i]/=this.Rdiag[u];for(n=0;n<u;n++)for(i=0;i<a;i++)l[n][i]-=l[u][i]*t[n][u]}return l.subMatrix(0,c-1,0,a-1)},isFullRank:function(){for(var e=this.QR.columns,t=0;t<e;t++)if(0===this.Rdiag[t])return!1;return!0},get upperTriangularMatrix(){var e=this.QR,t=e.columns,n=new r(t,t),o,i;for(o=0;o<t;o++)for(i=0;i<t;i++)n[o][i]=o<i?e[o][i]:o===i?this.Rdiag[o]:0;return n},get orthogonalMatrix(){var e=this.QR,t=e.rows,n=e.columns,o=new r(t,n),a,i,l,c;for(l=n-1;0<=l;l--){for(a=0;a<t;a++)o[a][l]=0;for(o[l][l]=1,i=l;i<n;i++)if(0!==e[l][l]){for(c=0,a=l;a<t;a++)c+=e[a][l]*o[a][i];for(c=-c/e[l][l],a=l;a<t;a++)o[a][i]+=c*e[a][l]}}return o}},e.exports=o},function(e,t,i){'use strict';function n(e){if(!(this instanceof n))return new n(e);if(e=o.checkMatrix(e),!e.isSymmetric())throw new Error('Matrix is not symmetric');var t=e,r=t.rows,a=new o(r,r),l=!0,c,i,u;for(i=0;i<r;i++){var m=a[i],g=0;for(u=0;u<i;u++){var d=a[u],h=0;for(c=0;c<u;c++)h+=d[c]*m[c];m[u]=h=(t[i][u]-h)/a[u][u],g+=h*h}for(g=t[i][i]-g,l&=0<g,a[i][i]=R(M(g,0)),u=i+1;u<r;u++)a[i][u]=0}if(!l)throw new Error('Matrix is not positive definite');this.L=a}var o=i(11).Matrix;n.prototype={get lowerTriangularMatrix(){return this.L},solve:function(e){e=o.checkMatrix(e);var t=this.L,n=t.rows;if(e.rows!==n)throw new Error('Matrix dimensions do not match');var s=e.columns,r=e.clone(),a,i,l;for(l=0;l<n;l++)for(i=0;i<s;i++){for(a=0;a<l;a++)r[l][i]-=r[a][i]*t[l][a];r[l][i]/=t[l][l]}for(l=n-1;0<=l;l--)for(i=0;i<s;i++){for(a=l+1;a<n;a++)r[l][i]-=r[a][i]*t[a][l];r[l][i]/=t[l][l]}return r}},e.exports=n},function(e,t,i){'use strict';function n(e,n,r){var a=new o(e),l=new o(n);a=s.featureNormalize(a).result,l=s.featureNormalize(l).result;var c=a.rows,u=a.columns,m=a.clone().mul(a).sum(),d=a.transpose().mmul(l);d.div(s.norm(d));for(var g=Array(r),h=Array(r),k=Array(r),j=0;j<r;j++){var i=a.mmul(d),t=a.transpose().mmul(i),x=i.transpose().mmul(i)[0][0],w=t.div(x);t=d.transpose().mmul(w)[0][0],x=d.transpose().mmul(d)[0][0];var p=w.sub(d.clone().mul(t/x));p.div(s.norm(p));var f=a.mmul(p);t=a.transpose().mmul(f),x=f.transpose().mmul(f)[0][0];var y=t.div(x);a.sub(f.mmul(y.transpose())),g[j]=p.getColumn(0),h[j]=f.getColumn(0),k[j]=y.getColumn(0)}this.Xosc=a;var M=this.Xosc.clone().mul(this.Xosc).sum();this.R2X=1-M/m,this.W=g,this.T=h,this.P=k,this.numberOSC=r}var o=i(45),s=i(47);e.exports=n,n.prototype.correctDataset=function(e){for(var n=new o(e),s=n.clone().mul(n).sum(),r=0;r<this.numberOSC;r++){var i=this.W.getColumnVector(r),a=this.P.getColumnVector(r),l=n.mmul(i);n.sub(l.mmul(a))}var t=n.clone().mul(n).sum();return{datasetOsc:n,R2Dataset:1-t/s}}},function(t,i,n){'use strict';function o(e,t,i,n,o,s){i=r.updateClusterID(t,e,i,o.distanceFunction);var a=r.updateCenters(t,i,n),c=r.converged(a,e,o.distanceFunction,o.tolerance);return new l(i,a,c,s,o.distanceFunction)}function*s(e,t,i,n,s){for(var r=!1,a=0,l;!r&&a<s.maxIterations;)l=o(e,t,i,n,s,++a),yield l.computeInformation(t),r=l.converged,e=l.centroids}var r=n(94),a=n(306),l=n(308),c=n(0).squared,u={maxIterations:100,tolerance:1e-6,withIterations:!1,initialization:'mostDistant',distanceFunction:c};t.exports=function(t,i,n){if(n=Object.assign({},u,n),0>=i||i>t.length||!m(i))throw new Error('K should be a positive integer bigger than the number of points');var l;if(!Array.isArray(n.initialization))switch(n.initialization){case'random':l=a.random(t,i);break;case'mostDistant':l=a.mostDistant(t,i,r.calculateDistanceMatrix(t,n.distanceFunction));break;default:throw new Error('Unknown initialization method: "'+n.initialization+'"');}else if(n.initialization.length!==i)throw new Error('The initial centers should have the same length as K');else l=n.initialization;0===n.maxIterations&&(n.maxIterations=e);var c=Array(t.length);if(n.withIterations)return s(l,t,c,i,n);for(var d=!1,g=0,h;!d&&g<n.maxIterations;)h=o(l,t,c,i,n,++g),d=h.converged,l=h.centroids;return h.computeInformation(t)}},function(i,n,o){'use strict';var s=o(0).squared,r={distanceFunction:s,similarityFunction:!1,returnVector:!1};i.exports=function(n,o,s){s=s||r;var a=s.distanceFunction||r.distanceFunction,l=s.similarityFunction||r.similarityFunction,c=s.returnVector||r.returnVector,u=-1;if('function'==typeof l)for(var m=t,d=0,g;d<n.length;d++)g=l(o,n[d]),g>m&&(m=g,u=d);else if('function'==typeof a)for(var h=e,p=0,i;p<n.length;p++)i=a(o,n[p]),i<h&&(h=i,u=p);else throw new Error('A similarity or distance function it\'s required');return c?n[u]:u}},function(t,i,n){'use strict';var o=n(307).Picker;i.random=function(e,t){for(var n=new o(e),s=Array(t),r=0;r<t;++r)s[r]=n.pick();return s},i.mostDistant=function(t,i,o){var s=Array(i);if(s[0]=g(Math.random()*t.length),1<i){for(var r={dist:-1,index:-1},a=0;a<t.length;++a)o[s[0]][a]>r.dist&&(r.dist=o[s[0]][a],r.index=a);if(s[1]=r.index,2<i)for(var l=2,c;l<i;++l){c={dist:-1,index:-1};for(var u=0,d;u<t.length;++u){d={dist:e,index:-1};for(var h=0;h<l;++h)o[h][u]<d.dist&&-1===s.indexOf(u)&&(d={dist:o[h][u],index:u});d.dist!==e&&d.dist>c.dist&&(c=Object.assign({},d))}s[l]=c.index}}return s.map((e)=>t[e])}},function(e){'use strict';(function(){function t(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t}var i;i='undefined'!=typeof e&&e.exports?e.exports:this.RandomSelection={},i.Picker=function(e){this._originalOptions=e,this._remainingOptions=[]},i.Picker.prototype={pick:function(){0===this._remainingOptions.length&&(this._remainingOptions=t(this._originalOptions));var e=g(Math.random()*this._remainingOptions.length);return this._remainingOptions.splice(e,1)[0]}}}).call(void 0)},function(e,t,i){'use strict';function n(e,t,i,n,o){this.clusters=e,this.centroids=t,this.converged=i,this.iterations=n,this[s]=o}var o=i(94),s=Symbol('distance');n.prototype.nearest=function(e){var t=Array(e.length),i=this.centroids.map(function(e){return e.centroid});return o.updateClusterID(e,i,t,this[s])},n.prototype.computeInformation=function(e){for(var t=this.centroids.map(function(e){return{centroid:e,error:0,size:0}}),o=0;o<e.length;o++)t[this.clusters[o]].error+=this[s](e[o],this.centroids[this.clusters[o]]),t[this.clusters[o]].size++;for(var i=0;i<this.centroids.length;i++)t[i].error/=t[i].size;return new n(this.clusters,t,this.converged,this.iterations,this[s])},e.exports=n},function(e,t,i){'use strict';t.agnes=i(310),t.diana=i(318)},function(e,t,i){'use strict';function n(e,t,n){for(var o=1e101,s=0;s<e.length;s++)for(var i=0,r;i<t.length;i++)r=n[e[s]][t[i]],o=v(r,o);return o}function o(e,t,n){for(var o=-1,s=0;s<e.length;s++)for(var i=0,r;i<t.length;i++)r=n[e[s]][t[i]],o=M(r,o);return o}function s(e,t,n){for(var o=0,s=0;s<e.length;s++)for(var i=0;i<t.length;i++)o+=n[e[s]][t[i]];return o/(e.length*t.length)}function r(e,t,n){for(var o=Array(e.length*t.length),s=0;s<e.length;s++)for(var i=0;i<t.length;i++)o[s*t.length+i]=n[e[s]][t[i]];return l(o)}function a(e,t,i){return r(e,t,i)*e.length*t.length/(e.length+t.length)}function c(e,t){return e-t}function l(e,t){t===void 0&&(t=!1),t||(e=[].concat(e).sort(c));var i=e.length,n=g(i/2);return 0==i%2?0.5*(e[n-1]+e[n]):e[n]}var u=i(0),m=i(95),d=i(48),h=i(68),p={disFunc:u,kind:'single',isDistanceMatrix:!1};e.exports=function(t,l){l=Object.assign({},p,l);var c=t.length,u=t;if(l.isDistanceMatrix||(u=h(t,l.disFunc)),'string'==typeof l.kind)switch(l.kind){case'single':l.kind=n;break;case'complete':l.kind=o;break;case'average':l.kind=s;break;case'centroid':l.kind=r;break;case'ward':l.kind=a;break;default:throw new RangeError('Unknown kind of similarity');}else if('function'!=typeof l.kind)throw new TypeError('Undefined kind of similarity');for(var g=Array(c),x=0;x<u.length;x++)g[x]=new m(x);for(var i=1e6,w={},y=0;1<g.length;){w={},i=1e6;for(var M=0;M<g.length;M++)for(var j=M+1;j<g.length;j++){var k,b;if(g[M]instanceof m)k=[g[M].index];else{k=Array(g[M].index.length);for(var R=0;R<k.length;R++)k[R]=g[M].index[R].index}if(g[j]instanceof m)b=[g[j].index];else{b=Array(g[j].index.length);for(var e=0;e<b.length;e++)b[e]=g[j].index[e].index}y=l.kind(k,b,u).toFixed(4),y in w?w[y].push([g[M],g[j]]):w[y]=[[g[M],g[j]]],i=v(y,i)}for(var f=w[i.toFixed(4)],I=Array(f.length),S=0,C;0<f.length;){C=f.shift();for(var V=0,D;V<f.length;V++)if(D=f[V].filter(function(e){return-1!==C.indexOf(e)}),0<D.length){var z=f[V].filter(function(e){return-1===C.indexOf(e)});C=C.concat(z),f.splice(V--,1)}I[S++]=C}I.length=S;for(var _=0,P;_<I.length;_++){P=new d,P.children=I[_].concat(),P.distance=i,P.index=Array(c);for(var A=0,L=0;L<I[_].length;L++)I[_][L]instanceof m?P.index[A++]=I[_][L]:(A+=I[_][L].index.length,P.index=I[_][L].index.concat(P.index)),g.splice(g.indexOf(I[_][L]),1);P.index.length=A,g.push(P)}}return g[0]}},function(e,t,i){'use strict';e.exports=i(312)},function(e,t){'use strict';var i,n,o;(function(){var s,r,l,a,c,u,m,d,h,p,k,j,w,x,f;l=g,p=v,r=function(e,t){return e<t?-1:e>t?1:0},h=function(e,t,i,n,o){var s;if(null==i&&(i=0),null==o&&(o=r),0>i)throw new Error('lo must be non-negative');for(null==n&&(n=e.length);i<n;)s=l((i+n)/2),0>o(t,e[s])?n=s:i=s+1;return[].splice.apply(e,[i,i-i].concat(t)),t},u=function(e,t,i){return null==i&&(i=r),e.push(t),x(e,0,e.length-1,i)},c=function(e,t){var i,n;return null==t&&(t=r),i=e.pop(),e.length?(n=e[0],e[0]=i,f(e,0,t)):n=i,n},d=function(e,t,i){var n;return null==i&&(i=r),n=e[0],e[0]=t,f(e,0,i),n},m=function(e,t,i){var n;return null==i&&(i=r),e.length&&0>i(e[0],t)&&(n=[e[0],t],t=n[0],e[0]=n[1],f(e,0,i)),t},a=function(e,t){var n,i,o,s,a,c;for(null==t&&(t=r),s=function(){c=[];for(var t=0,i=l(e.length/2);0<=i?t<i:t>i;0<=i?t++:t--)c.push(t);return c}.apply(this).reverse(),a=[],(i=0,o=s.length);i<o;i++)n=s[i],a.push(f(e,n,t));return a},w=function(e,t,i){var n;if(null==i&&(i=r),n=e.indexOf(t),-1!==n)return x(e,0,n,i),f(e,n,i)},k=function(e,t,i){var n,o,s,l,c;if(null==i&&(i=r),o=e.slice(0,t),!o.length)return o;for(a(o,i),c=e.slice(t),(s=0,l=c.length);s<l;s++)n=c[s],m(o,n,i);return o.sort(i).reverse()},j=function(e,t,n){var o,s,i,l,u,m,d,g,k,j;if(null==n&&(n=r),10*t<=e.length){if(l=e.slice(0,t).sort(n),!l.length)return l;for(i=l[l.length-1],g=e.slice(t),(u=0,d=g.length);u<d;u++)o=g[u],0>n(o,i)&&(h(l,o,0,null,n),l.pop(),i=l[l.length-1]);return l}for(a(e,n),j=[],(s=m=0,k=p(t,e.length));0<=k?m<k:m>k;s=0<=k?++m:--m)j.push(c(e,n));return j},x=function(e,t,i,n){var o,s,a;for(null==n&&(n=r),o=e[i];i>t;){if(a=i-1>>1,s=e[a],0>n(o,s)){e[i]=s,i=a;continue}break}return e[i]=o},f=function(e,t,i){var n,o,s,a,l;for(null==i&&(i=r),o=e.length,l=t,s=e[t],n=2*t+1;n<o;)a=n+1,a<o&&!(0>i(e[n],e[a]))&&(n=a),e[t]=e[n],t=n,n=2*t+1;return e[t]=s,x(e,l,t,i)},s=function(){function e(e){this.cmp=null==e?r:e,this.nodes=[]}return e.push=u,e.pop=c,e.replace=d,e.pushpop=m,e.heapify=a,e.updateItem=w,e.nlargest=k,e.nsmallest=j,e.prototype.push=function(e){return u(this.nodes,e,this.cmp)},e.prototype.pop=function(){return c(this.nodes,this.cmp)},e.prototype.peek=function(){return this.nodes[0]},e.prototype.contains=function(e){return-1!==this.nodes.indexOf(e)},e.prototype.replace=function(e){return d(this.nodes,e,this.cmp)},e.prototype.pushpop=function(e){return m(this.nodes,e,this.cmp)},e.prototype.heapify=function(){return a(this.nodes,this.cmp)},e.prototype.updateItem=function(e){return w(this.nodes,e,this.cmp)},e.prototype.clear=function(){return this.nodes=[]},e.prototype.empty=function(){return 0===this.nodes.length},e.prototype.size=function(){return this.nodes.length},e.prototype.clone=function(){var t;return t=new e,t.nodes=this.nodes.slice(0),t},e.prototype.toArray=function(){return this.nodes.slice(0)},e.prototype.insert=e.prototype.push,e.prototype.top=e.prototype.peek,e.prototype.front=e.prototype.peek,e.prototype.has=e.prototype.contains,e.prototype.copy=e.prototype.clone,e}(),function(s,r){return n=[],i=r,o='function'==typeof i?i.apply(t,n):i,!(void 0!==o&&(e.exports=o))}(this,function(){return s})}).call(void 0)},function(e,t,i){'use strict';(function(e,n){function o(e,i){var n={seen:[],stylize:r};return 3<=arguments.length&&(n.depth=arguments[2]),4<=arguments.length&&(n.colors=arguments[3]),p(i)?n.showHidden=i:i&&t._extend(n,i),x(n.showHidden)&&(n.showHidden=!1),x(n.depth)&&(n.depth=2),x(n.colors)&&(n.colors=!1),x(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=s),l(n,e,n.depth)}function s(e,t){var i=o.styles[t];return i?'\x1B['+o.colors[i][0]+'m'+e+'\x1B['+o.colors[i][1]+'m':e}function r(e){return e}function a(e){var t={};return e.forEach(function(e){t[e]=!0}),t}function l(e,i,o){if(e.customInspect&&i&&v(i.inspect)&&i.inspect!==t.inspect&&!(i.constructor&&i.constructor.prototype===i)){var s=i.inspect(o,e);return w(s)||(s=l(e,s,o)),s}var r=c(e,i);if(r)return r;var p=Object.keys(i),k=a(p);if(e.showHidden&&(p=Object.getOwnPropertyNames(i)),b(i)&&(0<=p.indexOf('message')||0<=p.indexOf('description')))return u(i);if(0===p.length){if(v(i)){var j=i.name?': '+i.name:'';return e.stylize('[Function'+j+']','special')}if(f(i))return e.stylize(RegExp.prototype.toString.call(i),'regexp');if(M(i))return e.stylize(Date.prototype.toString.call(i),'date');if(b(i))return u(i)}var x='',y=!1,R=['{','}'];if(h(i)&&(y=!0,R=['[',']']),v(i)){var I=i.name?': '+i.name:'';x=' [Function'+I+']'}if(f(i)&&(x=' '+RegExp.prototype.toString.call(i)),M(i)&&(x=' '+Date.prototype.toUTCString.call(i)),b(i)&&(x=' '+u(i)),0===p.length&&(!y||0==i.length))return R[0]+x+R[1];if(0>o)return f(i)?e.stylize(RegExp.prototype.toString.call(i),'regexp'):e.stylize('[Object]','special');e.seen.push(i);var n;return n=y?m(e,i,o,k,p):p.map(function(t){return d(e,i,o,k,t,y)}),e.seen.pop(),g(n,x,R)}function c(e,t){if(x(t))return e.stylize('undefined','undefined');if(w(t)){var i='\''+JSON.stringify(t).replace(/^"|"$/g,'').replace(/'/g,'\\\'').replace(/\\"/g,'"')+'\'';return e.stylize(i,'string')}return j(t)?e.stylize(''+t,'number'):p(t)?e.stylize(''+t,'boolean'):k(t)?e.stylize('null','null'):void 0}function u(e){return'['+Error.prototype.toString.call(e)+']'}function m(e,t,n,o,s){for(var r=[],a=0,i=t.length;a<i;++a)C(t,a+'')?r.push(d(e,t,n,o,a+'',!0)):r.push('');return s.forEach(function(i){i.match(/^\d+$/)||r.push(d(e,t,n,o,i,!0))}),r}function d(e,t,i,n,o,s){var r,a,c;if(c=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]},c.get?c.set?a=e.stylize('[Getter/Setter]','special'):a=e.stylize('[Getter]','special'):c.set&&(a=e.stylize('[Setter]','special')),C(n,o)||(r='['+o+']'),a||(0>e.seen.indexOf(c.value)?(a=k(i)?l(e,c.value,null):l(e,c.value,i-1),-1<a.indexOf('\n')&&(s?a=a.split('\n').map(function(e){return'  '+e}).join('\n').substr(2):a='\n'+a.split('\n').map(function(e){return'   '+e}).join('\n'))):a=e.stylize('[Circular]','special')),x(r)){if(s&&o.match(/^\d+$/))return a;r=JSON.stringify(''+o),r.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(r=r.substr(1,r.length-2),r=e.stylize(r,'name')):(r=r.replace(/'/g,'\\\'').replace(/\\"/g,'"').replace(/(^"|"$)/g,'\''),r=e.stylize(r,'string'))}return r+': '+a}function g(e,t,i){var n=0,o=e.reduce(function(e,t){return n++,0<=t.indexOf('\n')&&n++,e+t.replace(/\u001b\[\d\d?m/g,'').length+1},0);return 60<o?i[0]+(''===t?'':t+'\n ')+' '+e.join(',\n  ')+' '+i[1]:i[0]+t+' '+e.join(', ')+' '+i[1]}function h(e){return Array.isArray(e)}function p(e){return'boolean'==typeof e}function k(e){return null===e}function j(e){return'number'==typeof e}function w(e){return'string'==typeof e}function x(e){return void 0===e}function f(e){return y(e)&&'[object RegExp]'===R(e)}function y(e){return'object'==typeof e&&null!==e}function M(e){return y(e)&&'[object Date]'===R(e)}function b(t){return y(t)&&('[object Error]'===R(t)||t instanceof Error)}function v(e){return'function'==typeof e}function R(e){return Object.prototype.toString.call(e)}function I(e){return 10>e?'0'+e.toString(10):e.toString(10)}function S(){var e=new Date,t=[I(e.getHours()),I(e.getMinutes()),I(e.getSeconds())].join(':');return[e.getDate(),_[e.getMonth()],t].join(' ')}function C(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var V=/%[sdj%]/g;t.format=function(e){if(!w(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(o(arguments[n]));return t.join(' ')}for(var n=1,i=arguments,s=i.length,r=(e+'').replace(V,function(e){if('%%'===e)return'%';if(n>=s)return e;switch(e){case'%s':return i[n++]+'';case'%d':return+i[n++];case'%j':try{return JSON.stringify(i[n++])}catch(e){return'[Circular]'}default:return e;}}),a=i[n];n<s;a=i[++n])r+=k(a)||!y(a)?' '+a:' '+o(a);return r},t.deprecate=function(i,o){if(x(e.process))return function(){return t.deprecate(i,o).apply(this,arguments)};if(!0===n.noDeprecation)return i;var s=!1;return function(){if(!s){if(n.throwDeprecation)throw new Error(o);else n.traceDeprecation?console.trace(o):console.error(o);s=!0}return i.apply(this,arguments)}};var D={},z;t.debuglog=function(e){if(x(z)&&(z=n.env.NODE_DEBUG||''),e=e.toUpperCase(),!D[e])if(new RegExp('\\b'+e+'\\b','i').test(z)){var i=n.pid;D[e]=function(){var n=t.format.apply(t,arguments);console.error('%s %d: %s',e,i,n)}}else D[e]=function(){};return D[e]},t.inspect=o,o.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},o.styles={special:'cyan',number:'yellow',boolean:'yellow',undefined:'grey',null:'bold',string:'green',date:'magenta',regexp:'red'},t.isArray=h,t.isBoolean=p,t.isNull=k,t.isNullOrUndefined=function(e){return null==e},t.isNumber=j,t.isString=w,t.isSymbol=function(e){return'symbol'==typeof e},t.isUndefined=x,t.isRegExp=f,t.isObject=y,t.isDate=M,t.isError=b,t.isFunction=v,t.isPrimitive=function(e){return null===e||'boolean'==typeof e||'number'==typeof e||'string'==typeof e||'symbol'==typeof e||'undefined'==typeof e},t.isBuffer=i(316);var _=['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];t.log=function(){console.log('%s - %s',S(),t.format.apply(t,arguments))},t.inherits=i(317),t._extend=function(e,t){if(!t||!y(t))return e;for(var n=Object.keys(t),o=n.length;o--;)e[n[o]]=t[n[o]];return e}}).call(t,i(314),i(315))},function(e){'use strict';var t=function(){return this}();try{t=t||Function('return this')()||(1,eval)('this')}catch(i){'object'==typeof window&&(t=window)}e.exports=t},function(e){'use strict';function t(){throw new Error('setTimeout has not been defined')}function i(){throw new Error('clearTimeout has not been defined')}function n(e){if(u===setTimeout)return setTimeout(e,0);if((u===t||!u)&&setTimeout)return u=setTimeout,setTimeout(e,0);try{return u(e,0)}catch(t){try{return u.call(null,e,0)}catch(t){return u.call(this,e,0)}}}function o(e){if(m===clearTimeout)return clearTimeout(e);if((m===i||!m)&&clearTimeout)return m=clearTimeout,clearTimeout(e);try{return m(e)}catch(t){try{return m.call(null,e)}catch(t){return m.call(this,e)}}}function s(){g&&p&&(g=!1,p.length?d=p.concat(d):h=-1,d.length&&r())}function r(){if(!g){var e=n(s);g=!0;for(var t=d.length;t;){for(p=d,d=[];++h<t;)p&&p[h].run();h=-1,t=d.length}p=null,g=!1,o(e)}}function a(e,t){this.fun=e,this.array=t}function l(){}var c=e.exports={},u,m;(function(){try{u='function'==typeof setTimeout?setTimeout:t}catch(i){u=t}try{m='function'==typeof clearTimeout?clearTimeout:i}catch(t){m=i}})();var d=[],g=!1,h=-1,p;c.nextTick=function(e){var t=Array(arguments.length-1);if(1<arguments.length)for(var o=1;o<arguments.length;o++)t[o-1]=arguments[o];d.push(new a(e,t)),1!==d.length||g||n(r)},a.prototype.run=function(){this.fun.apply(null,this.array)},c.title='browser',c.browser=!0,c.env={},c.argv=[],c.version='',c.versions={},c.on=l,c.addListener=l,c.once=l,c.off=l,c.removeListener=l,c.removeAllListeners=l,c.emit=l,c.prependListener=l,c.prependOnceListener=l,c.listeners=function(){return[]},c.binding=function(){throw new Error('process.binding is not supported')},c.cwd=function(){return'/'},c.chdir=function(){throw new Error('process.chdir is not supported')},c.umask=function(){return 0}},function(e){'use strict';e.exports=function(e){return e&&'object'==typeof e&&'function'==typeof e.copy&&'function'==typeof e.fill&&'function'==typeof e.readUInt8}},function(e){'use strict';e.exports='function'==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}},function(e,t,i){'use strict';function n(e,t,n){for(var o=1e101,s=0;s<e.length;s++)for(var i=s,r;i<t.length;i++)r=n(e[s],t[i]),o=v(r,o);return o}function o(e,t,n){for(var o=-1,s=0;s<e.length;s++)for(var i=s,r;i<t.length;i++)r=n(e[s],t[i]),o=M(r,o);return o}function s(e,t,n){for(var o=0,s=0;s<e.length;s++)for(var i=0;i<t.length;i++)o+=n(e[s],t[i]);return o/(e.length*t.length)}function r(e,t,n){for(var o=0,s=0,r=0,a=0,l=0;l<e.length;l++)o+=e[l][0],s+=e[l][1];for(var i=0;i<t.length;i++)r+=t[i][0],a+=t[i][1];return o/=e.length,s/=e.length,r/=t.length,a/=t.length,n([o,s],[r,a])}function a(e,t,n){for(var o=0,s=0,r=0,a=0,l=0;l<e.length;l++)o+=e[l][0],s+=e[l][1];for(var i=0;i<t.length;i++)r+=t[i][0],a+=t[i][1];return o/=e.length,s/=e.length,r/=t.length,a/=t.length,n([o,s],[r,a])*e.length*t.length/(e.length+t.length)}function l(t,n,o){for(var s={d:0,p:0},r=Array(t[0].length),a=0;a<t[0].length;a++)r[a]=n[t[0][a]];for(var e=Array(t[1].length),l=0;l<t[1].length;l++)e[l]=n[t[1][l]];for(var c=0,i,u;c<r.length;c++){i=0;for(var m=0;m<r.length;m++)c!==m&&(i+=o(r[c],r[m]));i/=r.length-1,u=0;for(var d=0;d<e.length;d++)u+=o(r[c],e[d]);u/=e.length,i-u>s.d&&(s.d=i-u,s.p=c)}return s}function c(e,t,n){for(var o=0,s=0,r=0;r<e.length;r++)for(var i=r;i<e.length;i++)o+=n(t[e[r].index],t[e[i].index]),s++;return o/s}var u=i(0),m=i(95),g=i(48),h={dist:u,kind:'single'};e.exports=function(t,u){if(u=Object.assign({},h,u),'string'==typeof u.kind)switch(u.kind){case'single':u.kind=n;break;case'complete':u.kind=o;break;case'average':u.kind=s;break;case'centroid':u.kind=r;break;case'ward':u.kind=a;break;default:throw new RangeError('Unknown kind of similarity');}else if('function'!=typeof u.kind)throw new TypeError('Undefined kind of similarity');var p=new g;p.children=Array(t.length),p.index=Array(t.length);for(var k=0;k<t.length;k++)p.children[k]=new m(k),p.index[k]=new m(k);p.distance=c(p.index,t,u.dist);for(var x=[p],w,y,b,v,R;0<x.length;){y=0,b=0;for(var I=0;I<x.length;I++){w=0;for(var i=0;i<x[I].length;i++)for(var j=i+1;j<x[I].length;j++)w=M(u.dist(t[x[I].index[i].index],t[x[I].index[j].index]),w);w>y&&(y=w,b=I)}if(y=0,2===x[b].index.length)x[b].children=[x[b].index[0],x[b].index[1]],x[b].distance=u.dist(t[x[b].index[0].index],t[x[b].index[1].index]);else if(3===x[b].index.length){x[b].children=[x[b].index[0],x[b].index[1],x[b].index[2]];var S=[u.dist(t[x[b].index[0].index],t[x[b].index[1].index]),u.dist(t[x[b].index[1].index],t[x[b].index[2].index])];x[b].distance=(S[0]+S[1])/2}else{for(var d=new g,C=new g,V=[Array(x[b].index.length),[]],D=0;D<V[0].length;D++)V[0][D]=D;for(var z=0;z<V[0].length;z++){v=0;for(var _=0;_<V[0].length;_++)z!==_&&(v+=u.dist(t[x[b].index[V[0][_]].index],t[x[b].index[V[0][z]].index]));v/=V[0].length-1,v>y&&(y=v,R=z)}for(V[1]=[R],V[0].splice(R,1),v=l(V,t,u.dist);0<v.d;)V[1].push(V[0][v.p]),V[0].splice(v.p,1),v=l(V,t,u.dist);var P=Array(V[0].length);d.index=Array(V[0].length);for(var A=0;A<P.length;A++)P[A]=t[x[b].index[V[0][A]].index],d.index[A]=x[b].index[V[0][A]],d.children[A]=x[b].index[V[0][A]];var e=Array(V[1].length);C.index=Array(V[1].length);for(var L=0;L<e.length;L++)e[L]=t[x[b].index[V[1][L]].index],C.index[L]=x[b].index[V[1][L]],C.children[L]=x[b].index[V[1][L]];d.distance=c(d.index,t,u.dist),C.distance=c(C.index,t,u.dist),x.push(d),x.push(C),x[b].children=[d,C]}x.splice(b,1)}return p}},function(e,t,i){'use strict';function n(e,t,n,o){for(var r in this.x=e,this.y=t,n=n||{},this.options={},p)this.options[r]=n.hasOwnProperty(r)?n[r]:p[r];if('number'==typeof this.options.fields)this.numWeights=this.options.fields;else if(Array.isArray(this.options.fields)){this.numWeights=this.options.fields.length;var i=s(this.options.fields);this.extractor=i.extractor,this.creator=i.creator}else throw new Error('Invalid fields definition');if('rect'===this.options.gridType)this.nodeType=d,this.gridDim={x:e,y:t};else{this.nodeType=h;var a=this.x-g(this.y/2);this.gridDim={x:a,y:this.y,z:-(0-a-this.y)}}if(this.torus=this.options.torus,this.distanceMethod=this.torus?'getDistanceTorus':'getDistance',this.distance=this.options.distance,this.maxDistance=m(this.distance,this.numWeights),!0===o)return void(this.done=!0);if(!(0<e&&0<t))throw new Error('x and y must be positive');this.times={findBMU:0,adjust:0},this.randomizer=this.options.randomizer,this.iterationCount=0,this.iterations=this.options.iterations,this.startLearningRate=this.learningRate=this.options.learningRate,this.mapRadius=g(M(e,t)/2),this.algorithmMethod=this.options.method,this._initNodes(),this.done=!1}function s(e){for(var t=e.length,n=Array(t),o=Array(t),s=0;s<t;s++)n[s]=a(e[s].range),o[s]=c(e[s].range);return{extractor:function(o){for(var s=Array(t),r=0;r<t;r++)s[r]=n[r](o[e[r].name]);return s},creator:function(n){for(var s={},r=0;r<t;r++)s[e[r].name]=o[r](n[r]);return s}}}function a(e){return function(t){return(t-e[0])/(e[1]-e[0])}}function c(e){return function(t){return e[0]+t*(e[1]-e[0])}}function l(e,t){for(var n=0,o=0,i=e.length;o<i;o++)n+=(e[o]-t[o])*(e[o]-t[o]);return n}function u(e,t){return e[g(t()*e.length)]}function m(e,t){for(var n=Array(t),o=Array(t),s=0;s<t;s++)n[s]=0,o[s]=1;return e(n,o)}var d=i(96),h=i(320),p={fields:3,randomizer:Math.random,distance:l,iterations:10,learningRate:0.1,gridType:'rect',torus:!0,method:'random'};n.load=function(e,t){if('SOM'===e.name){var o=e.data.length,s=e.data[0].length;t?e.options.distance=t:e.options.distance&&(e.options.distance=eval('('+e.options.distance+')'));var r=new n(o,s,e.options,!0);r.nodes=Array(o);for(var a=0;a<o;a++){r.nodes[a]=Array(s);for(var i=0;i<s;i++)r.nodes[a][i]=new r.nodeType(a,i,e.data[a][i],r)}return r}throw new Error('expecting a SOM model')},n.prototype.export=function(e){if(!this.done)throw new Error('model is not ready yet');for(var t={name:'SOM',options:{fields:this.options.fields,gridType:this.options.gridType,torus:this.options.torus},data:Array(this.x)},n=0;n<this.x;n++){t.data[n]=Array(this.y);for(var i=0;i<this.y;i++)t.data[n][i]=this.nodes[n][i].weights}return e&&(t.options.distance=this.distance.toString()),t},n.prototype._initNodes=function(){var e=Date.now(),t,i,n;for(this.nodes=Array(this.x),t=0;t<this.x;t++)for(this.nodes[t]=Array(this.y),i=0;i<this.y;i++){var o=Array(this.numWeights);for(n=0;n<this.numWeights;n++)o[n]=this.randomizer();this.nodes[t][i]=new this.nodeType(t,i,o,this)}this.times.initNodes=Date.now()-e},n.prototype.setTraining=function(e){if(this.trainingSet)throw new Error('training set has already been set');var t=Date.now(),n=e,o=e.length,s;if(this.extractor)for(n=Array(o),s=0;s<o;s++)n[s]=this.extractor(e[s]);this.numIterations=this.iterations*o,this.timeConstant='random'===this.algorithmMethod?this.numIterations/r(this.mapRadius):o/r(this.mapRadius),this.trainingSet=n,this.times.setTraining=Date.now()-t},n.prototype.trainOne=function(){if(this.done)return!1;if(0<this.numIterations--){var e,t,i;return'random'===this.algorithmMethod?(e=this.mapRadius*o(-this.iterationCount/this.timeConstant),t=u(this.trainingSet,this.randomizer),this._adjust(t,e),this.learningRate=this.startLearningRate*o(-this.iterationCount/this.numIterations)):(i=-g(this.iterationCount/this.trainingSet.length),e=this.mapRadius*o(i/this.timeConstant),t=this.trainingSet[this.iterationCount%this.trainingSet.length],this._adjust(t,e),0==(this.iterationCount+1)%this.trainingSet.length&&(this.learningRate=this.startLearningRate*o(i/g(this.numIterations/this.trainingSet.length)))),this.iterationCount++,!0}return this.done=!0,!1},n.prototype._adjust=function(e,t){var i=Date.now(),n=this._findBestMatchingUnit(e),s=Date.now(),r,a,l,c;this.times.findBMU+=s-i;var u=g(t),m=n.x-u,d=n.x+u,h=n.y-u,p=n.y+u;for(r=m;r<=d;r++){var k=r;for(0>r?k+=this.x:r>=this.x&&(k-=this.x),a=h;a<=p;a++){var j=a;0>a?j+=this.y:a>=this.y&&(j-=this.y),l=n[this.distanceMethod](this.nodes[k][j]),l<t&&(c=o(-l/(2*t)),this.nodes[k][j].adjustWeights(e,this.learningRate,c))}}this.times.adjust+=Date.now()-s},n.prototype.train=function(e){if(!this.done)for(this.setTraining(e);this.trainOne(););},n.prototype.getConvertedNodes=function(){for(var e=Array(this.x),t=0;t<this.x;t++){e[t]=Array(this.y);for(var i=0,n;i<this.y;i++)n=this.nodes[t][i],e[t][i]=this.creator?this.creator(n.weights):n.weights}return e},n.prototype._findBestMatchingUnit=function(e){for(var t=Infinity,n=0,i,o;n<this.x;n++)for(var s=0;s<this.y;s++)o=this.distance(this.nodes[n][s].weights,e),o<t&&(t=o,i=this.nodes[n][s]);return i},n.prototype.predict=function(e,t){if('boolean'==typeof e&&(t=e,e=null),e||(e=this.trainingSet),Array.isArray(e)&&(Array.isArray(e[0])||'object'==typeof e[0])){var i=this;return e.map(function(e){return i._predict(e,t)})}return this._predict(e,t)},n.prototype._predict=function(e,t){Array.isArray(e)||(e=this.extractor(e));var i=this._findBestMatchingUnit(e),n=[i.x,i.y];return t&&(n[2]=i.getPosition(e)),n},n.prototype.getQuantizationError=function(){for(var e=this.getFit(),t=e.length,n=0,o=0;o<t;o++)n+=e[o];return n/t},n.prototype.getFit=function(e){e||(e=this.trainingSet);for(var t=e.length,n=Array(t),o=0,i;o<t;o++)i=this._findBestMatchingUnit(e[o]),n[o]=R(this.distance(e[o],i.weights));return n},e.exports=n},function(e,t,i){'use strict';function n(e,t,i,n){o.call(this,e,t,i,n),this.hX=e-g(t/2),this.z=0-this.hX-t}var o=i(96);n.prototype=new o,n.prototype.constructor=n,n.prototype.getDistance=function(e){return M(u(this.hX-e.hX),u(this.y-e.y),u(this.z-e.z))},n.prototype.getDistanceTorus=function(e){var t=u(this.hX-e.hX),i=u(this.y-e.y),n=u(this.z-e.z);return M(v(t,this.som.gridDim.x-t),v(i,this.som.gridDim.y-i),v(n,this.som.gridDim.z-n))},n.prototype.getPosition=function(){throw new Error('Unimplemented : cannot get position of the points for hexagonal grid')},e.exports=n},function(e,t,i){'use strict';var n=i(49),o=i(100),s=i(334),r=i(101),a=i(102);class l{constructor(e){if(e=e||{},e.model){this.hiddenLayers=e.hiddenLayers,this.iterations=e.iterations,this.learningRate=e.learningRate,this.regularization=e.regularization,this.dicts=e.dicts,this.activation=e.activation,this.activationParam=e.activationParam,this.model=Array(e.layers.length);for(var t=0;t<this.model.length-1;++t)this.model[t]=o.load(e.layers[t]);this.model[this.model.length-1]=s.load(e.layers[this.model.length-1])}else this.hiddenLayers=void 0===e.hiddenLayers?[10]:e.hiddenLayers,this.iterations=void 0===e.iterations?50:e.iterations,this.learningRate=void 0===e.learningRate?0.01:e.learningRate,this.regularization=void 0===e.regularization?0.01:e.regularization,this.activation=void 0===e.activation?'tanh':e.activation,this.activationParam=void 0===e.activationParam?1:e.activationParam,this.activation in Object.keys(a)||(this.activation='tanh')}buildNetwork(e,t){var n=2+(this.hiddenLayers.length-1);this.model=Array(n),this.model[0]=new o({inputSize:e,outputSize:this.hiddenLayers[0],activation:this.activation,activationParam:this.activationParam,regularization:this.regularization,epsilon:this.learningRate});for(var r=1;r<this.hiddenLayers.length;++r)this.model[r]=new o({inputSize:this.hiddenLayers[r-1],outputSize:this.hiddenLayers[r],activation:this.activation,activationParam:this.activationParam,regularization:this.regularization,epsilon:this.learningRate});this.model[n-1]=new s({inputSize:this.hiddenLayers[this.hiddenLayers.length-1],outputSize:t,activation:this.activation,activationParam:this.activationParam,regularization:this.regularization,epsilon:this.learningRate})}train(e,t){e=n.checkMatrix(e),this.dicts=r.dictOutputs(t);var o=e.columns,s=Object.keys(this.dicts.inputs).length;this.buildNetwork(o,s);for(var a=0,i;a<this.iterations;++a)i=this.propagate(e),this.backpropagation(e,t,i)}propagate(e){for(var t=e,n=0;n<this.model.length;++n)t=this.model[n].forward(t);return t.divColumnVector(r.sumRow(t))}backpropagation(e,t,n){for(var o=0;o<n.length;++o)n[o][this.dicts.inputs[t[o]]]-=1;var i=n;for(o=this.model.length-1;0<=o;--o){var s=0<o?this.model[o-1].a:e;i=this.model[o].backpropagation(i,s)}for(o=0;o<this.model.length;++o)this.model[o].update()}predict(e){e=n.checkMatrix(e);for(var t=Array(e.rows),o=this.propagate(e),s=0;s<e.rows;++s)t[s]=this.dicts.outputs[o.maxRowIndex(s)[1]];return t}toJSON(){for(var e={model:'FNN',hiddenLayers:this.hiddenLayers,iterations:this.iterations,learningRate:this.learningRate,regularization:this.regularization,activation:this.activation,activationParam:this.activationParam,dicts:this.dicts,layers:Array(this.model.length)},t=0;t<this.model.length;++t)e.layers[t]=this.model[t].toJSON();return e}static load(e){if('FNN'!==e.model)throw new RangeError('the current model is not a feed forward network');return new l(e)}}e.exports=l},function(){'use strict';Symbol.species||(Symbol.species=Symbol.for('@@species'))},function(e,t,i){'use strict';var n=i(22);e.exports=class extends n{constructor(e){super(e,e.columns,e.rows)}set(e,t,i){return this.matrix.set(t,e,i),this}get(e,t){return this.matrix.get(t,e)}}},function(e,t,i){'use strict';var n=i(22);e.exports=class extends n{constructor(e,t){super(e,1,e.columns),this.row=t}set(e,t,i){return this.matrix.set(this.row,t,i),this}get(e,t){return this.matrix.get(this.row,t)}}},function(e,t,i){'use strict';var n=i(22),o=i(31);e.exports=class extends n{constructor(e,t,i,n,s){o.checkRange(e,t,i,n,s),super(e,i-t+1,s-n+1),this.startRow=t,this.startColumn=n}set(e,t,i){return this.matrix.set(this.startRow+e,this.startColumn+t,i),this}get(e,t){return this.matrix.get(this.startRow+e,this.startColumn+t)}}},function(e,t,i){'use strict';var n=i(22),o=i(31);e.exports=class extends n{constructor(e,t,i){var n=o.checkIndices(e,t,i);super(e,n.row.length,n.column.length),this.rowIndices=n.row,this.columnIndices=n.column}set(e,t,i){return this.matrix.set(this.rowIndices[e],this.columnIndices[t],i),this}get(e,t){return this.matrix.get(this.rowIndices[e],this.columnIndices[t])}}},function(e,t,i){'use strict';var n=i(22);e.exports=class extends n{constructor(e,t){super(e,e.rows,1),this.column=t}set(e,t,i){return this.matrix.set(e,this.column,i),this}get(e){return this.matrix.get(e,this.column)}}},function(e,t,i){'use strict';var n=i(22);e.exports=class extends n{constructor(e){super(e,e.rows,e.columns)}set(e,t,i){return this.matrix.set(this.rows-e-1,t,i),this}get(e,t){return this.matrix.get(this.rows-e-1,t)}}},function(e,t,i){'use strict';var n=i(22);e.exports=class extends n{constructor(e){super(e,e.rows,e.columns)}set(e,t,i){return this.matrix.set(e,this.columns-t-1,i),this}get(e,t){return this.matrix.get(e,this.columns-t-1)}}},function(e,t,i){'use strict';function n(e){return e=s.checkMatrix(e),o(e,s.eye(e.rows))}function o(e,t){return e=s.checkMatrix(e),t=s.checkMatrix(t),e.isSquare()?new l(e).solve(t):new c(e).solve(t)}var s=i(12).Matrix,r=i(99),a=i(331),l=i(98),c=i(332),u=i(333);s.inverse=s.inv=n,s.prototype.inverse=s.prototype.inv=function(){return n(this)},s.solve=o,s.prototype.solve=function(e){return o(this,e)},e.exports={SingularValueDecomposition:r,SVD:r,EigenvalueDecomposition:a,EVD:a,LuDecomposition:l,LU:l,QrDecomposition:c,QR:c,CholeskyDecomposition:u,CHO:u,inverse:n,solve:o}},function(e,t,i){'use strict';function o(t,c){if(c=Object.assign({},h,c),!(this instanceof o))return new o(t,c);if(t=m.checkMatrix(t),!t.isSquare())throw new Error('Matrix is not a square matrix');var u=t.columns,n=g(u,u,0),p=Array(u),d=Array(u),e=t,k=!1,x,i;if(k=!!c.assumeSymmetric||t.isSymmetric(),k){for(x=0;x<u;x++)for(i=0;i<u;i++)n[x][i]=e.get(x,i);s(u,d,p,n),r(u,d,p,n)}else{var j=g(u,u,0),w=Array(u);for(i=0;i<u;i++)for(x=0;x<u;x++)j[x][i]=e.get(x,i);a(u,j,w,n),l(u,d,p,n,j)}this.n=u,this.e=d,this.d=p,this.V=n}function s(t,n,e,o){var s,r,a,l,i,c,m,d;for(i=0;i<t;i++)e[i]=o[t-1][i];for(l=t-1;0<l;l--){for(d=0,a=0,c=0;c<l;c++)d+=u(e[c]);if(0===d)for(n[l]=e[l-1],i=0;i<l;i++)e[i]=o[l-1][i],o[l][i]=0,o[i][l]=0;else{for(c=0;c<l;c++)e[c]/=d,a+=e[c]*e[c];for(s=e[l-1],r=R(a),0<s&&(r=-r),n[l]=d*r,a-=s*r,e[l-1]=s-r,i=0;i<l;i++)n[i]=0;for(i=0;i<l;i++){for(s=e[i],o[i][l]=s,r=n[i]+o[i][i]*s,c=i+1;c<=l-1;c++)r+=o[c][i]*e[c],n[c]+=o[c][i]*s;n[i]=r}for(s=0,i=0;i<l;i++)n[i]/=a,s+=n[i]*e[i];for(m=s/(a+a),i=0;i<l;i++)n[i]-=m*e[i];for(i=0;i<l;i++){for(s=e[i],r=n[i],c=i;c<=l-1;c++)o[c][i]-=s*n[c]+r*e[c];e[i]=o[l-1][i],o[l][i]=0}}e[l]=a}for(l=0;l<t-1;l++){if(o[t-1][l]=o[l][l],o[l][l]=1,a=e[l+1],0!==a){for(c=0;c<=l;c++)e[c]=o[c][l+1]/a;for(i=0;i<=l;i++){for(r=0,c=0;c<=l;c++)r+=o[c][l+1]*o[c][i];for(c=0;c<=l;c++)o[c][i]-=r*e[c]}}for(c=0;c<=l;c++)o[c][l+1]=0}for(i=0;i<t;i++)e[i]=o[t-1][i],o[t-1][i]=0;o[t-1][t-1]=1,n[0]=0}function r(t,n,e,o){var a,d,g,i,h,k,l,m,p,x,w,c,y,b,v,R,I;for(g=1;g<t;g++)n[g-1]=n[g];n[t-1]=0;var S=0,f=0,C=2.220446049250313e-16;for(k=0;k<t;k++){for(f=M(f,u(e[k])+u(n[k])),l=k;l<t&&!(u(n[l])<=C*f);)l++;if(l>k){I=0;do{for(++I,a=e[k],m=(e[k+1]-a)/(2*n[k]),p=j(m,1),0>m&&(p=-p),e[k]=n[k]/(m+p),e[k+1]=n[k]*(m+p),x=e[k+1],d=a-e[k],g=k+2;g<t;g++)e[g]-=d;for(S+=d,m=e[l],w=1,c=w,y=w,b=n[k+1],v=0,R=0,g=l-1;g>=k;g--)for(y=c,c=w,R=v,a=w*n[g],d=w*m,p=j(m,n[g]),n[g+1]=v*p,v=n[g]/p,w=m/p,m=w*e[g]-v*a,e[g+1]=d+v*(w*a+v*e[g]),h=0;h<t;h++)d=o[h][g+1],o[h][g+1]=v*o[h][g]+w*d,o[h][g]=w*o[h][g]-v*d;m=-v*R*y*b*n[k]/x,n[k]=v*m,e[k]=w*m}while(u(n[k])>C*f)}e[k]+=S,n[k]=0}for(g=0;g<t-1;g++){for(h=g,m=e[g],i=g+1;i<t;i++)e[i]<m&&(h=i,m=e[i]);if(h!==g)for(e[h]=e[g],e[g]=m,i=0;i<t;i++)m=o[i][g],o[i][g]=o[i][h],o[i][h]=m}}function a(e,t,n,o){var s=0,r=e-1,a,l,c,d,i,h,m;for(h=s+1;h<=r-1;h++){for(m=0,d=h;d<=r;d++)m+=u(t[d][h-1]);if(0!==m){for(c=0,d=r;d>=h;d--)n[d]=t[d][h-1]/m,c+=n[d]*n[d];for(l=R(c),0<n[h]&&(l=-l),c-=n[h]*l,n[h]-=l,i=h;i<e;i++){for(a=0,d=r;d>=h;d--)a+=n[d]*t[d][i];for(a/=c,d=h;d<=r;d++)t[d][i]-=a*n[d]}for(d=0;d<=r;d++){for(a=0,i=r;i>=h;i--)a+=n[i]*t[d][i];for(a/=c,i=h;i<=r;i++)t[d][i]-=a*n[i]}n[h]=m*n[h],t[h][h-1]=m*l}}for(d=0;d<e;d++)for(i=0;i<e;i++)o[d][i]=d===i?1:0;for(h=r-1;h>=s+1;h--)if(0!==t[h][h-1]){for(d=h+1;d<=r;d++)n[d]=t[d][h-1];for(i=h;i<=r;i++){for(l=0,d=h;d<=r;d++)l+=n[d]*o[d][i];for(l=l/n[h]/t[h][h-1],d=h;d<=r;d++)o[d][i]+=l*n[d]}}}function l(o,a,e,d,g){var h=o-1,n=0,f=o-1,b=2.220446049250313e-16,I=0,S=0,C=0,p=0,V=0,D=0,_=0,P=0,A,i,j,k,l,m,t,w,x,y,L,U,F,T,q;for(A=0;A<o;A++)for((A<n||A>f)&&(e[A]=g[A][A],a[A]=0),i=M(A-1,0);i<o;i++)S+=u(g[A][i]);for(;h>=n;){for(k=h;k>n&&(D=u(g[k-1][k-1])+u(g[k][k]),0===D&&(D=S),!(u(g[k][k-1])<b*D));)k--;if(k===h)g[h][h]+=I,e[h]=g[h][h],a[h]=0,h--,P=0;else if(k===h-1){if(t=g[h][h-1]*g[h-1][h],C=(g[h-1][h-1]-g[h][h])/2,p=C*C+t,_=R(u(p)),g[h][h]+=I,g[h-1][h-1]=g[h-1][h-1]+I,w=g[h][h],0<=p){for(_=0<=C?C+_:C-_,e[h-1]=w+_,e[h]=e[h-1],0!==_&&(e[h]=w-t/_),a[h-1]=0,a[h]=0,w=g[h][h-1],D=u(w)+u(_),C=w/D,p=_/D,V=R(C*C+p*p),C/=V,p/=V,i=h-1;i<o;i++)_=g[h-1][i],g[h-1][i]=p*_+C*g[h][i],g[h][i]=p*g[h][i]-C*_;for(A=0;A<=h;A++)_=g[A][h-1],g[A][h-1]=p*_+C*g[A][h],g[A][h]=p*g[A][h]-C*_;for(A=n;A<=f;A++)_=d[A][h-1],d[A][h-1]=p*_+C*d[A][h],d[A][h]=p*d[A][h]-C*_}else e[h-1]=w+C,e[h]=w+C,a[h-1]=_,a[h]=-_;h-=2,P=0}else{if(w=g[h][h],x=0,t=0,k<h&&(x=g[h-1][h-1],t=g[h][h-1]*g[h-1][h]),10==P){for(I+=w,A=n;A<=h;A++)g[A][A]-=w;D=u(g[h][h-1])+u(g[h-1][h-2]),w=x=0.75*D,t=-0.4375*D*D}if(30==P&&(D=(x-w)/2,D=D*D+t,0<D)){for(D=R(D),x<w&&(D=-D),D=w-t/((x-w)/2+D),A=n;A<=h;A++)g[A][A]-=D;I+=D,w=x=t=0.964}for(++P,l=h-2;l>=k&&(_=g[l][l],V=w-_,D=x-_,C=(V*D-t)/g[l+1][l]+g[l][l+1],p=g[l+1][l+1]-_-V-D,V=g[l+2][l+1],D=u(C)+u(p)+u(V),C/=D,p/=D,V/=D,l!==k)&&!(u(g[l][l-1])*(u(p)+u(V))<b*(u(C)*(u(g[l-1][l-1])+u(_)+u(g[l+1][l+1]))));)l--;for(A=l+2;A<=h;A++)g[A][A-2]=0,A>l+2&&(g[A][A-3]=0);for(j=l;j<=h-1&&(T=j!==h-1,j!==l&&(C=g[j][j-1],p=g[j+1][j-1],V=T?g[j+2][j-1]:0,w=u(C)+u(p)+u(V),0!==w&&(C/=w,p/=w,V/=w)),0!==w);j++)if(D=R(C*C+p*p+V*V),0>C&&(D=-D),0!==D){for(j===l?k!==l&&(g[j][j-1]=-g[j][j-1]):g[j][j-1]=-D*w,C+=D,w=C/D,x=p/D,_=V/D,p/=C,V/=C,i=j;i<o;i++)C=g[j][i]+p*g[j+1][i],T&&(C+=V*g[j+2][i],g[j+2][i]=g[j+2][i]-C*_),g[j][i]-=C*w,g[j+1][i]=g[j+1][i]-C*x;for(A=0;A<=v(h,j+3);A++)C=w*g[A][j]+x*g[A][j+1],T&&(C+=_*g[A][j+2],g[A][j+2]=g[A][j+2]-C*V),g[A][j]-=C,g[A][j+1]=g[A][j+1]-C*p;for(A=n;A<=f;A++)C=w*d[A][j]+x*d[A][j+1],T&&(C+=_*d[A][j+2],d[A][j+2]=d[A][j+2]-C*V),d[A][j]-=C,d[A][j+1]=d[A][j+1]-C*p}}}if(0!==S){for(h=o-1;0<=h;h--)if(C=e[h],p=a[h],0===p)for(k=h,g[h][h]=1,A=h-1;0<=A;A--){for(t=g[A][A]-C,V=0,i=k;i<=h;i++)V+=g[A][i]*g[i][h];if(0>a[A])_=t,D=V;else if(k=A,0===a[A]?g[A][h]=0===t?-V/(b*S):-V/t:(w=g[A][A+1],x=g[A+1][A],p=(e[A]-C)*(e[A]-C)+a[A]*a[A],m=(w*D-_*V)/p,g[A][h]=m,g[A+1][h]=u(w)>u(_)?(-V-t*m)/w:(-D-x*m)/_),m=u(g[A][h]),1<b*m*m)for(i=A;i<=h;i++)g[i][h]/=m}else if(0>p)for(k=h-1,u(g[h][h-1])>u(g[h-1][h])?(g[h-1][h-1]=p/g[h][h-1],g[h-1][h]=-(g[h][h]-C)/g[h][h-1]):(q=c(0,-g[h-1][h],g[h-1][h-1]-C,p),g[h-1][h-1]=q[0],g[h-1][h]=q[1]),g[h][h-1]=0,g[h][h]=1,A=h-2;0<=A;A--){for(y=0,L=0,i=k;i<=h;i++)y+=g[A][i]*g[i][h-1],L+=g[A][i]*g[i][h];if(t=g[A][A]-C,0>a[A])_=t,V=y,D=L;else if(k=A,0===a[A]?(q=c(-y,-L,t,p),g[A][h-1]=q[0],g[A][h]=q[1]):(w=g[A][A+1],x=g[A+1][A],U=(e[A]-C)*(e[A]-C)+a[A]*a[A]-p*p,F=2*(e[A]-C)*p,0===U&&0===F&&(U=b*S*(u(t)+u(p)+u(w)+u(x)+u(_))),q=c(w*V-_*y+p*L,w*D-_*L-p*y,U,F),g[A][h-1]=q[0],g[A][h]=q[1],u(w)>u(_)+u(p)?(g[A+1][h-1]=(-y-t*g[A][h-1]+p*g[A][h])/w,g[A+1][h]=(-L-t*g[A][h]-p*g[A][h-1])/w):(q=c(-V-x*g[A][h-1],-D-x*g[A][h],_,p),g[A+1][h-1]=q[0],g[A+1][h]=q[1])),m=M(u(g[A][h-1]),u(g[A][h])),1<b*m*m)for(i=A;i<=h;i++)g[i][h-1]=g[i][h-1]/m,g[i][h]/=m}for(A=0;A<o;A++)if(A<n||A>f)for(i=A;i<o;i++)d[A][i]=g[A][i];for(i=o-1;i>=n;i--)for(A=n;A<=f;A++){for(_=0,j=n;j<=v(i,f);j++)_+=d[A][j]*g[j][i];d[A][i]=_}}}function c(e,t,i,n){var o,s;return u(i)>u(n)?(o=n/i,s=i+o*n,[(e+o*t)/s,(t-o*e)/s]):(o=i/n,s=n+o*i,[(o*e+t)/s,(o*t-e)/s])}var m=i(12).Matrix,n=i(50),j=n.hypotenuse,g=n.getFilled2DArray,h={assumeSymmetric:!1};o.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return m.isMatrix(this.V)||(this.V=new m(this.V)),this.V},get diagonalMatrix(){var t=this.n,n=this.e,e=this.d,o=new m(t,t),s,i;for(s=0;s<t;s++){for(i=0;i<t;i++)o[s][i]=0;o[s][s]=e[s],0<n[s]?o[s][s+1]=n[s]:0>n[s]&&(o[s][s-1]=n[s])}return o}},e.exports=o},function(e,t,i){'use strict';function o(e){if(!(this instanceof o))return new o(e);e=r.checkMatrix(e);var t=e.clone(),a=e.rows,l=e.columns,c=Array(l),u,i,m,d;for(m=0;m<l;m++){var g=0;for(u=m;u<a;u++)g=n(g,t[u][m]);if(0!==g){for(0>t[m][m]&&(g=-g),u=m;u<a;u++)t[u][m]/=g;for(t[m][m]+=1,i=m+1;i<l;i++){for(d=0,u=m;u<a;u++)d+=t[u][m]*t[u][i];for(d=-d/t[m][m],u=m;u<a;u++)t[u][i]+=d*t[u][m]}}c[m]=-g}this.QR=t,this.Rdiag=c}var r=i(12).Matrix,n=i(50).hypotenuse;o.prototype={solve:function(e){e=r.checkMatrix(e);var t=this.QR,o=t.rows;if(e.rows!==o)throw new Error('Matrix row dimensions must agree');if(!this.isFullRank())throw new Error('Matrix is rank deficient');var a=e.columns,l=e.clone(),c=t.columns,n,i,u,m;for(u=0;u<c;u++)for(i=0;i<a;i++){for(m=0,n=u;n<o;n++)m+=t[n][u]*l[n][i];for(m=-m/t[u][u],n=u;n<o;n++)l[n][i]+=m*t[n][u]}for(u=c-1;0<=u;u--){for(i=0;i<a;i++)l[u][i]/=this.Rdiag[u];for(n=0;n<u;n++)for(i=0;i<a;i++)l[n][i]-=l[u][i]*t[n][u]}return l.subMatrix(0,c-1,0,a-1)},isFullRank:function(){for(var e=this.QR.columns,t=0;t<e;t++)if(0===this.Rdiag[t])return!1;return!0},get upperTriangularMatrix(){var e=this.QR,t=e.columns,n=new r(t,t),o,i;for(o=0;o<t;o++)for(i=0;i<t;i++)n[o][i]=o<i?e[o][i]:o===i?this.Rdiag[o]:0;return n},get orthogonalMatrix(){var e=this.QR,t=e.rows,n=e.columns,o=new r(t,n),a,i,l,c;for(l=n-1;0<=l;l--){for(a=0;a<t;a++)o[a][l]=0;for(o[l][l]=1,i=l;i<n;i++)if(0!==e[l][l]){for(c=0,a=l;a<t;a++)c+=e[a][l]*o[a][i];for(c=-c/e[l][l],a=l;a<t;a++)o[a][i]+=c*e[a][l]}}return o}},e.exports=o},function(e,t,i){'use strict';function n(e){if(!(this instanceof n))return new n(e);if(e=o.checkMatrix(e),!e.isSymmetric())throw new Error('Matrix is not symmetric');var t=e,r=t.rows,a=new o(r,r),l=!0,c,i,u;for(i=0;i<r;i++){var m=a[i],g=0;for(u=0;u<i;u++){var d=a[u],h=0;for(c=0;c<u;c++)h+=d[c]*m[c];m[u]=h=(t[i][u]-h)/a[u][u],g+=h*h}for(g=t[i][i]-g,l&=0<g,a[i][i]=R(M(g,0)),u=i+1;u<r;u++)a[i][u]=0}if(!l)throw new Error('Matrix is not positive definite');this.L=a}var o=i(12).Matrix;n.prototype={get lowerTriangularMatrix(){return this.L},solve:function(e){e=o.checkMatrix(e);var t=this.L,n=t.rows;if(e.rows!==n)throw new Error('Matrix dimensions do not match');var s=e.columns,r=e.clone(),a,i,l;for(l=0;l<n;l++)for(i=0;i<s;i++){for(a=0;a<l;a++)r[l][i]-=r[a][i]*t[l][a];r[l][i]/=t[l][l]}for(l=n-1;0<=l;l--)for(i=0;i<s;i++){for(a=l+1;a<n;a++)r[l][i]-=r[a][i]*t[a][l];r[l][i]/=t[l][l]}return r}},e.exports=n},function(e,t,i){'use strict';var n=i(100);class s extends n{constructor(e){super(e),this.activationFunction=function(e,t){this[e][t]=o(this[e][t])}}static load(e){if('Layer'!==e.model)throw new RangeError('the current model is not a Layer model');return new s(e)}}e.exports=s}])});
//# sourceMappingURL=ml.min.js.map